2020-08-26 09:55:44
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 09:55:44
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:55:44
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:55:44
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 09:55:44
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:55:45
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/26 9:55:45
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 09:55:47
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 09:55:47
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 09:55:47
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 09:55:48
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 09:55:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 09:55:49
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 09:55:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 09:55:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 09:55:49
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode32) AND ([TbUser].[UserPwd] = @UserPwd33) 	
Parameters:
@UserCode32[String] = 500000
@UserPwd33[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode34 	
Parameters:
@UserCode34[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 09:58:07
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu35,@ActionType36,@HostName37,@LogDate38,@UserCode39,@UserIP40);select scope_identity()	
Parameters:
@ActionMenu35[String] = 0
@ActionType36[String] = 登录系统
@HostName37[String] = 
@LogDate38[DateTime] = 2020/8/26 9:58:07
@UserCode39[String] = 500000
@UserIP40[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 09:58:08
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 09:58:08
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 09:58:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type41) AND ([TbOrganizationMap].[ProjectId] = @ProjectId42)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode43,@CompanyCode44,@CompanyCode45,@CompanyCode46,@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode51))) 	
Parameters:
@Type41[Int32] = 1
@ProjectId42[String] = 6372912251695766465
@CompanyCode43[String] = 6373083923489249281
@CompanyCode44[String] = 6373083925531366080
@CompanyCode45[String] = 6373083927883400612
@CompanyCode46[String] = 6373083918575368225
@CompanyCode47[String] = 6373083920445075162
@CompanyCode48[String] = 6373083908618598731
@CompanyCode49[String] = 6373083911842783146
@CompanyCode50[String] = 6373083913928202424
@ParentCompanyCode51[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type52) AND ([TbOrganizationMap].[ProjectId] = @ProjectId53)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode54,@CompanyCode55,@CompanyCode56,@CompanyCode57,@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode62))) 	
Parameters:
@Type52[Int32] = 2
@ProjectId53[String] = 6372912251695766465
@CompanyCode54[String] = 6373083923489249281
@CompanyCode55[String] = 6373083925531366080
@CompanyCode56[String] = 6373083927883400612
@CompanyCode57[String] = 6373083918575368225
@CompanyCode58[String] = 6373083920445075162
@CompanyCode59[String] = 6373083908618598731
@CompanyCode60[String] = 6373083911842783146
@CompanyCode61[String] = 6373083913928202424
@ParentCompanyCode62[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 09:58:09
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:01:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type63) AND ([TbOrganizationMap].[ProjectId] = @ProjectId64)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode65,@CompanyCode66,@CompanyCode67,@CompanyCode68,@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode73))) 	
Parameters:
@Type63[Int32] = 1
@ProjectId64[String] = 6372912251695766465
@CompanyCode65[String] = 6373083923489249281
@CompanyCode66[String] = 6373083925531366080
@CompanyCode67[String] = 6373083927883400612
@CompanyCode68[String] = 6373083918575368225
@CompanyCode69[String] = 6373083920445075162
@CompanyCode70[String] = 6373083908618598731
@CompanyCode71[String] = 6373083911842783146
@CompanyCode72[String] = 6373083913928202424
@ParentCompanyCode73[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type74) AND ([TbOrganizationMap].[ProjectId] = @ProjectId75)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode76,@CompanyCode77,@CompanyCode78,@CompanyCode79,@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode84))) 	
Parameters:
@Type74[Int32] = 2
@ProjectId75[String] = 6372912251695766465
@CompanyCode76[String] = 6373083923489249281
@CompanyCode77[String] = 6373083925531366080
@CompanyCode78[String] = 6373083927883400612
@CompanyCode79[String] = 6373083918575368225
@CompanyCode80[String] = 6373083920445075162
@CompanyCode81[String] = 6373083908618598731
@CompanyCode82[String] = 6373083911842783146
@CompanyCode83[String] = 6373083913928202424
@ParentCompanyCode84[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:02:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:02:43
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:02:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:02:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:02:43
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:02:51
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:02:51
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:02:51
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type85) AND ([TbOrganizationMap].[ProjectId] = @ProjectId86)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode87,@CompanyCode88,@CompanyCode89,@CompanyCode90,@CompanyCode91,@CompanyCode92,@CompanyCode93,@CompanyCode94)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode95))) 	
Parameters:
@Type85[Int32] = 1
@ProjectId86[String] = 6372912251695766465
@CompanyCode87[String] = 6373083923489249281
@CompanyCode88[String] = 6373083925531366080
@CompanyCode89[String] = 6373083927883400612
@CompanyCode90[String] = 6373083918575368225
@CompanyCode91[String] = 6373083920445075162
@CompanyCode92[String] = 6373083908618598731
@CompanyCode93[String] = 6373083911842783146
@CompanyCode94[String] = 6373083913928202424
@ParentCompanyCode95[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type96) AND ([TbOrganizationMap].[ProjectId] = @ProjectId97)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode98,@CompanyCode99,@CompanyCode100,@CompanyCode101,@CompanyCode102,@CompanyCode103,@CompanyCode104,@CompanyCode105)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode106))) 	
Parameters:
@Type96[Int32] = 2
@ProjectId97[String] = 6372912251695766465
@CompanyCode98[String] = 6373083923489249281
@CompanyCode99[String] = 6373083925531366080
@CompanyCode100[String] = 6373083927883400612
@CompanyCode101[String] = 6373083918575368225
@CompanyCode102[String] = 6373083920445075162
@CompanyCode103[String] = 6373083908618598731
@CompanyCode104[String] = 6373083911842783146
@CompanyCode105[String] = 6373083913928202424
@ParentCompanyCode106[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:02:52
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode107) AND ([TbUser].[UserPwd] = @UserPwd108) 	
Parameters:
@UserCode107[String] = 500000
@UserPwd108[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode109 	
Parameters:
@UserCode109[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:03:04
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu110,@ActionType111,@HostName112,@LogDate113,@UserCode114,@UserIP115);select scope_identity()	
Parameters:
@ActionMenu110[String] = 0
@ActionType111[String] = 登录系统
@HostName112[String] = 
@LogDate113[DateTime] = 2020/8/26 10:03:04
@UserCode114[String] = 500000
@UserIP115[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type116) AND ([TbOrganizationMap].[ProjectId] = @ProjectId117)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode118,@CompanyCode119,@CompanyCode120,@CompanyCode121,@CompanyCode122,@CompanyCode123,@CompanyCode124,@CompanyCode125)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode126))) 	
Parameters:
@Type116[Int32] = 1
@ProjectId117[String] = 6372912251695766465
@CompanyCode118[String] = 6373083923489249281
@CompanyCode119[String] = 6373083925531366080
@CompanyCode120[String] = 6373083927883400612
@CompanyCode121[String] = 6373083918575368225
@CompanyCode122[String] = 6373083920445075162
@CompanyCode123[String] = 6373083908618598731
@CompanyCode124[String] = 6373083911842783146
@CompanyCode125[String] = 6373083913928202424
@ParentCompanyCode126[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type127) AND ([TbOrganizationMap].[ProjectId] = @ProjectId128)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode129,@CompanyCode130,@CompanyCode131,@CompanyCode132,@CompanyCode133,@CompanyCode134,@CompanyCode135,@CompanyCode136)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode137))) 	
Parameters:
@Type127[Int32] = 2
@ProjectId128[String] = 6372912251695766465
@CompanyCode129[String] = 6373083923489249281
@CompanyCode130[String] = 6373083925531366080
@CompanyCode131[String] = 6373083927883400612
@CompanyCode132[String] = 6373083918575368225
@CompanyCode133[String] = 6373083920445075162
@CompanyCode134[String] = 6373083908618598731
@CompanyCode135[String] = 6373083911842783146
@CompanyCode136[String] = 6373083913928202424
@ParentCompanyCode137[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:03:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:03:06
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:03:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:03:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:03:06
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:04:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:04:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:04:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type138) AND ([TbOrganizationMap].[ProjectId] = @ProjectId139)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode140,@CompanyCode141,@CompanyCode142,@CompanyCode143,@CompanyCode144,@CompanyCode145,@CompanyCode146,@CompanyCode147)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode148))) 	
Parameters:
@Type138[Int32] = 1
@ProjectId139[String] = 6372912251695766465
@CompanyCode140[String] = 6373083923489249281
@CompanyCode141[String] = 6373083925531366080
@CompanyCode142[String] = 6373083927883400612
@CompanyCode143[String] = 6373083918575368225
@CompanyCode144[String] = 6373083920445075162
@CompanyCode145[String] = 6373083908618598731
@CompanyCode146[String] = 6373083911842783146
@CompanyCode147[String] = 6373083913928202424
@ParentCompanyCode148[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type149) AND ([TbOrganizationMap].[ProjectId] = @ProjectId150)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode151,@CompanyCode152,@CompanyCode153,@CompanyCode154,@CompanyCode155,@CompanyCode156,@CompanyCode157,@CompanyCode158)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode159))) 	
Parameters:
@Type149[Int32] = 2
@ProjectId150[String] = 6372912251695766465
@CompanyCode151[String] = 6373083923489249281
@CompanyCode152[String] = 6373083925531366080
@CompanyCode153[String] = 6373083927883400612
@CompanyCode154[String] = 6373083918575368225
@CompanyCode155[String] = 6373083920445075162
@CompanyCode156[String] = 6373083908618598731
@CompanyCode157[String] = 6373083911842783146
@CompanyCode158[String] = 6373083913928202424
@ParentCompanyCode159[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:04:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type160) AND ([TbOrganizationMap].[ProjectId] = @ProjectId161)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode162,@CompanyCode163,@CompanyCode164,@CompanyCode165,@CompanyCode166,@CompanyCode167,@CompanyCode168,@CompanyCode169)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode170))) 	
Parameters:
@Type160[Int32] = 1
@ProjectId161[String] = 6372912251695766465
@CompanyCode162[String] = 6373083923489249281
@CompanyCode163[String] = 6373083925531366080
@CompanyCode164[String] = 6373083927883400612
@CompanyCode165[String] = 6373083918575368225
@CompanyCode166[String] = 6373083920445075162
@CompanyCode167[String] = 6373083908618598731
@CompanyCode168[String] = 6373083911842783146
@CompanyCode169[String] = 6373083913928202424
@ParentCompanyCode170[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type171) AND ([TbOrganizationMap].[ProjectId] = @ProjectId172)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode173,@CompanyCode174,@CompanyCode175,@CompanyCode176,@CompanyCode177,@CompanyCode178,@CompanyCode179,@CompanyCode180)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode181))) 	
Parameters:
@Type171[Int32] = 2
@ProjectId172[String] = 6372912251695766465
@CompanyCode173[String] = 6373083923489249281
@CompanyCode174[String] = 6373083925531366080
@CompanyCode175[String] = 6373083927883400612
@CompanyCode176[String] = 6373083918575368225
@CompanyCode177[String] = 6373083920445075162
@CompanyCode178[String] = 6373083908618598731
@CompanyCode179[String] = 6373083911842783146
@CompanyCode180[String] = 6373083913928202424
@ParentCompanyCode181[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:05:20
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:05:28
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:05:28
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:05:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type182) AND ([TbOrganizationMap].[ProjectId] = @ProjectId183)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode184,@CompanyCode185,@CompanyCode186,@CompanyCode187,@CompanyCode188,@CompanyCode189,@CompanyCode190,@CompanyCode191)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode192))) 	
Parameters:
@Type182[Int32] = 1
@ProjectId183[String] = 6372912251695766465
@CompanyCode184[String] = 6373083923489249281
@CompanyCode185[String] = 6373083925531366080
@CompanyCode186[String] = 6373083927883400612
@CompanyCode187[String] = 6373083918575368225
@CompanyCode188[String] = 6373083920445075162
@CompanyCode189[String] = 6373083908618598731
@CompanyCode190[String] = 6373083911842783146
@CompanyCode191[String] = 6373083913928202424
@ParentCompanyCode192[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type193) AND ([TbOrganizationMap].[ProjectId] = @ProjectId194)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode195,@CompanyCode196,@CompanyCode197,@CompanyCode198,@CompanyCode199,@CompanyCode200,@CompanyCode201,@CompanyCode202)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode203))) 	
Parameters:
@Type193[Int32] = 2
@ProjectId194[String] = 6372912251695766465
@CompanyCode195[String] = 6373083923489249281
@CompanyCode196[String] = 6373083925531366080
@CompanyCode197[String] = 6373083927883400612
@CompanyCode198[String] = 6373083918575368225
@CompanyCode199[String] = 6373083920445075162
@CompanyCode200[String] = 6373083908618598731
@CompanyCode201[String] = 6373083911842783146
@CompanyCode202[String] = 6373083913928202424
@ParentCompanyCode203[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:05:29
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:08:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:09:37
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:09:37
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:09:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type204) AND ([TbOrganizationMap].[ProjectId] = @ProjectId205)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode206,@CompanyCode207,@CompanyCode208,@CompanyCode209,@CompanyCode210,@CompanyCode211,@CompanyCode212,@CompanyCode213)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode214))) 	
Parameters:
@Type204[Int32] = 1
@ProjectId205[String] = 6372912251695766465
@CompanyCode206[String] = 6373083923489249281
@CompanyCode207[String] = 6373083925531366080
@CompanyCode208[String] = 6373083927883400612
@CompanyCode209[String] = 6373083918575368225
@CompanyCode210[String] = 6373083920445075162
@CompanyCode211[String] = 6373083908618598731
@CompanyCode212[String] = 6373083911842783146
@CompanyCode213[String] = 6373083913928202424
@ParentCompanyCode214[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type215) AND ([TbOrganizationMap].[ProjectId] = @ProjectId216)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode217,@CompanyCode218,@CompanyCode219,@CompanyCode220,@CompanyCode221,@CompanyCode222,@CompanyCode223,@CompanyCode224)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode225))) 	
Parameters:
@Type215[Int32] = 2
@ProjectId216[String] = 6372912251695766465
@CompanyCode217[String] = 6373083923489249281
@CompanyCode218[String] = 6373083925531366080
@CompanyCode219[String] = 6373083927883400612
@CompanyCode220[String] = 6373083918575368225
@CompanyCode221[String] = 6373083920445075162
@CompanyCode222[String] = 6373083908618598731
@CompanyCode223[String] = 6373083911842783146
@CompanyCode224[String] = 6373083913928202424
@ParentCompanyCode225[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:09:38
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type226) AND ([TbOrganizationMap].[ProjectId] = @ProjectId227)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode228,@CompanyCode229,@CompanyCode230,@CompanyCode231,@CompanyCode232,@CompanyCode233,@CompanyCode234,@CompanyCode235)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode236))) 	
Parameters:
@Type226[Int32] = 1
@ProjectId227[String] = 6372912251695766465
@CompanyCode228[String] = 6373083923489249281
@CompanyCode229[String] = 6373083925531366080
@CompanyCode230[String] = 6373083927883400612
@CompanyCode231[String] = 6373083918575368225
@CompanyCode232[String] = 6373083920445075162
@CompanyCode233[String] = 6373083908618598731
@CompanyCode234[String] = 6373083911842783146
@CompanyCode235[String] = 6373083913928202424
@ParentCompanyCode236[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type237) AND ([TbOrganizationMap].[ProjectId] = @ProjectId238)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode239,@CompanyCode240,@CompanyCode241,@CompanyCode242,@CompanyCode243,@CompanyCode244,@CompanyCode245,@CompanyCode246)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode247))) 	
Parameters:
@Type237[Int32] = 2
@ProjectId238[String] = 6372912251695766465
@CompanyCode239[String] = 6373083923489249281
@CompanyCode240[String] = 6373083925531366080
@CompanyCode241[String] = 6373083927883400612
@CompanyCode242[String] = 6373083918575368225
@CompanyCode243[String] = 6373083920445075162
@CompanyCode244[String] = 6373083908618598731
@CompanyCode245[String] = 6373083911842783146
@CompanyCode246[String] = 6373083913928202424
@ParentCompanyCode247[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:09:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:09:50
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:09:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:09:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:09:50
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:11:26
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:11:26
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:11:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type248) AND ([TbOrganizationMap].[ProjectId] = @ProjectId249)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode250,@CompanyCode251,@CompanyCode252,@CompanyCode253,@CompanyCode254,@CompanyCode255,@CompanyCode256,@CompanyCode257)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode258))) 	
Parameters:
@Type248[Int32] = 1
@ProjectId249[String] = 6372912251695766465
@CompanyCode250[String] = 6373083923489249281
@CompanyCode251[String] = 6373083925531366080
@CompanyCode252[String] = 6373083927883400612
@CompanyCode253[String] = 6373083918575368225
@CompanyCode254[String] = 6373083920445075162
@CompanyCode255[String] = 6373083908618598731
@CompanyCode256[String] = 6373083911842783146
@CompanyCode257[String] = 6373083913928202424
@ParentCompanyCode258[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type259) AND ([TbOrganizationMap].[ProjectId] = @ProjectId260)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode261,@CompanyCode262,@CompanyCode263,@CompanyCode264,@CompanyCode265,@CompanyCode266,@CompanyCode267,@CompanyCode268)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode269))) 	
Parameters:
@Type259[Int32] = 2
@ProjectId260[String] = 6372912251695766465
@CompanyCode261[String] = 6373083923489249281
@CompanyCode262[String] = 6373083925531366080
@CompanyCode263[String] = 6373083927883400612
@CompanyCode264[String] = 6373083918575368225
@CompanyCode265[String] = 6373083920445075162
@CompanyCode266[String] = 6373083908618598731
@CompanyCode267[String] = 6373083911842783146
@CompanyCode268[String] = 6373083913928202424
@ParentCompanyCode269[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:11:27
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:11:28
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:12:50
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:12:50
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:12:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type270) AND ([TbOrganizationMap].[ProjectId] = @ProjectId271)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode272,@CompanyCode273,@CompanyCode274,@CompanyCode275,@CompanyCode276,@CompanyCode277,@CompanyCode278,@CompanyCode279)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode280))) 	
Parameters:
@Type270[Int32] = 1
@ProjectId271[String] = 6372912251695766465
@CompanyCode272[String] = 6373083923489249281
@CompanyCode273[String] = 6373083925531366080
@CompanyCode274[String] = 6373083927883400612
@CompanyCode275[String] = 6373083918575368225
@CompanyCode276[String] = 6373083920445075162
@CompanyCode277[String] = 6373083908618598731
@CompanyCode278[String] = 6373083911842783146
@CompanyCode279[String] = 6373083913928202424
@ParentCompanyCode280[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type281) AND ([TbOrganizationMap].[ProjectId] = @ProjectId282)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode283,@CompanyCode284,@CompanyCode285,@CompanyCode286,@CompanyCode287,@CompanyCode288,@CompanyCode289,@CompanyCode290)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode291))) 	
Parameters:
@Type281[Int32] = 2
@ProjectId282[String] = 6372912251695766465
@CompanyCode283[String] = 6373083923489249281
@CompanyCode284[String] = 6373083925531366080
@CompanyCode285[String] = 6373083927883400612
@CompanyCode286[String] = 6373083918575368225
@CompanyCode287[String] = 6373083920445075162
@CompanyCode288[String] = 6373083908618598731
@CompanyCode289[String] = 6373083911842783146
@CompanyCode290[String] = 6373083913928202424
@ParentCompanyCode291[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:12:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:12:57
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:13:14
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:13:14
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:13:14
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:13:14
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:13:54
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:13:54
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:13:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type292) AND ([TbOrganizationMap].[ProjectId] = @ProjectId293)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode294,@CompanyCode295,@CompanyCode296,@CompanyCode297,@CompanyCode298,@CompanyCode299,@CompanyCode300,@CompanyCode301)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode302))) 	
Parameters:
@Type292[Int32] = 1
@ProjectId293[String] = 6372912251695766465
@CompanyCode294[String] = 6373083923489249281
@CompanyCode295[String] = 6373083925531366080
@CompanyCode296[String] = 6373083927883400612
@CompanyCode297[String] = 6373083918575368225
@CompanyCode298[String] = 6373083920445075162
@CompanyCode299[String] = 6373083908618598731
@CompanyCode300[String] = 6373083911842783146
@CompanyCode301[String] = 6373083913928202424
@ParentCompanyCode302[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type303) AND ([TbOrganizationMap].[ProjectId] = @ProjectId304)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode305,@CompanyCode306,@CompanyCode307,@CompanyCode308,@CompanyCode309,@CompanyCode310,@CompanyCode311,@CompanyCode312)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode313))) 	
Parameters:
@Type303[Int32] = 2
@ProjectId304[String] = 6372912251695766465
@CompanyCode305[String] = 6373083923489249281
@CompanyCode306[String] = 6373083925531366080
@CompanyCode307[String] = 6373083927883400612
@CompanyCode308[String] = 6373083918575368225
@CompanyCode309[String] = 6373083920445075162
@CompanyCode310[String] = 6373083908618598731
@CompanyCode311[String] = 6373083911842783146
@CompanyCode312[String] = 6373083913928202424
@ParentCompanyCode313[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:13:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type314) AND ([TbOrganizationMap].[ProjectId] = @ProjectId315)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode316,@CompanyCode317,@CompanyCode318,@CompanyCode319,@CompanyCode320,@CompanyCode321,@CompanyCode322,@CompanyCode323)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode324))) 	
Parameters:
@Type314[Int32] = 1
@ProjectId315[String] = 6372912251695766465
@CompanyCode316[String] = 6373083923489249281
@CompanyCode317[String] = 6373083925531366080
@CompanyCode318[String] = 6373083927883400612
@CompanyCode319[String] = 6373083918575368225
@CompanyCode320[String] = 6373083920445075162
@CompanyCode321[String] = 6373083908618598731
@CompanyCode322[String] = 6373083911842783146
@CompanyCode323[String] = 6373083913928202424
@ParentCompanyCode324[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type325) AND ([TbOrganizationMap].[ProjectId] = @ProjectId326)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode327,@CompanyCode328,@CompanyCode329,@CompanyCode330,@CompanyCode331,@CompanyCode332,@CompanyCode333,@CompanyCode334)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode335))) 	
Parameters:
@Type325[Int32] = 2
@ProjectId326[String] = 6372912251695766465
@CompanyCode327[String] = 6373083923489249281
@CompanyCode328[String] = 6373083925531366080
@CompanyCode329[String] = 6373083927883400612
@CompanyCode330[String] = 6373083918575368225
@CompanyCode331[String] = 6373083920445075162
@CompanyCode332[String] = 6373083908618598731
@CompanyCode333[String] = 6373083911842783146
@CompanyCode334[String] = 6373083913928202424
@ParentCompanyCode335[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:15:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:15:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:16:02
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:16:03
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:16:03
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:16:03
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:16:03
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:17:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:17:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:17:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type336) AND ([TbOrganizationMap].[ProjectId] = @ProjectId337)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode338,@CompanyCode339,@CompanyCode340,@CompanyCode341,@CompanyCode342,@CompanyCode343,@CompanyCode344,@CompanyCode345)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode346))) 	
Parameters:
@Type336[Int32] = 1
@ProjectId337[String] = 6372912251695766465
@CompanyCode338[String] = 6373083923489249281
@CompanyCode339[String] = 6373083925531366080
@CompanyCode340[String] = 6373083927883400612
@CompanyCode341[String] = 6373083918575368225
@CompanyCode342[String] = 6373083920445075162
@CompanyCode343[String] = 6373083908618598731
@CompanyCode344[String] = 6373083911842783146
@CompanyCode345[String] = 6373083913928202424
@ParentCompanyCode346[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type347) AND ([TbOrganizationMap].[ProjectId] = @ProjectId348)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode349,@CompanyCode350,@CompanyCode351,@CompanyCode352,@CompanyCode353,@CompanyCode354,@CompanyCode355,@CompanyCode356)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode357))) 	
Parameters:
@Type347[Int32] = 2
@ProjectId348[String] = 6372912251695766465
@CompanyCode349[String] = 6373083923489249281
@CompanyCode350[String] = 6373083925531366080
@CompanyCode351[String] = 6373083927883400612
@CompanyCode352[String] = 6373083918575368225
@CompanyCode353[String] = 6373083920445075162
@CompanyCode354[String] = 6373083908618598731
@CompanyCode355[String] = 6373083911842783146
@CompanyCode356[String] = 6373083913928202424
@ParentCompanyCode357[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:17:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:17:29
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5	


-----------------------------------------------------------------------------
2020-08-26 10:17:35
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:17:35
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:17:35
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:17:35
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:18:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:18:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:18:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:18:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:18:45
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:18:50
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:18:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:18:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:18:50
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:19:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:19:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:19:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:19:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:19:18
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:19:18
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:19:18
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:19:18
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:19:18
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:22:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:25:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:28:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:31:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:31:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:31:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:31:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type45) AND ([TbOrganizationMap].[ProjectId] = @ProjectId46)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode55))) 	
Parameters:
@Type45[Int32] = 1
@ProjectId46[String] = 6372912251695766465
@CompanyCode47[String] = 6373083923489249281
@CompanyCode48[String] = 6373083925531366080
@CompanyCode49[String] = 6373083927883400612
@CompanyCode50[String] = 6373083918575368225
@CompanyCode51[String] = 6373083920445075162
@CompanyCode52[String] = 6373083908618598731
@CompanyCode53[String] = 6373083911842783146
@CompanyCode54[String] = 6373083913928202424
@ParentCompanyCode55[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type56) AND ([TbOrganizationMap].[ProjectId] = @ProjectId57)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode66))) 	
Parameters:
@Type56[Int32] = 2
@ProjectId57[String] = 6372912251695766465
@CompanyCode58[String] = 6373083923489249281
@CompanyCode59[String] = 6373083925531366080
@CompanyCode60[String] = 6373083927883400612
@CompanyCode61[String] = 6373083918575368225
@CompanyCode62[String] = 6373083920445075162
@CompanyCode63[String] = 6373083908618598731
@CompanyCode64[String] = 6373083911842783146
@CompanyCode65[String] = 6373083913928202424
@ParentCompanyCode66[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:31:17
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type67) AND ([TbOrganizationMap].[ProjectId] = @ProjectId68)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72,@CompanyCode73,@CompanyCode74,@CompanyCode75,@CompanyCode76)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode77))) 	
Parameters:
@Type67[Int32] = 1
@ProjectId68[String] = 6372912251695766465
@CompanyCode69[String] = 6373083923489249281
@CompanyCode70[String] = 6373083925531366080
@CompanyCode71[String] = 6373083927883400612
@CompanyCode72[String] = 6373083918575368225
@CompanyCode73[String] = 6373083920445075162
@CompanyCode74[String] = 6373083908618598731
@CompanyCode75[String] = 6373083911842783146
@CompanyCode76[String] = 6373083913928202424
@ParentCompanyCode77[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type78) AND ([TbOrganizationMap].[ProjectId] = @ProjectId79)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83,@CompanyCode84,@CompanyCode85,@CompanyCode86,@CompanyCode87)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode88))) 	
Parameters:
@Type78[Int32] = 2
@ProjectId79[String] = 6372912251695766465
@CompanyCode80[String] = 6373083923489249281
@CompanyCode81[String] = 6373083925531366080
@CompanyCode82[String] = 6373083927883400612
@CompanyCode83[String] = 6373083918575368225
@CompanyCode84[String] = 6373083920445075162
@CompanyCode85[String] = 6373083908618598731
@CompanyCode86[String] = 6373083911842783146
@CompanyCode87[String] = 6373083913928202424
@ParentCompanyCode88[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:33:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:33:05
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:33:05
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:33:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:33:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:33:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:37:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:37:56
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:37:56
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:37:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type89) AND ([TbOrganizationMap].[ProjectId] = @ProjectId90)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode91,@CompanyCode92,@CompanyCode93,@CompanyCode94,@CompanyCode95,@CompanyCode96,@CompanyCode97,@CompanyCode98)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode99))) 	
Parameters:
@Type89[Int32] = 1
@ProjectId90[String] = 6372912251695766465
@CompanyCode91[String] = 6373083923489249281
@CompanyCode92[String] = 6373083925531366080
@CompanyCode93[String] = 6373083927883400612
@CompanyCode94[String] = 6373083918575368225
@CompanyCode95[String] = 6373083920445075162
@CompanyCode96[String] = 6373083908618598731
@CompanyCode97[String] = 6373083911842783146
@CompanyCode98[String] = 6373083913928202424
@ParentCompanyCode99[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type100) AND ([TbOrganizationMap].[ProjectId] = @ProjectId101)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode102,@CompanyCode103,@CompanyCode104,@CompanyCode105,@CompanyCode106,@CompanyCode107,@CompanyCode108,@CompanyCode109)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode110))) 	
Parameters:
@Type100[Int32] = 2
@ProjectId101[String] = 6372912251695766465
@CompanyCode102[String] = 6373083923489249281
@CompanyCode103[String] = 6373083925531366080
@CompanyCode104[String] = 6373083927883400612
@CompanyCode105[String] = 6373083918575368225
@CompanyCode106[String] = 6373083920445075162
@CompanyCode107[String] = 6373083908618598731
@CompanyCode108[String] = 6373083911842783146
@CompanyCode109[String] = 6373083913928202424
@ParentCompanyCode110[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:37:57
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:38:09
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:38:09
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:38:09
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:38:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:38:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:38:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type111) AND ([TbOrganizationMap].[ProjectId] = @ProjectId112)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode113,@CompanyCode114,@CompanyCode115,@CompanyCode116,@CompanyCode117,@CompanyCode118,@CompanyCode119,@CompanyCode120)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode121))) 	
Parameters:
@Type111[Int32] = 1
@ProjectId112[String] = 6372912251695766465
@CompanyCode113[String] = 6373083923489249281
@CompanyCode114[String] = 6373083925531366080
@CompanyCode115[String] = 6373083927883400612
@CompanyCode116[String] = 6373083918575368225
@CompanyCode117[String] = 6373083920445075162
@CompanyCode118[String] = 6373083908618598731
@CompanyCode119[String] = 6373083911842783146
@CompanyCode120[String] = 6373083913928202424
@ParentCompanyCode121[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type122) AND ([TbOrganizationMap].[ProjectId] = @ProjectId123)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode124,@CompanyCode125,@CompanyCode126,@CompanyCode127,@CompanyCode128,@CompanyCode129,@CompanyCode130,@CompanyCode131)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode132))) 	
Parameters:
@Type122[Int32] = 2
@ProjectId123[String] = 6372912251695766465
@CompanyCode124[String] = 6373083923489249281
@CompanyCode125[String] = 6373083925531366080
@CompanyCode126[String] = 6373083927883400612
@CompanyCode127[String] = 6373083918575368225
@CompanyCode128[String] = 6373083920445075162
@CompanyCode129[String] = 6373083908618598731
@CompanyCode130[String] = 6373083911842783146
@CompanyCode131[String] = 6373083913928202424
@ParentCompanyCode132[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:38:16
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type133) AND ([TbOrganizationMap].[ProjectId] = @ProjectId134)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode135,@CompanyCode136,@CompanyCode137,@CompanyCode138,@CompanyCode139,@CompanyCode140,@CompanyCode141,@CompanyCode142)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode143))) 	
Parameters:
@Type133[Int32] = 1
@ProjectId134[String] = 6372912251695766465
@CompanyCode135[String] = 6373083923489249281
@CompanyCode136[String] = 6373083925531366080
@CompanyCode137[String] = 6373083927883400612
@CompanyCode138[String] = 6373083918575368225
@CompanyCode139[String] = 6373083920445075162
@CompanyCode140[String] = 6373083908618598731
@CompanyCode141[String] = 6373083911842783146
@CompanyCode142[String] = 6373083913928202424
@ParentCompanyCode143[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type144) AND ([TbOrganizationMap].[ProjectId] = @ProjectId145)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode146,@CompanyCode147,@CompanyCode148,@CompanyCode149,@CompanyCode150,@CompanyCode151,@CompanyCode152,@CompanyCode153)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode154))) 	
Parameters:
@Type144[Int32] = 2
@ProjectId145[String] = 6372912251695766465
@CompanyCode146[String] = 6373083923489249281
@CompanyCode147[String] = 6373083925531366080
@CompanyCode148[String] = 6373083927883400612
@CompanyCode149[String] = 6373083918575368225
@CompanyCode150[String] = 6373083920445075162
@CompanyCode151[String] = 6373083908618598731
@CompanyCode152[String] = 6373083911842783146
@CompanyCode153[String] = 6373083913928202424
@ParentCompanyCode154[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:40:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:40:21
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:40:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:40:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:40:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:40:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type155) AND ([TbOrganizationMap].[ProjectId] = @ProjectId156)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode157,@CompanyCode158,@CompanyCode159,@CompanyCode160,@CompanyCode161,@CompanyCode162,@CompanyCode163,@CompanyCode164)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode165))) 	
Parameters:
@Type155[Int32] = 1
@ProjectId156[String] = 6372912251695766465
@CompanyCode157[String] = 6373083923489249281
@CompanyCode158[String] = 6373083925531366080
@CompanyCode159[String] = 6373083927883400612
@CompanyCode160[String] = 6373083918575368225
@CompanyCode161[String] = 6373083920445075162
@CompanyCode162[String] = 6373083908618598731
@CompanyCode163[String] = 6373083911842783146
@CompanyCode164[String] = 6373083913928202424
@ParentCompanyCode165[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type166) AND ([TbOrganizationMap].[ProjectId] = @ProjectId167)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode168,@CompanyCode169,@CompanyCode170,@CompanyCode171,@CompanyCode172,@CompanyCode173,@CompanyCode174,@CompanyCode175)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode176))) 	
Parameters:
@Type166[Int32] = 2
@ProjectId167[String] = 6372912251695766465
@CompanyCode168[String] = 6373083923489249281
@CompanyCode169[String] = 6373083925531366080
@CompanyCode170[String] = 6373083927883400612
@CompanyCode171[String] = 6373083918575368225
@CompanyCode172[String] = 6373083920445075162
@CompanyCode173[String] = 6373083908618598731
@CompanyCode174[String] = 6373083911842783146
@CompanyCode175[String] = 6373083913928202424
@ParentCompanyCode176[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:42:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode177) AND ([TbUser].[UserPwd] = @UserPwd178) 	
Parameters:
@UserCode177[String] = 500000
@UserPwd178[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode179 	
Parameters:
@UserCode179[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:42:41
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu180,@ActionType181,@HostName182,@LogDate183,@UserCode184,@UserIP185);select scope_identity()	
Parameters:
@ActionMenu180[String] = 0
@ActionType181[String] = 登录系统
@HostName182[String] = 
@LogDate183[DateTime] = 2020/8/26 10:42:41
@UserCode184[String] = 500000
@UserIP185[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 10:42:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:42:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:42:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type186) AND ([TbOrganizationMap].[ProjectId] = @ProjectId187)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode188,@CompanyCode189,@CompanyCode190,@CompanyCode191,@CompanyCode192,@CompanyCode193,@CompanyCode194,@CompanyCode195)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode196))) 	
Parameters:
@Type186[Int32] = 1
@ProjectId187[String] = 6372912251695766465
@CompanyCode188[String] = 6373083923489249281
@CompanyCode189[String] = 6373083925531366080
@CompanyCode190[String] = 6373083927883400612
@CompanyCode191[String] = 6373083918575368225
@CompanyCode192[String] = 6373083920445075162
@CompanyCode193[String] = 6373083908618598731
@CompanyCode194[String] = 6373083911842783146
@CompanyCode195[String] = 6373083913928202424
@ParentCompanyCode196[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type197) AND ([TbOrganizationMap].[ProjectId] = @ProjectId198)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode199,@CompanyCode200,@CompanyCode201,@CompanyCode202,@CompanyCode203,@CompanyCode204,@CompanyCode205,@CompanyCode206)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode207))) 	
Parameters:
@Type197[Int32] = 2
@ProjectId198[String] = 6372912251695766465
@CompanyCode199[String] = 6373083923489249281
@CompanyCode200[String] = 6373083925531366080
@CompanyCode201[String] = 6373083927883400612
@CompanyCode202[String] = 6373083918575368225
@CompanyCode203[String] = 6373083920445075162
@CompanyCode204[String] = 6373083908618598731
@CompanyCode205[String] = 6373083911842783146
@CompanyCode206[String] = 6373083913928202424
@ParentCompanyCode207[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:42:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:42:44
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type208) AND ([TbOrganizationMap].[ProjectId] = @ProjectId209)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode210,@CompanyCode211,@CompanyCode212,@CompanyCode213,@CompanyCode214,@CompanyCode215,@CompanyCode216,@CompanyCode217)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode218))) 	
Parameters:
@Type208[Int32] = 1
@ProjectId209[String] = 6372912251695766465
@CompanyCode210[String] = 6373083923489249281
@CompanyCode211[String] = 6373083925531366080
@CompanyCode212[String] = 6373083927883400612
@CompanyCode213[String] = 6373083918575368225
@CompanyCode214[String] = 6373083920445075162
@CompanyCode215[String] = 6373083908618598731
@CompanyCode216[String] = 6373083911842783146
@CompanyCode217[String] = 6373083913928202424
@ParentCompanyCode218[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type219) AND ([TbOrganizationMap].[ProjectId] = @ProjectId220)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode221,@CompanyCode222,@CompanyCode223,@CompanyCode224,@CompanyCode225,@CompanyCode226,@CompanyCode227,@CompanyCode228)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode229))) 	
Parameters:
@Type219[Int32] = 2
@ProjectId220[String] = 6372912251695766465
@CompanyCode221[String] = 6373083923489249281
@CompanyCode222[String] = 6373083925531366080
@CompanyCode223[String] = 6373083927883400612
@CompanyCode224[String] = 6373083918575368225
@CompanyCode225[String] = 6373083920445075162
@CompanyCode226[String] = 6373083908618598731
@CompanyCode227[String] = 6373083911842783146
@CompanyCode228[String] = 6373083913928202424
@ParentCompanyCode229[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:43:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:43:28
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:43:28
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:43:28
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:43:28
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:43:28
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:44:30
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:44:30
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:44:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type230) AND ([TbOrganizationMap].[ProjectId] = @ProjectId231)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode232,@CompanyCode233,@CompanyCode234,@CompanyCode235,@CompanyCode236,@CompanyCode237,@CompanyCode238,@CompanyCode239)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode240))) 	
Parameters:
@Type230[Int32] = 1
@ProjectId231[String] = 6372912251695766465
@CompanyCode232[String] = 6373083923489249281
@CompanyCode233[String] = 6373083925531366080
@CompanyCode234[String] = 6373083927883400612
@CompanyCode235[String] = 6373083918575368225
@CompanyCode236[String] = 6373083920445075162
@CompanyCode237[String] = 6373083908618598731
@CompanyCode238[String] = 6373083911842783146
@CompanyCode239[String] = 6373083913928202424
@ParentCompanyCode240[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type241) AND ([TbOrganizationMap].[ProjectId] = @ProjectId242)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode243,@CompanyCode244,@CompanyCode245,@CompanyCode246,@CompanyCode247,@CompanyCode248,@CompanyCode249,@CompanyCode250)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode251))) 	
Parameters:
@Type241[Int32] = 2
@ProjectId242[String] = 6372912251695766465
@CompanyCode243[String] = 6373083923489249281
@CompanyCode244[String] = 6373083925531366080
@CompanyCode245[String] = 6373083927883400612
@CompanyCode246[String] = 6373083918575368225
@CompanyCode247[String] = 6373083920445075162
@CompanyCode248[String] = 6373083908618598731
@CompanyCode249[String] = 6373083911842783146
@CompanyCode250[String] = 6373083913928202424
@ParentCompanyCode251[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:44:31
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:44:37
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:44:37
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:44:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type252) AND ([TbOrganizationMap].[ProjectId] = @ProjectId253)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode254,@CompanyCode255,@CompanyCode256,@CompanyCode257,@CompanyCode258,@CompanyCode259,@CompanyCode260,@CompanyCode261)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode262))) 	
Parameters:
@Type252[Int32] = 1
@ProjectId253[String] = 6372912251695766465
@CompanyCode254[String] = 6373083923489249281
@CompanyCode255[String] = 6373083925531366080
@CompanyCode256[String] = 6373083927883400612
@CompanyCode257[String] = 6373083918575368225
@CompanyCode258[String] = 6373083920445075162
@CompanyCode259[String] = 6373083908618598731
@CompanyCode260[String] = 6373083911842783146
@CompanyCode261[String] = 6373083913928202424
@ParentCompanyCode262[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type263) AND ([TbOrganizationMap].[ProjectId] = @ProjectId264)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode265,@CompanyCode266,@CompanyCode267,@CompanyCode268,@CompanyCode269,@CompanyCode270,@CompanyCode271,@CompanyCode272)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode273))) 	
Parameters:
@Type263[Int32] = 2
@ProjectId264[String] = 6372912251695766465
@CompanyCode265[String] = 6373083923489249281
@CompanyCode266[String] = 6373083925531366080
@CompanyCode267[String] = 6373083927883400612
@CompanyCode268[String] = 6373083918575368225
@CompanyCode269[String] = 6373083920445075162
@CompanyCode270[String] = 6373083908618598731
@CompanyCode271[String] = 6373083911842783146
@CompanyCode272[String] = 6373083913928202424
@ParentCompanyCode273[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:44:38
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:47:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type274) AND ([TbOrganizationMap].[ProjectId] = @ProjectId275)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode276,@CompanyCode277,@CompanyCode278,@CompanyCode279,@CompanyCode280,@CompanyCode281,@CompanyCode282,@CompanyCode283)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode284))) 	
Parameters:
@Type274[Int32] = 1
@ProjectId275[String] = 6372912251695766465
@CompanyCode276[String] = 6373083923489249281
@CompanyCode277[String] = 6373083925531366080
@CompanyCode278[String] = 6373083927883400612
@CompanyCode279[String] = 6373083918575368225
@CompanyCode280[String] = 6373083920445075162
@CompanyCode281[String] = 6373083908618598731
@CompanyCode282[String] = 6373083911842783146
@CompanyCode283[String] = 6373083913928202424
@ParentCompanyCode284[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type285) AND ([TbOrganizationMap].[ProjectId] = @ProjectId286)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode287,@CompanyCode288,@CompanyCode289,@CompanyCode290,@CompanyCode291,@CompanyCode292,@CompanyCode293,@CompanyCode294)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode295))) 	
Parameters:
@Type285[Int32] = 2
@ProjectId286[String] = 6372912251695766465
@CompanyCode287[String] = 6373083923489249281
@CompanyCode288[String] = 6373083925531366080
@CompanyCode289[String] = 6373083927883400612
@CompanyCode290[String] = 6373083918575368225
@CompanyCode291[String] = 6373083920445075162
@CompanyCode292[String] = 6373083908618598731
@CompanyCode293[String] = 6373083911842783146
@CompanyCode294[String] = 6373083913928202424
@ParentCompanyCode295[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:47:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:47:59
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:47:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:47:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:47:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:47:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:48:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:48:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:48:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type296) AND ([TbOrganizationMap].[ProjectId] = @ProjectId297)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode298,@CompanyCode299,@CompanyCode300,@CompanyCode301,@CompanyCode302,@CompanyCode303,@CompanyCode304,@CompanyCode305)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode306))) 	
Parameters:
@Type296[Int32] = 1
@ProjectId297[String] = 6372912251695766465
@CompanyCode298[String] = 6373083923489249281
@CompanyCode299[String] = 6373083925531366080
@CompanyCode300[String] = 6373083927883400612
@CompanyCode301[String] = 6373083918575368225
@CompanyCode302[String] = 6373083920445075162
@CompanyCode303[String] = 6373083908618598731
@CompanyCode304[String] = 6373083911842783146
@CompanyCode305[String] = 6373083913928202424
@ParentCompanyCode306[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type307) AND ([TbOrganizationMap].[ProjectId] = @ProjectId308)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode309,@CompanyCode310,@CompanyCode311,@CompanyCode312,@CompanyCode313,@CompanyCode314,@CompanyCode315,@CompanyCode316)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode317))) 	
Parameters:
@Type307[Int32] = 2
@ProjectId308[String] = 6372912251695766465
@CompanyCode309[String] = 6373083923489249281
@CompanyCode310[String] = 6373083925531366080
@CompanyCode311[String] = 6373083927883400612
@CompanyCode312[String] = 6373083918575368225
@CompanyCode313[String] = 6373083920445075162
@CompanyCode314[String] = 6373083908618598731
@CompanyCode315[String] = 6373083911842783146
@CompanyCode316[String] = 6373083913928202424
@ParentCompanyCode317[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:48:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:49:54
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode318) AND ([TbUser].[UserPwd] = @UserPwd319) 	
Parameters:
@UserCode318[String] = 500000
@UserPwd319[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode320 	
Parameters:
@UserCode320[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu321,@ActionType322,@HostName323,@LogDate324,@UserCode325,@UserIP326);select scope_identity()	
Parameters:
@ActionMenu321[String] = 0
@ActionType322[String] = 登录系统
@HostName323[String] = 
@LogDate324[DateTime] = 2020/8/26 10:49:55
@UserCode325[String] = 500000
@UserIP326[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:49:55
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type327) AND ([TbOrganizationMap].[ProjectId] = @ProjectId328)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode329,@CompanyCode330,@CompanyCode331,@CompanyCode332,@CompanyCode333,@CompanyCode334,@CompanyCode335,@CompanyCode336)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode337))) 	
Parameters:
@Type327[Int32] = 1
@ProjectId328[String] = 6372912251695766465
@CompanyCode329[String] = 6373083923489249281
@CompanyCode330[String] = 6373083925531366080
@CompanyCode331[String] = 6373083927883400612
@CompanyCode332[String] = 6373083918575368225
@CompanyCode333[String] = 6373083920445075162
@CompanyCode334[String] = 6373083908618598731
@CompanyCode335[String] = 6373083911842783146
@CompanyCode336[String] = 6373083913928202424
@ParentCompanyCode337[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type338) AND ([TbOrganizationMap].[ProjectId] = @ProjectId339)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode340,@CompanyCode341,@CompanyCode342,@CompanyCode343,@CompanyCode344,@CompanyCode345,@CompanyCode346,@CompanyCode347)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode348))) 	
Parameters:
@Type338[Int32] = 2
@ProjectId339[String] = 6372912251695766465
@CompanyCode340[String] = 6373083923489249281
@CompanyCode341[String] = 6373083925531366080
@CompanyCode342[String] = 6373083927883400612
@CompanyCode343[String] = 6373083918575368225
@CompanyCode344[String] = 6373083920445075162
@CompanyCode345[String] = 6373083908618598731
@CompanyCode346[String] = 6373083911842783146
@CompanyCode347[String] = 6373083913928202424
@ParentCompanyCode348[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:49:56
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type349) AND ([TbOrganizationMap].[ProjectId] = @ProjectId350)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode351,@CompanyCode352,@CompanyCode353,@CompanyCode354,@CompanyCode355,@CompanyCode356,@CompanyCode357,@CompanyCode358)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode359))) 	
Parameters:
@Type349[Int32] = 1
@ProjectId350[String] = 6372912251695766465
@CompanyCode351[String] = 6373083923489249281
@CompanyCode352[String] = 6373083925531366080
@CompanyCode353[String] = 6373083927883400612
@CompanyCode354[String] = 6373083918575368225
@CompanyCode355[String] = 6373083920445075162
@CompanyCode356[String] = 6373083908618598731
@CompanyCode357[String] = 6373083911842783146
@CompanyCode358[String] = 6373083913928202424
@ParentCompanyCode359[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type360) AND ([TbOrganizationMap].[ProjectId] = @ProjectId361)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode362,@CompanyCode363,@CompanyCode364,@CompanyCode365,@CompanyCode366,@CompanyCode367,@CompanyCode368,@CompanyCode369)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode370))) 	
Parameters:
@Type360[Int32] = 2
@ProjectId361[String] = 6372912251695766465
@CompanyCode362[String] = 6373083923489249281
@CompanyCode363[String] = 6373083925531366080
@CompanyCode364[String] = 6373083927883400612
@CompanyCode365[String] = 6373083918575368225
@CompanyCode366[String] = 6373083920445075162
@CompanyCode367[String] = 6373083908618598731
@CompanyCode368[String] = 6373083911842783146
@CompanyCode369[String] = 6373083913928202424
@ParentCompanyCode370[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:50:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:50:17
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:50:17
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:50:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:50:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:50:17
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:51:50
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:51:50
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:51:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type371) AND ([TbOrganizationMap].[ProjectId] = @ProjectId372)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode373,@CompanyCode374,@CompanyCode375,@CompanyCode376,@CompanyCode377,@CompanyCode378,@CompanyCode379,@CompanyCode380)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode381))) 	
Parameters:
@Type371[Int32] = 1
@ProjectId372[String] = 6372912251695766465
@CompanyCode373[String] = 6373083923489249281
@CompanyCode374[String] = 6373083925531366080
@CompanyCode375[String] = 6373083927883400612
@CompanyCode376[String] = 6373083918575368225
@CompanyCode377[String] = 6373083920445075162
@CompanyCode378[String] = 6373083908618598731
@CompanyCode379[String] = 6373083911842783146
@CompanyCode380[String] = 6373083913928202424
@ParentCompanyCode381[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type382) AND ([TbOrganizationMap].[ProjectId] = @ProjectId383)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode384,@CompanyCode385,@CompanyCode386,@CompanyCode387,@CompanyCode388,@CompanyCode389,@CompanyCode390,@CompanyCode391)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode392))) 	
Parameters:
@Type382[Int32] = 2
@ProjectId383[String] = 6372912251695766465
@CompanyCode384[String] = 6373083923489249281
@CompanyCode385[String] = 6373083925531366080
@CompanyCode386[String] = 6373083927883400612
@CompanyCode387[String] = 6373083918575368225
@CompanyCode388[String] = 6373083920445075162
@CompanyCode389[String] = 6373083908618598731
@CompanyCode390[String] = 6373083911842783146
@CompanyCode391[String] = 6373083913928202424
@ParentCompanyCode392[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:51:51
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type393) AND ([TbOrganizationMap].[ProjectId] = @ProjectId394)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode395,@CompanyCode396,@CompanyCode397,@CompanyCode398,@CompanyCode399,@CompanyCode400,@CompanyCode401,@CompanyCode402)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode403))) 	
Parameters:
@Type393[Int32] = 1
@ProjectId394[String] = 6372912251695766465
@CompanyCode395[String] = 6373083923489249281
@CompanyCode396[String] = 6373083925531366080
@CompanyCode397[String] = 6373083927883400612
@CompanyCode398[String] = 6373083918575368225
@CompanyCode399[String] = 6373083920445075162
@CompanyCode400[String] = 6373083908618598731
@CompanyCode401[String] = 6373083911842783146
@CompanyCode402[String] = 6373083913928202424
@ParentCompanyCode403[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type404) AND ([TbOrganizationMap].[ProjectId] = @ProjectId405)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode406,@CompanyCode407,@CompanyCode408,@CompanyCode409,@CompanyCode410,@CompanyCode411,@CompanyCode412,@CompanyCode413)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode414))) 	
Parameters:
@Type404[Int32] = 2
@ProjectId405[String] = 6372912251695766465
@CompanyCode406[String] = 6373083923489249281
@CompanyCode407[String] = 6373083925531366080
@CompanyCode408[String] = 6373083927883400612
@CompanyCode409[String] = 6373083918575368225
@CompanyCode410[String] = 6373083920445075162
@CompanyCode411[String] = 6373083908618598731
@CompanyCode412[String] = 6373083911842783146
@CompanyCode413[String] = 6373083913928202424
@ParentCompanyCode414[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 10:53:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 10:53:02
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 10:53:02
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 10:53:02
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 10:53:02
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 10:53:02
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 10:56:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 10:59:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type415) AND ([TbOrganizationMap].[ProjectId] = @ProjectId416)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode417,@CompanyCode418,@CompanyCode419,@CompanyCode420,@CompanyCode421,@CompanyCode422,@CompanyCode423,@CompanyCode424)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode425))) 	
Parameters:
@Type415[Int32] = 1
@ProjectId416[String] = 6372912251695766465
@CompanyCode417[String] = 6373083923489249281
@CompanyCode418[String] = 6373083925531366080
@CompanyCode419[String] = 6373083927883400612
@CompanyCode420[String] = 6373083918575368225
@CompanyCode421[String] = 6373083920445075162
@CompanyCode422[String] = 6373083908618598731
@CompanyCode423[String] = 6373083911842783146
@CompanyCode424[String] = 6373083913928202424
@ParentCompanyCode425[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type426) AND ([TbOrganizationMap].[ProjectId] = @ProjectId427)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode428,@CompanyCode429,@CompanyCode430,@CompanyCode431,@CompanyCode432,@CompanyCode433,@CompanyCode434,@CompanyCode435)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode436))) 	
Parameters:
@Type426[Int32] = 2
@ProjectId427[String] = 6372912251695766465
@CompanyCode428[String] = 6373083923489249281
@CompanyCode429[String] = 6373083925531366080
@CompanyCode430[String] = 6373083927883400612
@CompanyCode431[String] = 6373083918575368225
@CompanyCode432[String] = 6373083920445075162
@CompanyCode433[String] = 6373083908618598731
@CompanyCode434[String] = 6373083911842783146
@CompanyCode435[String] = 6373083913928202424
@ParentCompanyCode436[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:00:14
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:00:15
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type437) AND ([TbOrganizationMap].[ProjectId] = @ProjectId438)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode439,@CompanyCode440,@CompanyCode441,@CompanyCode442,@CompanyCode443,@CompanyCode444,@CompanyCode445,@CompanyCode446)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode447))) 	
Parameters:
@Type437[Int32] = 1
@ProjectId438[String] = 6372912251695766465
@CompanyCode439[String] = 6373083923489249281
@CompanyCode440[String] = 6373083925531366080
@CompanyCode441[String] = 6373083927883400612
@CompanyCode442[String] = 6373083918575368225
@CompanyCode443[String] = 6373083920445075162
@CompanyCode444[String] = 6373083908618598731
@CompanyCode445[String] = 6373083911842783146
@CompanyCode446[String] = 6373083913928202424
@ParentCompanyCode447[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type448) AND ([TbOrganizationMap].[ProjectId] = @ProjectId449)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode450,@CompanyCode451,@CompanyCode452,@CompanyCode453,@CompanyCode454,@CompanyCode455,@CompanyCode456,@CompanyCode457)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode458))) 	
Parameters:
@Type448[Int32] = 2
@ProjectId449[String] = 6372912251695766465
@CompanyCode450[String] = 6373083923489249281
@CompanyCode451[String] = 6373083925531366080
@CompanyCode452[String] = 6373083927883400612
@CompanyCode453[String] = 6373083918575368225
@CompanyCode454[String] = 6373083920445075162
@CompanyCode455[String] = 6373083908618598731
@CompanyCode456[String] = 6373083911842783146
@CompanyCode457[String] = 6373083913928202424
@ParentCompanyCode458[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:00:23
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:00:24
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type459) AND ([TbOrganizationMap].[ProjectId] = @ProjectId460)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode461,@CompanyCode462,@CompanyCode463,@CompanyCode464,@CompanyCode465,@CompanyCode466,@CompanyCode467,@CompanyCode468)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode469))) 	
Parameters:
@Type459[Int32] = 1
@ProjectId460[String] = 6372912251695766465
@CompanyCode461[String] = 6373083923489249281
@CompanyCode462[String] = 6373083925531366080
@CompanyCode463[String] = 6373083927883400612
@CompanyCode464[String] = 6373083918575368225
@CompanyCode465[String] = 6373083920445075162
@CompanyCode466[String] = 6373083908618598731
@CompanyCode467[String] = 6373083911842783146
@CompanyCode468[String] = 6373083913928202424
@ParentCompanyCode469[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type470) AND ([TbOrganizationMap].[ProjectId] = @ProjectId471)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode472,@CompanyCode473,@CompanyCode474,@CompanyCode475,@CompanyCode476,@CompanyCode477,@CompanyCode478,@CompanyCode479)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode480))) 	
Parameters:
@Type470[Int32] = 2
@ProjectId471[String] = 6372912251695766465
@CompanyCode472[String] = 6373083923489249281
@CompanyCode473[String] = 6373083925531366080
@CompanyCode474[String] = 6373083927883400612
@CompanyCode475[String] = 6373083918575368225
@CompanyCode476[String] = 6373083920445075162
@CompanyCode477[String] = 6373083908618598731
@CompanyCode478[String] = 6373083911842783146
@CompanyCode479[String] = 6373083913928202424
@ParentCompanyCode480[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:01:30
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:02:24
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:02:24
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:02:24
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type481) AND ([TbOrganizationMap].[ProjectId] = @ProjectId482)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode483,@CompanyCode484,@CompanyCode485,@CompanyCode486,@CompanyCode487,@CompanyCode488,@CompanyCode489,@CompanyCode490)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode491))) 	
Parameters:
@Type481[Int32] = 1
@ProjectId482[String] = 6372912251695766465
@CompanyCode483[String] = 6373083923489249281
@CompanyCode484[String] = 6373083925531366080
@CompanyCode485[String] = 6373083927883400612
@CompanyCode486[String] = 6373083918575368225
@CompanyCode487[String] = 6373083920445075162
@CompanyCode488[String] = 6373083908618598731
@CompanyCode489[String] = 6373083911842783146
@CompanyCode490[String] = 6373083913928202424
@ParentCompanyCode491[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type492) AND ([TbOrganizationMap].[ProjectId] = @ProjectId493)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode494,@CompanyCode495,@CompanyCode496,@CompanyCode497,@CompanyCode498,@CompanyCode499,@CompanyCode500,@CompanyCode501)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode502))) 	
Parameters:
@Type492[Int32] = 2
@ProjectId493[String] = 6372912251695766465
@CompanyCode494[String] = 6373083923489249281
@CompanyCode495[String] = 6373083925531366080
@CompanyCode496[String] = 6373083927883400612
@CompanyCode497[String] = 6373083918575368225
@CompanyCode498[String] = 6373083920445075162
@CompanyCode499[String] = 6373083908618598731
@CompanyCode500[String] = 6373083911842783146
@CompanyCode501[String] = 6373083913928202424
@ParentCompanyCode502[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:02:25
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type503) AND ([TbOrganizationMap].[ProjectId] = @ProjectId504)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode505,@CompanyCode506,@CompanyCode507,@CompanyCode508,@CompanyCode509,@CompanyCode510,@CompanyCode511,@CompanyCode512)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode513))) 	
Parameters:
@Type503[Int32] = 1
@ProjectId504[String] = 6372912251695766465
@CompanyCode505[String] = 6373083923489249281
@CompanyCode506[String] = 6373083925531366080
@CompanyCode507[String] = 6373083927883400612
@CompanyCode508[String] = 6373083918575368225
@CompanyCode509[String] = 6373083920445075162
@CompanyCode510[String] = 6373083908618598731
@CompanyCode511[String] = 6373083911842783146
@CompanyCode512[String] = 6373083913928202424
@ParentCompanyCode513[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type514) AND ([TbOrganizationMap].[ProjectId] = @ProjectId515)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode516,@CompanyCode517,@CompanyCode518,@CompanyCode519,@CompanyCode520,@CompanyCode521,@CompanyCode522,@CompanyCode523)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode524))) 	
Parameters:
@Type514[Int32] = 2
@ProjectId515[String] = 6372912251695766465
@CompanyCode516[String] = 6373083923489249281
@CompanyCode517[String] = 6373083925531366080
@CompanyCode518[String] = 6373083927883400612
@CompanyCode519[String] = 6373083918575368225
@CompanyCode520[String] = 6373083920445075162
@CompanyCode521[String] = 6373083908618598731
@CompanyCode522[String] = 6373083911842783146
@CompanyCode523[String] = 6373083913928202424
@ParentCompanyCode524[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:03:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:03:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type525) AND ([TbOrganizationMap].[ProjectId] = @ProjectId526)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode527,@CompanyCode528,@CompanyCode529,@CompanyCode530,@CompanyCode531,@CompanyCode532,@CompanyCode533,@CompanyCode534)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode535))) 	
Parameters:
@Type525[Int32] = 1
@ProjectId526[String] = 6372912251695766465
@CompanyCode527[String] = 6373083923489249281
@CompanyCode528[String] = 6373083925531366080
@CompanyCode529[String] = 6373083927883400612
@CompanyCode530[String] = 6373083918575368225
@CompanyCode531[String] = 6373083920445075162
@CompanyCode532[String] = 6373083908618598731
@CompanyCode533[String] = 6373083911842783146
@CompanyCode534[String] = 6373083913928202424
@ParentCompanyCode535[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type536) AND ([TbOrganizationMap].[ProjectId] = @ProjectId537)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode538,@CompanyCode539,@CompanyCode540,@CompanyCode541,@CompanyCode542,@CompanyCode543,@CompanyCode544,@CompanyCode545)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode546))) 	
Parameters:
@Type536[Int32] = 2
@ProjectId537[String] = 6372912251695766465
@CompanyCode538[String] = 6373083923489249281
@CompanyCode539[String] = 6373083925531366080
@CompanyCode540[String] = 6373083927883400612
@CompanyCode541[String] = 6373083918575368225
@CompanyCode542[String] = 6373083920445075162
@CompanyCode543[String] = 6373083908618598731
@CompanyCode544[String] = 6373083911842783146
@CompanyCode545[String] = 6373083913928202424
@ParentCompanyCode546[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:05:00
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:05:01
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:05:01
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:05:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:05:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:05:01
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:06:45
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:06:45
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:06:45
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type547) AND ([TbOrganizationMap].[ProjectId] = @ProjectId548)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode549,@CompanyCode550,@CompanyCode551,@CompanyCode552,@CompanyCode553,@CompanyCode554,@CompanyCode555,@CompanyCode556)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode557))) 	
Parameters:
@Type547[Int32] = 1
@ProjectId548[String] = 6372912251695766465
@CompanyCode549[String] = 6373083923489249281
@CompanyCode550[String] = 6373083925531366080
@CompanyCode551[String] = 6373083927883400612
@CompanyCode552[String] = 6373083918575368225
@CompanyCode553[String] = 6373083920445075162
@CompanyCode554[String] = 6373083908618598731
@CompanyCode555[String] = 6373083911842783146
@CompanyCode556[String] = 6373083913928202424
@ParentCompanyCode557[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type558) AND ([TbOrganizationMap].[ProjectId] = @ProjectId559)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode560,@CompanyCode561,@CompanyCode562,@CompanyCode563,@CompanyCode564,@CompanyCode565,@CompanyCode566,@CompanyCode567)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode568))) 	
Parameters:
@Type558[Int32] = 2
@ProjectId559[String] = 6372912251695766465
@CompanyCode560[String] = 6373083923489249281
@CompanyCode561[String] = 6373083925531366080
@CompanyCode562[String] = 6373083927883400612
@CompanyCode563[String] = 6373083918575368225
@CompanyCode564[String] = 6373083920445075162
@CompanyCode565[String] = 6373083908618598731
@CompanyCode566[String] = 6373083911842783146
@CompanyCode567[String] = 6373083913928202424
@ParentCompanyCode568[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:06:46
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type569) AND ([TbOrganizationMap].[ProjectId] = @ProjectId570)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode571,@CompanyCode572,@CompanyCode573,@CompanyCode574,@CompanyCode575,@CompanyCode576,@CompanyCode577,@CompanyCode578)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode579))) 	
Parameters:
@Type569[Int32] = 1
@ProjectId570[String] = 6372912251695766465
@CompanyCode571[String] = 6373083923489249281
@CompanyCode572[String] = 6373083925531366080
@CompanyCode573[String] = 6373083927883400612
@CompanyCode574[String] = 6373083918575368225
@CompanyCode575[String] = 6373083920445075162
@CompanyCode576[String] = 6373083908618598731
@CompanyCode577[String] = 6373083911842783146
@CompanyCode578[String] = 6373083913928202424
@ParentCompanyCode579[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type580) AND ([TbOrganizationMap].[ProjectId] = @ProjectId581)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode582,@CompanyCode583,@CompanyCode584,@CompanyCode585,@CompanyCode586,@CompanyCode587,@CompanyCode588,@CompanyCode589)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode590))) 	
Parameters:
@Type580[Int32] = 2
@ProjectId581[String] = 6372912251695766465
@CompanyCode582[String] = 6373083923489249281
@CompanyCode583[String] = 6373083925531366080
@CompanyCode584[String] = 6373083927883400612
@CompanyCode585[String] = 6373083918575368225
@CompanyCode586[String] = 6373083920445075162
@CompanyCode587[String] = 6373083908618598731
@CompanyCode588[String] = 6373083911842783146
@CompanyCode589[String] = 6373083913928202424
@ParentCompanyCode590[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:08:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:08:34
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type591) AND ([TbOrganizationMap].[ProjectId] = @ProjectId592)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode593,@CompanyCode594,@CompanyCode595,@CompanyCode596,@CompanyCode597,@CompanyCode598,@CompanyCode599,@CompanyCode600)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode601))) 	
Parameters:
@Type591[Int32] = 1
@ProjectId592[String] = 6372912251695766465
@CompanyCode593[String] = 6373083923489249281
@CompanyCode594[String] = 6373083925531366080
@CompanyCode595[String] = 6373083927883400612
@CompanyCode596[String] = 6373083918575368225
@CompanyCode597[String] = 6373083920445075162
@CompanyCode598[String] = 6373083908618598731
@CompanyCode599[String] = 6373083911842783146
@CompanyCode600[String] = 6373083913928202424
@ParentCompanyCode601[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type602) AND ([TbOrganizationMap].[ProjectId] = @ProjectId603)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode604,@CompanyCode605,@CompanyCode606,@CompanyCode607,@CompanyCode608,@CompanyCode609,@CompanyCode610,@CompanyCode611)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode612))) 	
Parameters:
@Type602[Int32] = 2
@ProjectId603[String] = 6372912251695766465
@CompanyCode604[String] = 6373083923489249281
@CompanyCode605[String] = 6373083925531366080
@CompanyCode606[String] = 6373083927883400612
@CompanyCode607[String] = 6373083918575368225
@CompanyCode608[String] = 6373083920445075162
@CompanyCode609[String] = 6373083908618598731
@CompanyCode610[String] = 6373083911842783146
@CompanyCode611[String] = 6373083913928202424
@ParentCompanyCode612[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:10:10
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:10:11
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type613) AND ([TbOrganizationMap].[ProjectId] = @ProjectId614)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode615,@CompanyCode616,@CompanyCode617,@CompanyCode618,@CompanyCode619,@CompanyCode620,@CompanyCode621,@CompanyCode622)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode623))) 	
Parameters:
@Type613[Int32] = 1
@ProjectId614[String] = 6372912251695766465
@CompanyCode615[String] = 6373083923489249281
@CompanyCode616[String] = 6373083925531366080
@CompanyCode617[String] = 6373083927883400612
@CompanyCode618[String] = 6373083918575368225
@CompanyCode619[String] = 6373083920445075162
@CompanyCode620[String] = 6373083908618598731
@CompanyCode621[String] = 6373083911842783146
@CompanyCode622[String] = 6373083913928202424
@ParentCompanyCode623[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type624) AND ([TbOrganizationMap].[ProjectId] = @ProjectId625)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode626,@CompanyCode627,@CompanyCode628,@CompanyCode629,@CompanyCode630,@CompanyCode631,@CompanyCode632,@CompanyCode633)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode634))) 	
Parameters:
@Type624[Int32] = 2
@ProjectId625[String] = 6372912251695766465
@CompanyCode626[String] = 6373083923489249281
@CompanyCode627[String] = 6373083925531366080
@CompanyCode628[String] = 6373083927883400612
@CompanyCode629[String] = 6373083918575368225
@CompanyCode630[String] = 6373083920445075162
@CompanyCode631[String] = 6373083908618598731
@CompanyCode632[String] = 6373083911842783146
@CompanyCode633[String] = 6373083913928202424
@ParentCompanyCode634[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:10:49
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:10:50
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type635) AND ([TbOrganizationMap].[ProjectId] = @ProjectId636)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode637,@CompanyCode638,@CompanyCode639,@CompanyCode640,@CompanyCode641,@CompanyCode642,@CompanyCode643,@CompanyCode644)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode645))) 	
Parameters:
@Type635[Int32] = 1
@ProjectId636[String] = 6372912251695766465
@CompanyCode637[String] = 6373083923489249281
@CompanyCode638[String] = 6373083925531366080
@CompanyCode639[String] = 6373083927883400612
@CompanyCode640[String] = 6373083918575368225
@CompanyCode641[String] = 6373083920445075162
@CompanyCode642[String] = 6373083908618598731
@CompanyCode643[String] = 6373083911842783146
@CompanyCode644[String] = 6373083913928202424
@ParentCompanyCode645[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type646) AND ([TbOrganizationMap].[ProjectId] = @ProjectId647)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode648,@CompanyCode649,@CompanyCode650,@CompanyCode651,@CompanyCode652,@CompanyCode653,@CompanyCode654,@CompanyCode655)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode656))) 	
Parameters:
@Type646[Int32] = 2
@ProjectId647[String] = 6372912251695766465
@CompanyCode648[String] = 6373083923489249281
@CompanyCode649[String] = 6373083925531366080
@CompanyCode650[String] = 6373083927883400612
@CompanyCode651[String] = 6373083918575368225
@CompanyCode652[String] = 6373083920445075162
@CompanyCode653[String] = 6373083908618598731
@CompanyCode654[String] = 6373083911842783146
@CompanyCode655[String] = 6373083913928202424
@ParentCompanyCode656[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:11:04
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:14:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type657) AND ([TbOrganizationMap].[ProjectId] = @ProjectId658)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode659,@CompanyCode660,@CompanyCode661,@CompanyCode662,@CompanyCode663,@CompanyCode664,@CompanyCode665,@CompanyCode666)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode667))) 	
Parameters:
@Type657[Int32] = 1
@ProjectId658[String] = 6372912251695766465
@CompanyCode659[String] = 6373083923489249281
@CompanyCode660[String] = 6373083925531366080
@CompanyCode661[String] = 6373083927883400612
@CompanyCode662[String] = 6373083918575368225
@CompanyCode663[String] = 6373083920445075162
@CompanyCode664[String] = 6373083908618598731
@CompanyCode665[String] = 6373083911842783146
@CompanyCode666[String] = 6373083913928202424
@ParentCompanyCode667[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type668) AND ([TbOrganizationMap].[ProjectId] = @ProjectId669)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode670,@CompanyCode671,@CompanyCode672,@CompanyCode673,@CompanyCode674,@CompanyCode675,@CompanyCode676,@CompanyCode677)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode678))) 	
Parameters:
@Type668[Int32] = 2
@ProjectId669[String] = 6372912251695766465
@CompanyCode670[String] = 6373083923489249281
@CompanyCode671[String] = 6373083925531366080
@CompanyCode672[String] = 6373083927883400612
@CompanyCode673[String] = 6373083918575368225
@CompanyCode674[String] = 6373083920445075162
@CompanyCode675[String] = 6373083908618598731
@CompanyCode676[String] = 6373083911842783146
@CompanyCode677[String] = 6373083913928202424
@ParentCompanyCode678[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:14:50
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:14:51
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:18:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:18:11
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:18:11
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:18:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type679) AND ([TbOrganizationMap].[ProjectId] = @ProjectId680)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode681,@CompanyCode682,@CompanyCode683,@CompanyCode684,@CompanyCode685,@CompanyCode686,@CompanyCode687,@CompanyCode688)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode689))) 	
Parameters:
@Type679[Int32] = 1
@ProjectId680[String] = 6372912251695766465
@CompanyCode681[String] = 6373083923489249281
@CompanyCode682[String] = 6373083925531366080
@CompanyCode683[String] = 6373083927883400612
@CompanyCode684[String] = 6373083918575368225
@CompanyCode685[String] = 6373083920445075162
@CompanyCode686[String] = 6373083908618598731
@CompanyCode687[String] = 6373083911842783146
@CompanyCode688[String] = 6373083913928202424
@ParentCompanyCode689[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type690) AND ([TbOrganizationMap].[ProjectId] = @ProjectId691)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode692,@CompanyCode693,@CompanyCode694,@CompanyCode695,@CompanyCode696,@CompanyCode697,@CompanyCode698,@CompanyCode699)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode700))) 	
Parameters:
@Type690[Int32] = 2
@ProjectId691[String] = 6372912251695766465
@CompanyCode692[String] = 6373083923489249281
@CompanyCode693[String] = 6373083925531366080
@CompanyCode694[String] = 6373083927883400612
@CompanyCode695[String] = 6373083918575368225
@CompanyCode696[String] = 6373083920445075162
@CompanyCode697[String] = 6373083908618598731
@CompanyCode698[String] = 6373083911842783146
@CompanyCode699[String] = 6373083913928202424
@ParentCompanyCode700[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:18:12
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type701) AND ([TbOrganizationMap].[ProjectId] = @ProjectId702)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode703,@CompanyCode704,@CompanyCode705,@CompanyCode706,@CompanyCode707,@CompanyCode708,@CompanyCode709,@CompanyCode710)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode711))) 	
Parameters:
@Type701[Int32] = 1
@ProjectId702[String] = 6372912251695766465
@CompanyCode703[String] = 6373083923489249281
@CompanyCode704[String] = 6373083925531366080
@CompanyCode705[String] = 6373083927883400612
@CompanyCode706[String] = 6373083918575368225
@CompanyCode707[String] = 6373083920445075162
@CompanyCode708[String] = 6373083908618598731
@CompanyCode709[String] = 6373083911842783146
@CompanyCode710[String] = 6373083913928202424
@ParentCompanyCode711[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type712) AND ([TbOrganizationMap].[ProjectId] = @ProjectId713)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode714,@CompanyCode715,@CompanyCode716,@CompanyCode717,@CompanyCode718,@CompanyCode719,@CompanyCode720,@CompanyCode721)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode722))) 	
Parameters:
@Type712[Int32] = 2
@ProjectId713[String] = 6372912251695766465
@CompanyCode714[String] = 6373083923489249281
@CompanyCode715[String] = 6373083925531366080
@CompanyCode716[String] = 6373083927883400612
@CompanyCode717[String] = 6373083918575368225
@CompanyCode718[String] = 6373083920445075162
@CompanyCode719[String] = 6373083908618598731
@CompanyCode720[String] = 6373083911842783146
@CompanyCode721[String] = 6373083913928202424
@ParentCompanyCode722[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:18:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:19:44
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:19:44
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:19:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:19:44
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type723) AND ([TbOrganizationMap].[ProjectId] = @ProjectId724)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode725,@CompanyCode726,@CompanyCode727,@CompanyCode728,@CompanyCode729,@CompanyCode730,@CompanyCode731,@CompanyCode732)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode733))) 	
Parameters:
@Type723[Int32] = 1
@ProjectId724[String] = 6372912251695766465
@CompanyCode725[String] = 6373083923489249281
@CompanyCode726[String] = 6373083925531366080
@CompanyCode727[String] = 6373083927883400612
@CompanyCode728[String] = 6373083918575368225
@CompanyCode729[String] = 6373083920445075162
@CompanyCode730[String] = 6373083908618598731
@CompanyCode731[String] = 6373083911842783146
@CompanyCode732[String] = 6373083913928202424
@ParentCompanyCode733[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type734) AND ([TbOrganizationMap].[ProjectId] = @ProjectId735)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode736,@CompanyCode737,@CompanyCode738,@CompanyCode739,@CompanyCode740,@CompanyCode741,@CompanyCode742,@CompanyCode743)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode744))) 	
Parameters:
@Type734[Int32] = 2
@ProjectId735[String] = 6372912251695766465
@CompanyCode736[String] = 6373083923489249281
@CompanyCode737[String] = 6373083925531366080
@CompanyCode738[String] = 6373083927883400612
@CompanyCode739[String] = 6373083918575368225
@CompanyCode740[String] = 6373083920445075162
@CompanyCode741[String] = 6373083908618598731
@CompanyCode742[String] = 6373083911842783146
@CompanyCode743[String] = 6373083913928202424
@ParentCompanyCode744[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:19:45
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type745) AND ([TbOrganizationMap].[ProjectId] = @ProjectId746)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode747,@CompanyCode748,@CompanyCode749,@CompanyCode750,@CompanyCode751,@CompanyCode752,@CompanyCode753,@CompanyCode754)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode755))) 	
Parameters:
@Type745[Int32] = 1
@ProjectId746[String] = 6372912251695766465
@CompanyCode747[String] = 6373083923489249281
@CompanyCode748[String] = 6373083925531366080
@CompanyCode749[String] = 6373083927883400612
@CompanyCode750[String] = 6373083918575368225
@CompanyCode751[String] = 6373083920445075162
@CompanyCode752[String] = 6373083908618598731
@CompanyCode753[String] = 6373083911842783146
@CompanyCode754[String] = 6373083913928202424
@ParentCompanyCode755[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type756) AND ([TbOrganizationMap].[ProjectId] = @ProjectId757)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode758,@CompanyCode759,@CompanyCode760,@CompanyCode761,@CompanyCode762,@CompanyCode763,@CompanyCode764,@CompanyCode765)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode766))) 	
Parameters:
@Type756[Int32] = 2
@ProjectId757[String] = 6372912251695766465
@CompanyCode758[String] = 6373083923489249281
@CompanyCode759[String] = 6373083925531366080
@CompanyCode760[String] = 6373083927883400612
@CompanyCode761[String] = 6373083918575368225
@CompanyCode762[String] = 6373083920445075162
@CompanyCode763[String] = 6373083908618598731
@CompanyCode764[String] = 6373083911842783146
@CompanyCode765[String] = 6373083913928202424
@ParentCompanyCode766[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:19:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type767) AND ([TbOrganizationMap].[ProjectId] = @ProjectId768)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode769,@CompanyCode770,@CompanyCode771,@CompanyCode772,@CompanyCode773,@CompanyCode774,@CompanyCode775,@CompanyCode776)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode777))) 	
Parameters:
@Type767[Int32] = 1
@ProjectId768[String] = 6372912251695766465
@CompanyCode769[String] = 6373083923489249281
@CompanyCode770[String] = 6373083925531366080
@CompanyCode771[String] = 6373083927883400612
@CompanyCode772[String] = 6373083918575368225
@CompanyCode773[String] = 6373083920445075162
@CompanyCode774[String] = 6373083908618598731
@CompanyCode775[String] = 6373083911842783146
@CompanyCode776[String] = 6373083913928202424
@ParentCompanyCode777[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:21:28
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type778) AND ([TbOrganizationMap].[ProjectId] = @ProjectId779)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode780,@CompanyCode781,@CompanyCode782,@CompanyCode783,@CompanyCode784,@CompanyCode785,@CompanyCode786,@CompanyCode787)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode788))) 	
Parameters:
@Type778[Int32] = 2
@ProjectId779[String] = 6372912251695766465
@CompanyCode780[String] = 6373083923489249281
@CompanyCode781[String] = 6373083925531366080
@CompanyCode782[String] = 6373083927883400612
@CompanyCode783[String] = 6373083918575368225
@CompanyCode784[String] = 6373083920445075162
@CompanyCode785[String] = 6373083908618598731
@CompanyCode786[String] = 6373083911842783146
@CompanyCode787[String] = 6373083913928202424
@ParentCompanyCode788[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:21:29
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:24:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:27:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type789) AND ([TbOrganizationMap].[ProjectId] = @ProjectId790)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode791,@CompanyCode792,@CompanyCode793,@CompanyCode794,@CompanyCode795,@CompanyCode796,@CompanyCode797,@CompanyCode798)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode799))) 	
Parameters:
@Type789[Int32] = 1
@ProjectId790[String] = 6372912251695766465
@CompanyCode791[String] = 6373083923489249281
@CompanyCode792[String] = 6373083925531366080
@CompanyCode793[String] = 6373083927883400612
@CompanyCode794[String] = 6373083918575368225
@CompanyCode795[String] = 6373083920445075162
@CompanyCode796[String] = 6373083908618598731
@CompanyCode797[String] = 6373083911842783146
@CompanyCode798[String] = 6373083913928202424
@ParentCompanyCode799[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type800) AND ([TbOrganizationMap].[ProjectId] = @ProjectId801)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode802,@CompanyCode803,@CompanyCode804,@CompanyCode805,@CompanyCode806,@CompanyCode807,@CompanyCode808,@CompanyCode809)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode810))) 	
Parameters:
@Type800[Int32] = 2
@ProjectId801[String] = 6372912251695766465
@CompanyCode802[String] = 6373083923489249281
@CompanyCode803[String] = 6373083925531366080
@CompanyCode804[String] = 6373083927883400612
@CompanyCode805[String] = 6373083918575368225
@CompanyCode806[String] = 6373083920445075162
@CompanyCode807[String] = 6373083908618598731
@CompanyCode808[String] = 6373083911842783146
@CompanyCode809[String] = 6373083913928202424
@ParentCompanyCode810[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:29:38
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type811) AND ([TbOrganizationMap].[ProjectId] = @ProjectId812)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode813,@CompanyCode814,@CompanyCode815,@CompanyCode816,@CompanyCode817,@CompanyCode818,@CompanyCode819,@CompanyCode820)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode821))) 	
Parameters:
@Type811[Int32] = 1
@ProjectId812[String] = 6372912251695766465
@CompanyCode813[String] = 6373083923489249281
@CompanyCode814[String] = 6373083925531366080
@CompanyCode815[String] = 6373083927883400612
@CompanyCode816[String] = 6373083918575368225
@CompanyCode817[String] = 6373083920445075162
@CompanyCode818[String] = 6373083908618598731
@CompanyCode819[String] = 6373083911842783146
@CompanyCode820[String] = 6373083913928202424
@ParentCompanyCode821[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type822) AND ([TbOrganizationMap].[ProjectId] = @ProjectId823)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode824,@CompanyCode825,@CompanyCode826,@CompanyCode827,@CompanyCode828,@CompanyCode829,@CompanyCode830,@CompanyCode831)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode832))) 	
Parameters:
@Type822[Int32] = 2
@ProjectId823[String] = 6372912251695766465
@CompanyCode824[String] = 6373083923489249281
@CompanyCode825[String] = 6373083925531366080
@CompanyCode826[String] = 6373083927883400612
@CompanyCode827[String] = 6373083918575368225
@CompanyCode828[String] = 6373083920445075162
@CompanyCode829[String] = 6373083908618598731
@CompanyCode830[String] = 6373083911842783146
@CompanyCode831[String] = 6373083913928202424
@ParentCompanyCode832[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:29:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:30:00
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:30:00
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:30:00
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:30:00
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:30:00
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:30:48
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type833) AND ([TbOrganizationMap].[ProjectId] = @ProjectId834)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode835,@CompanyCode836,@CompanyCode837,@CompanyCode838,@CompanyCode839,@CompanyCode840,@CompanyCode841,@CompanyCode842)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode843))) 	
Parameters:
@Type833[Int32] = 1
@ProjectId834[String] = 6372912251695766465
@CompanyCode835[String] = 6373083923489249281
@CompanyCode836[String] = 6373083925531366080
@CompanyCode837[String] = 6373083927883400612
@CompanyCode838[String] = 6373083918575368225
@CompanyCode839[String] = 6373083920445075162
@CompanyCode840[String] = 6373083908618598731
@CompanyCode841[String] = 6373083911842783146
@CompanyCode842[String] = 6373083913928202424
@ParentCompanyCode843[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type844) AND ([TbOrganizationMap].[ProjectId] = @ProjectId845)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode846,@CompanyCode847,@CompanyCode848,@CompanyCode849,@CompanyCode850,@CompanyCode851,@CompanyCode852,@CompanyCode853)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode854))) 	
Parameters:
@Type844[Int32] = 2
@ProjectId845[String] = 6372912251695766465
@CompanyCode846[String] = 6373083923489249281
@CompanyCode847[String] = 6373083925531366080
@CompanyCode848[String] = 6373083927883400612
@CompanyCode849[String] = 6373083918575368225
@CompanyCode850[String] = 6373083920445075162
@CompanyCode851[String] = 6373083908618598731
@CompanyCode852[String] = 6373083911842783146
@CompanyCode853[String] = 6373083913928202424
@ParentCompanyCode854[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:30:49
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type855) AND ([TbOrganizationMap].[ProjectId] = @ProjectId856)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode857,@CompanyCode858,@CompanyCode859,@CompanyCode860,@CompanyCode861,@CompanyCode862,@CompanyCode863,@CompanyCode864)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode865))) 	
Parameters:
@Type855[Int32] = 1
@ProjectId856[String] = 6372912251695766465
@CompanyCode857[String] = 6373083923489249281
@CompanyCode858[String] = 6373083925531366080
@CompanyCode859[String] = 6373083927883400612
@CompanyCode860[String] = 6373083918575368225
@CompanyCode861[String] = 6373083920445075162
@CompanyCode862[String] = 6373083908618598731
@CompanyCode863[String] = 6373083911842783146
@CompanyCode864[String] = 6373083913928202424
@ParentCompanyCode865[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type866) AND ([TbOrganizationMap].[ProjectId] = @ProjectId867)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode868,@CompanyCode869,@CompanyCode870,@CompanyCode871,@CompanyCode872,@CompanyCode873,@CompanyCode874,@CompanyCode875)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode876))) 	
Parameters:
@Type866[Int32] = 2
@ProjectId867[String] = 6372912251695766465
@CompanyCode868[String] = 6373083923489249281
@CompanyCode869[String] = 6373083925531366080
@CompanyCode870[String] = 6373083927883400612
@CompanyCode871[String] = 6373083918575368225
@CompanyCode872[String] = 6373083920445075162
@CompanyCode873[String] = 6373083908618598731
@CompanyCode874[String] = 6373083911842783146
@CompanyCode875[String] = 6373083913928202424
@ParentCompanyCode876[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode905)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId877) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode878,@SiteCode879,@SiteCode880,@SiteCode881,@SiteCode882,@SiteCode883,@SiteCode884,@SiteCode885,@SiteCode886,@SiteCode887,@SiteCode888,@SiteCode889,@SiteCode890,@SiteCode891,@SiteCode892,@SiteCode893,@SiteCode894,@SiteCode895,@SiteCode896,@SiteCode897,@SiteCode898,@SiteCode899,@SiteCode900,@SiteCode901,@SiteCode902,@SiteCode903,@SiteCode904)))	
Parameters:
@ProjectId877[String] = 6372912251695766465
@SiteCode878[String] = 6373083923489249281
@SiteCode879[String] = 6373083925531366080
@SiteCode880[String] = 6373083927883400612
@SiteCode881[String] = 6373083918575368225
@SiteCode882[String] = 6373083920445075162
@SiteCode883[String] = 6373083908618598731
@SiteCode884[String] = 6373083911842783146
@SiteCode885[String] = 6373083913928202424
@SiteCode886[String] = 6373083877551621804
@SiteCode887[String] = 6373083879921857377
@SiteCode888[String] = 6373083881542550067
@SiteCode889[String] = 6373083883689772886
@SiteCode890[String] = 6373083887136270013
@SiteCode891[String] = 6373083889697116488
@SiteCode892[String] = 6373083891969846476
@SiteCode893[String] = 6373083894422586761
@SiteCode894[String] = 6373083897509963358
@SiteCode895[String] = 6373083900444931227
@SiteCode896[String] = 6373083829464571372
@SiteCode897[String] = 6373083833327492328
@SiteCode898[String] = 6373083841964286321
@SiteCode899[String] = 6373083844982558950
@SiteCode900[String] = 6373083847585007801
@SiteCode901[String] = 6373083856887939900
@SiteCode902[String] = 6373083859102666584
@SiteCode903[String] = 6373083864919499284
@SiteCode904[String] = 6373334974514214221
@FDictionaryCode905[String] = OrderState
@FDictionaryCode906[String] = UrgentDegree
@FDictionaryCode907[String] = OrderType


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode906) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode907) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode905)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId877) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode878,@SiteCode879,@SiteCode880,@SiteCode881,@SiteCode882,@SiteCode883,@SiteCode884,@SiteCode885,@SiteCode886,@SiteCode887,@SiteCode888,@SiteCode889,@SiteCode890,@SiteCode891,@SiteCode892,@SiteCode893,@SiteCode894,@SiteCode895,@SiteCode896,@SiteCode897,@SiteCode898,@SiteCode899,@SiteCode900,@SiteCode901,@SiteCode902,@SiteCode903,@SiteCode904))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId877[String] = 6372912251695766465
@SiteCode878[String] = 6373083923489249281
@SiteCode879[String] = 6373083925531366080
@SiteCode880[String] = 6373083927883400612
@SiteCode881[String] = 6373083918575368225
@SiteCode882[String] = 6373083920445075162
@SiteCode883[String] = 6373083908618598731
@SiteCode884[String] = 6373083911842783146
@SiteCode885[String] = 6373083913928202424
@SiteCode886[String] = 6373083877551621804
@SiteCode887[String] = 6373083879921857377
@SiteCode888[String] = 6373083881542550067
@SiteCode889[String] = 6373083883689772886
@SiteCode890[String] = 6373083887136270013
@SiteCode891[String] = 6373083889697116488
@SiteCode892[String] = 6373083891969846476
@SiteCode893[String] = 6373083894422586761
@SiteCode894[String] = 6373083897509963358
@SiteCode895[String] = 6373083900444931227
@SiteCode896[String] = 6373083829464571372
@SiteCode897[String] = 6373083833327492328
@SiteCode898[String] = 6373083841964286321
@SiteCode899[String] = 6373083844982558950
@SiteCode900[String] = 6373083847585007801
@SiteCode901[String] = 6373083856887939900
@SiteCode902[String] = 6373083859102666584
@SiteCode903[String] = 6373083864919499284
@SiteCode904[String] = 6373334974514214221
@FDictionaryCode905[String] = OrderState
@FDictionaryCode906[String] = UrgentDegree
@FDictionaryCode907[String] = OrderType


-----------------------------------------------------------------------------
2020-08-26 11:31:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	 SELECT count(*) as r_cnt FROM [TbProblemOrder] LEFT OUTER JOIN [TbUser] ON ([TbProblemOrder].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbCompany] ON ([TbProblemOrder].[SiteCode] = [TbCompany].[CompanyCode]) WHERE ((([TbProblemOrder].[SiteCode] IN (@SiteCode908,@SiteCode909,@SiteCode910,@SiteCode911,@SiteCode912,@SiteCode913,@SiteCode914,@SiteCode915,@SiteCode916,@SiteCode917,@SiteCode918,@SiteCode919,@SiteCode920,@SiteCode921,@SiteCode922,@SiteCode923,@SiteCode924,@SiteCode925,@SiteCode926,@SiteCode927,@SiteCode928,@SiteCode929,@SiteCode930,@SiteCode931,@SiteCode932,@SiteCode933,@SiteCode934)) AND ([TbProblemOrder].[ProcessFactoryCode] = @ProcessFactoryCode935)) AND ([TbProblemOrder].[ProjectId] = @ProjectId936))	
Parameters:
@SiteCode908[String] = 6373083923489249281
@SiteCode909[String] = 6373083925531366080
@SiteCode910[String] = 6373083927883400612
@SiteCode911[String] = 6373083918575368225
@SiteCode912[String] = 6373083920445075162
@SiteCode913[String] = 6373083908618598731
@SiteCode914[String] = 6373083911842783146
@SiteCode915[String] = 6373083913928202424
@SiteCode916[String] = 6373083877551621804
@SiteCode917[String] = 6373083879921857377
@SiteCode918[String] = 6373083881542550067
@SiteCode919[String] = 6373083883689772886
@SiteCode920[String] = 6373083887136270013
@SiteCode921[String] = 6373083889697116488
@SiteCode922[String] = 6373083891969846476
@SiteCode923[String] = 6373083894422586761
@SiteCode924[String] = 6373083897509963358
@SiteCode925[String] = 6373083900444931227
@SiteCode926[String] = 6373083829464571372
@SiteCode927[String] = 6373083833327492328
@SiteCode928[String] = 6373083841964286321
@SiteCode929[String] = 6373083844982558950
@SiteCode930[String] = 6373083847585007801
@SiteCode931[String] = 6373083856887939900
@SiteCode932[String] = 6373083859102666584
@SiteCode933[String] = 6373083864919499284
@SiteCode934[String] = 6373334974514214221
@ProcessFactoryCode935[String] = 6372982160979097303
@ProjectId936[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	 SELECT   TOP 50 [TbProblemOrder].*,[TbProblemOrder].[Examinestatus] AS [ExaminestatusNew],[TbUser].[UserName],[TbCompany].[CompanyFullName] AS [SiteName] FROM [TbProblemOrder] LEFT OUTER JOIN [TbUser] ON ([TbProblemOrder].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbCompany] ON ([TbProblemOrder].[SiteCode] = [TbCompany].[CompanyCode])  WHERE ((([TbProblemOrder].[SiteCode] IN (@SiteCode908,@SiteCode909,@SiteCode910,@SiteCode911,@SiteCode912,@SiteCode913,@SiteCode914,@SiteCode915,@SiteCode916,@SiteCode917,@SiteCode918,@SiteCode919,@SiteCode920,@SiteCode921,@SiteCode922,@SiteCode923,@SiteCode924,@SiteCode925,@SiteCode926,@SiteCode927,@SiteCode928,@SiteCode929,@SiteCode930,@SiteCode931,@SiteCode932,@SiteCode933,@SiteCode934)) AND ([TbProblemOrder].[ProcessFactoryCode] = @ProcessFactoryCode935)) AND ([TbProblemOrder].[ProjectId] = @ProjectId936)) ORDER BY [TbProblemOrder].[ID] DESC 	
Parameters:
@SiteCode908[String] = 6373083923489249281
@SiteCode909[String] = 6373083925531366080
@SiteCode910[String] = 6373083927883400612
@SiteCode911[String] = 6373083918575368225
@SiteCode912[String] = 6373083920445075162
@SiteCode913[String] = 6373083908618598731
@SiteCode914[String] = 6373083911842783146
@SiteCode915[String] = 6373083913928202424
@SiteCode916[String] = 6373083877551621804
@SiteCode917[String] = 6373083879921857377
@SiteCode918[String] = 6373083881542550067
@SiteCode919[String] = 6373083883689772886
@SiteCode920[String] = 6373083887136270013
@SiteCode921[String] = 6373083889697116488
@SiteCode922[String] = 6373083891969846476
@SiteCode923[String] = 6373083894422586761
@SiteCode924[String] = 6373083897509963358
@SiteCode925[String] = 6373083900444931227
@SiteCode926[String] = 6373083829464571372
@SiteCode927[String] = 6373083833327492328
@SiteCode928[String] = 6373083841964286321
@SiteCode929[String] = 6373083844982558950
@SiteCode930[String] = 6373083847585007801
@SiteCode931[String] = 6373083856887939900
@SiteCode932[String] = 6373083859102666584
@SiteCode933[String] = 6373083864919499284
@SiteCode934[String] = 6373334974514214221
@ProcessFactoryCode935[String] = 6372982160979097303
@ProjectId936[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb 	


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb ) as a)  SELECT * FROM temptbl where Row between 1 and 15	


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:31:08
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:33:41
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:33:41
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:33:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type937) AND ([TbOrganizationMap].[ProjectId] = @ProjectId938)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode939,@CompanyCode940,@CompanyCode941,@CompanyCode942,@CompanyCode943,@CompanyCode944,@CompanyCode945,@CompanyCode946)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode947))) 	
Parameters:
@Type937[Int32] = 1
@ProjectId938[String] = 6372912251695766465
@CompanyCode939[String] = 6373083923489249281
@CompanyCode940[String] = 6373083925531366080
@CompanyCode941[String] = 6373083927883400612
@CompanyCode942[String] = 6373083918575368225
@CompanyCode943[String] = 6373083920445075162
@CompanyCode944[String] = 6373083908618598731
@CompanyCode945[String] = 6373083911842783146
@CompanyCode946[String] = 6373083913928202424
@ParentCompanyCode947[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type948) AND ([TbOrganizationMap].[ProjectId] = @ProjectId949)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode950,@CompanyCode951,@CompanyCode952,@CompanyCode953,@CompanyCode954,@CompanyCode955,@CompanyCode956,@CompanyCode957)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode958))) 	
Parameters:
@Type948[Int32] = 2
@ProjectId949[String] = 6372912251695766465
@CompanyCode950[String] = 6373083923489249281
@CompanyCode951[String] = 6373083925531366080
@CompanyCode952[String] = 6373083927883400612
@CompanyCode953[String] = 6373083918575368225
@CompanyCode954[String] = 6373083920445075162
@CompanyCode955[String] = 6373083908618598731
@CompanyCode956[String] = 6373083911842783146
@CompanyCode957[String] = 6373083913928202424
@ParentCompanyCode958[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:33:42
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:33:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:33:47
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:33:47
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:33:48
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:34:48
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:34:53
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:34:53
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:34:53
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:34:54
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:35:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:36:06
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:36:06
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:36:06
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:36:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:37:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:37:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:37:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:37:21
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type45) AND ([TbOrganizationMap].[ProjectId] = @ProjectId46)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode55))) 	
Parameters:
@Type45[Int32] = 1
@ProjectId46[String] = 6372912251695766465
@CompanyCode47[String] = 6373083923489249281
@CompanyCode48[String] = 6373083925531366080
@CompanyCode49[String] = 6373083927883400612
@CompanyCode50[String] = 6373083918575368225
@CompanyCode51[String] = 6373083920445075162
@CompanyCode52[String] = 6373083908618598731
@CompanyCode53[String] = 6373083911842783146
@CompanyCode54[String] = 6373083913928202424
@ParentCompanyCode55[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type56) AND ([TbOrganizationMap].[ProjectId] = @ProjectId57)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode66))) 	
Parameters:
@Type56[Int32] = 2
@ProjectId57[String] = 6372912251695766465
@CompanyCode58[String] = 6373083923489249281
@CompanyCode59[String] = 6373083925531366080
@CompanyCode60[String] = 6373083927883400612
@CompanyCode61[String] = 6373083918575368225
@CompanyCode62[String] = 6373083920445075162
@CompanyCode63[String] = 6373083908618598731
@CompanyCode64[String] = 6373083911842783146
@CompanyCode65[String] = 6373083913928202424
@ParentCompanyCode66[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:37:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:37:30
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:37:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:37:43
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:39:02
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:39:03
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:40:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:41:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:41:56
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:41:56
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:41:56
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:41:57
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:42:56
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 11:42:56
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 11:42:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 11:42:57
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 11:43:02
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 11:43:02
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 11:43:02
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:43:02
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:43:03
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 11:45:09
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FG_FG%


-----------------------------------------------------------------------------
2020-08-26 11:45:09
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FG_%


-----------------------------------------------------------------------------
2020-08-26 11:45:09
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FG_%


-----------------------------------------------------------------------------
2020-08-26 11:45:09
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm26,@MxGjBm27,@MxGjBm28,@MxGjBm29,@MxGjBm30,@MxGjBm31,@MxGjBm32,@MxGjBm33,@MxGjBm34,@MxGjBm35,@MxGjBm36,@MxGjBm37,@MxGjBm38,@MxGjBm39,@MxGjBm40,@MxGjBm41,@MxGjBm42,@MxGjBm43,@MxGjBm44) 	
Parameters:
@MxGjBm26[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm27[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm28[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm29[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm30[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm31[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm32[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm33[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1
@MxGjBm34[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm35[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm36[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1
@MxGjBm37[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1
@MxGjBm38[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1
@MxGjBm39[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm40[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm41[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm42[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1
@MxGjBm43[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2
@MxGjBm44[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2


-----------------------------------------------------------------------------
2020-08-26 11:45:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode45,@ComponentCode46,@ComponentCode47,@ComponentCode48,@ComponentCode49,@ComponentCode50,@ComponentCode51,@ComponentCode52,@ComponentCode53,@ComponentCode54,@ComponentCode55,@ComponentCode56,@ComponentCode57,@ComponentCode58,@ComponentCode59,@ComponentCode60,@ComponentCode61,@ComponentCode62,@ComponentCode63)) AND ([TbModelOtherInfo].[Type] = @Type64) 	
Parameters:
@ComponentCode45[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_115
@ComponentCode46[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_176
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_033
@ComponentCode48[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_067
@ComponentCode49[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_164
@ComponentCode50[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_133
@ComponentCode51[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_152
@ComponentCode52[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1_052
@ComponentCode53[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_073
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_106
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1_146
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1_056
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FG_FG-P1_136
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_029
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_058
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_050
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S1_153
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_026
@ComponentCode63[String] = L21_Z08_00KT_DXT_DXT_FG_FG-S2_188
@Type64[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 11:45:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:48:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:51:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:54:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 11:57:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:00:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:03:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:06:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:09:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:12:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:14:47
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:14:47
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:14:47
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:14:49
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 12:15:35
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 12:15:36
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 12:15:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 12:15:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 12:15:36
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 12:15:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:15:41
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 12:15:41
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:15:41
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:15:43
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:18:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:21:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:21:59
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:21:59
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:21:59
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type45) AND ([TbOrganizationMap].[ProjectId] = @ProjectId46)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode55))) 	
Parameters:
@Type45[Int32] = 1
@ProjectId46[String] = 6372912251695766465
@CompanyCode47[String] = 6373083923489249281
@CompanyCode48[String] = 6373083925531366080
@CompanyCode49[String] = 6373083927883400612
@CompanyCode50[String] = 6373083918575368225
@CompanyCode51[String] = 6373083920445075162
@CompanyCode52[String] = 6373083908618598731
@CompanyCode53[String] = 6373083911842783146
@CompanyCode54[String] = 6373083913928202424
@ParentCompanyCode55[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type56) AND ([TbOrganizationMap].[ProjectId] = @ProjectId57)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode66))) 	
Parameters:
@Type56[Int32] = 2
@ProjectId57[String] = 6372912251695766465
@CompanyCode58[String] = 6373083923489249281
@CompanyCode59[String] = 6373083925531366080
@CompanyCode60[String] = 6373083927883400612
@CompanyCode61[String] = 6373083918575368225
@CompanyCode62[String] = 6373083920445075162
@CompanyCode63[String] = 6373083908618598731
@CompanyCode64[String] = 6373083911842783146
@CompanyCode65[String] = 6373083913928202424
@ParentCompanyCode66[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 12:22:00
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 12:22:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:22:35
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 12:22:36
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:22:36
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:22:37
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:23:39
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:23:39
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:23:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type67) AND ([TbOrganizationMap].[ProjectId] = @ProjectId68)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72,@CompanyCode73,@CompanyCode74,@CompanyCode75,@CompanyCode76)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode77))) 	
Parameters:
@Type67[Int32] = 1
@ProjectId68[String] = 6372912251695766465
@CompanyCode69[String] = 6373083923489249281
@CompanyCode70[String] = 6373083925531366080
@CompanyCode71[String] = 6373083927883400612
@CompanyCode72[String] = 6373083918575368225
@CompanyCode73[String] = 6373083920445075162
@CompanyCode74[String] = 6373083908618598731
@CompanyCode75[String] = 6373083911842783146
@CompanyCode76[String] = 6373083913928202424
@ParentCompanyCode77[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type78) AND ([TbOrganizationMap].[ProjectId] = @ProjectId79)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83,@CompanyCode84,@CompanyCode85,@CompanyCode86,@CompanyCode87)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode88))) 	
Parameters:
@Type78[Int32] = 2
@ProjectId79[String] = 6372912251695766465
@CompanyCode80[String] = 6373083923489249281
@CompanyCode81[String] = 6373083925531366080
@CompanyCode82[String] = 6373083927883400612
@CompanyCode83[String] = 6373083918575368225
@CompanyCode84[String] = 6373083920445075162
@CompanyCode85[String] = 6373083908618598731
@CompanyCode86[String] = 6373083911842783146
@CompanyCode87[String] = 6373083913928202424
@ParentCompanyCode88[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 12:23:40
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 12:24:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:24:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:24:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type89) AND ([TbOrganizationMap].[ProjectId] = @ProjectId90)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode91,@CompanyCode92,@CompanyCode93,@CompanyCode94,@CompanyCode95,@CompanyCode96,@CompanyCode97,@CompanyCode98)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode99))) 	
Parameters:
@Type89[Int32] = 1
@ProjectId90[String] = 6372912251695766465
@CompanyCode91[String] = 6373083923489249281
@CompanyCode92[String] = 6373083925531366080
@CompanyCode93[String] = 6373083927883400612
@CompanyCode94[String] = 6373083918575368225
@CompanyCode95[String] = 6373083920445075162
@CompanyCode96[String] = 6373083908618598731
@CompanyCode97[String] = 6373083911842783146
@CompanyCode98[String] = 6373083913928202424
@ParentCompanyCode99[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type100) AND ([TbOrganizationMap].[ProjectId] = @ProjectId101)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode102,@CompanyCode103,@CompanyCode104,@CompanyCode105,@CompanyCode106,@CompanyCode107,@CompanyCode108,@CompanyCode109)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode110))) 	
Parameters:
@Type100[Int32] = 2
@ProjectId101[String] = 6372912251695766465
@CompanyCode102[String] = 6373083923489249281
@CompanyCode103[String] = 6373083925531366080
@CompanyCode104[String] = 6373083927883400612
@CompanyCode105[String] = 6373083918575368225
@CompanyCode106[String] = 6373083920445075162
@CompanyCode107[String] = 6373083908618598731
@CompanyCode108[String] = 6373083911842783146
@CompanyCode109[String] = 6373083913928202424
@ParentCompanyCode110[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 12:24:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 12:24:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:24:34
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 12:24:34
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:24:34
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:24:35
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:26:11
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 12:26:11
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 12:26:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type111) AND ([TbOrganizationMap].[ProjectId] = @ProjectId112)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode113,@CompanyCode114,@CompanyCode115,@CompanyCode116,@CompanyCode117,@CompanyCode118,@CompanyCode119,@CompanyCode120)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode121))) 	
Parameters:
@Type111[Int32] = 1
@ProjectId112[String] = 6372912251695766465
@CompanyCode113[String] = 6373083923489249281
@CompanyCode114[String] = 6373083925531366080
@CompanyCode115[String] = 6373083927883400612
@CompanyCode116[String] = 6373083918575368225
@CompanyCode117[String] = 6373083920445075162
@CompanyCode118[String] = 6373083908618598731
@CompanyCode119[String] = 6373083911842783146
@CompanyCode120[String] = 6373083913928202424
@ParentCompanyCode121[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type122) AND ([TbOrganizationMap].[ProjectId] = @ProjectId123)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode124,@CompanyCode125,@CompanyCode126,@CompanyCode127,@CompanyCode128,@CompanyCode129,@CompanyCode130,@CompanyCode131)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode132))) 	
Parameters:
@Type122[Int32] = 2
@ProjectId123[String] = 6372912251695766465
@CompanyCode124[String] = 6373083923489249281
@CompanyCode125[String] = 6373083925531366080
@CompanyCode126[String] = 6373083927883400612
@CompanyCode127[String] = 6373083918575368225
@CompanyCode128[String] = 6373083920445075162
@CompanyCode129[String] = 6373083908618598731
@CompanyCode130[String] = 6373083911842783146
@CompanyCode131[String] = 6373083913928202424
@ParentCompanyCode132[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 12:26:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 12:26:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 12:26:35
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 12:26:35
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:26:35
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:26:36
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 12:29:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:32:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:35:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:38:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:41:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 12:44:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 12:47:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 12:50:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 12:53:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 12:56:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 12:59:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:02:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:05:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:08:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:11:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:14:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:17:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:20:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:23:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:26:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:29:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:32:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:35:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:38:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:41:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:44:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:47:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:50:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:53:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:56:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 13:59:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:02:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:05:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:08:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:11:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:14:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:17:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:20:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:23:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:26:13
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:29:13
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:32:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:33:22
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6337324142387400704','6352967650544590848') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 14:33:22
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6487716734823440384


-----------------------------------------------------------------------------
2020-08-26 14:33:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type133) AND ([TbOrganizationMap].[ProjectId] = @ProjectId134)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode135,@CompanyCode136,@CompanyCode137,@CompanyCode138,@CompanyCode139,@CompanyCode140,@CompanyCode141,@CompanyCode142)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode143))) 	
Parameters:
@Type133[Int32] = 1
@ProjectId134[String] = 6245721945602523136
@CompanyCode135[String] = 6373083923489249281
@CompanyCode136[String] = 6373083925531366080
@CompanyCode137[String] = 6373083927883400612
@CompanyCode138[String] = 6373083918575368225
@CompanyCode139[String] = 6373083920445075162
@CompanyCode140[String] = 6373083908618598731
@CompanyCode141[String] = 6373083911842783146
@CompanyCode142[String] = 6373083913928202424
@ParentCompanyCode143[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type144) AND ([TbOrganizationMap].[ProjectId] = @ProjectId145)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode146,@CompanyCode147,@CompanyCode148,@CompanyCode149,@CompanyCode150,@CompanyCode151,@CompanyCode152,@CompanyCode153)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode154))) 	
Parameters:
@Type144[Int32] = 2
@ProjectId145[String] = 6245721945602523136
@CompanyCode146[String] = 6373083923489249281
@CompanyCode147[String] = 6373083925531366080
@CompanyCode148[String] = 6373083927883400612
@CompanyCode149[String] = 6373083918575368225
@CompanyCode150[String] = 6373083920445075162
@CompanyCode151[String] = 6373083908618598731
@CompanyCode152[String] = 6373083911842783146
@CompanyCode153[String] = 6373083913928202424
@ParentCompanyCode154[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6337324142387400704','6352967650544590848')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 102787
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6247574415609954304')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6247574415609954304')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6337324142387400704','6352967650544590848')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 102787
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  and a.FullCode='6245721945602523136' order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 14:33:23
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6247574415609954304


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6337324142387400704','6352967650544590848') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6487716734823440384


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type155) AND ([TbOrganizationMap].[ProjectId] = @ProjectId156)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode157,@CompanyCode158,@CompanyCode159,@CompanyCode160,@CompanyCode161,@CompanyCode162,@CompanyCode163,@CompanyCode164)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode165))) 	
Parameters:
@Type155[Int32] = 1
@ProjectId156[String] = 6245721945602523136
@CompanyCode157[String] = 6373083923489249281
@CompanyCode158[String] = 6373083925531366080
@CompanyCode159[String] = 6373083927883400612
@CompanyCode160[String] = 6373083918575368225
@CompanyCode161[String] = 6373083920445075162
@CompanyCode162[String] = 6373083908618598731
@CompanyCode163[String] = 6373083911842783146
@CompanyCode164[String] = 6373083913928202424
@ParentCompanyCode165[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type166) AND ([TbOrganizationMap].[ProjectId] = @ProjectId167)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode168,@CompanyCode169,@CompanyCode170,@CompanyCode171,@CompanyCode172,@CompanyCode173,@CompanyCode174,@CompanyCode175)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode176))) 	
Parameters:
@Type166[Int32] = 2
@ProjectId167[String] = 6245721945602523136
@CompanyCode168[String] = 6373083923489249281
@CompanyCode169[String] = 6373083925531366080
@CompanyCode170[String] = 6373083927883400612
@CompanyCode171[String] = 6373083918575368225
@CompanyCode172[String] = 6373083920445075162
@CompanyCode173[String] = 6373083908618598731
@CompanyCode174[String] = 6373083911842783146
@CompanyCode175[String] = 6373083913928202424
@ParentCompanyCode176[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6337324142387400704','6352967650544590848')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 102787
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6247574415609954304
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6247574415609954304')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6247574415609954304')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6337324142387400704','6352967650544590848')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 102787
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  and a.FullCode='6245721945602523136' order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 14:33:32
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6247574415609954304


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode177) AND ([TbUser].[UserPwd] = @UserPwd178) 	
Parameters:
@UserCode177[String] = 500000
@UserPwd178[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode179 	
Parameters:
@UserCode179[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 14:34:19
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu180,@ActionType181,@HostName182,@LogDate183,@UserCode184,@UserIP185);select scope_identity()	
Parameters:
@ActionMenu180[String] = 0
@ActionType181[String] = 登录系统
@HostName182[String] = 
@LogDate183[DateTime] = 2020/8/26 14:34:19
@UserCode184[String] = 500000
@UserIP185[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type186) AND ([TbOrganizationMap].[ProjectId] = @ProjectId187)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode188,@CompanyCode189,@CompanyCode190,@CompanyCode191,@CompanyCode192,@CompanyCode193,@CompanyCode194,@CompanyCode195)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode196))) 	
Parameters:
@Type186[Int32] = 1
@ProjectId187[String] = 6372912251695766465
@CompanyCode188[String] = 6373083923489249281
@CompanyCode189[String] = 6373083925531366080
@CompanyCode190[String] = 6373083927883400612
@CompanyCode191[String] = 6373083918575368225
@CompanyCode192[String] = 6373083920445075162
@CompanyCode193[String] = 6373083908618598731
@CompanyCode194[String] = 6373083911842783146
@CompanyCode195[String] = 6373083913928202424
@ParentCompanyCode196[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type197) AND ([TbOrganizationMap].[ProjectId] = @ProjectId198)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode199,@CompanyCode200,@CompanyCode201,@CompanyCode202,@CompanyCode203,@CompanyCode204,@CompanyCode205,@CompanyCode206)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode207))) 	
Parameters:
@Type197[Int32] = 2
@ProjectId198[String] = 6372912251695766465
@CompanyCode199[String] = 6373083923489249281
@CompanyCode200[String] = 6373083925531366080
@CompanyCode201[String] = 6373083927883400612
@CompanyCode202[String] = 6373083918575368225
@CompanyCode203[String] = 6373083920445075162
@CompanyCode204[String] = 6373083908618598731
@CompanyCode205[String] = 6373083911842783146
@CompanyCode206[String] = 6373083913928202424
@ParentCompanyCode207[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 14:34:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 14:34:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 14:34:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 14:34:36
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 14:34:36
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 14:34:36
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 14:34:38
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 14:34:50
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode209) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode210) 	
Parameters:
@SiteCode209[String] = 6373083923489249281
@ComponentCode210[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 14:34:51
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 14:34:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 14:34:51
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm211) 	
Parameters:
@MxGjBm211[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-26 14:34:51
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode212)) AND ([TbModelOtherInfo].[Type] = @Type213) 	
Parameters:
@ComponentCode212[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type213[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 14:34:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-26 14:34:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 14:34:54
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId214,@MxGjId215) 	
Parameters:
@MxGjId214[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId215[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 14:34:54
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode216,@ComponentCode217)) AND ([TbModelOtherInfo].[Type] = @Type218) 	
Parameters:
@ComponentCode216[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode217[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type218[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 14:37:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:40:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:43:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:46:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:49:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:52:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:55:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 14:58:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:01:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:04:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:07:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:10:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:13:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:16:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:19:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:20:36
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode220) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode221) 	
Parameters:
@SiteCode220[String] = 6373083923489249281
@ComponentCode221[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%


-----------------------------------------------------------------------------
2020-08-26 15:20:36
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:36
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:36
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm222,@MxGjBm223) 	
Parameters:
@MxGjBm222[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm223[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:36
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode224,@ComponentCode225)) AND ([TbModelOtherInfo].[Type] = @Type226) 	
Parameters:
@ComponentCode224[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode225[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type226[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:37
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode228) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode229) 	
Parameters:
@SiteCode228[String] = 6373083923489249281
@ComponentCode229[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%


-----------------------------------------------------------------------------
2020-08-26 15:20:37
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:37
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:37
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm230) 	
Parameters:
@MxGjBm230[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:37
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode231)) AND ([TbModelOtherInfo].[Type] = @Type232) 	
Parameters:
@ComponentCode231[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type232[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:38
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode234) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode235) 	
Parameters:
@SiteCode234[String] = 6373083923489249281
@ComponentCode235[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:39
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode237) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode238) 	
Parameters:
@SiteCode237[String] = 6373083923489249281
@ComponentCode238[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:39
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:39
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm239) 	
Parameters:
@MxGjBm239[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:39
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode240)) AND ([TbModelOtherInfo].[Type] = @Type241) 	
Parameters:
@ComponentCode240[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type241[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:40
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode243) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode244) 	
Parameters:
@SiteCode243[String] = 6373083923489249281
@ComponentCode244[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:41
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode246) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode247) 	
Parameters:
@SiteCode246[String] = 6373083923489249281
@ComponentCode247[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%


-----------------------------------------------------------------------------
2020-08-26 15:20:41
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:41
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm248) 	
Parameters:
@MxGjBm248[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode249)) AND ([TbModelOtherInfo].[Type] = @Type250) 	
Parameters:
@ComponentCode249[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type250[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:42
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode252) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode253) 	
Parameters:
@SiteCode252[String] = 6373083923489249281
@ComponentCode253[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode255) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode256) 	
Parameters:
@SiteCode255[String] = 6373083923489249281
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm257) 	
Parameters:
@MxGjBm257[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode258)) AND ([TbModelOtherInfo].[Type] = @Type259) 	
Parameters:
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type259[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:43
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode261) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode262) 	
Parameters:
@SiteCode261[String] = 6373083923489249281
@ComponentCode262[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:45
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode264) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode265) 	
Parameters:
@SiteCode264[String] = 6373083923489249281
@ComponentCode265[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%


-----------------------------------------------------------------------------
2020-08-26 15:20:45
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-26 15:20:45
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm266) 	
Parameters:
@MxGjBm266[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-26 15:20:45
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode267)) AND ([TbModelOtherInfo].[Type] = @Type268) 	
Parameters:
@ComponentCode267[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type268[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 15:20:46
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode270) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode271) 	
Parameters:
@SiteCode270[String] = 6373083923489249281
@ComponentCode271[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%


-----------------------------------------------------------------------------
2020-08-26 15:22:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:25:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:28:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:31:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:34:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:37:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:40:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:43:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:46:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:49:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:52:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:55:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 15:58:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:01:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:04:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:07:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:10:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:13:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:16:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:19:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:22:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:43:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 16:43:54
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/26 16:43:54
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 16:43:57
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:43:57
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:43:57
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:43:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:43:59
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:43:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:43:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:43:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:43:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:44:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:44:18
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:44:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:44:39
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:46:28
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:46:28
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:46:28
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type32) AND ([TbOrganizationMap].[ProjectId] = @ProjectId33)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode34,@CompanyCode35,@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode42))) 	
Parameters:
@Type32[Int32] = 1
@ProjectId33[String] = 6372912251695766465
@CompanyCode34[String] = 6373083923489249281
@CompanyCode35[String] = 6373083925531366080
@CompanyCode36[String] = 6373083927883400612
@CompanyCode37[String] = 6373083918575368225
@CompanyCode38[String] = 6373083920445075162
@CompanyCode39[String] = 6373083908618598731
@CompanyCode40[String] = 6373083911842783146
@CompanyCode41[String] = 6373083913928202424
@ParentCompanyCode42[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type43) AND ([TbOrganizationMap].[ProjectId] = @ProjectId44)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode45,@CompanyCode46,@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode53))) 	
Parameters:
@Type43[Int32] = 2
@ProjectId44[String] = 6372912251695766465
@CompanyCode45[String] = 6373083923489249281
@CompanyCode46[String] = 6373083925531366080
@CompanyCode47[String] = 6373083927883400612
@CompanyCode48[String] = 6373083918575368225
@CompanyCode49[String] = 6373083920445075162
@CompanyCode50[String] = 6373083908618598731
@CompanyCode51[String] = 6373083911842783146
@CompanyCode52[String] = 6373083913928202424
@ParentCompanyCode53[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:46:29
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:46:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:46:38
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:46:38
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:46:39
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:46:40
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:46:47
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode55) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode56) 	
Parameters:
@SiteCode55[String] = 6373083923489249281
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 16:46:47
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:46:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:46:47
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode57) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart58)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode59)) 	
Parameters:
@SiteCode57[String] = 6373083923489249281
@RevokeStart58[String] = 未撤销
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF


-----------------------------------------------------------------------------
2020-08-26 16:46:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60)) AND ([TbModelOtherInfo].[Type] = @Type61) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type61[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:46:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:46:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode62) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart63)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId64,@MxGjId65)) 	
Parameters:
@SiteCode62[String] = 6373083923489249281
@RevokeStart63[String] = 未撤销
@MxGjId64[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId65[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:46:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode66,@ComponentCode67)) AND ([TbModelOtherInfo].[Type] = @Type68) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type68[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:48:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:48:01
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:48:01
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:48:01
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:48:02
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:48:08
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode70) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode71) 	
Parameters:
@SiteCode70[String] = 6373083923489249281
@ComponentCode71[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-26 16:48:08
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:48:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:48:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode72) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart73)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode74,@ComponentCode75,@ComponentCode76)) 	
Parameters:
@SiteCode72[String] = 6373083923489249281
@RevokeStart73[String] = 未撤销
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-26 16:48:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode77,@ComponentCode78,@ComponentCode79)) AND ([TbModelOtherInfo].[Type] = @Type80) 	
Parameters:
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type80[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:48:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:48:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode81) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart82)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId83,@MxGjId84)) 	
Parameters:
@SiteCode81[String] = 6373083923489249281
@RevokeStart82[String] = 未撤销
@MxGjId83[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId84[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:48:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode85,@ComponentCode86)) AND ([TbModelOtherInfo].[Type] = @Type87) 	
Parameters:
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode86[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type87[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:48:57
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:48:57
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode88) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart89)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId90,@MxGjId91)) 	
Parameters:
@SiteCode88[String] = 6373083923489249281
@RevokeStart89[String] = 未撤销
@MxGjId90[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId91[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:48:57
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode92,@ComponentCode93)) AND ([TbModelOtherInfo].[Type] = @Type94) 	
Parameters:
@ComponentCode92[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode93[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type94[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:49:06
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:49:06
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:49:06
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type95) AND ([TbOrganizationMap].[ProjectId] = @ProjectId96)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode97,@CompanyCode98,@CompanyCode99,@CompanyCode100,@CompanyCode101,@CompanyCode102,@CompanyCode103,@CompanyCode104)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode105))) 	
Parameters:
@Type95[Int32] = 1
@ProjectId96[String] = 6372912251695766465
@CompanyCode97[String] = 6373083923489249281
@CompanyCode98[String] = 6373083925531366080
@CompanyCode99[String] = 6373083927883400612
@CompanyCode100[String] = 6373083918575368225
@CompanyCode101[String] = 6373083920445075162
@CompanyCode102[String] = 6373083908618598731
@CompanyCode103[String] = 6373083911842783146
@CompanyCode104[String] = 6373083913928202424
@ParentCompanyCode105[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type106) AND ([TbOrganizationMap].[ProjectId] = @ProjectId107)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode108,@CompanyCode109,@CompanyCode110,@CompanyCode111,@CompanyCode112,@CompanyCode113,@CompanyCode114,@CompanyCode115)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode116))) 	
Parameters:
@Type106[Int32] = 2
@ProjectId107[String] = 6372912251695766465
@CompanyCode108[String] = 6373083923489249281
@CompanyCode109[String] = 6373083925531366080
@CompanyCode110[String] = 6373083927883400612
@CompanyCode111[String] = 6373083918575368225
@CompanyCode112[String] = 6373083920445075162
@CompanyCode113[String] = 6373083908618598731
@CompanyCode114[String] = 6373083911842783146
@CompanyCode115[String] = 6373083913928202424
@ParentCompanyCode116[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:49:07
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:49:11
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:49:11
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:49:11
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:49:11
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:49:13
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:49:18
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode118) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode119) 	
Parameters:
@SiteCode118[String] = 6373083923489249281
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-26 16:49:18
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:49:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:49:18
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode120) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart121)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode122,@ComponentCode123,@ComponentCode124)) 	
Parameters:
@SiteCode120[String] = 6373083923489249281
@RevokeStart121[String] = 未撤销
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-26 16:49:18
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode125,@ComponentCode126,@ComponentCode127)) AND ([TbModelOtherInfo].[Type] = @Type128) 	
Parameters:
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type128[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:49:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:49:21
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode129) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart130)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId131,@MxGjId132)) 	
Parameters:
@SiteCode129[String] = 6373083923489249281
@RevokeStart130[String] = 未撤销
@MxGjId131[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId132[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:49:21
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode133,@ComponentCode134)) AND ([TbModelOtherInfo].[Type] = @Type135) 	
Parameters:
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type135[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:52:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:55:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:56:54
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:56:54
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:56:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:56:56
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:57:02
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:57:02
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:57:02
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:57:02
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:57:03
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:57:08
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 16:57:08
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:57:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:57:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF


-----------------------------------------------------------------------------
2020-08-26 16:57:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode29)) AND ([TbModelOtherInfo].[Type] = @Type30) 	
Parameters:
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type30[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:57:12
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:57:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode31) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart32)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId33,@MxGjId34)) 	
Parameters:
@SiteCode31[String] = 6373083923489249281
@RevokeStart32[String] = 未撤销
@MxGjId33[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId34[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:57:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode35,@ComponentCode36)) AND ([TbModelOtherInfo].[Type] = @Type37) 	
Parameters:
@ComponentCode35[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode36[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type37[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:57:56
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:57:56
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type38) AND ([TbOrganizationMap].[ProjectId] = @ProjectId39)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43,@CompanyCode44,@CompanyCode45,@CompanyCode46,@CompanyCode47)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode48))) 	
Parameters:
@Type38[Int32] = 1
@ProjectId39[String] = 6372912251695766465
@CompanyCode40[String] = 6373083923489249281
@CompanyCode41[String] = 6373083925531366080
@CompanyCode42[String] = 6373083927883400612
@CompanyCode43[String] = 6373083918575368225
@CompanyCode44[String] = 6373083920445075162
@CompanyCode45[String] = 6373083908618598731
@CompanyCode46[String] = 6373083911842783146
@CompanyCode47[String] = 6373083913928202424
@ParentCompanyCode48[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type49) AND ([TbOrganizationMap].[ProjectId] = @ProjectId50)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54,@CompanyCode55,@CompanyCode56,@CompanyCode57,@CompanyCode58)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode59))) 	
Parameters:
@Type49[Int32] = 2
@ProjectId50[String] = 6372912251695766465
@CompanyCode51[String] = 6373083923489249281
@CompanyCode52[String] = 6373083925531366080
@CompanyCode53[String] = 6373083927883400612
@CompanyCode54[String] = 6373083918575368225
@CompanyCode55[String] = 6373083920445075162
@CompanyCode56[String] = 6373083908618598731
@CompanyCode57[String] = 6373083911842783146
@CompanyCode58[String] = 6373083913928202424
@ParentCompanyCode59[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:57:57
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:58:02
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:58:02
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:58:02
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:58:02
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:58:03
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:58:08
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode61) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode62) 	
Parameters:
@SiteCode61[String] = 6373083923489249281
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-26 16:58:08
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:58:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:58:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode63) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart64)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode65)) 	
Parameters:
@SiteCode63[String] = 6373083923489249281
@RevokeStart64[String] = 未撤销
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF


-----------------------------------------------------------------------------
2020-08-26 16:58:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode66)) AND ([TbModelOtherInfo].[Type] = @Type67) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type67[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:58:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:58:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode68) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart69)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId70,@MxGjId71)) 	
Parameters:
@SiteCode68[String] = 6373083923489249281
@RevokeStart69[String] = 未撤销
@MxGjId70[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId71[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:58:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode72,@ComponentCode73)) AND ([TbModelOtherInfo].[Type] = @Type74) 	
Parameters:
@ComponentCode72[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode73[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type74[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 16:59:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 16:59:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 16:59:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type75) AND ([TbOrganizationMap].[ProjectId] = @ProjectId76)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode77,@CompanyCode78,@CompanyCode79,@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83,@CompanyCode84)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode85))) 	
Parameters:
@Type75[Int32] = 1
@ProjectId76[String] = 6372912251695766465
@CompanyCode77[String] = 6373083923489249281
@CompanyCode78[String] = 6373083925531366080
@CompanyCode79[String] = 6373083927883400612
@CompanyCode80[String] = 6373083918575368225
@CompanyCode81[String] = 6373083920445075162
@CompanyCode82[String] = 6373083908618598731
@CompanyCode83[String] = 6373083911842783146
@CompanyCode84[String] = 6373083913928202424
@ParentCompanyCode85[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type86) AND ([TbOrganizationMap].[ProjectId] = @ProjectId87)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode88,@CompanyCode89,@CompanyCode90,@CompanyCode91,@CompanyCode92,@CompanyCode93,@CompanyCode94,@CompanyCode95)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode96))) 	
Parameters:
@Type86[Int32] = 2
@ProjectId87[String] = 6372912251695766465
@CompanyCode88[String] = 6373083923489249281
@CompanyCode89[String] = 6373083925531366080
@CompanyCode90[String] = 6373083927883400612
@CompanyCode91[String] = 6373083918575368225
@CompanyCode92[String] = 6373083920445075162
@CompanyCode93[String] = 6373083908618598731
@CompanyCode94[String] = 6373083911842783146
@CompanyCode95[String] = 6373083913928202424
@ParentCompanyCode96[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 16:59:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 16:59:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 16:59:09
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 16:59:09
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:59:09
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:59:10
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 16:59:14
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode98) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode99) 	
Parameters:
@SiteCode98[String] = 6373083923489249281
@ComponentCode99[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-26 16:59:14
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:59:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 16:59:14
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode100) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart101)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode102,@ComponentCode103,@ComponentCode104)) 	
Parameters:
@SiteCode100[String] = 6373083923489249281
@RevokeStart101[String] = 未撤销
@ComponentCode102[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode103[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode104[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-26 16:59:14
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode105,@ComponentCode106,@ComponentCode107)) AND ([TbModelOtherInfo].[Type] = @Type108) 	
Parameters:
@ComponentCode105[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode106[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode107[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type108[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 16:59:17
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 16:59:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode109) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart110)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId111,@MxGjId112)) 	
Parameters:
@SiteCode109[String] = 6373083923489249281
@RevokeStart110[String] = 未撤销
@MxGjId111[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId112[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 16:59:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode113,@ComponentCode114)) AND ([TbModelOtherInfo].[Type] = @Type115) 	
Parameters:
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type115[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:00:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 17:00:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 17:00:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type116) AND ([TbOrganizationMap].[ProjectId] = @ProjectId117)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode118,@CompanyCode119,@CompanyCode120,@CompanyCode121,@CompanyCode122,@CompanyCode123,@CompanyCode124,@CompanyCode125)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode126))) 	
Parameters:
@Type116[Int32] = 1
@ProjectId117[String] = 6372912251695766465
@CompanyCode118[String] = 6373083923489249281
@CompanyCode119[String] = 6373083925531366080
@CompanyCode120[String] = 6373083927883400612
@CompanyCode121[String] = 6373083918575368225
@CompanyCode122[String] = 6373083920445075162
@CompanyCode123[String] = 6373083908618598731
@CompanyCode124[String] = 6373083911842783146
@CompanyCode125[String] = 6373083913928202424
@ParentCompanyCode126[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type127) AND ([TbOrganizationMap].[ProjectId] = @ProjectId128)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode129,@CompanyCode130,@CompanyCode131,@CompanyCode132,@CompanyCode133,@CompanyCode134,@CompanyCode135,@CompanyCode136)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode137))) 	
Parameters:
@Type127[Int32] = 2
@ProjectId128[String] = 6372912251695766465
@CompanyCode129[String] = 6373083923489249281
@CompanyCode130[String] = 6373083925531366080
@CompanyCode131[String] = 6373083927883400612
@CompanyCode132[String] = 6373083918575368225
@CompanyCode133[String] = 6373083920445075162
@CompanyCode134[String] = 6373083908618598731
@CompanyCode135[String] = 6373083911842783146
@CompanyCode136[String] = 6373083913928202424
@ParentCompanyCode137[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 17:00:22
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 17:00:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:00:26
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 17:00:26
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:00:26
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:00:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:00:32
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode139) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode140) 	
Parameters:
@SiteCode139[String] = 6373083923489249281
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-26 17:00:32
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 17:00:32
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 17:00:32
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode141) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart142)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode143,@ComponentCode144,@ComponentCode145)) 	
Parameters:
@SiteCode141[String] = 6373083923489249281
@RevokeStart142[String] = 未撤销
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-26 17:00:32
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode146,@ComponentCode147,@ComponentCode148)) AND ([TbModelOtherInfo].[Type] = @Type149) 	
Parameters:
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type149[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:00:35
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:00:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode150) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart151)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId152,@MxGjId153)) 	
Parameters:
@SiteCode150[String] = 6373083923489249281
@RevokeStart151[String] = 未撤销
@MxGjId152[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId153[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:00:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode154,@ComponentCode155)) AND ([TbModelOtherInfo].[Type] = @Type156) 	
Parameters:
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode155[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type156[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:01:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 17:01:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 17:01:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type157) AND ([TbOrganizationMap].[ProjectId] = @ProjectId158)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode159,@CompanyCode160,@CompanyCode161,@CompanyCode162,@CompanyCode163,@CompanyCode164,@CompanyCode165,@CompanyCode166)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode167))) 	
Parameters:
@Type157[Int32] = 1
@ProjectId158[String] = 6372912251695766465
@CompanyCode159[String] = 6373083923489249281
@CompanyCode160[String] = 6373083925531366080
@CompanyCode161[String] = 6373083927883400612
@CompanyCode162[String] = 6373083918575368225
@CompanyCode163[String] = 6373083920445075162
@CompanyCode164[String] = 6373083908618598731
@CompanyCode165[String] = 6373083911842783146
@CompanyCode166[String] = 6373083913928202424
@ParentCompanyCode167[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type168) AND ([TbOrganizationMap].[ProjectId] = @ProjectId169)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode170,@CompanyCode171,@CompanyCode172,@CompanyCode173,@CompanyCode174,@CompanyCode175,@CompanyCode176,@CompanyCode177)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode178))) 	
Parameters:
@Type168[Int32] = 2
@ProjectId169[String] = 6372912251695766465
@CompanyCode170[String] = 6373083923489249281
@CompanyCode171[String] = 6373083925531366080
@CompanyCode172[String] = 6373083927883400612
@CompanyCode173[String] = 6373083918575368225
@CompanyCode174[String] = 6373083920445075162
@CompanyCode175[String] = 6373083908618598731
@CompanyCode176[String] = 6373083911842783146
@CompanyCode177[String] = 6373083913928202424
@ParentCompanyCode178[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 17:01:15
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 17:01:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:01:21
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 17:01:21
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:01:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:01:23
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:01:28
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode180) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode181) 	
Parameters:
@SiteCode180[String] = 6373083923489249281
@ComponentCode181[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-26 17:01:28
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 17:01:28
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-26 17:01:28
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode182) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart183)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode184,@ComponentCode185,@ComponentCode186)) 	
Parameters:
@SiteCode182[String] = 6373083923489249281
@RevokeStart183[String] = 未撤销
@ComponentCode184[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode185[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode186[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-26 17:01:28
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode187,@ComponentCode188,@ComponentCode189)) AND ([TbModelOtherInfo].[Type] = @Type190) 	
Parameters:
@ComponentCode187[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode188[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode189[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type190[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:01:31
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:01:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode191) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart192)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId193,@MxGjId194)) 	
Parameters:
@SiteCode191[String] = 6373083923489249281
@RevokeStart192[String] = 未撤销
@MxGjId193[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId194[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:01:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode195,@ComponentCode196)) AND ([TbModelOtherInfo].[Type] = @Type197) 	
Parameters:
@ComponentCode195[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode196[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type197[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:01
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode198) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart199)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId200,@MxGjId201)) 	
Parameters:
@SiteCode198[String] = 6373083923489249281
@RevokeStart199[String] = 未撤销
@MxGjId200[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId201[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-26 17:02:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode202,@ComponentCode203)) AND ([TbModelOtherInfo].[Type] = @Type204) 	
Parameters:
@ComponentCode202[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode203[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type204[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode205) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart206)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId207,@MxGjId208)) 	
Parameters:
@SiteCode205[String] = 6373083923489249281
@RevokeStart206[String] = 未撤销
@MxGjId207[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId208[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-26 17:02:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode209,@ComponentCode210)) AND ([TbModelOtherInfo].[Type] = @Type211) 	
Parameters:
@ComponentCode209[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode210[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type211[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:04
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode212) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart213)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId214,@MxGjId215)) 	
Parameters:
@SiteCode212[String] = 6373083923489249281
@RevokeStart213[String] = 未撤销
@MxGjId214[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId215[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:02:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode216,@ComponentCode217)) AND ([TbModelOtherInfo].[Type] = @Type218) 	
Parameters:
@ComponentCode216[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode217[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type218[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:06
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:06
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode219) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart220)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId221,@MxGjId222)) 	
Parameters:
@SiteCode219[String] = 6373083923489249281
@RevokeStart220[String] = 未撤销
@MxGjId221[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId222[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:02:06
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode223,@ComponentCode224)) AND ([TbModelOtherInfo].[Type] = @Type225) 	
Parameters:
@ComponentCode223[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode224[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type225[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode226) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart227)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId228,@MxGjId229)) 	
Parameters:
@SiteCode226[String] = 6373083923489249281
@RevokeStart227[String] = 未撤销
@MxGjId228[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId229[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:02:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode230,@ComponentCode231)) AND ([TbModelOtherInfo].[Type] = @Type232) 	
Parameters:
@ComponentCode230[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode231[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type232[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:12
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode233) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart234)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId235,@MxGjId236)) 	
Parameters:
@SiteCode233[String] = 6373083923489249281
@RevokeStart234[String] = 未撤销
@MxGjId235[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId236[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-26 17:02:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode237,@ComponentCode238)) AND ([TbModelOtherInfo].[Type] = @Type239) 	
Parameters:
@ComponentCode237[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode238[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type239[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:13
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode240) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart241)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId242,@MxGjId243)) 	
Parameters:
@SiteCode240[String] = 6373083923489249281
@RevokeStart241[String] = 未撤销
@MxGjId242[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId243[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-26 17:02:13
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode244,@ComponentCode245)) AND ([TbModelOtherInfo].[Type] = @Type246) 	
Parameters:
@ComponentCode244[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode245[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type246[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:15
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:15
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode247) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart248)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId249,@MxGjId250)) 	
Parameters:
@SiteCode247[String] = 6373083923489249281
@RevokeStart248[String] = 未撤销
@MxGjId249[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId250[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:02:15
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode251,@ComponentCode252)) AND ([TbModelOtherInfo].[Type] = @Type253) 	
Parameters:
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode252[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type253[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:02:20
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-26 17:02:20
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode254) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart255)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId256,@MxGjId257)) 	
Parameters:
@SiteCode254[String] = 6373083923489249281
@RevokeStart255[String] = 未撤销
@MxGjId256[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId257[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-26 17:02:20
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode258,@ComponentCode259)) AND ([TbModelOtherInfo].[Type] = @Type260) 	
Parameters:
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode259[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type260[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:04:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:07:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:10:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:13:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:16:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:19:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:22:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:25:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-26 17:30:19
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/26 17:30:19
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 17:30:24
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 17:30:24
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 17:30:24
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:25
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 17:30:26
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 17:30:27
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 17:30:47
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName,count(*) as Total
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:30:48
Text:	 SELECT   * FROM [TbModelReporte]  WHERE [TbModelReporte].[SiteCode] = @SiteCode32 	
Parameters:
@SiteCode32[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:30:58
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu33,@ActionType34,@HostName35,@LogDate36,@UserCode37,@UserIP38);select scope_identity()	
Parameters:
@ActionMenu33[String] = TbModelReporte
@ActionType34[String] = 新增
@HostName35[String] = 
@LogDate36[DateTime] = 2020/8/26 17:30:58
@UserCode37[String] = 500000
@UserIP38[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 17:30:58
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode39,@ProjectId40,@FileName41,@PlanTotal42,@ComponentName43,@ComponentCode44,@ComponentCodeP45,@Type46);select scope_identity()	
Parameters:
@SiteCode39[String] = 6373083925531366080
@ProjectId40[String] = 6372912251695766465
@FileName41[String] = tmp9F18
@PlanTotal42[Int32] = 31
@ComponentName43[String] = 给排水及消防
@ComponentCode44[String] = L21_Z17_00GS
@ComponentCodeP45[String] = 
@Type46[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:30:58
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode47,@ProjectId48,@FileName49,@PlanTotal50,@ComponentName51,@ComponentCode52,@ComponentCodeP53,@Type54);select scope_identity()	
Parameters:
@SiteCode47[String] = 6373083925531366080
@ProjectId48[String] = 6372912251695766465
@FileName49[String] = tmp8184
@PlanTotal50[Int32] = 16
@ComponentName51[String] = 通风与空调
@ComponentCode52[String] = L21_Z17_00KT
@ComponentCodeP53[String] = 
@Type54[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode55,@ProjectId56,@FileName57,@PlanTotal58,@ComponentName59,@ComponentCode60,@ComponentCodeP61,@Type62);select scope_identity()	
Parameters:
@SiteCode55[String] = 6373083925531366080
@ProjectId56[String] = 6372912251695766465
@FileName57[String] = tmp9F18
@PlanTotal58[Int32] = 8
@ComponentName59[String] = 给水
@ComponentCode60[String] = L21_Z17_00GS_GS
@ComponentCodeP61[String] = L21_Z17_00GS
@Type62[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode63,@ProjectId64,@FileName65,@PlanTotal66,@ComponentName67,@ComponentCode68,@ComponentCodeP69,@Type70);select scope_identity()	
Parameters:
@SiteCode63[String] = 6373083925531366080
@ProjectId64[String] = 6372912251695766465
@FileName65[String] = tmp9F18
@PlanTotal66[Int32] = 9
@ComponentName67[String] = 排水
@ComponentCode68[String] = L21_Z17_00GS_PS
@ComponentCodeP69[String] = L21_Z17_00GS
@Type70[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode71,@ProjectId72,@FileName73,@PlanTotal74,@ComponentName75,@ComponentCode76,@ComponentCodeP77,@Type78);select scope_identity()	
Parameters:
@SiteCode71[String] = 6373083925531366080
@ProjectId72[String] = 6372912251695766465
@FileName73[String] = tmp9F18
@PlanTotal74[Int32] = 14
@ComponentName75[String] = 消防
@ComponentCode76[String] = L21_Z17_00GS_XF
@ComponentCodeP77[String] = L21_Z17_00GS
@Type78[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode79,@ProjectId80,@FileName81,@PlanTotal82,@ComponentName83,@ComponentCode84,@ComponentCodeP85,@Type86);select scope_identity()	
Parameters:
@SiteCode79[String] = 6373083925531366080
@ProjectId80[String] = 6372912251695766465
@FileName81[String] = tmp8184
@PlanTotal82[Int32] = 14
@ComponentName83[String] = 大系统
@ComponentCode84[String] = L21_Z17_00KT_DXT
@ComponentCodeP85[String] = L21_Z17_00KT
@Type86[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode87,@ProjectId88,@FileName89,@PlanTotal90,@ComponentName91,@ComponentCode92,@ComponentCodeP93,@Type94);select scope_identity()	
Parameters:
@SiteCode87[String] = 6373083925531366080
@ProjectId88[String] = 6372912251695766465
@FileName89[String] = tmp7FCD
@PlanTotal90[Int32] = 2
@ComponentName91[String] = 隧道通风系统
@ComponentCode92[String] = L21_Z17_00KT_SDF
@ComponentCodeP93[String] = L21_Z17_00KT
@Type94[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode95,@ProjectId96,@FileName97,@PlanTotal98,@ComponentName99,@ComponentCode100,@ComponentCodeP101,@Type102);select scope_identity()	
Parameters:
@SiteCode95[String] = 6373083925531366080
@ProjectId96[String] = 6372912251695766465
@FileName97[String] = tmp9F18
@PlanTotal98[Int32] = 8
@ComponentName99[String] = 给水
@ComponentCode100[String] = L21_Z17_00GS_GS_GS
@ComponentCodeP101[String] = L21_Z17_00GS_GS
@Type102[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode103,@ProjectId104,@FileName105,@PlanTotal106,@ComponentName107,@ComponentCode108,@ComponentCodeP109,@Type110);select scope_identity()	
Parameters:
@SiteCode103[String] = 6373083925531366080
@ProjectId104[String] = 6372912251695766465
@FileName105[String] = tmp9F18
@PlanTotal106[Int32] = 9
@ComponentName107[String] = 排水
@ComponentCode108[String] = L21_Z17_00GS_PS_PS
@ComponentCodeP109[String] = L21_Z17_00GS_PS
@Type110[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode111,@ProjectId112,@FileName113,@PlanTotal114,@ComponentName115,@ComponentCode116,@ComponentCodeP117,@Type118);select scope_identity()	
Parameters:
@SiteCode111[String] = 6373083925531366080
@ProjectId112[String] = 6372912251695766465
@FileName113[String] = tmp9F18
@PlanTotal114[Int32] = 14
@ComponentName115[String] = 消防
@ComponentCode116[String] = L21_Z17_00GS_XF_XF
@ComponentCodeP117[String] = L21_Z17_00GS_XF
@Type118[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode119,@ProjectId120,@FileName121,@PlanTotal122,@ComponentName123,@ComponentCode124,@ComponentCodeP125,@Type126);select scope_identity()	
Parameters:
@SiteCode119[String] = 6373083925531366080
@ProjectId120[String] = 6372912251695766465
@FileName121[String] = tmp8184
@PlanTotal122[Int32] = 14
@ComponentName123[String] = 大系统
@ComponentCode124[String] = L21_Z17_00KT_DXT_DXT
@ComponentCodeP125[String] = L21_Z17_00KT_DXT
@Type126[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode127,@ProjectId128,@FileName129,@PlanTotal130,@ComponentName131,@ComponentCode132,@ComponentCodeP133,@Type134);select scope_identity()	
Parameters:
@SiteCode127[String] = 6373083925531366080
@ProjectId128[String] = 6372912251695766465
@FileName129[String] = tmp7FCD
@PlanTotal130[Int32] = 2
@ComponentName131[String] = 隧道通风系统
@ComponentCode132[String] = L21_Z17_00KT_SDF_SDF
@ComponentCodeP133[String] = L21_Z17_00KT_SDF
@Type134[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode135,@ProjectId136,@FileName137,@PlanTotal138,@ComponentName139,@ComponentCode140,@ComponentCodeP141,@Type142);select scope_identity()	
Parameters:
@SiteCode135[String] = 6373083925531366080
@ProjectId136[String] = 6372912251695766465
@FileName137[String] = tmp9F18
@PlanTotal138[Int32] = 1
@ComponentName139[String] = 波纹伸缩器
@ComponentCode140[String] = L21_Z17_00GS_GS_GS_SSQ
@ComponentCodeP141[String] = L21_Z17_00GS_GS_GS
@Type142[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode143,@ProjectId144,@FileName145,@PlanTotal146,@ComponentName147,@ComponentCode148,@ComponentCodeP149,@Type150);select scope_identity()	
Parameters:
@SiteCode143[String] = 6373083925531366080
@ProjectId144[String] = 6372912251695766465
@FileName145[String] = tmp9F18
@PlanTotal146[Int32] = 2
@ComponentName147[String] = 管件
@ComponentCode148[String] = L21_Z17_00GS_GS_GS_GJ
@ComponentCodeP149[String] = L21_Z17_00GS_GS_GS
@Type150[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode151,@ProjectId152,@FileName153,@PlanTotal154,@ComponentName155,@ComponentCode156,@ComponentCodeP157,@Type158);select scope_identity()	
Parameters:
@SiteCode151[String] = 6373083925531366080
@ProjectId152[String] = 6372912251695766465
@FileName153[String] = tmp9F18
@PlanTotal154[Int32] = 1
@ComponentName155[String] = 截止阀
@ComponentCode156[String] = L21_Z17_00GS_GS_GS_JZF
@ComponentCodeP157[String] = L21_Z17_00GS_GS_GS
@Type158[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode159,@ProjectId160,@FileName161,@PlanTotal162,@ComponentName163,@ComponentCode164,@ComponentCodeP165,@Type166);select scope_identity()	
Parameters:
@SiteCode159[String] = 6373083925531366080
@ProjectId160[String] = 6372912251695766465
@FileName161[String] = tmp9F18
@PlanTotal162[Int32] = 1
@ComponentName163[String] = 水表
@ComponentCode164[String] = L21_Z17_00GS_GS_GS_SB
@ComponentCodeP165[String] = L21_Z17_00GS_GS_GS
@Type166[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode167,@ProjectId168,@FileName169,@PlanTotal170,@ComponentName171,@ComponentCode172,@ComponentCodeP173,@Type174);select scope_identity()	
Parameters:
@SiteCode167[String] = 6373083925531366080
@ProjectId168[String] = 6372912251695766465
@FileName169[String] = tmp9F18
@PlanTotal170[Int32] = 1
@ComponentName171[String] = 水管
@ComponentCode172[String] = L21_Z17_00GS_GS_GS_SG
@ComponentCodeP173[String] = L21_Z17_00GS_GS_GS
@Type174[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode175,@ProjectId176,@FileName177,@PlanTotal178,@ComponentName179,@ComponentCode180,@ComponentCodeP181,@Type182);select scope_identity()	
Parameters:
@SiteCode175[String] = 6373083925531366080
@ProjectId176[String] = 6372912251695766465
@FileName177[String] = tmp9F18
@PlanTotal178[Int32] = 1
@ComponentName179[String] = 水龙头
@ComponentCode180[String] = L21_Z17_00GS_GS_GS_SLT
@ComponentCodeP181[String] = L21_Z17_00GS_GS_GS
@Type182[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode183,@ProjectId184,@FileName185,@PlanTotal186,@ComponentName187,@ComponentCode188,@ComponentCodeP189,@Type190);select scope_identity()	
Parameters:
@SiteCode183[String] = 6373083925531366080
@ProjectId184[String] = 6372912251695766465
@FileName185[String] = tmp9F18
@PlanTotal186[Int32] = 1
@ComponentName187[String] = 闸阀
@ComponentCode188[String] = L21_Z17_00GS_GS_GS_ZF
@ComponentCodeP189[String] = L21_Z17_00GS_GS_GS
@Type190[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode191,@ProjectId192,@FileName193,@PlanTotal194,@ComponentName195,@ComponentCode196,@ComponentCodeP197,@Type198);select scope_identity()	
Parameters:
@SiteCode191[String] = 6373083925531366080
@ProjectId192[String] = 6372912251695766465
@FileName193[String] = tmp9F18
@PlanTotal194[Int32] = 1
@ComponentName195[String] = 地漏
@ComponentCode196[String] = L21_Z17_00GS_PS_PS_DL
@ComponentCodeP197[String] = L21_Z17_00GS_PS_PS
@Type198[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode199,@ProjectId200,@FileName201,@PlanTotal202,@ComponentName203,@ComponentCode204,@ComponentCodeP205,@Type206);select scope_identity()	
Parameters:
@SiteCode199[String] = 6373083925531366080
@ProjectId200[String] = 6372912251695766465
@FileName201[String] = tmp9F18
@PlanTotal202[Int32] = 2
@ComponentName203[String] = 管件
@ComponentCode204[String] = L21_Z17_00GS_PS_PS_GJ
@ComponentCodeP205[String] = L21_Z17_00GS_PS_PS
@Type206[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode207,@ProjectId208,@FileName209,@PlanTotal210,@ComponentName211,@ComponentCode212,@ComponentCodeP213,@Type214);select scope_identity()	
Parameters:
@SiteCode207[String] = 6373083925531366080
@ProjectId208[String] = 6372912251695766465
@FileName209[String] = tmp9F18
@PlanTotal210[Int32] = 1
@ComponentName211[String] = 潜污泵
@ComponentCode212[String] = L21_Z17_00GS_PS_PS_QWB
@ComponentCodeP213[String] = L21_Z17_00GS_PS_PS
@Type214[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode215,@ProjectId216,@FileName217,@PlanTotal218,@ComponentName219,@ComponentCode220,@ComponentCodeP221,@Type222);select scope_identity()	
Parameters:
@SiteCode215[String] = 6373083925531366080
@ProjectId216[String] = 6372912251695766465
@FileName217[String] = tmp9F18
@PlanTotal218[Int32] = 1
@ComponentName219[String] = 水管
@ComponentCode220[String] = L21_Z17_00GS_PS_PS_SG
@ComponentCodeP221[String] = L21_Z17_00GS_PS_PS
@Type222[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode223,@ProjectId224,@FileName225,@PlanTotal226,@ComponentName227,@ComponentCode228,@ComponentCodeP229,@Type230);select scope_identity()	
Parameters:
@SiteCode223[String] = 6373083925531366080
@ProjectId224[String] = 6372912251695766465
@FileName225[String] = tmp9F18
@PlanTotal226[Int32] = 1
@ComponentName227[String] = 污水提升装置
@ComponentCode228[String] = L21_Z17_00GS_PS_PS_TSQ
@ComponentCodeP229[String] = L21_Z17_00GS_PS_PS
@Type230[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode231,@ProjectId232,@FileName233,@PlanTotal234,@ComponentName235,@ComponentCode236,@ComponentCodeP237,@Type238);select scope_identity()	
Parameters:
@SiteCode231[String] = 6373083925531366080
@ProjectId232[String] = 6372912251695766465
@FileName233[String] = tmp9F18
@PlanTotal234[Int32] = 1
@ComponentName235[String] = 压力表
@ComponentCode236[String] = L21_Z17_00GS_PS_PS_YLB
@ComponentCodeP237[String] = L21_Z17_00GS_PS_PS
@Type238[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode239,@ProjectId240,@FileName241,@PlanTotal242,@ComponentName243,@ComponentCode244,@ComponentCodeP245,@Type246);select scope_identity()	
Parameters:
@SiteCode239[String] = 6373083925531366080
@ProjectId240[String] = 6372912251695766465
@FileName241[String] = tmp9F18
@PlanTotal242[Int32] = 1
@ComponentName243[String] = 闸阀
@ComponentCode244[String] = L21_Z17_00GS_PS_PS_ZF
@ComponentCodeP245[String] = L21_Z17_00GS_PS_PS
@Type246[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode247,@ProjectId248,@FileName249,@PlanTotal250,@ComponentName251,@ComponentCode252,@ComponentCodeP253,@Type254);select scope_identity()	
Parameters:
@SiteCode247[String] = 6373083925531366080
@ProjectId248[String] = 6372912251695766465
@FileName249[String] = tmp9F18
@PlanTotal250[Int32] = 1
@ComponentName251[String] = 止回阀
@ComponentCode252[String] = L21_Z17_00GS_PS_PS_ZHF
@ComponentCodeP253[String] = L21_Z17_00GS_PS_PS
@Type254[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode255,@ProjectId256,@FileName257,@PlanTotal258,@ComponentName259,@ComponentCode260,@ComponentCodeP261,@Type262);select scope_identity()	
Parameters:
@SiteCode255[String] = 6373083925531366080
@ProjectId256[String] = 6372912251695766465
@FileName257[String] = tmp9F18
@PlanTotal258[Int32] = 1
@ComponentName259[String] = Y型过滤器
@ComponentCode260[String] = L21_Z17_00GS_XF_XF_YGL
@ComponentCodeP261[String] = L21_Z17_00GS_XF_XF
@Type262[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode263,@ProjectId264,@FileName265,@PlanTotal266,@ComponentName267,@ComponentCode268,@ComponentCodeP269,@Type270);select scope_identity()	
Parameters:
@SiteCode263[String] = 6373083925531366080
@ProjectId264[String] = 6372912251695766465
@FileName265[String] = tmp9F18
@PlanTotal266[Int32] = 1
@ComponentName267[String] = 蝶阀
@ComponentCode268[String] = L21_Z17_00GS_XF_XF_DF
@ComponentCodeP269[String] = L21_Z17_00GS_XF_XF
@Type270[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode271,@ProjectId272,@FileName273,@PlanTotal274,@ComponentName275,@ComponentCode276,@ComponentCodeP277,@Type278);select scope_identity()	
Parameters:
@SiteCode271[String] = 6373083925531366080
@ProjectId272[String] = 6372912251695766465
@FileName273[String] = tmp9F18
@PlanTotal274[Int32] = 2
@ComponentName275[String] = 管件
@ComponentCode276[String] = L21_Z17_00GS_XF_XF_GJ
@ComponentCodeP277[String] = L21_Z17_00GS_XF_XF
@Type278[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode279,@ProjectId280,@FileName281,@PlanTotal282,@ComponentName283,@ComponentCode284,@ComponentCodeP285,@Type286);select scope_identity()	
Parameters:
@SiteCode279[String] = 6373083925531366080
@ProjectId280[String] = 6372912251695766465
@FileName281[String] = tmp9F18
@PlanTotal282[Int32] = 1
@ComponentName283[String] = 金属伸缩节
@ComponentCode284[String] = L21_Z17_00GS_XF_XF_SSJ
@ComponentCodeP285[String] = L21_Z17_00GS_XF_XF
@Type286[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode287,@ProjectId288,@FileName289,@PlanTotal290,@ComponentName291,@ComponentCode292,@ComponentCodeP293,@Type294);select scope_identity()	
Parameters:
@SiteCode287[String] = 6373083925531366080
@ProjectId288[String] = 6372912251695766465
@FileName289[String] = tmp9F18
@PlanTotal290[Int32] = 1
@ComponentName291[String] = 可曲挠橡胶接头
@ComponentCode292[String] = L21_Z17_00GS_XF_XF_JJT
@ComponentCodeP293[String] = L21_Z17_00GS_XF_XF
@Type294[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode295,@ProjectId296,@FileName297,@PlanTotal298,@ComponentName299,@ComponentCode300,@ComponentCodeP301,@Type302);select scope_identity()	
Parameters:
@SiteCode295[String] = 6373083925531366080
@ProjectId296[String] = 6372912251695766465
@FileName297[String] = tmp9F18
@PlanTotal298[Int32] = 1
@ComponentName299[String] = 气压罐
@ComponentCode300[String] = L21_Z17_00GS_XF_XF_QYG
@ComponentCodeP301[String] = L21_Z17_00GS_XF_XF
@Type302[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode303,@ProjectId304,@FileName305,@PlanTotal306,@ComponentName307,@ComponentCode308,@ComponentCodeP309,@Type310);select scope_identity()	
Parameters:
@SiteCode303[String] = 6373083925531366080
@ProjectId304[String] = 6372912251695766465
@FileName305[String] = tmp9F18
@PlanTotal306[Int32] = 1
@ComponentName307[String] = 水管
@ComponentCode308[String] = L21_Z17_00GS_XF_XF_SG
@ComponentCodeP309[String] = L21_Z17_00GS_XF_XF
@Type310[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode311,@ProjectId312,@FileName313,@PlanTotal314,@ComponentName315,@ComponentCode316,@ComponentCodeP317,@Type318);select scope_identity()	
Parameters:
@SiteCode311[String] = 6373083925531366080
@ProjectId312[String] = 6372912251695766465
@FileName313[String] = tmp9F18
@PlanTotal314[Int32] = 1
@ComponentName315[String] = 消防器材箱
@ComponentCode316[String] = L21_Z17_00GS_XF_XF_QCX
@ComponentCodeP317[String] = L21_Z17_00GS_XF_XF
@Type318[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode319,@ProjectId320,@FileName321,@PlanTotal322,@ComponentName323,@ComponentCode324,@ComponentCodeP325,@Type326);select scope_identity()	
Parameters:
@SiteCode319[String] = 6373083925531366080
@ProjectId320[String] = 6372912251695766465
@FileName321[String] = tmp9F18
@PlanTotal322[Int32] = 1
@ComponentName323[String] = 消防水泵
@ComponentCode324[String] = L21_Z17_00GS_XF_XF_XFB
@ComponentCodeP325[String] = L21_Z17_00GS_XF_XF
@Type326[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode327,@ProjectId328,@FileName329,@PlanTotal330,@ComponentName331,@ComponentCode332,@ComponentCodeP333,@Type334);select scope_identity()	
Parameters:
@SiteCode327[String] = 6373083925531366080
@ProjectId328[String] = 6372912251695766465
@FileName329[String] = tmp9F18
@PlanTotal330[Int32] = 1
@ComponentName331[String] = 消火栓（箱）
@ComponentCode332[String] = L21_Z17_00GS_XF_XF_XH
@ComponentCodeP333[String] = L21_Z17_00GS_XF_XF
@Type334[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode335,@ProjectId336,@FileName337,@PlanTotal338,@ComponentName339,@ComponentCode340,@ComponentCodeP341,@Type342);select scope_identity()	
Parameters:
@SiteCode335[String] = 6373083925531366080
@ProjectId336[String] = 6372912251695766465
@FileName337[String] = tmp9F18
@PlanTotal338[Int32] = 1
@ComponentName339[String] = 泄压阀
@ComponentCode340[String] = L21_Z17_00GS_XF_XF_XYF
@ComponentCodeP341[String] = L21_Z17_00GS_XF_XF
@Type342[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode343,@ProjectId344,@FileName345,@PlanTotal346,@ComponentName347,@ComponentCode348,@ComponentCodeP349,@Type350);select scope_identity()	
Parameters:
@SiteCode343[String] = 6373083925531366080
@ProjectId344[String] = 6372912251695766465
@FileName345[String] = tmp9F18
@PlanTotal346[Int32] = 1
@ComponentName347[String] = 闸阀
@ComponentCode348[String] = L21_Z17_00GS_XF_XF_ZF
@ComponentCodeP349[String] = L21_Z17_00GS_XF_XF
@Type350[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode351,@ProjectId352,@FileName353,@PlanTotal354,@ComponentName355,@ComponentCode356,@ComponentCodeP357,@Type358);select scope_identity()	
Parameters:
@SiteCode351[String] = 6373083925531366080
@ProjectId352[String] = 6372912251695766465
@FileName353[String] = tmp9F18
@PlanTotal354[Int32] = 1
@ComponentName355[String] = 止回阀
@ComponentCode356[String] = L21_Z17_00GS_XF_XF_ZHF
@ComponentCodeP357[String] = L21_Z17_00GS_XF_XF
@Type358[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode359,@ProjectId360,@FileName361,@PlanTotal362,@ComponentName363,@ComponentCode364,@ComponentCodeP365,@Type366);select scope_identity()	
Parameters:
@SiteCode359[String] = 6373083925531366080
@ProjectId360[String] = 6372912251695766465
@FileName361[String] = tmp8184
@PlanTotal362[Int32] = 2
@ComponentName363[String] = 车站风机
@ComponentCode364[String] = L21_Z17_00KT_DXT_DXT_FJ
@ComponentCodeP365[String] = L21_Z17_00KT_DXT_DXT
@Type366[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode367,@ProjectId368,@FileName369,@PlanTotal370,@ComponentName371,@ComponentCode372,@ComponentCodeP373,@Type374);select scope_identity()	
Parameters:
@SiteCode367[String] = 6373083925531366080
@ProjectId368[String] = 6372912251695766465
@FileName369[String] = tmp8184
@PlanTotal370[Int32] = 1
@ComponentName371[String] = 电动风阀
@ComponentCode372[String] = L21_Z17_00KT_DXT_DXT_MD
@ComponentCodeP373[String] = L21_Z17_00KT_DXT_DXT
@Type374[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode375,@ProjectId376,@FileName377,@PlanTotal378,@ComponentName379,@ComponentCode380,@ComponentCodeP381,@Type382);select scope_identity()	
Parameters:
@SiteCode375[String] = 6373083925531366080
@ProjectId376[String] = 6372912251695766465
@FileName377[String] = tmp8184
@PlanTotal378[Int32] = 1
@ComponentName379[String] = 防火阀
@ComponentCode380[String] = L21_Z17_00KT_DXT_DXT_FD
@ComponentCodeP381[String] = L21_Z17_00KT_DXT_DXT
@Type382[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode383,@ProjectId384,@FileName385,@PlanTotal386,@ComponentName387,@ComponentCode388,@ComponentCodeP389,@Type390);select scope_identity()	
Parameters:
@SiteCode383[String] = 6373083925531366080
@ProjectId384[String] = 6372912251695766465
@FileName385[String] = tmp8184
@PlanTotal386[Int32] = 1
@ComponentName387[String] = 风机软接头
@ComponentCode388[String] = L21_Z17_00KT_DXT_DXT_RJT
@ComponentCodeP389[String] = L21_Z17_00KT_DXT_DXT
@Type390[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode391,@ProjectId392,@FileName393,@PlanTotal394,@ComponentName395,@ComponentCode396,@ComponentCodeP397,@Type398);select scope_identity()	
Parameters:
@SiteCode391[String] = 6373083925531366080
@ProjectId392[String] = 6372912251695766465
@FileName393[String] = tmp8184
@PlanTotal394[Int32] = 1
@ComponentName395[String] = 风口
@ComponentCode396[String] = L21_Z17_00KT_DXT_DXT_FK
@ComponentCodeP397[String] = L21_Z17_00KT_DXT_DXT
@Type398[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode399,@ProjectId400,@FileName401,@PlanTotal402,@ComponentName403,@ComponentCode404,@ComponentCodeP405,@Type406);select scope_identity()	
Parameters:
@SiteCode399[String] = 6373083925531366080
@ProjectId400[String] = 6372912251695766465
@FileName401[String] = tmp8184
@PlanTotal402[Int32] = 3
@ComponentName403[String] = 管件
@ComponentCode404[String] = L21_Z17_00KT_DXT_DXT_GJ
@ComponentCodeP405[String] = L21_Z17_00KT_DXT_DXT
@Type406[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode407,@ProjectId408,@FileName409,@PlanTotal410,@ComponentName411,@ComponentCode412,@ComponentCodeP413,@Type414);select scope_identity()	
Parameters:
@SiteCode407[String] = 6373083925531366080
@ProjectId408[String] = 6372912251695766465
@FileName409[String] = tmp8184
@PlanTotal410[Int32] = 1
@ComponentName411[String] = 静压箱
@ComponentCode412[String] = L21_Z17_00KT_DXT_DXT_JY
@ComponentCodeP413[String] = L21_Z17_00KT_DXT_DXT
@Type414[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode415,@ProjectId416,@FileName417,@PlanTotal418,@ComponentName419,@ComponentCode420,@ComponentCodeP421,@Type422);select scope_identity()	
Parameters:
@SiteCode415[String] = 6373083925531366080
@ProjectId416[String] = 6372912251695766465
@FileName417[String] = tmp8184
@PlanTotal418[Int32] = 1
@ComponentName419[String] = 手动调节阀
@ComponentCode420[String] = L21_Z17_00KT_DXT_DXT_D
@ComponentCodeP421[String] = L21_Z17_00KT_DXT_DXT
@Type422[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode423,@ProjectId424,@FileName425,@PlanTotal426,@ComponentName427,@ComponentCode428,@ComponentCodeP429,@Type430);select scope_identity()	
Parameters:
@SiteCode423[String] = 6373083925531366080
@ProjectId424[String] = 6372912251695766465
@FileName425[String] = tmp8184
@PlanTotal426[Int32] = 1
@ComponentName427[String] = 通风管道
@ComponentCode428[String] = L21_Z17_00KT_DXT_DXT_FG
@ComponentCodeP429[String] = L21_Z17_00KT_DXT_DXT
@Type430[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode431,@ProjectId432,@FileName433,@PlanTotal434,@ComponentName435,@ComponentCode436,@ComponentCodeP437,@Type438);select scope_identity()	
Parameters:
@SiteCode431[String] = 6373083925531366080
@ProjectId432[String] = 6372912251695766465
@FileName433[String] = tmp8184
@PlanTotal434[Int32] = 1
@ComponentName435[String] = 消声器
@ComponentCode436[String] = L21_Z17_00KT_DXT_DXT_SIL
@ComponentCodeP437[String] = L21_Z17_00KT_DXT_DXT
@Type438[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode439,@ProjectId440,@FileName441,@PlanTotal442,@ComponentName443,@ComponentCode444,@ComponentCodeP445,@Type446);select scope_identity()	
Parameters:
@SiteCode439[String] = 6373083925531366080
@ProjectId440[String] = 6372912251695766465
@FileName441[String] = tmp8184
@PlanTotal442[Int32] = 1
@ComponentName443[String] = 组合式空调机组
@ComponentCode444[String] = L21_Z17_00KT_DXT_DXT_AHU
@ComponentCodeP445[String] = L21_Z17_00KT_DXT_DXT
@Type446[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode447,@ProjectId448,@FileName449,@PlanTotal450,@ComponentName451,@ComponentCode452,@ComponentCodeP453,@Type454);select scope_identity()	
Parameters:
@SiteCode447[String] = 6373083925531366080
@ProjectId448[String] = 6372912251695766465
@FileName449[String] = tmp7FCD
@PlanTotal450[Int32] = 1
@ComponentName451[String] = 电动风阀
@ComponentCode452[String] = L21_Z17_00KT_SDF_SDF_MD
@ComponentCodeP453[String] = L21_Z17_00KT_SDF_SDF
@Type454[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode455,@ProjectId456,@FileName457,@PlanTotal458,@ComponentName459,@ComponentCode460,@ComponentCodeP461,@Type462);select scope_identity()	
Parameters:
@SiteCode455[String] = 6373083925531366080
@ProjectId456[String] = 6372912251695766465
@FileName457[String] = tmp7FCD
@PlanTotal458[Int32] = 1
@ComponentName459[String] = 消声器
@ComponentCode460[String] = L21_Z17_00KT_SDF_SDF_SIL
@ComponentCodeP461[String] = L21_Z17_00KT_SDF_SDF
@Type462[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode463,@ProjectId464,@FileName465,@PlanTotal466,@ComponentName467,@ComponentCode468,@ComponentCodeP469,@Type470);select scope_identity()	
Parameters:
@SiteCode463[String] = 6373083925531366080
@ProjectId464[String] = 6372912251695766465
@FileName465[String] = tmp9F18
@PlanTotal466[Int32] = 18
@ComponentName467[String] = 波纹伸缩器
@ComponentCode468[String] = L21_Z17_00GS_GS_GS_SSQ_SSQ
@ComponentCodeP469[String] = L21_Z17_00GS_GS_GS_SSQ
@Type470[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode471,@ProjectId472,@FileName473,@PlanTotal474,@ComponentName475,@ComponentCode476,@ComponentCodeP477,@Type478);select scope_identity()	
Parameters:
@SiteCode471[String] = 6373083925531366080
@ProjectId472[String] = 6372912251695766465
@FileName473[String] = tmp9F18
@PlanTotal474[Int32] = 156
@ComponentName475[String] = 过度件
@ComponentCode476[String] = L21_Z17_00GS_GS_GS_GJ_GDJ
@ComponentCodeP477[String] = L21_Z17_00GS_GS_GS_GJ
@Type478[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode479,@ProjectId480,@FileName481,@PlanTotal482,@ComponentName483,@ComponentCode484,@ComponentCodeP485,@Type486);select scope_identity()	
Parameters:
@SiteCode479[String] = 6373083925531366080
@ProjectId480[String] = 6372912251695766465
@FileName481[String] = tmp9F18
@PlanTotal482[Int32] = 61
@ComponentName483[String] = 弯头
@ComponentCode484[String] = L21_Z17_00GS_GS_GS_GJ_WT
@ComponentCodeP485[String] = L21_Z17_00GS_GS_GS_GJ
@Type486[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode487,@ProjectId488,@FileName489,@PlanTotal490,@ComponentName491,@ComponentCode492,@ComponentCodeP493,@Type494);select scope_identity()	
Parameters:
@SiteCode487[String] = 6373083925531366080
@ProjectId488[String] = 6372912251695766465
@FileName489[String] = tmp9F18
@PlanTotal490[Int32] = 22
@ComponentName491[String] = 截止阀
@ComponentCode492[String] = L21_Z17_00GS_GS_GS_JZF_JZF
@ComponentCodeP493[String] = L21_Z17_00GS_GS_GS_JZF
@Type494[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode495,@ProjectId496,@FileName497,@PlanTotal498,@ComponentName499,@ComponentCode500,@ComponentCodeP501,@Type502);select scope_identity()	
Parameters:
@SiteCode495[String] = 6373083925531366080
@ProjectId496[String] = 6372912251695766465
@FileName497[String] = tmp9F18
@PlanTotal498[Int32] = 6
@ComponentName499[String] = 水表
@ComponentCode500[String] = L21_Z17_00GS_GS_GS_SB_SB
@ComponentCodeP501[String] = L21_Z17_00GS_GS_GS_SB
@Type502[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode503,@ProjectId504,@FileName505,@PlanTotal506,@ComponentName507,@ComponentCode508,@ComponentCodeP509,@Type510);select scope_identity()	
Parameters:
@SiteCode503[String] = 6373083925531366080
@ProjectId504[String] = 6372912251695766465
@FileName505[String] = tmp9F18
@PlanTotal506[Int32] = 299
@ComponentName507[String] = 水管
@ComponentCode508[String] = L21_Z17_00GS_GS_GS_SG_SG
@ComponentCodeP509[String] = L21_Z17_00GS_GS_GS_SG
@Type510[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode511,@ProjectId512,@FileName513,@PlanTotal514,@ComponentName515,@ComponentCode516,@ComponentCodeP517,@Type518);select scope_identity()	
Parameters:
@SiteCode511[String] = 6373083925531366080
@ProjectId512[String] = 6372912251695766465
@FileName513[String] = tmp9F18
@PlanTotal514[Int32] = 7
@ComponentName515[String] = 水龙头
@ComponentCode516[String] = L21_Z17_00GS_GS_GS_SLT_SLT
@ComponentCodeP517[String] = L21_Z17_00GS_GS_GS_SLT
@Type518[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode519,@ProjectId520,@FileName521,@PlanTotal522,@ComponentName523,@ComponentCode524,@ComponentCodeP525,@Type526);select scope_identity()	
Parameters:
@SiteCode519[String] = 6373083925531366080
@ProjectId520[String] = 6372912251695766465
@FileName521[String] = tmp9F18
@PlanTotal522[Int32] = 1
@ComponentName523[String] = 闸阀
@ComponentCode524[String] = L21_Z17_00GS_GS_GS_ZF_ZF
@ComponentCodeP525[String] = L21_Z17_00GS_GS_GS_ZF
@Type526[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode527,@ProjectId528,@FileName529,@PlanTotal530,@ComponentName531,@ComponentCode532,@ComponentCodeP533,@Type534);select scope_identity()	
Parameters:
@SiteCode527[String] = 6373083925531366080
@ProjectId528[String] = 6372912251695766465
@FileName529[String] = tmp9F18
@PlanTotal530[Int32] = 34
@ComponentName531[String] = 地漏
@ComponentCode532[String] = L21_Z17_00GS_PS_PS_DL_DL
@ComponentCodeP533[String] = L21_Z17_00GS_PS_PS_DL
@Type534[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode535,@ProjectId536,@FileName537,@PlanTotal538,@ComponentName539,@ComponentCode540,@ComponentCodeP541,@Type542);select scope_identity()	
Parameters:
@SiteCode535[String] = 6373083925531366080
@ProjectId536[String] = 6372912251695766465
@FileName537[String] = tmp9F18
@PlanTotal538[Int32] = 31
@ComponentName539[String] = 过度件
@ComponentCode540[String] = L21_Z17_00GS_PS_PS_GJ_GDJ
@ComponentCodeP541[String] = L21_Z17_00GS_PS_PS_GJ
@Type542[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode543,@ProjectId544,@FileName545,@PlanTotal546,@ComponentName547,@ComponentCode548,@ComponentCodeP549,@Type550);select scope_identity()	
Parameters:
@SiteCode543[String] = 6373083925531366080
@ProjectId544[String] = 6372912251695766465
@FileName545[String] = tmp9F18
@PlanTotal546[Int32] = 393
@ComponentName547[String] = 弯头
@ComponentCode548[String] = L21_Z17_00GS_PS_PS_GJ_WT
@ComponentCodeP549[String] = L21_Z17_00GS_PS_PS_GJ
@Type550[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode551,@ProjectId552,@FileName553,@PlanTotal554,@ComponentName555,@ComponentCode556,@ComponentCodeP557,@Type558);select scope_identity()	
Parameters:
@SiteCode551[String] = 6373083925531366080
@ProjectId552[String] = 6372912251695766465
@FileName553[String] = tmp9F18
@PlanTotal554[Int32] = 19
@ComponentName555[String] = 
@ComponentCode556[String] = L21_Z17_00GS_PS_PS_QWB_QWB
@ComponentCodeP557[String] = L21_Z17_00GS_PS_PS_QWB
@Type558[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode559,@ProjectId560,@FileName561,@PlanTotal562,@ComponentName563,@ComponentCode564,@ComponentCodeP565,@Type566);select scope_identity()	
Parameters:
@SiteCode559[String] = 6373083925531366080
@ProjectId560[String] = 6372912251695766465
@FileName561[String] = tmp9F18
@PlanTotal562[Int32] = 351
@ComponentName563[String] = 水管
@ComponentCode564[String] = L21_Z17_00GS_PS_PS_SG_SG
@ComponentCodeP565[String] = L21_Z17_00GS_PS_PS_SG
@Type566[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode567,@ProjectId568,@FileName569,@PlanTotal570,@ComponentName571,@ComponentCode572,@ComponentCodeP573,@Type574);select scope_identity()	
Parameters:
@SiteCode567[String] = 6373083925531366080
@ProjectId568[String] = 6372912251695766465
@FileName569[String] = tmp9F18
@PlanTotal570[Int32] = 1
@ComponentName571[String] = 污水提升装置
@ComponentCode572[String] = L21_Z17_00GS_PS_PS_TSQ_TSQ
@ComponentCodeP573[String] = L21_Z17_00GS_PS_PS_TSQ
@Type574[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode575,@ProjectId576,@FileName577,@PlanTotal578,@ComponentName579,@ComponentCode580,@ComponentCodeP581,@Type582);select scope_identity()	
Parameters:
@SiteCode575[String] = 6373083925531366080
@ProjectId576[String] = 6372912251695766465
@FileName577[String] = tmp9F18
@PlanTotal578[Int32] = 12
@ComponentName579[String] = 压力表
@ComponentCode580[String] = L21_Z17_00GS_PS_PS_YLB_YLB
@ComponentCodeP581[String] = L21_Z17_00GS_PS_PS_YLB
@Type582[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode583,@ProjectId584,@FileName585,@PlanTotal586,@ComponentName587,@ComponentCode588,@ComponentCodeP589,@Type590);select scope_identity()	
Parameters:
@SiteCode583[String] = 6373083925531366080
@ProjectId584[String] = 6372912251695766465
@FileName585[String] = tmp9F18
@PlanTotal586[Int32] = 3
@ComponentName587[String] = 闸阀
@ComponentCode588[String] = L21_Z17_00GS_PS_PS_ZF_ZF
@ComponentCodeP589[String] = L21_Z17_00GS_PS_PS_ZF
@Type590[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode591,@ProjectId592,@FileName593,@PlanTotal594,@ComponentName595,@ComponentCode596,@ComponentCodeP597,@Type598);select scope_identity()	
Parameters:
@SiteCode591[String] = 6373083925531366080
@ProjectId592[String] = 6372912251695766465
@FileName593[String] = tmp9F18
@PlanTotal594[Int32] = 12
@ComponentName595[String] = 止回阀
@ComponentCode596[String] = L21_Z17_00GS_PS_PS_ZHF_ZHF
@ComponentCodeP597[String] = L21_Z17_00GS_PS_PS_ZHF
@Type598[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode599,@ProjectId600,@FileName601,@PlanTotal602,@ComponentName603,@ComponentCode604,@ComponentCodeP605,@Type606);select scope_identity()	
Parameters:
@SiteCode599[String] = 6373083925531366080
@ProjectId600[String] = 6372912251695766465
@FileName601[String] = tmp9F18
@PlanTotal602[Int32] = 1
@ComponentName603[String] = Y型过滤器
@ComponentCode604[String] = L21_Z17_00GS_XF_XF_YGL_YGL
@ComponentCodeP605[String] = L21_Z17_00GS_XF_XF_YGL
@Type606[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode607,@ProjectId608,@FileName609,@PlanTotal610,@ComponentName611,@ComponentCode612,@ComponentCodeP613,@Type614);select scope_identity()	
Parameters:
@SiteCode607[String] = 6373083925531366080
@ProjectId608[String] = 6372912251695766465
@FileName609[String] = tmp9F18
@PlanTotal610[Int32] = 27
@ComponentName611[String] = 电动蝶阀
@ComponentCode612[String] = L21_Z17_00GS_XF_XF_DF_DF
@ComponentCodeP613[String] = L21_Z17_00GS_XF_XF_DF
@Type614[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode615,@ProjectId616,@FileName617,@PlanTotal618,@ComponentName619,@ComponentCode620,@ComponentCodeP621,@Type622);select scope_identity()	
Parameters:
@SiteCode615[String] = 6373083925531366080
@ProjectId616[String] = 6372912251695766465
@FileName617[String] = tmp9F18
@PlanTotal618[Int32] = 153
@ComponentName619[String] = 过度件
@ComponentCode620[String] = L21_Z17_00GS_XF_XF_GJ_GDJ
@ComponentCodeP621[String] = L21_Z17_00GS_XF_XF_GJ
@Type622[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode623,@ProjectId624,@FileName625,@PlanTotal626,@ComponentName627,@ComponentCode628,@ComponentCodeP629,@Type630);select scope_identity()	
Parameters:
@SiteCode623[String] = 6373083925531366080
@ProjectId624[String] = 6372912251695766465
@FileName625[String] = tmp9F18
@PlanTotal626[Int32] = 253
@ComponentName627[String] = 弯头
@ComponentCode628[String] = L21_Z17_00GS_XF_XF_GJ_WT
@ComponentCodeP629[String] = L21_Z17_00GS_XF_XF_GJ
@Type630[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode631,@ProjectId632,@FileName633,@PlanTotal634,@ComponentName635,@ComponentCode636,@ComponentCodeP637,@Type638);select scope_identity()	
Parameters:
@SiteCode631[String] = 6373083925531366080
@ProjectId632[String] = 6372912251695766465
@FileName633[String] = tmp9F18
@PlanTotal634[Int32] = 1
@ComponentName635[String] = 金属伸缩节
@ComponentCode636[String] = L21_Z17_00GS_XF_XF_SSJ_SSJ
@ComponentCodeP637[String] = L21_Z17_00GS_XF_XF_SSJ
@Type638[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode639,@ProjectId640,@FileName641,@PlanTotal642,@ComponentName643,@ComponentCode644,@ComponentCodeP645,@Type646);select scope_identity()	
Parameters:
@SiteCode639[String] = 6373083925531366080
@ProjectId640[String] = 6372912251695766465
@FileName641[String] = tmp9F18
@PlanTotal642[Int32] = 19
@ComponentName643[String] = 可曲挠橡胶接头
@ComponentCode644[String] = L21_Z17_00GS_XF_XF_JJT_JJT
@ComponentCodeP645[String] = L21_Z17_00GS_XF_XF_JJT
@Type646[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode647,@ProjectId648,@FileName649,@PlanTotal650,@ComponentName651,@ComponentCode652,@ComponentCodeP653,@Type654);select scope_identity()	
Parameters:
@SiteCode647[String] = 6373083925531366080
@ProjectId648[String] = 6372912251695766465
@FileName649[String] = tmp9F18
@PlanTotal650[Int32] = 1
@ComponentName651[String] = 气压罐
@ComponentCode652[String] = L21_Z17_00GS_XF_XF_QYG_QYG
@ComponentCodeP653[String] = L21_Z17_00GS_XF_XF_QYG
@Type654[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode655,@ProjectId656,@FileName657,@PlanTotal658,@ComponentName659,@ComponentCode660,@ComponentCodeP661,@Type662);select scope_identity()	
Parameters:
@SiteCode655[String] = 6373083925531366080
@ProjectId656[String] = 6372912251695766465
@FileName657[String] = tmp9F18
@PlanTotal658[Int32] = 681
@ComponentName659[String] = 水管
@ComponentCode660[String] = L21_Z17_00GS_XF_XF_SG_XHG
@ComponentCodeP661[String] = L21_Z17_00GS_XF_XF_SG
@Type662[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode663,@ProjectId664,@FileName665,@PlanTotal666,@ComponentName667,@ComponentCode668,@ComponentCodeP669,@Type670);select scope_identity()	
Parameters:
@SiteCode663[String] = 6373083925531366080
@ProjectId664[String] = 6372912251695766465
@FileName665[String] = tmp9F18
@PlanTotal666[Int32] = 54
@ComponentName667[String] = 消防器材箱
@ComponentCode668[String] = L21_Z17_00GS_XF_XF_QCX_QCX
@ComponentCodeP669[String] = L21_Z17_00GS_XF_XF_QCX
@Type670[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode671,@ProjectId672,@FileName673,@PlanTotal674,@ComponentName675,@ComponentCode676,@ComponentCodeP677,@Type678);select scope_identity()	
Parameters:
@SiteCode671[String] = 6373083925531366080
@ProjectId672[String] = 6372912251695766465
@FileName673[String] = tmp9F18
@PlanTotal674[Int32] = 4
@ComponentName675[String] = 消防水泵
@ComponentCode676[String] = L21_Z17_00GS_XF_XF_XFB_XFB
@ComponentCodeP677[String] = L21_Z17_00GS_XF_XF_XFB
@Type678[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode679,@ProjectId680,@FileName681,@PlanTotal682,@ComponentName683,@ComponentCode684,@ComponentCodeP685,@Type686);select scope_identity()	
Parameters:
@SiteCode679[String] = 6373083925531366080
@ProjectId680[String] = 6372912251695766465
@FileName681[String] = tmp9F18
@PlanTotal682[Int32] = 46
@ComponentName683[String] = 区间消火栓
@ComponentCode684[String] = L21_Z17_00GS_XF_XF_XH_XH
@ComponentCodeP685[String] = L21_Z17_00GS_XF_XF_XH
@Type686[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode687,@ProjectId688,@FileName689,@PlanTotal690,@ComponentName691,@ComponentCode692,@ComponentCodeP693,@Type694);select scope_identity()	
Parameters:
@SiteCode687[String] = 6373083925531366080
@ProjectId688[String] = 6372912251695766465
@FileName689[String] = tmp9F18
@PlanTotal690[Int32] = 1
@ComponentName691[String] = 泄压阀
@ComponentCode692[String] = L21_Z17_00GS_XF_XF_XYF_XYF
@ComponentCodeP693[String] = L21_Z17_00GS_XF_XF_XYF
@Type694[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode695,@ProjectId696,@FileName697,@PlanTotal698,@ComponentName699,@ComponentCode700,@ComponentCodeP701,@Type702);select scope_identity()	
Parameters:
@SiteCode695[String] = 6373083925531366080
@ProjectId696[String] = 6372912251695766465
@FileName697[String] = tmp9F18
@PlanTotal698[Int32] = 43
@ComponentName699[String] = 闸阀
@ComponentCode700[String] = L21_Z17_00GS_XF_XF_ZF_ZF
@ComponentCodeP701[String] = L21_Z17_00GS_XF_XF_ZF
@Type702[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode703,@ProjectId704,@FileName705,@PlanTotal706,@ComponentName707,@ComponentCode708,@ComponentCodeP709,@Type710);select scope_identity()	
Parameters:
@SiteCode703[String] = 6373083925531366080
@ProjectId704[String] = 6372912251695766465
@FileName705[String] = tmp9F18
@PlanTotal706[Int32] = 3
@ComponentName707[String] = 止回阀
@ComponentCode708[String] = L21_Z17_00GS_XF_XF_ZHF_ZHF
@ComponentCodeP709[String] = L21_Z17_00GS_XF_XF_ZHF
@Type710[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode711,@ProjectId712,@FileName713,@PlanTotal714,@ComponentName715,@ComponentCode716,@ComponentCodeP717,@Type718);select scope_identity()	
Parameters:
@SiteCode711[String] = 6373083925531366080
@ProjectId712[String] = 6372912251695766465
@FileName713[String] = tmp8184
@PlanTotal714[Int32] = 1
@ComponentName715[String] = 排烟风机
@ComponentCode716[String] = L21_Z17_00KT_DXT_DXT_FJ_SEF
@ComponentCodeP717[String] = L21_Z17_00KT_DXT_DXT_FJ
@Type718[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode719,@ProjectId720,@FileName721,@PlanTotal722,@ComponentName723,@ComponentCode724,@ComponentCodeP725,@Type726);select scope_identity()	
Parameters:
@SiteCode719[String] = 6373083925531366080
@ProjectId720[String] = 6372912251695766465
@FileName721[String] = tmp8184
@PlanTotal722[Int32] = 3
@ComponentName723[String] = 新风机
@ComponentCode724[String] = L21_Z17_00KT_DXT_DXT_FJ_FJ
@ComponentCodeP725[String] = L21_Z17_00KT_DXT_DXT_FJ
@Type726[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode727,@ProjectId728,@FileName729,@PlanTotal730,@ComponentName731,@ComponentCode732,@ComponentCodeP733,@Type734);select scope_identity()	
Parameters:
@SiteCode727[String] = 6373083925531366080
@ProjectId728[String] = 6372912251695766465
@FileName729[String] = tmp8184
@PlanTotal730[Int32] = 9
@ComponentName731[String] = 电动风阀
@ComponentCode732[String] = L21_Z17_00KT_DXT_DXT_MD_MD
@ComponentCodeP733[String] = L21_Z17_00KT_DXT_DXT_MD
@Type734[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode735,@ProjectId736,@FileName737,@PlanTotal738,@ComponentName739,@ComponentCode740,@ComponentCodeP741,@Type742);select scope_identity()	
Parameters:
@SiteCode735[String] = 6373083925531366080
@ProjectId736[String] = 6372912251695766465
@FileName737[String] = tmp8184
@PlanTotal738[Int32] = 16
@ComponentName739[String] = 防火阀
@ComponentCode740[String] = L21_Z17_00KT_DXT_DXT_FD_FD2-B0
@ComponentCodeP741[String] = L21_Z17_00KT_DXT_DXT_FD
@Type742[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode743,@ProjectId744,@FileName745,@PlanTotal746,@ComponentName747,@ComponentCode748,@ComponentCodeP749,@Type750);select scope_identity()	
Parameters:
@SiteCode743[String] = 6373083925531366080
@ProjectId744[String] = 6372912251695766465
@FileName745[String] = tmp8184
@PlanTotal746[Int32] = 7
@ComponentName747[String] = 风机软接头
@ComponentCode748[String] = L21_Z17_00KT_DXT_DXT_RJT_RJT
@ComponentCodeP749[String] = L21_Z17_00KT_DXT_DXT_RJT
@Type750[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode751,@ProjectId752,@FileName753,@PlanTotal754,@ComponentName755,@ComponentCode756,@ComponentCodeP757,@Type758);select scope_identity()	
Parameters:
@SiteCode751[String] = 6373083925531366080
@ProjectId752[String] = 6372912251695766465
@FileName753[String] = tmp8184
@PlanTotal754[Int32] = 127
@ComponentName755[String] = 风口
@ComponentCode756[String] = L21_Z17_00KT_DXT_DXT_FK_FK
@ComponentCodeP757[String] = L21_Z17_00KT_DXT_DXT_FK
@Type758[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode759,@ProjectId760,@FileName761,@PlanTotal762,@ComponentName763,@ComponentCode764,@ComponentCodeP765,@Type766);select scope_identity()	
Parameters:
@SiteCode759[String] = 6373083925531366080
@ProjectId760[String] = 6372912251695766465
@FileName761[String] = tmp8184
@PlanTotal762[Int32] = 748
@ComponentName763[String] = 过度件
@ComponentCode764[String] = L21_Z17_00KT_DXT_DXT_GJ_GDJ
@ComponentCodeP765[String] = L21_Z17_00KT_DXT_DXT_GJ
@Type766[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode767,@ProjectId768,@FileName769,@PlanTotal770,@ComponentName771,@ComponentCode772,@ComponentCodeP773,@Type774);select scope_identity()	
Parameters:
@SiteCode767[String] = 6373083925531366080
@ProjectId768[String] = 6372912251695766465
@FileName769[String] = tmp8184
@PlanTotal770[Int32] = 2
@ComponentName771[String] = 三通
@ComponentCode772[String] = L21_Z17_00KT_DXT_DXT_GJ_ST
@ComponentCodeP773[String] = L21_Z17_00KT_DXT_DXT_GJ
@Type774[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:30:59
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode775,@ProjectId776,@FileName777,@PlanTotal778,@ComponentName779,@ComponentCode780,@ComponentCodeP781,@Type782);select scope_identity()	
Parameters:
@SiteCode775[String] = 6373083925531366080
@ProjectId776[String] = 6372912251695766465
@FileName777[String] = tmp8184
@PlanTotal778[Int32] = 30
@ComponentName779[String] = 弯头
@ComponentCode780[String] = L21_Z17_00KT_DXT_DXT_GJ_WT
@ComponentCodeP781[String] = L21_Z17_00KT_DXT_DXT_GJ
@Type782[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode783,@ProjectId784,@FileName785,@PlanTotal786,@ComponentName787,@ComponentCode788,@ComponentCodeP789,@Type790);select scope_identity()	
Parameters:
@SiteCode783[String] = 6373083925531366080
@ProjectId784[String] = 6372912251695766465
@FileName785[String] = tmp8184
@PlanTotal786[Int32] = 2
@ComponentName787[String] = 静压箱
@ComponentCode788[String] = L21_Z17_00KT_DXT_DXT_JY_JY
@ComponentCodeP789[String] = L21_Z17_00KT_DXT_DXT_JY
@Type790[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode791,@ProjectId792,@FileName793,@PlanTotal794,@ComponentName795,@ComponentCode796,@ComponentCodeP797,@Type798);select scope_identity()	
Parameters:
@SiteCode791[String] = 6373083925531366080
@ProjectId792[String] = 6372912251695766465
@FileName793[String] = tmp8184
@PlanTotal794[Int32] = 9
@ComponentName795[String] = 手动调节阀
@ComponentCode796[String] = L21_Z17_00KT_DXT_DXT_D_D
@ComponentCodeP797[String] = L21_Z17_00KT_DXT_DXT_D
@Type798[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode799,@ProjectId800,@FileName801,@PlanTotal802,@ComponentName803,@ComponentCode804,@ComponentCodeP805,@Type806);select scope_identity()	
Parameters:
@SiteCode799[String] = 6373083925531366080
@ProjectId800[String] = 6372912251695766465
@FileName801[String] = tmp8184
@PlanTotal802[Int32] = 816
@ComponentName803[String] = 通风管道
@ComponentCode804[String] = L21_Z17_00KT_DXT_DXT_FG_FG
@ComponentCodeP805[String] = L21_Z17_00KT_DXT_DXT_FG
@Type806[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode807,@ProjectId808,@FileName809,@PlanTotal810,@ComponentName811,@ComponentCode812,@ComponentCodeP813,@Type814);select scope_identity()	
Parameters:
@SiteCode807[String] = 6373083925531366080
@ProjectId808[String] = 6372912251695766465
@FileName809[String] = tmp8184
@PlanTotal810[Int32] = 2
@ComponentName811[String] = 消声器
@ComponentCode812[String] = L21_Z17_00KT_DXT_DXT_SIL_SIL
@ComponentCodeP813[String] = L21_Z17_00KT_DXT_DXT_SIL
@Type814[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode815,@ProjectId816,@FileName817,@PlanTotal818,@ComponentName819,@ComponentCode820,@ComponentCodeP821,@Type822);select scope_identity()	
Parameters:
@SiteCode815[String] = 6373083925531366080
@ProjectId816[String] = 6372912251695766465
@FileName817[String] = tmp8184
@PlanTotal818[Int32] = 2
@ComponentName819[String] = 组合式空调机组
@ComponentCode820[String] = L21_Z17_00KT_DXT_DXT_AHU_AHU
@ComponentCodeP821[String] = L21_Z17_00KT_DXT_DXT_AHU
@Type822[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode823,@ProjectId824,@FileName825,@PlanTotal826,@ComponentName827,@ComponentCode828,@ComponentCodeP829,@Type830);select scope_identity()	
Parameters:
@SiteCode823[String] = 6373083925531366080
@ProjectId824[String] = 6372912251695766465
@FileName825[String] = tmp7FCD
@PlanTotal826[Int32] = 85
@ComponentName827[String] = 电动风阀
@ComponentCode828[String] = L21_Z17_00KT_SDF_SDF_MD_MD-2117-B1
@ComponentCodeP829[String] = L21_Z17_00KT_SDF_SDF_MD
@Type830[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:00
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode831,@ProjectId832,@FileName833,@PlanTotal834,@ComponentName835,@ComponentCode836,@ComponentCodeP837,@Type838);select scope_identity()	
Parameters:
@SiteCode831[String] = 6373083925531366080
@ProjectId832[String] = 6372912251695766465
@FileName833[String] = tmp7FCD
@PlanTotal834[Int32] = 6
@ComponentName835[String] = 消声器
@ComponentCode836[String] = L21_Z17_00KT_SDF_SDF_SIL_SIL-2117-B0
@ComponentCodeP837[String] = L21_Z17_00KT_SDF_SDF_SIL
@Type838[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083925531366080
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:31:59
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083925531366080')	


-----------------------------------------------------------------------------
2020-08-26 17:31:59
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:31:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:32:03
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName,count(*) as Total
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:32:03
Text:	 SELECT   * FROM [TbModelReporte]  WHERE [TbModelReporte].[SiteCode] = @SiteCode839 	
Parameters:
@SiteCode839[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu840,@ActionType841,@HostName842,@LogDate843,@UserCode844,@UserIP845);select scope_identity()	
Parameters:
@ActionMenu840[String] = TbModelReporte
@ActionType841[String] = 编辑
@HostName842[String] = 
@LogDate843[DateTime] = 2020/8/26 17:32:10
@UserCode844[String] = 500000
@UserIP845[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal847 WHERE [TbModelReporte].[ID] = @ID846	
Parameters:
@PlanTotal847[Int32] = 31
@ID846[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal849 WHERE [TbModelReporte].[ID] = @ID848	
Parameters:
@PlanTotal849[Int32] = 16
@ID848[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal851 WHERE [TbModelReporte].[ID] = @ID850	
Parameters:
@PlanTotal851[Int32] = 8
@ID850[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal853 WHERE [TbModelReporte].[ID] = @ID852	
Parameters:
@PlanTotal853[Int32] = 9
@ID852[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal855 WHERE [TbModelReporte].[ID] = @ID854	
Parameters:
@PlanTotal855[Int32] = 14
@ID854[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal857 WHERE [TbModelReporte].[ID] = @ID856	
Parameters:
@PlanTotal857[Int32] = 14
@ID856[Int32] = 6


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal859 WHERE [TbModelReporte].[ID] = @ID858	
Parameters:
@PlanTotal859[Int32] = 2
@ID858[Int32] = 7


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal861 WHERE [TbModelReporte].[ID] = @ID860	
Parameters:
@PlanTotal861[Int32] = 8
@ID860[Int32] = 8


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal863 WHERE [TbModelReporte].[ID] = @ID862	
Parameters:
@PlanTotal863[Int32] = 9
@ID862[Int32] = 9


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal865 WHERE [TbModelReporte].[ID] = @ID864	
Parameters:
@PlanTotal865[Int32] = 14
@ID864[Int32] = 10


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal867 WHERE [TbModelReporte].[ID] = @ID866	
Parameters:
@PlanTotal867[Int32] = 14
@ID866[Int32] = 11


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal869 WHERE [TbModelReporte].[ID] = @ID868	
Parameters:
@PlanTotal869[Int32] = 2
@ID868[Int32] = 12


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal871 WHERE [TbModelReporte].[ID] = @ID870	
Parameters:
@PlanTotal871[Int32] = 1
@ID870[Int32] = 13


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal873 WHERE [TbModelReporte].[ID] = @ID872	
Parameters:
@PlanTotal873[Int32] = 2
@ID872[Int32] = 14


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal875 WHERE [TbModelReporte].[ID] = @ID874	
Parameters:
@PlanTotal875[Int32] = 1
@ID874[Int32] = 15


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal877 WHERE [TbModelReporte].[ID] = @ID876	
Parameters:
@PlanTotal877[Int32] = 1
@ID876[Int32] = 16


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal879 WHERE [TbModelReporte].[ID] = @ID878	
Parameters:
@PlanTotal879[Int32] = 1
@ID878[Int32] = 17


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal881 WHERE [TbModelReporte].[ID] = @ID880	
Parameters:
@PlanTotal881[Int32] = 1
@ID880[Int32] = 18


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal883 WHERE [TbModelReporte].[ID] = @ID882	
Parameters:
@PlanTotal883[Int32] = 1
@ID882[Int32] = 19


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal885 WHERE [TbModelReporte].[ID] = @ID884	
Parameters:
@PlanTotal885[Int32] = 1
@ID884[Int32] = 20


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal887 WHERE [TbModelReporte].[ID] = @ID886	
Parameters:
@PlanTotal887[Int32] = 2
@ID886[Int32] = 21


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal889 WHERE [TbModelReporte].[ID] = @ID888	
Parameters:
@PlanTotal889[Int32] = 1
@ID888[Int32] = 22


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal891 WHERE [TbModelReporte].[ID] = @ID890	
Parameters:
@PlanTotal891[Int32] = 1
@ID890[Int32] = 23


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal893 WHERE [TbModelReporte].[ID] = @ID892	
Parameters:
@PlanTotal893[Int32] = 1
@ID892[Int32] = 24


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal895 WHERE [TbModelReporte].[ID] = @ID894	
Parameters:
@PlanTotal895[Int32] = 1
@ID894[Int32] = 25


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal897 WHERE [TbModelReporte].[ID] = @ID896	
Parameters:
@PlanTotal897[Int32] = 1
@ID896[Int32] = 26


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal899 WHERE [TbModelReporte].[ID] = @ID898	
Parameters:
@PlanTotal899[Int32] = 1
@ID898[Int32] = 27


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal901 WHERE [TbModelReporte].[ID] = @ID900	
Parameters:
@PlanTotal901[Int32] = 1
@ID900[Int32] = 28


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal903 WHERE [TbModelReporte].[ID] = @ID902	
Parameters:
@PlanTotal903[Int32] = 1
@ID902[Int32] = 29


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal905 WHERE [TbModelReporte].[ID] = @ID904	
Parameters:
@PlanTotal905[Int32] = 2
@ID904[Int32] = 30


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal907 WHERE [TbModelReporte].[ID] = @ID906	
Parameters:
@PlanTotal907[Int32] = 1
@ID906[Int32] = 31


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal909 WHERE [TbModelReporte].[ID] = @ID908	
Parameters:
@PlanTotal909[Int32] = 1
@ID908[Int32] = 32


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal911 WHERE [TbModelReporte].[ID] = @ID910	
Parameters:
@PlanTotal911[Int32] = 1
@ID910[Int32] = 33


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal913 WHERE [TbModelReporte].[ID] = @ID912	
Parameters:
@PlanTotal913[Int32] = 1
@ID912[Int32] = 34


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal915 WHERE [TbModelReporte].[ID] = @ID914	
Parameters:
@PlanTotal915[Int32] = 1
@ID914[Int32] = 35


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal917 WHERE [TbModelReporte].[ID] = @ID916	
Parameters:
@PlanTotal917[Int32] = 1
@ID916[Int32] = 36


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal919 WHERE [TbModelReporte].[ID] = @ID918	
Parameters:
@PlanTotal919[Int32] = 1
@ID918[Int32] = 37


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal921 WHERE [TbModelReporte].[ID] = @ID920	
Parameters:
@PlanTotal921[Int32] = 1
@ID920[Int32] = 38


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal923 WHERE [TbModelReporte].[ID] = @ID922	
Parameters:
@PlanTotal923[Int32] = 1
@ID922[Int32] = 39


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal925 WHERE [TbModelReporte].[ID] = @ID924	
Parameters:
@PlanTotal925[Int32] = 1
@ID924[Int32] = 40


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal927 WHERE [TbModelReporte].[ID] = @ID926	
Parameters:
@PlanTotal927[Int32] = 2
@ID926[Int32] = 41


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal929 WHERE [TbModelReporte].[ID] = @ID928	
Parameters:
@PlanTotal929[Int32] = 1
@ID928[Int32] = 42


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal931 WHERE [TbModelReporte].[ID] = @ID930	
Parameters:
@PlanTotal931[Int32] = 1
@ID930[Int32] = 43


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal933 WHERE [TbModelReporte].[ID] = @ID932	
Parameters:
@PlanTotal933[Int32] = 1
@ID932[Int32] = 44


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal935 WHERE [TbModelReporte].[ID] = @ID934	
Parameters:
@PlanTotal935[Int32] = 1
@ID934[Int32] = 45


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal937 WHERE [TbModelReporte].[ID] = @ID936	
Parameters:
@PlanTotal937[Int32] = 3
@ID936[Int32] = 46


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal939 WHERE [TbModelReporte].[ID] = @ID938	
Parameters:
@PlanTotal939[Int32] = 1
@ID938[Int32] = 47


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal941 WHERE [TbModelReporte].[ID] = @ID940	
Parameters:
@PlanTotal941[Int32] = 1
@ID940[Int32] = 48


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal943 WHERE [TbModelReporte].[ID] = @ID942	
Parameters:
@PlanTotal943[Int32] = 1
@ID942[Int32] = 49


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal945 WHERE [TbModelReporte].[ID] = @ID944	
Parameters:
@PlanTotal945[Int32] = 1
@ID944[Int32] = 50


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal947 WHERE [TbModelReporte].[ID] = @ID946	
Parameters:
@PlanTotal947[Int32] = 1
@ID946[Int32] = 51


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal949 WHERE [TbModelReporte].[ID] = @ID948	
Parameters:
@PlanTotal949[Int32] = 1
@ID948[Int32] = 52


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal951 WHERE [TbModelReporte].[ID] = @ID950	
Parameters:
@PlanTotal951[Int32] = 1
@ID950[Int32] = 53


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal953 WHERE [TbModelReporte].[ID] = @ID952	
Parameters:
@PlanTotal953[Int32] = 18
@ID952[Int32] = 54


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal955 WHERE [TbModelReporte].[ID] = @ID954	
Parameters:
@PlanTotal955[Int32] = 156
@ID954[Int32] = 55


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal957 WHERE [TbModelReporte].[ID] = @ID956	
Parameters:
@PlanTotal957[Int32] = 61
@ID956[Int32] = 56


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal959 WHERE [TbModelReporte].[ID] = @ID958	
Parameters:
@PlanTotal959[Int32] = 22
@ID958[Int32] = 57


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal961 WHERE [TbModelReporte].[ID] = @ID960	
Parameters:
@PlanTotal961[Int32] = 6
@ID960[Int32] = 58


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal963 WHERE [TbModelReporte].[ID] = @ID962	
Parameters:
@PlanTotal963[Int32] = 299
@ID962[Int32] = 59


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal965 WHERE [TbModelReporte].[ID] = @ID964	
Parameters:
@PlanTotal965[Int32] = 7
@ID964[Int32] = 60


-----------------------------------------------------------------------------
2020-08-26 17:32:10
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal967 WHERE [TbModelReporte].[ID] = @ID966	
Parameters:
@PlanTotal967[Int32] = 1
@ID966[Int32] = 61


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal969 WHERE [TbModelReporte].[ID] = @ID968	
Parameters:
@PlanTotal969[Int32] = 34
@ID968[Int32] = 62


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal971 WHERE [TbModelReporte].[ID] = @ID970	
Parameters:
@PlanTotal971[Int32] = 31
@ID970[Int32] = 63


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal973 WHERE [TbModelReporte].[ID] = @ID972	
Parameters:
@PlanTotal973[Int32] = 393
@ID972[Int32] = 64


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal975 WHERE [TbModelReporte].[ID] = @ID974	
Parameters:
@PlanTotal975[Int32] = 19
@ID974[Int32] = 65


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal977 WHERE [TbModelReporte].[ID] = @ID976	
Parameters:
@PlanTotal977[Int32] = 351
@ID976[Int32] = 66


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal979 WHERE [TbModelReporte].[ID] = @ID978	
Parameters:
@PlanTotal979[Int32] = 1
@ID978[Int32] = 67


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal981 WHERE [TbModelReporte].[ID] = @ID980	
Parameters:
@PlanTotal981[Int32] = 12
@ID980[Int32] = 68


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal983 WHERE [TbModelReporte].[ID] = @ID982	
Parameters:
@PlanTotal983[Int32] = 3
@ID982[Int32] = 69


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal985 WHERE [TbModelReporte].[ID] = @ID984	
Parameters:
@PlanTotal985[Int32] = 12
@ID984[Int32] = 70


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal987 WHERE [TbModelReporte].[ID] = @ID986	
Parameters:
@PlanTotal987[Int32] = 1
@ID986[Int32] = 71


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal989 WHERE [TbModelReporte].[ID] = @ID988	
Parameters:
@PlanTotal989[Int32] = 27
@ID988[Int32] = 72


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal991 WHERE [TbModelReporte].[ID] = @ID990	
Parameters:
@PlanTotal991[Int32] = 153
@ID990[Int32] = 73


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal993 WHERE [TbModelReporte].[ID] = @ID992	
Parameters:
@PlanTotal993[Int32] = 253
@ID992[Int32] = 74


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal995 WHERE [TbModelReporte].[ID] = @ID994	
Parameters:
@PlanTotal995[Int32] = 1
@ID994[Int32] = 75


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal997 WHERE [TbModelReporte].[ID] = @ID996	
Parameters:
@PlanTotal997[Int32] = 19
@ID996[Int32] = 76


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal999 WHERE [TbModelReporte].[ID] = @ID998	
Parameters:
@PlanTotal999[Int32] = 1
@ID998[Int32] = 77


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1001 WHERE [TbModelReporte].[ID] = @ID1000	
Parameters:
@PlanTotal1001[Int32] = 681
@ID1000[Int32] = 78


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1003 WHERE [TbModelReporte].[ID] = @ID1002	
Parameters:
@PlanTotal1003[Int32] = 54
@ID1002[Int32] = 79


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1005 WHERE [TbModelReporte].[ID] = @ID1004	
Parameters:
@PlanTotal1005[Int32] = 4
@ID1004[Int32] = 80


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1007 WHERE [TbModelReporte].[ID] = @ID1006	
Parameters:
@PlanTotal1007[Int32] = 46
@ID1006[Int32] = 81


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1009 WHERE [TbModelReporte].[ID] = @ID1008	
Parameters:
@PlanTotal1009[Int32] = 1
@ID1008[Int32] = 82


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1011 WHERE [TbModelReporte].[ID] = @ID1010	
Parameters:
@PlanTotal1011[Int32] = 43
@ID1010[Int32] = 83


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1013 WHERE [TbModelReporte].[ID] = @ID1012	
Parameters:
@PlanTotal1013[Int32] = 3
@ID1012[Int32] = 84


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1015 WHERE [TbModelReporte].[ID] = @ID1014	
Parameters:
@PlanTotal1015[Int32] = 1
@ID1014[Int32] = 85


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1017 WHERE [TbModelReporte].[ID] = @ID1016	
Parameters:
@PlanTotal1017[Int32] = 3
@ID1016[Int32] = 86


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1019 WHERE [TbModelReporte].[ID] = @ID1018	
Parameters:
@PlanTotal1019[Int32] = 9
@ID1018[Int32] = 87


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1021 WHERE [TbModelReporte].[ID] = @ID1020	
Parameters:
@PlanTotal1021[Int32] = 16
@ID1020[Int32] = 88


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1023 WHERE [TbModelReporte].[ID] = @ID1022	
Parameters:
@PlanTotal1023[Int32] = 7
@ID1022[Int32] = 89


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1025 WHERE [TbModelReporte].[ID] = @ID1024	
Parameters:
@PlanTotal1025[Int32] = 127
@ID1024[Int32] = 90


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1027 WHERE [TbModelReporte].[ID] = @ID1026	
Parameters:
@PlanTotal1027[Int32] = 748
@ID1026[Int32] = 91


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1029 WHERE [TbModelReporte].[ID] = @ID1028	
Parameters:
@PlanTotal1029[Int32] = 2
@ID1028[Int32] = 92


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1031 WHERE [TbModelReporte].[ID] = @ID1030	
Parameters:
@PlanTotal1031[Int32] = 30
@ID1030[Int32] = 93


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1033 WHERE [TbModelReporte].[ID] = @ID1032	
Parameters:
@PlanTotal1033[Int32] = 2
@ID1032[Int32] = 94


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1035 WHERE [TbModelReporte].[ID] = @ID1034	
Parameters:
@PlanTotal1035[Int32] = 9
@ID1034[Int32] = 95


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1037 WHERE [TbModelReporte].[ID] = @ID1036	
Parameters:
@PlanTotal1037[Int32] = 816
@ID1036[Int32] = 96


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1039 WHERE [TbModelReporte].[ID] = @ID1038	
Parameters:
@PlanTotal1039[Int32] = 2
@ID1038[Int32] = 97


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1041 WHERE [TbModelReporte].[ID] = @ID1040	
Parameters:
@PlanTotal1041[Int32] = 2
@ID1040[Int32] = 98


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1043 WHERE [TbModelReporte].[ID] = @ID1042	
Parameters:
@PlanTotal1043[Int32] = 85
@ID1042[Int32] = 99


-----------------------------------------------------------------------------
2020-08-26 17:32:11
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal1045 WHERE [TbModelReporte].[ID] = @ID1044	
Parameters:
@PlanTotal1045[Int32] = 6
@ID1044[Int32] = 100


-----------------------------------------------------------------------------
2020-08-26 17:33:18
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-26 17:33:18
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-26 17:33:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName,count(*) as Total
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	 SELECT   * FROM [TbModelReporte]  WHERE [TbModelReporte].[SiteCode] = @SiteCode23 	
Parameters:
@SiteCode23[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode24,@ProjectId25,@FileName26,@PlanTotal27,@ComponentName28,@ComponentCode29,@ComponentCodeP30,@Type31);select scope_identity()	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ProjectId25[String] = 6372912251695766465
@FileName26[String] = tmpC635
@PlanTotal27[Int32] = 19
@ComponentName28[String] = 给排水及消防
@ComponentCode29[String] = L21_Z08_00GS
@ComponentCodeP30[String] = 
@Type31[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode32,@ProjectId33,@FileName34,@PlanTotal35,@ComponentName36,@ComponentCode37,@ComponentCodeP38,@Type39);select scope_identity()	
Parameters:
@SiteCode32[String] = 6373083923489249281
@ProjectId33[String] = 6372912251695766465
@FileName34[String] = tmp16
@PlanTotal35[Int32] = 14
@ComponentName36[String] = 通风与空调
@ComponentCode37[String] = L21_Z08_00KT
@ComponentCodeP38[String] = 
@Type39[Int32] = 1


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode40,@ProjectId41,@FileName42,@PlanTotal43,@ComponentName44,@ComponentCode45,@ComponentCodeP46,@Type47);select scope_identity()	
Parameters:
@SiteCode40[String] = 6373083923489249281
@ProjectId41[String] = 6372912251695766465
@FileName42[String] = tmpC635
@PlanTotal43[Int32] = 4
@ComponentName44[String] = 给水
@ComponentCode45[String] = L21_Z08_00GS_GS
@ComponentCodeP46[String] = L21_Z08_00GS
@Type47[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode48,@ProjectId49,@FileName50,@PlanTotal51,@ComponentName52,@ComponentCode53,@ComponentCodeP54,@Type55);select scope_identity()	
Parameters:
@SiteCode48[String] = 6373083923489249281
@ProjectId49[String] = 6372912251695766465
@FileName50[String] = tmpC635
@PlanTotal51[Int32] = 9
@ComponentName52[String] = 排水
@ComponentCode53[String] = L21_Z08_00GS_PS
@ComponentCodeP54[String] = L21_Z08_00GS
@Type55[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode56,@ProjectId57,@FileName58,@PlanTotal59,@ComponentName60,@ComponentCode61,@ComponentCodeP62,@Type63);select scope_identity()	
Parameters:
@SiteCode56[String] = 6373083923489249281
@ProjectId57[String] = 6372912251695766465
@FileName58[String] = tmpC635
@PlanTotal59[Int32] = 6
@ComponentName60[String] = 消防
@ComponentCode61[String] = L21_Z08_00GS_XF
@ComponentCodeP62[String] = L21_Z08_00GS
@Type63[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode64,@ProjectId65,@FileName66,@PlanTotal67,@ComponentName68,@ComponentCode69,@ComponentCodeP70,@Type71);select scope_identity()	
Parameters:
@SiteCode64[String] = 6373083923489249281
@ProjectId65[String] = 6372912251695766465
@FileName66[String] = tmp16
@PlanTotal67[Int32] = 14
@ComponentName68[String] = 大系统
@ComponentCode69[String] = L21_Z08_00KT_DXT
@ComponentCodeP70[String] = L21_Z08_00KT
@Type71[Int32] = 2


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode72,@ProjectId73,@FileName74,@PlanTotal75,@ComponentName76,@ComponentCode77,@ComponentCodeP78,@Type79);select scope_identity()	
Parameters:
@SiteCode72[String] = 6373083923489249281
@ProjectId73[String] = 6372912251695766465
@FileName74[String] = tmpC635
@PlanTotal75[Int32] = 4
@ComponentName76[String] = 给水
@ComponentCode77[String] = L21_Z08_00GS_GS_GS
@ComponentCodeP78[String] = L21_Z08_00GS_GS
@Type79[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode80,@ProjectId81,@FileName82,@PlanTotal83,@ComponentName84,@ComponentCode85,@ComponentCodeP86,@Type87);select scope_identity()	
Parameters:
@SiteCode80[String] = 6373083923489249281
@ProjectId81[String] = 6372912251695766465
@FileName82[String] = tmpC635
@PlanTotal83[Int32] = 9
@ComponentName84[String] = 排水
@ComponentCode85[String] = L21_Z08_00GS_PS_PS
@ComponentCodeP86[String] = L21_Z08_00GS_PS
@Type87[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode88,@ProjectId89,@FileName90,@PlanTotal91,@ComponentName92,@ComponentCode93,@ComponentCodeP94,@Type95);select scope_identity()	
Parameters:
@SiteCode88[String] = 6373083923489249281
@ProjectId89[String] = 6372912251695766465
@FileName90[String] = tmpC635
@PlanTotal91[Int32] = 6
@ComponentName92[String] = 消防
@ComponentCode93[String] = L21_Z08_00GS_XF_XF
@ComponentCodeP94[String] = L21_Z08_00GS_XF
@Type95[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode96,@ProjectId97,@FileName98,@PlanTotal99,@ComponentName100,@ComponentCode101,@ComponentCodeP102,@Type103);select scope_identity()	
Parameters:
@SiteCode96[String] = 6373083923489249281
@ProjectId97[String] = 6372912251695766465
@FileName98[String] = tmp16
@PlanTotal99[Int32] = 14
@ComponentName100[String] = 大系统
@ComponentCode101[String] = L21_Z08_00KT_DXT_DXT
@ComponentCodeP102[String] = L21_Z08_00KT_DXT
@Type103[Int32] = 3


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode104,@ProjectId105,@FileName106,@PlanTotal107,@ComponentName108,@ComponentCode109,@ComponentCodeP110,@Type111);select scope_identity()	
Parameters:
@SiteCode104[String] = 6373083923489249281
@ProjectId105[String] = 6372912251695766465
@FileName106[String] = tmpC635
@PlanTotal107[Int32] = 1
@ComponentName108[String] = 波纹伸缩器
@ComponentCode109[String] = L21_Z08_00GS_GS_GS_SSQ
@ComponentCodeP110[String] = L21_Z08_00GS_GS_GS
@Type111[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode112,@ProjectId113,@FileName114,@PlanTotal115,@ComponentName116,@ComponentCode117,@ComponentCodeP118,@Type119);select scope_identity()	
Parameters:
@SiteCode112[String] = 6373083923489249281
@ProjectId113[String] = 6372912251695766465
@FileName114[String] = tmpC635
@PlanTotal115[Int32] = 1
@ComponentName116[String] = 截止阀
@ComponentCode117[String] = L21_Z08_00GS_GS_GS_JZF
@ComponentCodeP118[String] = L21_Z08_00GS_GS_GS
@Type119[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode120,@ProjectId121,@FileName122,@PlanTotal123,@ComponentName124,@ComponentCode125,@ComponentCodeP126,@Type127);select scope_identity()	
Parameters:
@SiteCode120[String] = 6373083923489249281
@ProjectId121[String] = 6372912251695766465
@FileName122[String] = tmpC635
@PlanTotal123[Int32] = 1
@ComponentName124[String] = 水管
@ComponentCode125[String] = L21_Z08_00GS_GS_GS_SG
@ComponentCodeP126[String] = L21_Z08_00GS_GS_GS
@Type127[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode128,@ProjectId129,@FileName130,@PlanTotal131,@ComponentName132,@ComponentCode133,@ComponentCodeP134,@Type135);select scope_identity()	
Parameters:
@SiteCode128[String] = 6373083923489249281
@ProjectId129[String] = 6372912251695766465
@FileName130[String] = tmpC635
@PlanTotal131[Int32] = 1
@ComponentName132[String] = 水龙头
@ComponentCode133[String] = L21_Z08_00GS_GS_GS_SLT
@ComponentCodeP134[String] = L21_Z08_00GS_GS_GS
@Type135[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode136,@ProjectId137,@FileName138,@PlanTotal139,@ComponentName140,@ComponentCode141,@ComponentCodeP142,@Type143);select scope_identity()	
Parameters:
@SiteCode136[String] = 6373083923489249281
@ProjectId137[String] = 6372912251695766465
@FileName138[String] = tmpC635
@PlanTotal139[Int32] = 1
@ComponentName140[String] = 地漏
@ComponentCode141[String] = L21_Z08_00GS_PS_PS_DL
@ComponentCodeP142[String] = L21_Z08_00GS_PS_PS
@Type143[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode144,@ProjectId145,@FileName146,@PlanTotal147,@ComponentName148,@ComponentCode149,@ComponentCodeP150,@Type151);select scope_identity()	
Parameters:
@SiteCode144[String] = 6373083923489249281
@ProjectId145[String] = 6372912251695766465
@FileName146[String] = tmpC635
@PlanTotal147[Int32] = 1
@ComponentName148[String] = 金属伸缩节
@ComponentCode149[String] = L21_Z08_00GS_PS_PS_SSJ
@ComponentCodeP150[String] = L21_Z08_00GS_PS_PS
@Type151[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode152,@ProjectId153,@FileName154,@PlanTotal155,@ComponentName156,@ComponentCode157,@ComponentCodeP158,@Type159);select scope_identity()	
Parameters:
@SiteCode152[String] = 6373083923489249281
@ProjectId153[String] = 6372912251695766465
@FileName154[String] = tmpC635
@PlanTotal155[Int32] = 1
@ComponentName156[String] = 可曲挠橡胶接头
@ComponentCode157[String] = L21_Z08_00GS_PS_PS_JJT
@ComponentCodeP158[String] = L21_Z08_00GS_PS_PS
@Type159[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode160,@ProjectId161,@FileName162,@PlanTotal163,@ComponentName164,@ComponentCode165,@ComponentCodeP166,@Type167);select scope_identity()	
Parameters:
@SiteCode160[String] = 6373083923489249281
@ProjectId161[String] = 6372912251695766465
@FileName162[String] = tmpC635
@PlanTotal163[Int32] = 1
@ComponentName164[String] = 潜污泵
@ComponentCode165[String] = L21_Z08_00GS_PS_PS_QWB
@ComponentCodeP166[String] = L21_Z08_00GS_PS_PS
@Type167[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode168,@ProjectId169,@FileName170,@PlanTotal171,@ComponentName172,@ComponentCode173,@ComponentCodeP174,@Type175);select scope_identity()	
Parameters:
@SiteCode168[String] = 6373083923489249281
@ProjectId169[String] = 6372912251695766465
@FileName170[String] = tmpC635
@PlanTotal171[Int32] = 1
@ComponentName172[String] = 水管
@ComponentCode173[String] = L21_Z08_00GS_PS_PS_SG
@ComponentCodeP174[String] = L21_Z08_00GS_PS_PS
@Type175[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode176,@ProjectId177,@FileName178,@PlanTotal179,@ComponentName180,@ComponentCode181,@ComponentCodeP182,@Type183);select scope_identity()	
Parameters:
@SiteCode176[String] = 6373083923489249281
@ProjectId177[String] = 6372912251695766465
@FileName178[String] = tmpC635
@PlanTotal179[Int32] = 1
@ComponentName180[String] = 污水提升装置
@ComponentCode181[String] = L21_Z08_00GS_PS_PS_TSQ
@ComponentCodeP182[String] = L21_Z08_00GS_PS_PS
@Type183[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode184,@ProjectId185,@FileName186,@PlanTotal187,@ComponentName188,@ComponentCode189,@ComponentCodeP190,@Type191);select scope_identity()	
Parameters:
@SiteCode184[String] = 6373083923489249281
@ProjectId185[String] = 6372912251695766465
@FileName186[String] = tmpC635
@PlanTotal187[Int32] = 1
@ComponentName188[String] = 压力表
@ComponentCode189[String] = L21_Z08_00GS_PS_PS_YLB
@ComponentCodeP190[String] = L21_Z08_00GS_PS_PS
@Type191[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode192,@ProjectId193,@FileName194,@PlanTotal195,@ComponentName196,@ComponentCode197,@ComponentCodeP198,@Type199);select scope_identity()	
Parameters:
@SiteCode192[String] = 6373083923489249281
@ProjectId193[String] = 6372912251695766465
@FileName194[String] = tmpC635
@PlanTotal195[Int32] = 1
@ComponentName196[String] = 闸阀
@ComponentCode197[String] = L21_Z08_00GS_PS_PS_ZF
@ComponentCodeP198[String] = L21_Z08_00GS_PS_PS
@Type199[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode200,@ProjectId201,@FileName202,@PlanTotal203,@ComponentName204,@ComponentCode205,@ComponentCodeP206,@Type207);select scope_identity()	
Parameters:
@SiteCode200[String] = 6373083923489249281
@ProjectId201[String] = 6372912251695766465
@FileName202[String] = tmpC635
@PlanTotal203[Int32] = 1
@ComponentName204[String] = 止回阀
@ComponentCode205[String] = L21_Z08_00GS_PS_PS_ZHF
@ComponentCodeP206[String] = L21_Z08_00GS_PS_PS
@Type207[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode208,@ProjectId209,@FileName210,@PlanTotal211,@ComponentName212,@ComponentCode213,@ComponentCodeP214,@Type215);select scope_identity()	
Parameters:
@SiteCode208[String] = 6373083923489249281
@ProjectId209[String] = 6372912251695766465
@FileName210[String] = tmpC635
@PlanTotal211[Int32] = 1
@ComponentName212[String] = 蝶阀
@ComponentCode213[String] = L21_Z08_00GS_XF_XF_DF
@ComponentCodeP214[String] = L21_Z08_00GS_XF_XF
@Type215[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode216,@ProjectId217,@FileName218,@PlanTotal219,@ComponentName220,@ComponentCode221,@ComponentCodeP222,@Type223);select scope_identity()	
Parameters:
@SiteCode216[String] = 6373083923489249281
@ProjectId217[String] = 6372912251695766465
@FileName218[String] = tmpC635
@PlanTotal219[Int32] = 1
@ComponentName220[String] = 金属伸缩节
@ComponentCode221[String] = L21_Z08_00GS_XF_XF_SSJ
@ComponentCodeP222[String] = L21_Z08_00GS_XF_XF
@Type223[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode224,@ProjectId225,@FileName226,@PlanTotal227,@ComponentName228,@ComponentCode229,@ComponentCodeP230,@Type231);select scope_identity()	
Parameters:
@SiteCode224[String] = 6373083923489249281
@ProjectId225[String] = 6372912251695766465
@FileName226[String] = tmpC635
@PlanTotal227[Int32] = 1
@ComponentName228[String] = 可曲挠橡胶接头
@ComponentCode229[String] = L21_Z08_00GS_XF_XF_JJT
@ComponentCodeP230[String] = L21_Z08_00GS_XF_XF
@Type231[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode232,@ProjectId233,@FileName234,@PlanTotal235,@ComponentName236,@ComponentCode237,@ComponentCodeP238,@Type239);select scope_identity()	
Parameters:
@SiteCode232[String] = 6373083923489249281
@ProjectId233[String] = 6372912251695766465
@FileName234[String] = tmpC635
@PlanTotal235[Int32] = 1
@ComponentName236[String] = 灭火器（箱）
@ComponentCode237[String] = L21_Z08_00GS_XF_XF_MH
@ComponentCodeP238[String] = L21_Z08_00GS_XF_XF
@Type239[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode240,@ProjectId241,@FileName242,@PlanTotal243,@ComponentName244,@ComponentCode245,@ComponentCodeP246,@Type247);select scope_identity()	
Parameters:
@SiteCode240[String] = 6373083923489249281
@ProjectId241[String] = 6372912251695766465
@FileName242[String] = tmpC635
@PlanTotal243[Int32] = 1
@ComponentName244[String] = 水管
@ComponentCode245[String] = L21_Z08_00GS_XF_XF_SG
@ComponentCodeP246[String] = L21_Z08_00GS_XF_XF
@Type247[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode248,@ProjectId249,@FileName250,@PlanTotal251,@ComponentName252,@ComponentCode253,@ComponentCodeP254,@Type255);select scope_identity()	
Parameters:
@SiteCode248[String] = 6373083923489249281
@ProjectId249[String] = 6372912251695766465
@FileName250[String] = tmpC635
@PlanTotal251[Int32] = 1
@ComponentName252[String] = 消火栓（箱）
@ComponentCode253[String] = L21_Z08_00GS_XF_XF_XH
@ComponentCodeP254[String] = L21_Z08_00GS_XF_XF
@Type255[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode256,@ProjectId257,@FileName258,@PlanTotal259,@ComponentName260,@ComponentCode261,@ComponentCodeP262,@Type263);select scope_identity()	
Parameters:
@SiteCode256[String] = 6373083923489249281
@ProjectId257[String] = 6372912251695766465
@FileName258[String] = tmp16
@PlanTotal259[Int32] = 3
@ComponentName260[String] = 车站风机
@ComponentCode261[String] = L21_Z08_00KT_DXT_DXT_FJ
@ComponentCodeP262[String] = L21_Z08_00KT_DXT_DXT
@Type263[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode264,@ProjectId265,@FileName266,@PlanTotal267,@ComponentName268,@ComponentCode269,@ComponentCodeP270,@Type271);select scope_identity()	
Parameters:
@SiteCode264[String] = 6373083923489249281
@ProjectId265[String] = 6372912251695766465
@FileName266[String] = tmp16
@PlanTotal267[Int32] = 1
@ComponentName268[String] = 电动风阀
@ComponentCode269[String] = L21_Z08_00KT_DXT_DXT_MD
@ComponentCodeP270[String] = L21_Z08_00KT_DXT_DXT
@Type271[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode272,@ProjectId273,@FileName274,@PlanTotal275,@ComponentName276,@ComponentCode277,@ComponentCodeP278,@Type279);select scope_identity()	
Parameters:
@SiteCode272[String] = 6373083923489249281
@ProjectId273[String] = 6372912251695766465
@FileName274[String] = tmp16
@PlanTotal275[Int32] = 1
@ComponentName276[String] = 防火阀
@ComponentCode277[String] = L21_Z08_00KT_DXT_DXT_FD
@ComponentCodeP278[String] = L21_Z08_00KT_DXT_DXT
@Type279[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode280,@ProjectId281,@FileName282,@PlanTotal283,@ComponentName284,@ComponentCode285,@ComponentCodeP286,@Type287);select scope_identity()	
Parameters:
@SiteCode280[String] = 6373083923489249281
@ProjectId281[String] = 6372912251695766465
@FileName282[String] = tmp16
@PlanTotal283[Int32] = 1
@ComponentName284[String] = 风管保温材料
@ComponentCode285[String] = L21_Z08_00KT_DXT_DXT_BWM
@ComponentCodeP286[String] = L21_Z08_00KT_DXT_DXT
@Type287[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode288,@ProjectId289,@FileName290,@PlanTotal291,@ComponentName292,@ComponentCode293,@ComponentCodeP294,@Type295);select scope_identity()	
Parameters:
@SiteCode288[String] = 6373083923489249281
@ProjectId289[String] = 6372912251695766465
@FileName290[String] = tmp16
@PlanTotal291[Int32] = 1
@ComponentName292[String] = 风口
@ComponentCode293[String] = L21_Z08_00KT_DXT_DXT_FK
@ComponentCodeP294[String] = L21_Z08_00KT_DXT_DXT
@Type295[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode296,@ProjectId297,@FileName298,@PlanTotal299,@ComponentName300,@ComponentCode301,@ComponentCodeP302,@Type303);select scope_identity()	
Parameters:
@SiteCode296[String] = 6373083923489249281
@ProjectId297[String] = 6372912251695766465
@FileName298[String] = tmp16
@PlanTotal299[Int32] = 2
@ComponentName300[String] = 管件
@ComponentCode301[String] = L21_Z08_00KT_DXT_DXT_GJ
@ComponentCodeP302[String] = L21_Z08_00KT_DXT_DXT
@Type303[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode304,@ProjectId305,@FileName306,@PlanTotal307,@ComponentName308,@ComponentCode309,@ComponentCodeP310,@Type311);select scope_identity()	
Parameters:
@SiteCode304[String] = 6373083923489249281
@ProjectId305[String] = 6372912251695766465
@FileName306[String] = tmp16
@PlanTotal307[Int32] = 1
@ComponentName308[String] = 静压箱
@ComponentCode309[String] = L21_Z08_00KT_DXT_DXT_JY
@ComponentCodeP310[String] = L21_Z08_00KT_DXT_DXT
@Type311[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode312,@ProjectId313,@FileName314,@PlanTotal315,@ComponentName316,@ComponentCode317,@ComponentCodeP318,@Type319);select scope_identity()	
Parameters:
@SiteCode312[String] = 6373083923489249281
@ProjectId313[String] = 6372912251695766465
@FileName314[String] = tmp16
@PlanTotal315[Int32] = 1
@ComponentName316[String] = 手动调节阀
@ComponentCode317[String] = L21_Z08_00KT_DXT_DXT_D
@ComponentCodeP318[String] = L21_Z08_00KT_DXT_DXT
@Type319[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode320,@ProjectId321,@FileName322,@PlanTotal323,@ComponentName324,@ComponentCode325,@ComponentCodeP326,@Type327);select scope_identity()	
Parameters:
@SiteCode320[String] = 6373083923489249281
@ProjectId321[String] = 6372912251695766465
@FileName322[String] = tmp16
@PlanTotal323[Int32] = 1
@ComponentName324[String] = 通风管道
@ComponentCode325[String] = L21_Z08_00KT_DXT_DXT_FG
@ComponentCodeP326[String] = L21_Z08_00KT_DXT_DXT
@Type327[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode328,@ProjectId329,@FileName330,@PlanTotal331,@ComponentName332,@ComponentCode333,@ComponentCodeP334,@Type335);select scope_identity()	
Parameters:
@SiteCode328[String] = 6373083923489249281
@ProjectId329[String] = 6372912251695766465
@FileName330[String] = tmp16
@PlanTotal331[Int32] = 1
@ComponentName332[String] = 消声器
@ComponentCode333[String] = L21_Z08_00KT_DXT_DXT_SIL
@ComponentCodeP334[String] = L21_Z08_00KT_DXT_DXT
@Type335[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode336,@ProjectId337,@FileName338,@PlanTotal339,@ComponentName340,@ComponentCode341,@ComponentCodeP342,@Type343);select scope_identity()	
Parameters:
@SiteCode336[String] = 6373083923489249281
@ProjectId337[String] = 6372912251695766465
@FileName338[String] = tmp16
@PlanTotal339[Int32] = 1
@ComponentName340[String] = 组合式空调机组
@ComponentCode341[String] = L21_Z08_00KT_DXT_DXT_AHU
@ComponentCodeP342[String] = L21_Z08_00KT_DXT_DXT
@Type343[Int32] = 4


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode344,@ProjectId345,@FileName346,@PlanTotal347,@ComponentName348,@ComponentCode349,@ComponentCodeP350,@Type351);select scope_identity()	
Parameters:
@SiteCode344[String] = 6373083923489249281
@ProjectId345[String] = 6372912251695766465
@FileName346[String] = tmpC635
@PlanTotal347[Int32] = 1
@ComponentName348[String] = 波纹伸缩器
@ComponentCode349[String] = L21_Z08_00GS_GS_GS_SSQ_SSQ
@ComponentCodeP350[String] = L21_Z08_00GS_GS_GS_SSQ
@Type351[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode352,@ProjectId353,@FileName354,@PlanTotal355,@ComponentName356,@ComponentCode357,@ComponentCodeP358,@Type359);select scope_identity()	
Parameters:
@SiteCode352[String] = 6373083923489249281
@ProjectId353[String] = 6372912251695766465
@FileName354[String] = tmpC635
@PlanTotal355[Int32] = 7
@ComponentName356[String] = 截止阀
@ComponentCode357[String] = L21_Z08_00GS_GS_GS_JZF_JZF
@ComponentCodeP358[String] = L21_Z08_00GS_GS_GS_JZF
@Type359[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode360,@ProjectId361,@FileName362,@PlanTotal363,@ComponentName364,@ComponentCode365,@ComponentCodeP366,@Type367);select scope_identity()	
Parameters:
@SiteCode360[String] = 6373083923489249281
@ProjectId361[String] = 6372912251695766465
@FileName362[String] = tmpC635
@PlanTotal363[Int32] = 458
@ComponentName364[String] = 水管
@ComponentCode365[String] = L21_Z08_00GS_GS_GS_SG_SG-JL
@ComponentCodeP366[String] = L21_Z08_00GS_GS_GS_SG
@Type367[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode368,@ProjectId369,@FileName370,@PlanTotal371,@ComponentName372,@ComponentCode373,@ComponentCodeP374,@Type375);select scope_identity()	
Parameters:
@SiteCode368[String] = 6373083923489249281
@ProjectId369[String] = 6372912251695766465
@FileName370[String] = tmpC635
@PlanTotal371[Int32] = 5
@ComponentName372[String] = 水龙头
@ComponentCode373[String] = L21_Z08_00GS_GS_GS_SLT_SLT
@ComponentCodeP374[String] = L21_Z08_00GS_GS_GS_SLT
@Type375[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode376,@ProjectId377,@FileName378,@PlanTotal379,@ComponentName380,@ComponentCode381,@ComponentCodeP382,@Type383);select scope_identity()	
Parameters:
@SiteCode376[String] = 6373083923489249281
@ProjectId377[String] = 6372912251695766465
@FileName378[String] = tmpC635
@PlanTotal379[Int32] = 31
@ComponentName380[String] = 地漏
@ComponentCode381[String] = L21_Z08_00GS_PS_PS_DL_DL-FL
@ComponentCodeP382[String] = L21_Z08_00GS_PS_PS_DL
@Type383[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode384,@ProjectId385,@FileName386,@PlanTotal387,@ComponentName388,@ComponentCode389,@ComponentCodeP390,@Type391);select scope_identity()	
Parameters:
@SiteCode384[String] = 6373083923489249281
@ProjectId385[String] = 6372912251695766465
@FileName386[String] = tmpC635
@PlanTotal387[Int32] = 2
@ComponentName388[String] = 金属伸缩节
@ComponentCode389[String] = L21_Z08_00GS_PS_PS_SSJ_SSJ
@ComponentCodeP390[String] = L21_Z08_00GS_PS_PS_SSJ
@Type391[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode392,@ProjectId393,@FileName394,@PlanTotal395,@ComponentName396,@ComponentCode397,@ComponentCodeP398,@Type399);select scope_identity()	
Parameters:
@SiteCode392[String] = 6373083923489249281
@ProjectId393[String] = 6372912251695766465
@FileName394[String] = tmpC635
@PlanTotal395[Int32] = 10
@ComponentName396[String] = 可曲挠橡胶接头
@ComponentCode397[String] = L21_Z08_00GS_PS_PS_JJT_JJT-B-F-21408-9
@ComponentCodeP398[String] = L21_Z08_00GS_PS_PS_JJT
@Type399[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode400,@ProjectId401,@FileName402,@PlanTotal403,@ComponentName404,@ComponentCode405,@ComponentCodeP406,@Type407);select scope_identity()	
Parameters:
@SiteCode400[String] = 6373083923489249281
@ProjectId401[String] = 6372912251695766465
@FileName402[String] = tmpC635
@PlanTotal403[Int32] = 11
@ComponentName404[String] = 潜污泵
@ComponentCode405[String] = L21_Z08_00GS_PS_PS_QWB_B-W-21408-1
@ComponentCodeP406[String] = L21_Z08_00GS_PS_PS_QWB
@Type407[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode408,@ProjectId409,@FileName410,@PlanTotal411,@ComponentName412,@ComponentCode413,@ComponentCodeP414,@Type415);select scope_identity()	
Parameters:
@SiteCode408[String] = 6373083923489249281
@ProjectId409[String] = 6372912251695766465
@FileName410[String] = tmpC635
@PlanTotal411[Int32] = 680
@ComponentName412[String] = 水管
@ComponentCode413[String] = L21_Z08_00GS_PS_PS_SG_SG-YWL
@ComponentCodeP414[String] = L21_Z08_00GS_PS_PS_SG
@Type415[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode416,@ProjectId417,@FileName418,@PlanTotal419,@ComponentName420,@ComponentCode421,@ComponentCodeP422,@Type423);select scope_identity()	
Parameters:
@SiteCode416[String] = 6373083923489249281
@ProjectId417[String] = 6372912251695766465
@FileName418[String] = tmpC635
@PlanTotal419[Int32] = 153
@ComponentName420[String] = 污水提升装置
@ComponentCode421[String] = L21_Z08_00GS_PS_PS_TSQ_TSQ
@ComponentCodeP422[String] = L21_Z08_00GS_PS_PS_TSQ
@Type423[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode424,@ProjectId425,@FileName426,@PlanTotal427,@ComponentName428,@ComponentCode429,@ComponentCodeP430,@Type431);select scope_identity()	
Parameters:
@SiteCode424[String] = 6373083923489249281
@ProjectId425[String] = 6372912251695766465
@FileName426[String] = tmpC635
@PlanTotal427[Int32] = 10
@ComponentName428[String] = 压力表
@ComponentCode429[String] = L21_Z08_00GS_PS_PS_YLB_YLB-B-F-21408-9
@ComponentCodeP430[String] = L21_Z08_00GS_PS_PS_YLB
@Type431[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode432,@ProjectId433,@FileName434,@PlanTotal435,@ComponentName436,@ComponentCode437,@ComponentCodeP438,@Type439);select scope_identity()	
Parameters:
@SiteCode432[String] = 6373083923489249281
@ProjectId433[String] = 6372912251695766465
@FileName434[String] = tmpC635
@PlanTotal435[Int32] = 21
@ComponentName436[String] = 闸阀
@ComponentCode437[String] = L21_Z08_00GS_PS_PS_ZF_ZF
@ComponentCodeP438[String] = L21_Z08_00GS_PS_PS_ZF
@Type439[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode440,@ProjectId441,@FileName442,@PlanTotal443,@ComponentName444,@ComponentCode445,@ComponentCodeP446,@Type447);select scope_identity()	
Parameters:
@SiteCode440[String] = 6373083923489249281
@ProjectId441[String] = 6372912251695766465
@FileName442[String] = tmpC635
@PlanTotal443[Int32] = 14
@ComponentName444[String] = 止回阀
@ComponentCode445[String] = L21_Z08_00GS_PS_PS_ZHF_ZHF
@ComponentCodeP446[String] = L21_Z08_00GS_PS_PS_ZHF
@Type447[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode448,@ProjectId449,@FileName450,@PlanTotal451,@ComponentName452,@ComponentCode453,@ComponentCodeP454,@Type455);select scope_identity()	
Parameters:
@SiteCode448[String] = 6373083923489249281
@ProjectId449[String] = 6372912251695766465
@FileName450[String] = tmpC635
@PlanTotal451[Int32] = 24
@ComponentName452[String] = 手动蝶阀
@ComponentCode453[String] = L21_Z08_00GS_XF_XF_DF_SDF
@ComponentCodeP454[String] = L21_Z08_00GS_XF_XF_DF
@Type455[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode456,@ProjectId457,@FileName458,@PlanTotal459,@ComponentName460,@ComponentCode461,@ComponentCodeP462,@Type463);select scope_identity()	
Parameters:
@SiteCode456[String] = 6373083923489249281
@ProjectId457[String] = 6372912251695766465
@FileName458[String] = tmpC635
@PlanTotal459[Int32] = 10
@ComponentName460[String] = 金属伸缩节
@ComponentCode461[String] = L21_Z08_00GS_XF_XF_SSJ_SSJ
@ComponentCodeP462[String] = L21_Z08_00GS_XF_XF_SSJ
@Type463[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode464,@ProjectId465,@FileName466,@PlanTotal467,@ComponentName468,@ComponentCode469,@ComponentCodeP470,@Type471);select scope_identity()	
Parameters:
@SiteCode464[String] = 6373083923489249281
@ProjectId465[String] = 6372912251695766465
@FileName466[String] = tmpC635
@PlanTotal467[Int32] = 4
@ComponentName468[String] = 可曲挠橡胶接头
@ComponentCode469[String] = L21_Z08_00GS_XF_XF_JJT_JJT
@ComponentCodeP470[String] = L21_Z08_00GS_XF_XF_JJT
@Type471[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode472,@ProjectId473,@FileName474,@PlanTotal475,@ComponentName476,@ComponentCode477,@ComponentCodeP478,@Type479);select scope_identity()	
Parameters:
@SiteCode472[String] = 6373083923489249281
@ProjectId473[String] = 6372912251695766465
@FileName474[String] = tmpC635
@PlanTotal475[Int32] = 51
@ComponentName476[String] = 灭火器（箱）
@ComponentCode477[String] = L21_Z08_00GS_XF_XF_MH_MH-
@ComponentCodeP478[String] = L21_Z08_00GS_XF_XF_MH
@Type479[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode480,@ProjectId481,@FileName482,@PlanTotal483,@ComponentName484,@ComponentCode485,@ComponentCodeP486,@Type487);select scope_identity()	
Parameters:
@SiteCode480[String] = 6373083923489249281
@ProjectId481[String] = 6372912251695766465
@FileName482[String] = tmpC635
@PlanTotal483[Int32] = 805
@ComponentName484[String] = 水管
@ComponentCode485[String] = L21_Z08_00GS_XF_XF_SG_SG-XHL
@ComponentCodeP486[String] = L21_Z08_00GS_XF_XF_SG
@Type487[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode488,@ProjectId489,@FileName490,@PlanTotal491,@ComponentName492,@ComponentCode493,@ComponentCodeP494,@Type495);select scope_identity()	
Parameters:
@SiteCode488[String] = 6373083923489249281
@ProjectId489[String] = 6372912251695766465
@FileName490[String] = tmpC635
@PlanTotal491[Int32] = 40
@ComponentName492[String] = 室内消火栓箱
@ComponentCode493[String] = L21_Z08_00GS_XF_XF_XH_XH-
@ComponentCodeP494[String] = L21_Z08_00GS_XF_XF_XH
@Type495[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode496,@ProjectId497,@FileName498,@PlanTotal499,@ComponentName500,@ComponentCode501,@ComponentCodeP502,@Type503);select scope_identity()	
Parameters:
@SiteCode496[String] = 6373083923489249281
@ProjectId497[String] = 6372912251695766465
@FileName498[String] = tmp16
@PlanTotal499[Int32] = 2
@ComponentName500[String] = 回排风机
@ComponentCode501[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCodeP502[String] = L21_Z08_00KT_DXT_DXT_FJ
@Type503[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode504,@ProjectId505,@FileName506,@PlanTotal507,@ComponentName508,@ComponentCode509,@ComponentCodeP510,@Type511);select scope_identity()	
Parameters:
@SiteCode504[String] = 6373083923489249281
@ProjectId505[String] = 6372912251695766465
@FileName506[String] = tmp16
@PlanTotal507[Int32] = 2
@ComponentName508[String] = 排烟风机
@ComponentCode509[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCodeP510[String] = L21_Z08_00KT_DXT_DXT_FJ
@Type511[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode512,@ProjectId513,@FileName514,@PlanTotal515,@ComponentName516,@ComponentCode517,@ComponentCodeP518,@Type519);select scope_identity()	
Parameters:
@SiteCode512[String] = 6373083923489249281
@ProjectId513[String] = 6372912251695766465
@FileName514[String] = tmp16
@PlanTotal515[Int32] = 2
@ComponentName516[String] = 新风机
@ComponentCode517[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@ComponentCodeP518[String] = L21_Z08_00KT_DXT_DXT_FJ
@Type519[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode520,@ProjectId521,@FileName522,@PlanTotal523,@ComponentName524,@ComponentCode525,@ComponentCodeP526,@Type527);select scope_identity()	
Parameters:
@SiteCode520[String] = 6373083923489249281
@ProjectId521[String] = 6372912251695766465
@FileName522[String] = tmp16
@PlanTotal523[Int32] = 13
@ComponentName524[String] = 电动风阀
@ComponentCode525[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCodeP526[String] = L21_Z08_00KT_DXT_DXT_MD
@Type527[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode528,@ProjectId529,@FileName530,@PlanTotal531,@ComponentName532,@ComponentCode533,@ComponentCodeP534,@Type535);select scope_identity()	
Parameters:
@SiteCode528[String] = 6373083923489249281
@ProjectId529[String] = 6372912251695766465
@FileName530[String] = tmp16
@PlanTotal531[Int32] = 16
@ComponentName532[String] = 防火阀
@ComponentCode533[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B0
@ComponentCodeP534[String] = L21_Z08_00KT_DXT_DXT_FD
@Type535[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode536,@ProjectId537,@FileName538,@PlanTotal539,@ComponentName540,@ComponentCode541,@ComponentCodeP542,@Type543);select scope_identity()	
Parameters:
@SiteCode536[String] = 6373083923489249281
@ProjectId537[String] = 6372912251695766465
@FileName538[String] = tmp16
@PlanTotal539[Int32] = 1280
@ComponentName540[String] = 风管保温材料
@ComponentCode541[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@ComponentCodeP542[String] = L21_Z08_00KT_DXT_DXT_BWM
@Type543[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode544,@ProjectId545,@FileName546,@PlanTotal547,@ComponentName548,@ComponentCode549,@ComponentCodeP550,@Type551);select scope_identity()	
Parameters:
@SiteCode544[String] = 6373083923489249281
@ProjectId545[String] = 6372912251695766465
@FileName546[String] = tmp16
@PlanTotal547[Int32] = 112
@ComponentName548[String] = 风口
@ComponentCode549[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCodeP550[String] = L21_Z08_00KT_DXT_DXT_FK
@Type551[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode552,@ProjectId553,@FileName554,@PlanTotal555,@ComponentName556,@ComponentCode557,@ComponentCodeP558,@Type559);select scope_identity()	
Parameters:
@SiteCode552[String] = 6373083923489249281
@ProjectId553[String] = 6372912251695766465
@FileName554[String] = tmp16
@PlanTotal555[Int32] = 575
@ComponentName556[String] = 过度件
@ComponentCode557[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCodeP558[String] = L21_Z08_00KT_DXT_DXT_GJ
@Type559[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode560,@ProjectId561,@FileName562,@PlanTotal563,@ComponentName564,@ComponentCode565,@ComponentCodeP566,@Type567);select scope_identity()	
Parameters:
@SiteCode560[String] = 6373083923489249281
@ProjectId561[String] = 6372912251695766465
@FileName562[String] = tmp16
@PlanTotal563[Int32] = 36
@ComponentName564[String] = 弯头
@ComponentCode565[String] = L21_Z08_00KT_DXT_DXT_GJ_WT
@ComponentCodeP566[String] = L21_Z08_00KT_DXT_DXT_GJ
@Type567[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode568,@ProjectId569,@FileName570,@PlanTotal571,@ComponentName572,@ComponentCode573,@ComponentCodeP574,@Type575);select scope_identity()	
Parameters:
@SiteCode568[String] = 6373083923489249281
@ProjectId569[String] = 6372912251695766465
@FileName570[String] = tmp16
@PlanTotal571[Int32] = 4
@ComponentName572[String] = 静压箱
@ComponentCode573[String] = L21_Z08_00KT_DXT_DXT_JY_JY
@ComponentCodeP574[String] = L21_Z08_00KT_DXT_DXT_JY
@Type575[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode576,@ProjectId577,@FileName578,@PlanTotal579,@ComponentName580,@ComponentCode581,@ComponentCodeP582,@Type583);select scope_identity()	
Parameters:
@SiteCode576[String] = 6373083923489249281
@ProjectId577[String] = 6372912251695766465
@FileName578[String] = tmp16
@PlanTotal579[Int32] = 12
@ComponentName580[String] = 手动调节阀
@ComponentCode581[String] = L21_Z08_00KT_DXT_DXT_D_D
@ComponentCodeP582[String] = L21_Z08_00KT_DXT_DXT_D
@Type583[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode584,@ProjectId585,@FileName586,@PlanTotal587,@ComponentName588,@ComponentCode589,@ComponentCodeP590,@Type591);select scope_identity()	
Parameters:
@SiteCode584[String] = 6373083923489249281
@ProjectId585[String] = 6372912251695766465
@FileName586[String] = tmp16
@PlanTotal587[Int32] = 670
@ComponentName588[String] = 通风管道
@ComponentCode589[String] = L21_Z08_00KT_DXT_DXT_FG_FG
@ComponentCodeP590[String] = L21_Z08_00KT_DXT_DXT_FG
@Type591[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode592,@ProjectId593,@FileName594,@PlanTotal595,@ComponentName596,@ComponentCode597,@ComponentCodeP598,@Type599);select scope_identity()	
Parameters:
@SiteCode592[String] = 6373083923489249281
@ProjectId593[String] = 6372912251695766465
@FileName594[String] = tmp16
@PlanTotal595[Int32] = 2
@ComponentName596[String] = 消声器
@ComponentCode597[String] = L21_Z08_00KT_DXT_DXT_SIL_SIL
@ComponentCodeP598[String] = L21_Z08_00KT_DXT_DXT_SIL
@Type599[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:20
Text:	INSERT INTO [TbModelReporte] ([SiteCode],[ProjectId],[FileName],[PlanTotal],[ComponentName],[ComponentCode],[ComponentCodeP],[Type]) VALUES (@SiteCode600,@ProjectId601,@FileName602,@PlanTotal603,@ComponentName604,@ComponentCode605,@ComponentCodeP606,@Type607);select scope_identity()	
Parameters:
@SiteCode600[String] = 6373083923489249281
@ProjectId601[String] = 6372912251695766465
@FileName602[String] = tmp16
@PlanTotal603[Int32] = 2
@ComponentName604[String] = 组合式空调机组
@ComponentCode605[String] = L21_Z08_00KT_DXT_DXT_AHU_AHU
@ComponentCodeP606[String] = L21_Z08_00KT_DXT_DXT_AHU
@Type607[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-26 17:33:37
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-26 17:33:37
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:37
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:37
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName,count(*) as Total
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	 SELECT   * FROM [TbModelReporte]  WHERE [TbModelReporte].[SiteCode] = @SiteCode608 	
Parameters:
@SiteCode608[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal610 WHERE [TbModelReporte].[ID] = @ID609	
Parameters:
@PlanTotal610[Int32] = 19
@ID609[Int32] = 101


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal612 WHERE [TbModelReporte].[ID] = @ID611	
Parameters:
@PlanTotal612[Int32] = 14
@ID611[Int32] = 102


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal614 WHERE [TbModelReporte].[ID] = @ID613	
Parameters:
@PlanTotal614[Int32] = 4
@ID613[Int32] = 103


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal616 WHERE [TbModelReporte].[ID] = @ID615	
Parameters:
@PlanTotal616[Int32] = 9
@ID615[Int32] = 104


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal618 WHERE [TbModelReporte].[ID] = @ID617	
Parameters:
@PlanTotal618[Int32] = 6
@ID617[Int32] = 105


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal620 WHERE [TbModelReporte].[ID] = @ID619	
Parameters:
@PlanTotal620[Int32] = 14
@ID619[Int32] = 106


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal622 WHERE [TbModelReporte].[ID] = @ID621	
Parameters:
@PlanTotal622[Int32] = 4
@ID621[Int32] = 107


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal624 WHERE [TbModelReporte].[ID] = @ID623	
Parameters:
@PlanTotal624[Int32] = 9
@ID623[Int32] = 108


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal626 WHERE [TbModelReporte].[ID] = @ID625	
Parameters:
@PlanTotal626[Int32] = 6
@ID625[Int32] = 109


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal628 WHERE [TbModelReporte].[ID] = @ID627	
Parameters:
@PlanTotal628[Int32] = 14
@ID627[Int32] = 110


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal630 WHERE [TbModelReporte].[ID] = @ID629	
Parameters:
@PlanTotal630[Int32] = 1
@ID629[Int32] = 111


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal632 WHERE [TbModelReporte].[ID] = @ID631	
Parameters:
@PlanTotal632[Int32] = 1
@ID631[Int32] = 112


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal634 WHERE [TbModelReporte].[ID] = @ID633	
Parameters:
@PlanTotal634[Int32] = 1
@ID633[Int32] = 113


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal636 WHERE [TbModelReporte].[ID] = @ID635	
Parameters:
@PlanTotal636[Int32] = 1
@ID635[Int32] = 114


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal638 WHERE [TbModelReporte].[ID] = @ID637	
Parameters:
@PlanTotal638[Int32] = 1
@ID637[Int32] = 115


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal640 WHERE [TbModelReporte].[ID] = @ID639	
Parameters:
@PlanTotal640[Int32] = 1
@ID639[Int32] = 116


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal642 WHERE [TbModelReporte].[ID] = @ID641	
Parameters:
@PlanTotal642[Int32] = 1
@ID641[Int32] = 117


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal644 WHERE [TbModelReporte].[ID] = @ID643	
Parameters:
@PlanTotal644[Int32] = 1
@ID643[Int32] = 118


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal646 WHERE [TbModelReporte].[ID] = @ID645	
Parameters:
@PlanTotal646[Int32] = 1
@ID645[Int32] = 119


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal648 WHERE [TbModelReporte].[ID] = @ID647	
Parameters:
@PlanTotal648[Int32] = 1
@ID647[Int32] = 120


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal650 WHERE [TbModelReporte].[ID] = @ID649	
Parameters:
@PlanTotal650[Int32] = 1
@ID649[Int32] = 121


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal652 WHERE [TbModelReporte].[ID] = @ID651	
Parameters:
@PlanTotal652[Int32] = 1
@ID651[Int32] = 122


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal654 WHERE [TbModelReporte].[ID] = @ID653	
Parameters:
@PlanTotal654[Int32] = 1
@ID653[Int32] = 123


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal656 WHERE [TbModelReporte].[ID] = @ID655	
Parameters:
@PlanTotal656[Int32] = 1
@ID655[Int32] = 124


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal658 WHERE [TbModelReporte].[ID] = @ID657	
Parameters:
@PlanTotal658[Int32] = 1
@ID657[Int32] = 125


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal660 WHERE [TbModelReporte].[ID] = @ID659	
Parameters:
@PlanTotal660[Int32] = 1
@ID659[Int32] = 126


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal662 WHERE [TbModelReporte].[ID] = @ID661	
Parameters:
@PlanTotal662[Int32] = 1
@ID661[Int32] = 127


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal664 WHERE [TbModelReporte].[ID] = @ID663	
Parameters:
@PlanTotal664[Int32] = 1
@ID663[Int32] = 128


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal666 WHERE [TbModelReporte].[ID] = @ID665	
Parameters:
@PlanTotal666[Int32] = 1
@ID665[Int32] = 129


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal668 WHERE [TbModelReporte].[ID] = @ID667	
Parameters:
@PlanTotal668[Int32] = 3
@ID667[Int32] = 130


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal670 WHERE [TbModelReporte].[ID] = @ID669	
Parameters:
@PlanTotal670[Int32] = 1
@ID669[Int32] = 131


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal672 WHERE [TbModelReporte].[ID] = @ID671	
Parameters:
@PlanTotal672[Int32] = 1
@ID671[Int32] = 132


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal674 WHERE [TbModelReporte].[ID] = @ID673	
Parameters:
@PlanTotal674[Int32] = 1
@ID673[Int32] = 133


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal676 WHERE [TbModelReporte].[ID] = @ID675	
Parameters:
@PlanTotal676[Int32] = 1
@ID675[Int32] = 134


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal678 WHERE [TbModelReporte].[ID] = @ID677	
Parameters:
@PlanTotal678[Int32] = 2
@ID677[Int32] = 135


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal680 WHERE [TbModelReporte].[ID] = @ID679	
Parameters:
@PlanTotal680[Int32] = 1
@ID679[Int32] = 136


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal682 WHERE [TbModelReporte].[ID] = @ID681	
Parameters:
@PlanTotal682[Int32] = 1
@ID681[Int32] = 137


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal684 WHERE [TbModelReporte].[ID] = @ID683	
Parameters:
@PlanTotal684[Int32] = 1
@ID683[Int32] = 138


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal686 WHERE [TbModelReporte].[ID] = @ID685	
Parameters:
@PlanTotal686[Int32] = 1
@ID685[Int32] = 139


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal688 WHERE [TbModelReporte].[ID] = @ID687	
Parameters:
@PlanTotal688[Int32] = 1
@ID687[Int32] = 140


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal690 WHERE [TbModelReporte].[ID] = @ID689	
Parameters:
@PlanTotal690[Int32] = 1
@ID689[Int32] = 141


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal692 WHERE [TbModelReporte].[ID] = @ID691	
Parameters:
@PlanTotal692[Int32] = 7
@ID691[Int32] = 142


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal694 WHERE [TbModelReporte].[ID] = @ID693	
Parameters:
@PlanTotal694[Int32] = 458
@ID693[Int32] = 143


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal696 WHERE [TbModelReporte].[ID] = @ID695	
Parameters:
@PlanTotal696[Int32] = 5
@ID695[Int32] = 144


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal698 WHERE [TbModelReporte].[ID] = @ID697	
Parameters:
@PlanTotal698[Int32] = 31
@ID697[Int32] = 145


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal700 WHERE [TbModelReporte].[ID] = @ID699	
Parameters:
@PlanTotal700[Int32] = 2
@ID699[Int32] = 146


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal702 WHERE [TbModelReporte].[ID] = @ID701	
Parameters:
@PlanTotal702[Int32] = 10
@ID701[Int32] = 147


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal704 WHERE [TbModelReporte].[ID] = @ID703	
Parameters:
@PlanTotal704[Int32] = 11
@ID703[Int32] = 148


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal706 WHERE [TbModelReporte].[ID] = @ID705	
Parameters:
@PlanTotal706[Int32] = 680
@ID705[Int32] = 149


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal708 WHERE [TbModelReporte].[ID] = @ID707	
Parameters:
@PlanTotal708[Int32] = 153
@ID707[Int32] = 150


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal710 WHERE [TbModelReporte].[ID] = @ID709	
Parameters:
@PlanTotal710[Int32] = 10
@ID709[Int32] = 151


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal712 WHERE [TbModelReporte].[ID] = @ID711	
Parameters:
@PlanTotal712[Int32] = 21
@ID711[Int32] = 152


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal714 WHERE [TbModelReporte].[ID] = @ID713	
Parameters:
@PlanTotal714[Int32] = 14
@ID713[Int32] = 153


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal716 WHERE [TbModelReporte].[ID] = @ID715	
Parameters:
@PlanTotal716[Int32] = 24
@ID715[Int32] = 154


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal718 WHERE [TbModelReporte].[ID] = @ID717	
Parameters:
@PlanTotal718[Int32] = 10
@ID717[Int32] = 155


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal720 WHERE [TbModelReporte].[ID] = @ID719	
Parameters:
@PlanTotal720[Int32] = 4
@ID719[Int32] = 156


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal722 WHERE [TbModelReporte].[ID] = @ID721	
Parameters:
@PlanTotal722[Int32] = 51
@ID721[Int32] = 157


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal724 WHERE [TbModelReporte].[ID] = @ID723	
Parameters:
@PlanTotal724[Int32] = 805
@ID723[Int32] = 158


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal726 WHERE [TbModelReporte].[ID] = @ID725	
Parameters:
@PlanTotal726[Int32] = 40
@ID725[Int32] = 159


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal728 WHERE [TbModelReporte].[ID] = @ID727	
Parameters:
@PlanTotal728[Int32] = 2
@ID727[Int32] = 160


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal730 WHERE [TbModelReporte].[ID] = @ID729	
Parameters:
@PlanTotal730[Int32] = 2
@ID729[Int32] = 161


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal732 WHERE [TbModelReporte].[ID] = @ID731	
Parameters:
@PlanTotal732[Int32] = 2
@ID731[Int32] = 162


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal734 WHERE [TbModelReporte].[ID] = @ID733	
Parameters:
@PlanTotal734[Int32] = 13
@ID733[Int32] = 163


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal736 WHERE [TbModelReporte].[ID] = @ID735	
Parameters:
@PlanTotal736[Int32] = 16
@ID735[Int32] = 164


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal738 WHERE [TbModelReporte].[ID] = @ID737	
Parameters:
@PlanTotal738[Int32] = 1280
@ID737[Int32] = 165


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal740 WHERE [TbModelReporte].[ID] = @ID739	
Parameters:
@PlanTotal740[Int32] = 112
@ID739[Int32] = 166


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal742 WHERE [TbModelReporte].[ID] = @ID741	
Parameters:
@PlanTotal742[Int32] = 575
@ID741[Int32] = 167


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal744 WHERE [TbModelReporte].[ID] = @ID743	
Parameters:
@PlanTotal744[Int32] = 36
@ID743[Int32] = 168


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal746 WHERE [TbModelReporte].[ID] = @ID745	
Parameters:
@PlanTotal746[Int32] = 4
@ID745[Int32] = 169


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal748 WHERE [TbModelReporte].[ID] = @ID747	
Parameters:
@PlanTotal748[Int32] = 12
@ID747[Int32] = 170


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal750 WHERE [TbModelReporte].[ID] = @ID749	
Parameters:
@PlanTotal750[Int32] = 670
@ID749[Int32] = 171


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal752 WHERE [TbModelReporte].[ID] = @ID751	
Parameters:
@PlanTotal752[Int32] = 2
@ID751[Int32] = 172


-----------------------------------------------------------------------------
2020-08-26 17:33:38
Text:	UPDATE [TbModelReporte] SET [PlanTotal]=@PlanTotal754 WHERE [TbModelReporte].[ID] = @ID753	
Parameters:
@PlanTotal754[Int32] = 2
@ID753[Int32] = 173


-----------------------------------------------------------------------------
2020-08-26 17:33:40
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-26 17:36:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-26 17:44:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
