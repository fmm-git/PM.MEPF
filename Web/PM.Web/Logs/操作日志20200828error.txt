2020-08-28 09:37:43
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-28 09:37:43
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 09:37:43
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 09:37:43
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 09:37:43
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 09:37:43
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/28 9:37:43
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-28 09:37:45
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 09:37:45
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 09:37:45
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 09:37:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 09:37:47
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 09:37:47
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-28 09:37:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-28 09:37:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-28 09:37:47
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 09:37:48
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 09:40:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:43:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:46:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:49:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:52:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:55:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 09:58:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:01:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:04:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:07:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:10:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:13:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:16:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:19:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:22:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:25:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type32) AND ([TbOrganizationMap].[ProjectId] = @ProjectId33)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode34,@CompanyCode35,@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode42))) 	
Parameters:
@Type32[Int32] = 1
@ProjectId33[String] = 6372912251695766465
@CompanyCode34[String] = 6373083923489249281
@CompanyCode35[String] = 6373083925531366080
@CompanyCode36[String] = 6373083927883400612
@CompanyCode37[String] = 6373083918575368225
@CompanyCode38[String] = 6373083920445075162
@CompanyCode39[String] = 6373083908618598731
@CompanyCode40[String] = 6373083911842783146
@CompanyCode41[String] = 6373083913928202424
@ParentCompanyCode42[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type43) AND ([TbOrganizationMap].[ProjectId] = @ProjectId44)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode45,@CompanyCode46,@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode53))) 	
Parameters:
@Type43[Int32] = 2
@ProjectId44[String] = 6372912251695766465
@CompanyCode45[String] = 6373083923489249281
@CompanyCode46[String] = 6373083925531366080
@CompanyCode47[String] = 6373083927883400612
@CompanyCode48[String] = 6373083918575368225
@CompanyCode49[String] = 6373083920445075162
@CompanyCode50[String] = 6373083908618598731
@CompanyCode51[String] = 6373083911842783146
@CompanyCode52[String] = 6373083913928202424
@ParentCompanyCode53[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode82)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId54) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59,@SiteCode60,@SiteCode61,@SiteCode62,@SiteCode63,@SiteCode64,@SiteCode65,@SiteCode66,@SiteCode67,@SiteCode68,@SiteCode69,@SiteCode70,@SiteCode71,@SiteCode72,@SiteCode73,@SiteCode74,@SiteCode75,@SiteCode76,@SiteCode77,@SiteCode78,@SiteCode79,@SiteCode80,@SiteCode81)))	
Parameters:
@ProjectId54[String] = 6372912251695766465
@SiteCode55[String] = 6373083923489249281
@SiteCode56[String] = 6373083925531366080
@SiteCode57[String] = 6373083927883400612
@SiteCode58[String] = 6373083918575368225
@SiteCode59[String] = 6373083920445075162
@SiteCode60[String] = 6373083908618598731
@SiteCode61[String] = 6373083911842783146
@SiteCode62[String] = 6373083913928202424
@SiteCode63[String] = 6373083877551621804
@SiteCode64[String] = 6373083879921857377
@SiteCode65[String] = 6373083881542550067
@SiteCode66[String] = 6373083883689772886
@SiteCode67[String] = 6373083887136270013
@SiteCode68[String] = 6373083889697116488
@SiteCode69[String] = 6373083891969846476
@SiteCode70[String] = 6373083894422586761
@SiteCode71[String] = 6373083897509963358
@SiteCode72[String] = 6373083900444931227
@SiteCode73[String] = 6373083829464571372
@SiteCode74[String] = 6373083833327492328
@SiteCode75[String] = 6373083841964286321
@SiteCode76[String] = 6373083844982558950
@SiteCode77[String] = 6373083847585007801
@SiteCode78[String] = 6373083856887939900
@SiteCode79[String] = 6373083859102666584
@SiteCode80[String] = 6373083864919499284
@SiteCode81[String] = 6373334974514214221
@FDictionaryCode82[String] = OrderState
@FDictionaryCode83[String] = UrgentDegree
@FDictionaryCode84[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:35
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode83) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode84) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode82)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId54) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59,@SiteCode60,@SiteCode61,@SiteCode62,@SiteCode63,@SiteCode64,@SiteCode65,@SiteCode66,@SiteCode67,@SiteCode68,@SiteCode69,@SiteCode70,@SiteCode71,@SiteCode72,@SiteCode73,@SiteCode74,@SiteCode75,@SiteCode76,@SiteCode77,@SiteCode78,@SiteCode79,@SiteCode80,@SiteCode81))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId54[String] = 6372912251695766465
@SiteCode55[String] = 6373083923489249281
@SiteCode56[String] = 6373083925531366080
@SiteCode57[String] = 6373083927883400612
@SiteCode58[String] = 6373083918575368225
@SiteCode59[String] = 6373083920445075162
@SiteCode60[String] = 6373083908618598731
@SiteCode61[String] = 6373083911842783146
@SiteCode62[String] = 6373083913928202424
@SiteCode63[String] = 6373083877551621804
@SiteCode64[String] = 6373083879921857377
@SiteCode65[String] = 6373083881542550067
@SiteCode66[String] = 6373083883689772886
@SiteCode67[String] = 6373083887136270013
@SiteCode68[String] = 6373083889697116488
@SiteCode69[String] = 6373083891969846476
@SiteCode70[String] = 6373083894422586761
@SiteCode71[String] = 6373083897509963358
@SiteCode72[String] = 6373083900444931227
@SiteCode73[String] = 6373083829464571372
@SiteCode74[String] = 6373083833327492328
@SiteCode75[String] = 6373083841964286321
@SiteCode76[String] = 6373083844982558950
@SiteCode77[String] = 6373083847585007801
@SiteCode78[String] = 6373083856887939900
@SiteCode79[String] = 6373083859102666584
@SiteCode80[String] = 6373083864919499284
@SiteCode81[String] = 6373334974514214221
@FDictionaryCode82[String] = OrderState
@FDictionaryCode83[String] = UrgentDegree
@FDictionaryCode84[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	 SELECT count(*) as r_cnt FROM [TbProblemOrder] LEFT OUTER JOIN [TbUser] ON ([TbProblemOrder].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbCompany] ON ([TbProblemOrder].[SiteCode] = [TbCompany].[CompanyCode]) WHERE ((([TbProblemOrder].[SiteCode] IN (@SiteCode85,@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111)) AND ([TbProblemOrder].[ProcessFactoryCode] = @ProcessFactoryCode112)) AND ([TbProblemOrder].[ProjectId] = @ProjectId113))	
Parameters:
@SiteCode85[String] = 6373083923489249281
@SiteCode86[String] = 6373083925531366080
@SiteCode87[String] = 6373083927883400612
@SiteCode88[String] = 6373083918575368225
@SiteCode89[String] = 6373083920445075162
@SiteCode90[String] = 6373083908618598731
@SiteCode91[String] = 6373083911842783146
@SiteCode92[String] = 6373083913928202424
@SiteCode93[String] = 6373083877551621804
@SiteCode94[String] = 6373083879921857377
@SiteCode95[String] = 6373083881542550067
@SiteCode96[String] = 6373083883689772886
@SiteCode97[String] = 6373083887136270013
@SiteCode98[String] = 6373083889697116488
@SiteCode99[String] = 6373083891969846476
@SiteCode100[String] = 6373083894422586761
@SiteCode101[String] = 6373083897509963358
@SiteCode102[String] = 6373083900444931227
@SiteCode103[String] = 6373083829464571372
@SiteCode104[String] = 6373083833327492328
@SiteCode105[String] = 6373083841964286321
@SiteCode106[String] = 6373083844982558950
@SiteCode107[String] = 6373083847585007801
@SiteCode108[String] = 6373083856887939900
@SiteCode109[String] = 6373083859102666584
@SiteCode110[String] = 6373083864919499284
@SiteCode111[String] = 6373334974514214221
@ProcessFactoryCode112[String] = 6372982160979097303
@ProjectId113[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	 SELECT   TOP 50 [TbProblemOrder].*,[TbProblemOrder].[Examinestatus] AS [ExaminestatusNew],[TbUser].[UserName],[TbCompany].[CompanyFullName] AS [SiteName] FROM [TbProblemOrder] LEFT OUTER JOIN [TbUser] ON ([TbProblemOrder].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbCompany] ON ([TbProblemOrder].[SiteCode] = [TbCompany].[CompanyCode])  WHERE ((([TbProblemOrder].[SiteCode] IN (@SiteCode85,@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111)) AND ([TbProblemOrder].[ProcessFactoryCode] = @ProcessFactoryCode112)) AND ([TbProblemOrder].[ProjectId] = @ProjectId113)) ORDER BY [TbProblemOrder].[ID] DESC 	
Parameters:
@SiteCode85[String] = 6373083923489249281
@SiteCode86[String] = 6373083925531366080
@SiteCode87[String] = 6373083927883400612
@SiteCode88[String] = 6373083918575368225
@SiteCode89[String] = 6373083920445075162
@SiteCode90[String] = 6373083908618598731
@SiteCode91[String] = 6373083911842783146
@SiteCode92[String] = 6373083913928202424
@SiteCode93[String] = 6373083877551621804
@SiteCode94[String] = 6373083879921857377
@SiteCode95[String] = 6373083881542550067
@SiteCode96[String] = 6373083883689772886
@SiteCode97[String] = 6373083887136270013
@SiteCode98[String] = 6373083889697116488
@SiteCode99[String] = 6373083891969846476
@SiteCode100[String] = 6373083894422586761
@SiteCode101[String] = 6373083897509963358
@SiteCode102[String] = 6373083900444931227
@SiteCode103[String] = 6373083829464571372
@SiteCode104[String] = 6373083833327492328
@SiteCode105[String] = 6373083841964286321
@SiteCode106[String] = 6373083844982558950
@SiteCode107[String] = 6373083847585007801
@SiteCode108[String] = 6373083856887939900
@SiteCode109[String] = 6373083859102666584
@SiteCode110[String] = 6373083864919499284
@SiteCode111[String] = 6373334974514214221
@ProcessFactoryCode112[String] = 6372982160979097303
@ProjectId113[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb 	


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb ) as a)  SELECT * FROM temptbl where Row between 1 and 15	


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-28 10:26:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-28 10:26:37
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 10:26:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083829464571372
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:41
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode116)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId114) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode115)))	
Parameters:
@ProjectId114[String] = 6372912251695766465
@SiteCode115[String] = 6373083829464571372
@FDictionaryCode116[String] = OrderState
@FDictionaryCode117[String] = UrgentDegree
@FDictionaryCode118[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:41
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode117) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode118) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode116)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId114) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode115))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId114[String] = 6372912251695766465
@SiteCode115[String] = 6373083829464571372
@FDictionaryCode116[String] = OrderState
@FDictionaryCode117[String] = UrgentDegree
@FDictionaryCode118[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373334974514214221
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:42
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode121)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId119) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode120)))	
Parameters:
@ProjectId119[String] = 6372912251695766465
@SiteCode120[String] = 6373334974514214221
@FDictionaryCode121[String] = OrderState
@FDictionaryCode122[String] = UrgentDegree
@FDictionaryCode123[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:42
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode122) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode123) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode121)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId119) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode120))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId119[String] = 6372912251695766465
@SiteCode120[String] = 6373334974514214221
@FDictionaryCode121[String] = OrderState
@FDictionaryCode122[String] = UrgentDegree
@FDictionaryCode123[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083847585007801
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:43
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode126)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId124) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode125)))	
Parameters:
@ProjectId124[String] = 6372912251695766465
@SiteCode125[String] = 6373083847585007801
@FDictionaryCode126[String] = OrderState
@FDictionaryCode127[String] = UrgentDegree
@FDictionaryCode128[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:43
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode127) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode128) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode126)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId124) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode125))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId124[String] = 6372912251695766465
@SiteCode125[String] = 6373083847585007801
@FDictionaryCode126[String] = OrderState
@FDictionaryCode127[String] = UrgentDegree
@FDictionaryCode128[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083841964286321
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:44
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode131)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId129) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode130)))	
Parameters:
@ProjectId129[String] = 6372912251695766465
@SiteCode130[String] = 6373083841964286321
@FDictionaryCode131[String] = OrderState
@FDictionaryCode132[String] = UrgentDegree
@FDictionaryCode133[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:44
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode132) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode133) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode131)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId129) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode130))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId129[String] = 6372912251695766465
@SiteCode130[String] = 6373083841964286321
@FDictionaryCode131[String] = OrderState
@FDictionaryCode132[String] = UrgentDegree
@FDictionaryCode133[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083829464571372
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:26:45
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode136)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId134) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode135)))	
Parameters:
@ProjectId134[String] = 6372912251695766465
@SiteCode135[String] = 6373083829464571372
@FDictionaryCode136[String] = OrderState
@FDictionaryCode137[String] = UrgentDegree
@FDictionaryCode138[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:45
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode137) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode138) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode136)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId134) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode135))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId134[String] = 6372912251695766465
@SiteCode135[String] = 6373083829464571372
@FDictionaryCode136[String] = OrderState
@FDictionaryCode137[String] = UrgentDegree
@FDictionaryCode138[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:47
Text:	select * from (select * from TbProcessingTechnology where PID!=0 
                            union all
                            select 0,-1,0,'请选择') Tb order by Tb.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 10:26:47
Text:	select * from (select * from TbProcessingTechnology where PID!=0 
                            union all
                            select 0,-1,0,'请选择') Tb order by Tb.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 10:26:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-28 10:26:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = OrderType


-----------------------------------------------------------------------------
2020-08-28 10:26:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = DistributionTimeJg


-----------------------------------------------------------------------------
2020-08-28 10:28:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:31:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:34:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:37:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:40:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:43:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:46:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:49:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:52:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:54:02
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-28 10:54:03
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 10:54:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = scgl


-----------------------------------------------------------------------------
2020-08-28 10:54:06
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = yuancail


-----------------------------------------------------------------------------
2020-08-28 10:55:47
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:56:35
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 10:56:35
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 10:56:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 10:56:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-28 10:56:37
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 10:59:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:01:30
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-28 11:01:32
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-28 11:01:38
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-28 11:01:40
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-28 11:01:40
Text:	 SELECT   TOP 1 * FROM [TbSysDictionaryType]  WHERE [TbSysDictionaryType].[DictionaryCode] = @DictionaryCode23 	
Parameters:
@DictionaryCode23[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-28 11:02:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:02:48
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-28 11:02:48
Text:	select a.FDictionaryCode,a.DictionaryCode,a.DictionaryOrder,a.DictionaryText,a.id,b.DictionaryType as DictionaryValue  from TbSysDictionaryData a left join TbSysDictionaryType b on a.FDictionaryCode=b.DictionaryCode where 1=1 and a.DictionaryText = @name and a.FDictionaryCode=@type and a.DictionaryCode=@text	
Parameters:
@name[String] = 0
@type[String] = LagPoint
@text[String] = LagPoint_6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:05:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:08:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:11:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:14:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:17:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:20:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:23:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:26:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:29:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:32:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:35:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:38:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:41:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:44:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:47:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:50:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:53:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:56:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 11:59:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:02:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:05:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:08:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:11:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:14:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:17:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:20:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:23:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:26:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:29:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:32:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:33:53
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 12:33:53
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 12:33:53
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:33:55
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:34:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:34:24
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 12:34:24
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:34:24
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:34:25
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:36:53
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:37:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 12:37:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 12:37:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:37:18
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 12:37:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 12:37:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 12:37:42
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:37:42
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:37:43
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 12:38:10
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 12:38:11
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 12:38:11
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 12:39:21
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28,@ComponentCode29,@ComponentCode30)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 12:39:21
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode31,@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode31[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type34[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 12:39:44
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 12:39:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode35) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart36)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId37,@MxGjId38)) 	
Parameters:
@SiteCode35[String] = 6373083923489249281
@RevokeStart36[String] = 未撤销
@MxGjId37[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId38[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 12:39:44
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode39,@ComponentCode40)) AND ([TbModelOtherInfo].[Type] = @Type41) 	
Parameters:
@ComponentCode39[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode40[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type41[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 12:39:47
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 12:39:47
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode42) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart43)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId44,@MxGjId45)) 	
Parameters:
@SiteCode42[String] = 6373083923489249281
@RevokeStart43[String] = 未撤销
@MxGjId44[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId45[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 12:39:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode46,@ComponentCode47)) AND ([TbModelOtherInfo].[Type] = @Type48) 	
Parameters:
@ComponentCode46[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type48[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 12:39:55
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 12:39:55
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode49) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart50)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId51,@MxGjId52)) 	
Parameters:
@SiteCode49[String] = 6373083923489249281
@RevokeStart50[String] = 未撤销
@MxGjId51[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId52[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-28 12:39:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode53,@ComponentCode54)) AND ([TbModelOtherInfo].[Type] = @Type55) 	
Parameters:
@ComponentCode53[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type55[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 12:40:01
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 12:40:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode56) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart57)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId58,@MxGjId59)) 	
Parameters:
@SiteCode56[String] = 6373083923489249281
@RevokeStart57[String] = 未撤销
@MxGjId58[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId59[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 12:40:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60,@ComponentCode61)) AND ([TbModelOtherInfo].[Type] = @Type62) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type62[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 12:40:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:43:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:46:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:49:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:52:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:55:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 12:58:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:01:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:03:34
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:03:34
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:03:36
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:03:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:03:41
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 13:03:41
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:03:42
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:03:43
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:03:54
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 13:03:54
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:03:54
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:04:34
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:05:25
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28,@ComponentCode29,@ComponentCode30)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 13:05:25
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode31,@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode31[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type34[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 13:05:42
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 13:05:42
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode35) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart36)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId37,@MxGjId38)) 	
Parameters:
@SiteCode35[String] = 6373083923489249281
@RevokeStart36[String] = 未撤销
@MxGjId37[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId38[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-28 13:05:42
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode39,@ComponentCode40)) AND ([TbModelOtherInfo].[Type] = @Type41) 	
Parameters:
@ComponentCode39[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode40[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type41[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 13:05:59
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 13:05:59
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode42) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart43)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId44,@MxGjId45)) 	
Parameters:
@SiteCode42[String] = 6373083923489249281
@RevokeStart43[String] = 未撤销
@MxGjId44[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId45[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-28 13:05:59
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode46,@ComponentCode47)) AND ([TbModelOtherInfo].[Type] = @Type48) 	
Parameters:
@ComponentCode46[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type48[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 13:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:08:55
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:08:55
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:08:55
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type49) AND ([TbOrganizationMap].[ProjectId] = @ProjectId50)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54,@CompanyCode55,@CompanyCode56,@CompanyCode57,@CompanyCode58)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode59))) 	
Parameters:
@Type49[Int32] = 1
@ProjectId50[String] = 6372912251695766465
@CompanyCode51[String] = 6373083923489249281
@CompanyCode52[String] = 6373083925531366080
@CompanyCode53[String] = 6373083927883400612
@CompanyCode54[String] = 6373083918575368225
@CompanyCode55[String] = 6373083920445075162
@CompanyCode56[String] = 6373083908618598731
@CompanyCode57[String] = 6373083911842783146
@CompanyCode58[String] = 6373083913928202424
@ParentCompanyCode59[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type60) AND ([TbOrganizationMap].[ProjectId] = @ProjectId61)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65,@CompanyCode66,@CompanyCode67,@CompanyCode68,@CompanyCode69)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode70))) 	
Parameters:
@Type60[Int32] = 2
@ProjectId61[String] = 6372912251695766465
@CompanyCode62[String] = 6373083923489249281
@CompanyCode63[String] = 6373083925531366080
@CompanyCode64[String] = 6373083927883400612
@CompanyCode65[String] = 6373083918575368225
@CompanyCode66[String] = 6373083920445075162
@CompanyCode67[String] = 6373083908618598731
@CompanyCode68[String] = 6373083911842783146
@CompanyCode69[String] = 6373083913928202424
@ParentCompanyCode70[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:08:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:08:57
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:08:57
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:08:57
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:08:57
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:08:57
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:09:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:09:03
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 13:09:03
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:09:03
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:09:04
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode72) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode73) 	
Parameters:
@SiteCode72[String] = 6373083923489249281
@ComponentCode73[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode74) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart75)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode76,@ComponentCode77,@ComponentCode78)) 	
Parameters:
@SiteCode74[String] = 6373083923489249281
@RevokeStart75[String] = 未撤销
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 13:09:14
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode79,@ComponentCode80,@ComponentCode81)) AND ([TbModelOtherInfo].[Type] = @Type82) 	
Parameters:
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode80[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode81[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type82[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 13:10:24
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:10:25
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:10:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type83) AND ([TbOrganizationMap].[ProjectId] = @ProjectId84)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode85,@CompanyCode86,@CompanyCode87,@CompanyCode88,@CompanyCode89,@CompanyCode90,@CompanyCode91,@CompanyCode92)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode93))) 	
Parameters:
@Type83[Int32] = 1
@ProjectId84[String] = 6372912251695766465
@CompanyCode85[String] = 6373083923489249281
@CompanyCode86[String] = 6373083925531366080
@CompanyCode87[String] = 6373083927883400612
@CompanyCode88[String] = 6373083918575368225
@CompanyCode89[String] = 6373083920445075162
@CompanyCode90[String] = 6373083908618598731
@CompanyCode91[String] = 6373083911842783146
@CompanyCode92[String] = 6373083913928202424
@ParentCompanyCode93[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type94) AND ([TbOrganizationMap].[ProjectId] = @ProjectId95)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode96,@CompanyCode97,@CompanyCode98,@CompanyCode99,@CompanyCode100,@CompanyCode101,@CompanyCode102,@CompanyCode103)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode104))) 	
Parameters:
@Type94[Int32] = 2
@ProjectId95[String] = 6372912251695766465
@CompanyCode96[String] = 6373083923489249281
@CompanyCode97[String] = 6373083925531366080
@CompanyCode98[String] = 6373083927883400612
@CompanyCode99[String] = 6373083918575368225
@CompanyCode100[String] = 6373083920445075162
@CompanyCode101[String] = 6373083908618598731
@CompanyCode102[String] = 6373083911842783146
@CompanyCode103[String] = 6373083913928202424
@ParentCompanyCode104[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:10:26
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:10:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:10:30
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 13:10:30
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:10:30
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:10:32
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode106) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode107) 	
Parameters:
@SiteCode106[String] = 6373083923489249281
@ComponentCode107[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode108) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart109)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode110,@ComponentCode111,@ComponentCode112)) 	
Parameters:
@SiteCode108[String] = 6373083923489249281
@RevokeStart109[String] = 未撤销
@ComponentCode110[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode111[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 13:10:38
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode113,@ComponentCode114,@ComponentCode115)) AND ([TbModelOtherInfo].[Type] = @Type116) 	
Parameters:
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode115[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type116[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 13:13:24
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:16:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:16:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:16:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type117) AND ([TbOrganizationMap].[ProjectId] = @ProjectId118)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode119,@CompanyCode120,@CompanyCode121,@CompanyCode122,@CompanyCode123,@CompanyCode124,@CompanyCode125,@CompanyCode126)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode127))) 	
Parameters:
@Type117[Int32] = 1
@ProjectId118[String] = 6372912251695766465
@CompanyCode119[String] = 6373083923489249281
@CompanyCode120[String] = 6373083925531366080
@CompanyCode121[String] = 6373083927883400612
@CompanyCode122[String] = 6373083918575368225
@CompanyCode123[String] = 6373083920445075162
@CompanyCode124[String] = 6373083908618598731
@CompanyCode125[String] = 6373083911842783146
@CompanyCode126[String] = 6373083913928202424
@ParentCompanyCode127[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type128) AND ([TbOrganizationMap].[ProjectId] = @ProjectId129)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode130,@CompanyCode131,@CompanyCode132,@CompanyCode133,@CompanyCode134,@CompanyCode135,@CompanyCode136,@CompanyCode137)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode138))) 	
Parameters:
@Type128[Int32] = 2
@ProjectId129[String] = 6372912251695766465
@CompanyCode130[String] = 6373083923489249281
@CompanyCode131[String] = 6373083925531366080
@CompanyCode132[String] = 6373083927883400612
@CompanyCode133[String] = 6373083918575368225
@CompanyCode134[String] = 6373083920445075162
@CompanyCode135[String] = 6373083908618598731
@CompanyCode136[String] = 6373083911842783146
@CompanyCode137[String] = 6373083913928202424
@ParentCompanyCode138[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:16:22
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:16:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:16:27
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 13:16:27
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:16:27
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:16:28
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:16:34
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode140) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode141) 	
Parameters:
@SiteCode140[String] = 6373083923489249281
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 13:16:34
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:16:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:16:34
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:16:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode142) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart143)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode144,@ComponentCode145,@ComponentCode146)) 	
Parameters:
@SiteCode142[String] = 6373083923489249281
@RevokeStart143[String] = 未撤销
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 13:16:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode147,@ComponentCode148,@ComponentCode149)) AND ([TbModelOtherInfo].[Type] = @Type150) 	
Parameters:
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type150[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 13:17:11
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode151) AND ([TbModelOtherInfo].[Type] = @Type152) 	
Parameters:
@ComponentCode151[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type152[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 13:17:24
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode154,[PlanTime]=@PlanTime155,[Remark]=@Remark156,[SiteCode]=@SiteCode157,[Type]=@Type158,[ProjectId]=@ProjectId159 WHERE [TbModelOtherInfo].[ID] = @ID153	
Parameters:
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime155[DateTime] = 2020/8/18 0:00:00
@Remark156[String] = 
@SiteCode157[String] = 6373083923489249281
@Type158[Int32] = 1
@ProjectId159[String] = 6372912251695766465
@ID153[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 13:17:37
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode160) AND ([TbModelReporte].[Type] = @Type161) 	
Parameters:
@ComponentCode160[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type161[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:17:47
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 13:17:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode162,@ComponentCode163)) AND ([TbModelOtherInfo].[Type] = @Type164) 	
Parameters:
@ComponentCode162[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode163[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type164[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 13:17:47
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime166 WHERE [TbModelOtherInfo].[ID] = @ID165	
Parameters:
@PlanTime166[DateTime] = 2020/8/18 0:00:00
@ID165[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 13:17:47
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime168 WHERE [TbModelOtherInfo].[ID] = @ID167	
Parameters:
@PlanTime168[DateTime] = 2020/8/18 0:00:00
@ID167[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 13:19:23
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:19:50
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 13:19:50
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode1) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart2)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId3,@MxGjId4)) 	
Parameters:
@SiteCode1[String] = 6373083923489249281
@RevokeStart2[String] = 未撤销
@MxGjId3[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId4[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 13:19:50
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode5,@ComponentCode6)) AND ([TbModelOtherInfo].[Type] = @Type7) 	
Parameters:
@ComponentCode5[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode6[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type7[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 13:22:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:23:07
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:23:07
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:23:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type8) AND ([TbOrganizationMap].[ProjectId] = @ProjectId9)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode10,@CompanyCode11,@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode18))) 	
Parameters:
@Type8[Int32] = 1
@ProjectId9[String] = 6372912251695766465
@CompanyCode10[String] = 6373083923489249281
@CompanyCode11[String] = 6373083925531366080
@CompanyCode12[String] = 6373083927883400612
@CompanyCode13[String] = 6373083918575368225
@CompanyCode14[String] = 6373083920445075162
@CompanyCode15[String] = 6373083908618598731
@CompanyCode16[String] = 6373083911842783146
@CompanyCode17[String] = 6373083913928202424
@ParentCompanyCode18[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type19) AND ([TbOrganizationMap].[ProjectId] = @ProjectId20)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode21,@CompanyCode22,@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode29))) 	
Parameters:
@Type19[Int32] = 2
@ProjectId20[String] = 6372912251695766465
@CompanyCode21[String] = 6373083923489249281
@CompanyCode22[String] = 6373083925531366080
@CompanyCode23[String] = 6373083927883400612
@CompanyCode24[String] = 6373083918575368225
@CompanyCode25[String] = 6373083920445075162
@CompanyCode26[String] = 6373083908618598731
@CompanyCode27[String] = 6373083911842783146
@CompanyCode28[String] = 6373083913928202424
@ParentCompanyCode29[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:23:09
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:26:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:29:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:32:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:35:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:38:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:41:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:44:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:47:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:50:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:53:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:56:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:58:43
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 13:58:44
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 13:58:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type30) AND ([TbOrganizationMap].[ProjectId] = @ProjectId31)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode32,@CompanyCode33,@CompanyCode34,@CompanyCode35,@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode40))) 	
Parameters:
@Type30[Int32] = 1
@ProjectId31[String] = 6372912251695766465
@CompanyCode32[String] = 6373083923489249281
@CompanyCode33[String] = 6373083925531366080
@CompanyCode34[String] = 6373083927883400612
@CompanyCode35[String] = 6373083918575368225
@CompanyCode36[String] = 6373083920445075162
@CompanyCode37[String] = 6373083908618598731
@CompanyCode38[String] = 6373083911842783146
@CompanyCode39[String] = 6373083913928202424
@ParentCompanyCode40[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type41) AND ([TbOrganizationMap].[ProjectId] = @ProjectId42)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode43,@CompanyCode44,@CompanyCode45,@CompanyCode46,@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode51))) 	
Parameters:
@Type41[Int32] = 2
@ProjectId42[String] = 6372912251695766465
@CompanyCode43[String] = 6373083923489249281
@CompanyCode44[String] = 6373083925531366080
@CompanyCode45[String] = 6373083927883400612
@CompanyCode46[String] = 6373083918575368225
@CompanyCode47[String] = 6373083920445075162
@CompanyCode48[String] = 6373083908618598731
@CompanyCode49[String] = 6373083911842783146
@CompanyCode50[String] = 6373083913928202424
@ParentCompanyCode51[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:58:45
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 13:58:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 13:58:52
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 13:58:52
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:58:52
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:58:53
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode53) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode54) 	
Parameters:
@SiteCode53[String] = 6373083923489249281
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode55) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart56)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode57,@ComponentCode58,@ComponentCode59)) 	
Parameters:
@SiteCode55[String] = 6373083923489249281
@RevokeStart56[String] = 未撤销
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 13:59:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60,@ComponentCode61,@ComponentCode62)) AND ([TbModelOtherInfo].[Type] = @Type63) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type63[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:01:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:01:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:01:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:01:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:01:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type64) AND ([TbOrganizationMap].[ProjectId] = @ProjectId65)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode66,@CompanyCode67,@CompanyCode68,@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72,@CompanyCode73)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode74))) 	
Parameters:
@Type64[Int32] = 1
@ProjectId65[String] = 6372912251695766465
@CompanyCode66[String] = 6373083923489249281
@CompanyCode67[String] = 6373083925531366080
@CompanyCode68[String] = 6373083927883400612
@CompanyCode69[String] = 6373083918575368225
@CompanyCode70[String] = 6373083920445075162
@CompanyCode71[String] = 6373083908618598731
@CompanyCode72[String] = 6373083911842783146
@CompanyCode73[String] = 6373083913928202424
@ParentCompanyCode74[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type75) AND ([TbOrganizationMap].[ProjectId] = @ProjectId76)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode77,@CompanyCode78,@CompanyCode79,@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83,@CompanyCode84)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode85))) 	
Parameters:
@Type75[Int32] = 2
@ProjectId76[String] = 6372912251695766465
@CompanyCode77[String] = 6373083923489249281
@CompanyCode78[String] = 6373083925531366080
@CompanyCode79[String] = 6373083927883400612
@CompanyCode80[String] = 6373083918575368225
@CompanyCode81[String] = 6373083920445075162
@CompanyCode82[String] = 6373083908618598731
@CompanyCode83[String] = 6373083911842783146
@CompanyCode84[String] = 6373083913928202424
@ParentCompanyCode85[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:01:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:01:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:25
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:01:25
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:01:26
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:01:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode87) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode88) 	
Parameters:
@SiteCode87[String] = 6373083923489249281
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode89) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart90)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode91,@ComponentCode92,@ComponentCode93)) 	
Parameters:
@SiteCode89[String] = 6373083923489249281
@RevokeStart90[String] = 未撤销
@ComponentCode91[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode92[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode93[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:01:33
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode94,@ComponentCode95,@ComponentCode96)) AND ([TbModelOtherInfo].[Type] = @Type97) 	
Parameters:
@ComponentCode94[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode95[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode96[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type97[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode98) AND ([TbModelOtherInfo].[Type] = @Type99) 	
Parameters:
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type99[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode101,[PlanTime]=@PlanTime102,[Remark]=@Remark103,[SiteCode]=@SiteCode104,[Type]=@Type105,[ProjectId]=@ProjectId106 WHERE [TbModelOtherInfo].[ID] = @ID100	
Parameters:
@ComponentCode101[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime102[DateTime] = 2020/8/12 0:00:00
@Remark103[String] = 
@SiteCode104[String] = 6373083923489249281
@Type105[Int32] = 1
@ProjectId106[String] = 6372912251695766465
@ID100[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode107) AND ([TbModelReporte].[Type] = @Type108) 	
Parameters:
@ComponentCode107[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type108[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode109) AND ([TbModelOtherInfo].[Type] = @Type110) 	
Parameters:
@ComponentCode109[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type110[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode111,@ComponentCode112)) AND ([TbModelOtherInfo].[Type] = @Type113) 	
Parameters:
@ComponentCode111[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type113[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime115 WHERE [TbModelOtherInfo].[ID] = @ID114	
Parameters:
@PlanTime115[DateTime] = 2020/8/12 0:00:00
@ID114[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:01:48
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime117 WHERE [TbModelOtherInfo].[ID] = @ID116	
Parameters:
@PlanTime117[DateTime] = 2020/8/12 0:00:00
@ID116[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:02:22
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode118) AND ([TbModelOtherInfo].[Type] = @Type119) 	
Parameters:
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type119[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:02:25
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode121,[PlanTime]=@PlanTime122,[Remark]=@Remark123,[SiteCode]=@SiteCode124,[Type]=@Type125,[ProjectId]=@ProjectId126 WHERE [TbModelOtherInfo].[ID] = @ID120	
Parameters:
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime122[DateTime] = 2020/8/21 0:00:00
@Remark123[String] = 
@SiteCode124[String] = 6373083923489249281
@Type125[Int32] = 1
@ProjectId126[String] = 6372912251695766465
@ID120[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:02:32
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode127) AND ([TbModelReporte].[Type] = @Type128) 	
Parameters:
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type128[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:02:39
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode129) AND ([TbModelOtherInfo].[Type] = @Type130) 	
Parameters:
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type130[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:04:10
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1) AND ([TbModelOtherInfo].[Type] = @Type2) 	
Parameters:
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:04:11
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode4,[PlanTime]=@PlanTime5,[Remark]=@Remark6,[SiteCode]=@SiteCode7,[Type]=@Type8,[ProjectId]=@ProjectId9 WHERE [TbModelOtherInfo].[ID] = @ID3	
Parameters:
@ComponentCode4[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime5[DateTime] = 2020/8/13 0:00:00
@Remark6[String] = 
@SiteCode7[String] = 6373083923489249281
@Type8[Int32] = 1
@ProjectId9[String] = 6372912251695766465
@ID3[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:04:14
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode10) AND ([TbModelReporte].[Type] = @Type11) 	
Parameters:
@ComponentCode10[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type11[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:04:14
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode12) AND ([TbModelOtherInfo].[Type] = @Type13) 	
Parameters:
@ComponentCode12[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type13[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:04:14
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime15 WHERE [TbModelReporte].[ID] = @ID14	
Parameters:
@PlanTime15[DateTime] = 2020/8/20 0:00:00
@ID14[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:04:19
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:04:19
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode16,@ComponentCode17)) AND ([TbModelOtherInfo].[Type] = @Type18) 	
Parameters:
@ComponentCode16[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode17[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type18[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:04:19
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime20 WHERE [TbModelOtherInfo].[ID] = @ID19	
Parameters:
@PlanTime20[DateTime] = 2020/8/13 0:00:00
@ID19[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:04:19
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime22 WHERE [TbModelOtherInfo].[ID] = @ID21	
Parameters:
@PlanTime22[DateTime] = 2020/8/13 0:00:00
@ID21[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:04:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:04:41
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode23) AND ([TbModelOtherInfo].[Type] = @Type24) 	
Parameters:
@ComponentCode23[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type24[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:04:41
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode26,[PlanTime]=@PlanTime27,[Remark]=@Remark28,[SiteCode]=@SiteCode29,[Type]=@Type30,[ProjectId]=@ProjectId31 WHERE [TbModelOtherInfo].[ID] = @ID25	
Parameters:
@ComponentCode26[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime27[DateTime] = 2020/8/11 0:00:00
@Remark28[String] = 
@SiteCode29[String] = 6373083923489249281
@Type30[Int32] = 1
@ProjectId31[String] = 6372912251695766465
@ID25[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:04:45
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode32) AND ([TbModelReporte].[Type] = @Type33) 	
Parameters:
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type33[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:04:51
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode34) AND ([TbModelOtherInfo].[Type] = @Type35) 	
Parameters:
@ComponentCode34[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type35[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:05:06
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime37 WHERE [TbModelReporte].[ID] = @ID36	
Parameters:
@PlanTime37[DateTime] = 2020/8/21 0:00:00
@ID36[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:05:09
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 14:05:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode38,@ComponentCode39)) AND ([TbModelOtherInfo].[Type] = @Type40) 	
Parameters:
@ComponentCode38[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode39[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type40[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:05:09
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime42 WHERE [TbModelOtherInfo].[ID] = @ID41	
Parameters:
@PlanTime42[DateTime] = 2020/8/11 0:00:00
@ID41[Int32] = 58


-----------------------------------------------------------------------------
2020-08-28 14:05:09
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime44 WHERE [TbModelOtherInfo].[ID] = @ID43	
Parameters:
@PlanTime44[DateTime] = 2020/8/11 0:00:00
@ID43[Int32] = 64


-----------------------------------------------------------------------------
2020-08-28 14:05:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode45) AND ([TbModelOtherInfo].[Type] = @Type46) 	
Parameters:
@ComponentCode45[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type46[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:05:18
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode48,[PlanTime]=@PlanTime49,[Remark]=@Remark50,[SiteCode]=@SiteCode51,[Type]=@Type52,[ProjectId]=@ProjectId53 WHERE [TbModelOtherInfo].[ID] = @ID47	
Parameters:
@ComponentCode48[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime49[DateTime] = 2020/8/12 0:00:00
@Remark50[String] = 
@SiteCode51[String] = 6373083923489249281
@Type52[Int32] = 1
@ProjectId53[String] = 6372912251695766465
@ID47[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:05:22
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode54) AND ([TbModelReporte].[Type] = @Type55) 	
Parameters:
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type55[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:05:28
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode56) AND ([TbModelOtherInfo].[Type] = @Type57) 	
Parameters:
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type57[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:05:50
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:05:50
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode58,@ComponentCode59)) AND ([TbModelOtherInfo].[Type] = @Type60) 	
Parameters:
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type60[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:05:50
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime62 WHERE [TbModelOtherInfo].[ID] = @ID61	
Parameters:
@PlanTime62[DateTime] = 2020/8/12 0:00:00
@ID61[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:05:50
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime64 WHERE [TbModelOtherInfo].[ID] = @ID63	
Parameters:
@PlanTime64[DateTime] = 2020/8/12 0:00:00
@ID63[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:06:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode65) AND ([TbModelOtherInfo].[Type] = @Type66) 	
Parameters:
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type66[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:06:00
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode68,[PlanTime]=@PlanTime69,[Remark]=@Remark70,[SiteCode]=@SiteCode71,[Type]=@Type72,[ProjectId]=@ProjectId73 WHERE [TbModelOtherInfo].[ID] = @ID67	
Parameters:
@ComponentCode68[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime69[DateTime] = 2020/8/8 0:00:00
@Remark70[String] = 
@SiteCode71[String] = 6373083923489249281
@Type72[Int32] = 1
@ProjectId73[String] = 6372912251695766465
@ID67[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:06:11
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode74) AND ([TbModelReporte].[Type] = @Type75) 	
Parameters:
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type75[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:06:19
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode76) AND ([TbModelOtherInfo].[Type] = @Type77) 	
Parameters:
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type77[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:06:42
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 14:06:42
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode78,@ComponentCode79)) AND ([TbModelOtherInfo].[Type] = @Type80) 	
Parameters:
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type80[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:06:42
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime82 WHERE [TbModelOtherInfo].[ID] = @ID81	
Parameters:
@PlanTime82[DateTime] = 2020/8/8 0:00:00
@ID81[Int32] = 58


-----------------------------------------------------------------------------
2020-08-28 14:06:42
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime84 WHERE [TbModelOtherInfo].[ID] = @ID83	
Parameters:
@PlanTime84[DateTime] = 2020/8/8 0:00:00
@ID83[Int32] = 64


-----------------------------------------------------------------------------
2020-08-28 14:07:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:10:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode85) AND ([TbModelOtherInfo].[Type] = @Type86) 	
Parameters:
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type86[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode88,[PlanTime]=@PlanTime89,[Remark]=@Remark90,[SiteCode]=@SiteCode91,[Type]=@Type92,[ProjectId]=@ProjectId93 WHERE [TbModelOtherInfo].[ID] = @ID87	
Parameters:
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime89[DateTime] = 2020/8/1 0:00:00
@Remark90[String] = 
@SiteCode91[String] = 6373083923489249281
@Type92[Int32] = 1
@ProjectId93[String] = 6372912251695766465
@ID87[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode94) AND ([TbModelReporte].[Type] = @Type95) 	
Parameters:
@ComponentCode94[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type95[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode96) AND ([TbModelOtherInfo].[Type] = @Type97) 	
Parameters:
@ComponentCode96[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type97[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode98,@ComponentCode99)) AND ([TbModelOtherInfo].[Type] = @Type100) 	
Parameters:
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode99[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type100[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime102 WHERE [TbModelOtherInfo].[ID] = @ID101	
Parameters:
@PlanTime102[DateTime] = 2020/8/1 0:00:00
@ID101[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:11:17
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime104 WHERE [TbModelOtherInfo].[ID] = @ID103	
Parameters:
@PlanTime104[DateTime] = 2020/8/1 0:00:00
@ID103[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:12:59
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode105) AND ([TbModelOtherInfo].[Type] = @Type106) 	
Parameters:
@ComponentCode105[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type106[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:13:11
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode108,[PlanTime]=@PlanTime109,[Remark]=@Remark110,[SiteCode]=@SiteCode111,[Type]=@Type112,[ProjectId]=@ProjectId113 WHERE [TbModelOtherInfo].[ID] = @ID107	
Parameters:
@ComponentCode108[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime109[DateTime] = 2020/7/9 0:00:00
@Remark110[String] = 
@SiteCode111[String] = 6373083923489249281
@Type112[Int32] = 1
@ProjectId113[String] = 6372912251695766465
@ID107[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:13:28
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode114) AND ([TbModelReporte].[Type] = @Type115) 	
Parameters:
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type115[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:13:32
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode116) AND ([TbModelOtherInfo].[Type] = @Type117) 	
Parameters:
@ComponentCode116[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type117[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:14:52
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 14:14:52
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode118,@ComponentCode119)) AND ([TbModelOtherInfo].[Type] = @Type120) 	
Parameters:
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type120[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:14:52
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime122 WHERE [TbModelOtherInfo].[ID] = @ID121	
Parameters:
@PlanTime122[DateTime] = 2020/7/9 0:00:00
@ID121[Int32] = 58


-----------------------------------------------------------------------------
2020-08-28 14:14:52
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime124 WHERE [TbModelOtherInfo].[ID] = @ID123	
Parameters:
@PlanTime124[DateTime] = 2020/7/9 0:00:00
@ID123[Int32] = 64


-----------------------------------------------------------------------------
2020-08-28 14:14:53
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:15:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode125) AND ([TbModelOtherInfo].[Type] = @Type126) 	
Parameters:
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type126[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:15:54
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode128,[PlanTime]=@PlanTime129,[Remark]=@Remark130,[SiteCode]=@SiteCode131,[Type]=@Type132,[ProjectId]=@ProjectId133 WHERE [TbModelOtherInfo].[ID] = @ID127	
Parameters:
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime129[DateTime] = 2020/8/1 0:00:00
@Remark130[String] = 
@SiteCode131[String] = 6373083923489249281
@Type132[Int32] = 1
@ProjectId133[String] = 6372912251695766465
@ID127[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:16:14
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode134) AND ([TbModelReporte].[Type] = @Type135) 	
Parameters:
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@Type135[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:16:16
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode136) AND ([TbModelOtherInfo].[Type] = @Type137) 	
Parameters:
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%
@Type137[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime139 WHERE [TbModelReporte].[ID] = @ID138	
Parameters:
@PlanTime139[DateTime] = 2020/8/20 0:00:00
@ID138[Int32] = 62


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode140,@ComponentCode141)) AND ([TbModelOtherInfo].[Type] = @Type142) 	
Parameters:
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type142[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime144 WHERE [TbModelOtherInfo].[ID] = @ID143	
Parameters:
@PlanTime144[DateTime] = 2020/8/1 0:00:00
@ID143[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime146 WHERE [TbModelOtherInfo].[ID] = @ID145	
Parameters:
@PlanTime146[DateTime] = 2020/8/1 0:00:00
@ID145[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 14:16:57
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:18:53
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1) AND ([TbModelOtherInfo].[Type] = @Type2) 	
Parameters:
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type2[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:18:53
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode4,[PlanTime]=@PlanTime5,[Remark]=@Remark6,[SiteCode]=@SiteCode7,[Type]=@Type8,[ProjectId]=@ProjectId9 WHERE [TbModelOtherInfo].[ID] = @ID3	
Parameters:
@ComponentCode4[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime5[DateTime] = 2020/7/31 0:00:00
@Remark6[String] = 
@SiteCode7[String] = 6373083923489249281
@Type8[Int32] = 1
@ProjectId9[String] = 6372912251695766465
@ID3[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:19:00
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode10) AND ([TbModelReporte].[Type] = @Type11) 	
Parameters:
@ComponentCode10[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@Type11[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:19:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode12) AND ([TbModelOtherInfo].[Type] = @Type13) 	
Parameters:
@ComponentCode12[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%
@Type13[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:19:36
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:19:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode14) AND ([TbModelOtherInfo].[Type] = @Type15) 	
Parameters:
@ComponentCode14[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type15[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:19:54
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode17,[PlanTime]=@PlanTime18,[Remark]=@Remark19,[SiteCode]=@SiteCode20,[Type]=@Type21,[ProjectId]=@ProjectId22 WHERE [TbModelOtherInfo].[ID] = @ID16	
Parameters:
@ComponentCode17[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime18[DateTime] = 2020/7/9 0:00:00
@Remark19[String] = 
@SiteCode20[String] = 6373083923489249281
@Type21[Int32] = 1
@ProjectId22[String] = 6372912251695766465
@ID16[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:20:51
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode23) AND ([TbModelReporte].[Type] = @Type24) 	
Parameters:
@ComponentCode23[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type24[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:20:51
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode25) AND ([TbModelOtherInfo].[Type] = @Type26) 	
Parameters:
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type26[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:22:16
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode27) AND ([TbModelOtherInfo].[Type] = @Type28) 	
Parameters:
@ComponentCode27[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type28[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:22:25
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode30,[PlanTime]=@PlanTime31,[Remark]=@Remark32,[SiteCode]=@SiteCode33,[Type]=@Type34,[ProjectId]=@ProjectId35 WHERE [TbModelOtherInfo].[ID] = @ID29	
Parameters:
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime31[DateTime] = 2020/7/31 0:00:00
@Remark32[String] = 
@SiteCode33[String] = 6373083923489249281
@Type34[Int32] = 1
@ProjectId35[String] = 6372912251695766465
@ID29[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:22:25
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode36) AND ([TbModelReporte].[Type] = @Type37) 	
Parameters:
@ComponentCode36[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type37[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:22:25
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode38) AND ([TbModelOtherInfo].[Type] = @Type39) 	
Parameters:
@ComponentCode38[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type39[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:22:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:23:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:23:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:23:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:23:23
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:23:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:23:28
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:23:28
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:23:28
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:23:30
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28,@ComponentCode29,@ComponentCode30)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:23:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode31,@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode31[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type34[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:24:05
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode35) AND ([TbModelOtherInfo].[Type] = @Type36) 	
Parameters:
@ComponentCode35[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type36[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:24:05
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode38,[PlanTime]=@PlanTime39,[Remark]=@Remark40,[SiteCode]=@SiteCode41,[Type]=@Type42,[ProjectId]=@ProjectId43 WHERE [TbModelOtherInfo].[ID] = @ID37	
Parameters:
@ComponentCode38[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime39[DateTime] = 2020/8/1 0:00:00
@Remark40[String] = 
@SiteCode41[String] = 6373083923489249281
@Type42[Int32] = 1
@ProjectId43[String] = 6372912251695766465
@ID37[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:24:07
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode44) AND ([TbModelReporte].[Type] = @Type45) 	
Parameters:
@ComponentCode44[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type45[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:24:11
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode46) AND ([TbModelOtherInfo].[Type] = @Type47) 	
Parameters:
@ComponentCode46[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type47[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:24:31
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:24:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode48,@ComponentCode49)) AND ([TbModelOtherInfo].[Type] = @Type50) 	
Parameters:
@ComponentCode48[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode49[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type50[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:24:31
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime52 WHERE [TbModelOtherInfo].[ID] = @ID51	
Parameters:
@PlanTime52[DateTime] = 2020/8/1 0:00:00
@ID51[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:24:31
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime54 WHERE [TbModelOtherInfo].[ID] = @ID53	
Parameters:
@PlanTime54[DateTime] = 2020/8/1 0:00:00
@ID53[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:25:22
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode55) AND ([TbModelOtherInfo].[Type] = @Type56) 	
Parameters:
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type56[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:25:33
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode58,[PlanTime]=@PlanTime59,[Remark]=@Remark60,[SiteCode]=@SiteCode61,[Type]=@Type62,[ProjectId]=@ProjectId63 WHERE [TbModelOtherInfo].[ID] = @ID57	
Parameters:
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime59[DateTime] = 2020/8/1 0:00:00
@Remark60[String] = 
@SiteCode61[String] = 6373083923489249281
@Type62[Int32] = 1
@ProjectId63[String] = 6372912251695766465
@ID57[Int32] = 0


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode64) AND ([TbModelReporte].[Type] = @Type65) 	
Parameters:
@ComponentCode64[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type65[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode66) AND ([TbModelOtherInfo].[Type] = @Type67) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type67[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode68,@ComponentCode69)) AND ([TbModelOtherInfo].[Type] = @Type70) 	
Parameters:
@ComponentCode68[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode69[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type70[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime72 WHERE [TbModelOtherInfo].[ID] = @ID71	
Parameters:
@PlanTime72[DateTime] = 2020/8/1 0:00:00
@ID71[Int32] = 58


-----------------------------------------------------------------------------
2020-08-28 14:25:55
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime74 WHERE [TbModelOtherInfo].[ID] = @ID73	
Parameters:
@PlanTime74[DateTime] = 2020/8/1 0:00:00
@ID73[Int32] = 64


-----------------------------------------------------------------------------
2020-08-28 14:26:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:26:55
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:26:55
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:26:55
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:26:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:26:58
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:29:49
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:29:50
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:29:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:29:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:29:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:29:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:29:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:29:52
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:32:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:35:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:35:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:35:55
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:35:55
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:35:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:35:56
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode2) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode3) 	
Parameters:
@SiteCode2[String] = 6373083923489249281
@ComponentCode3[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode4) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart5)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode6,@ComponentCode7,@ComponentCode8)) 	
Parameters:
@SiteCode4[String] = 6373083923489249281
@RevokeStart5[String] = 未撤销
@ComponentCode6[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode7[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode8[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:36:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode9,@ComponentCode10,@ComponentCode11)) AND ([TbModelOtherInfo].[Type] = @Type12) 	
Parameters:
@ComponentCode9[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode10[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode11[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type12[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:36:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode13) AND ([TbModelOtherInfo].[Type] = @Type14) 	
Parameters:
@ComponentCode13[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type14[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:36:23
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime16 WHERE [TbModelOtherInfo].[ID] = @ID15	
Parameters:
@PlanTime16[DateTime] = 2020/8/1 0:00:00
@ID15[Int32] = 94


-----------------------------------------------------------------------------
2020-08-28 14:36:27
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode17) AND ([TbModelReporte].[Type] = @Type18) 	
Parameters:
@ComponentCode17[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type18[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:36:30
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode19) AND ([TbModelOtherInfo].[Type] = @Type20) 	
Parameters:
@ComponentCode19[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type20[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:36:39
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime22 WHERE [TbModelReporte].[ID] = @ID21	
Parameters:
@PlanTime22[DateTime] = 2020/8/1 0:00:00
@ID21[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:36:40
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:36:40
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode23,@ComponentCode24)) AND ([TbModelOtherInfo].[Type] = @Type25) 	
Parameters:
@ComponentCode23[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode24[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type25[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:36:40
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime27 WHERE [TbModelOtherInfo].[ID] = @ID26	
Parameters:
@PlanTime27[DateTime] = 2020/8/1 0:00:00
@ID26[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 14:36:40
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime29 WHERE [TbModelOtherInfo].[ID] = @ID28	
Parameters:
@PlanTime29[DateTime] = 2020/8/1 0:00:00
@ID28[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:37:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode30) AND ([TbModelOtherInfo].[Type] = @Type31) 	
Parameters:
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type31[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:37:19
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime33 WHERE [TbModelOtherInfo].[ID] = @ID32	
Parameters:
@PlanTime33[DateTime] = 2020/8/6 0:00:00
@ID32[Int32] = 121


-----------------------------------------------------------------------------
2020-08-28 14:37:22
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode34) AND ([TbModelReporte].[Type] = @Type35) 	
Parameters:
@ComponentCode34[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@Type35[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:37:25
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode36) AND ([TbModelOtherInfo].[Type] = @Type37) 	
Parameters:
@ComponentCode36[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF%
@Type37[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:37:30
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime39 WHERE [TbModelReporte].[ID] = @ID38	
Parameters:
@PlanTime39[DateTime] = 2020/8/6 0:00:00
@ID38[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:37:32
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 14:37:32
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode40,@ComponentCode41)) AND ([TbModelOtherInfo].[Type] = @Type42) 	
Parameters:
@ComponentCode40[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode41[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type42[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:37:32
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime44 WHERE [TbModelOtherInfo].[ID] = @ID43	
Parameters:
@PlanTime44[DateTime] = 2020/8/6 0:00:00
@ID43[Int32] = 58


-----------------------------------------------------------------------------
2020-08-28 14:37:32
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime46 WHERE [TbModelOtherInfo].[ID] = @ID45	
Parameters:
@PlanTime46[DateTime] = 2020/8/6 0:00:00
@ID45[Int32] = 64


-----------------------------------------------------------------------------
2020-08-28 14:37:49
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode47) AND ([TbModelOtherInfo].[Type] = @Type48) 	
Parameters:
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type48[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:37:49
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime50 WHERE [TbModelOtherInfo].[ID] = @ID49	
Parameters:
@PlanTime50[DateTime] = 2020/8/10 0:00:00
@ID49[Int32] = 139


-----------------------------------------------------------------------------
2020-08-28 14:37:51
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode51) AND ([TbModelReporte].[Type] = @Type52) 	
Parameters:
@ComponentCode51[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@Type52[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:37:51
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode53) AND ([TbModelOtherInfo].[Type] = @Type54) 	
Parameters:
@ComponentCode53[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%
@Type54[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:37:51
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime56 WHERE [TbModelReporte].[ID] = @ID55	
Parameters:
@PlanTime56[DateTime] = 2020/8/10 0:00:00
@ID55[Int32] = 62


-----------------------------------------------------------------------------
2020-08-28 14:38:05
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:38:23
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode57,@ComponentCode58)) AND ([TbModelOtherInfo].[Type] = @Type59) 	
Parameters:
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type59[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:39:19
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime61 WHERE [TbModelOtherInfo].[ID] = @ID60	
Parameters:
@PlanTime61[DateTime] = 2020/8/10 0:00:00
@ID60[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:39:19
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime63 WHERE [TbModelOtherInfo].[ID] = @ID62	
Parameters:
@PlanTime63[DateTime] = 2020/8/10 0:00:00
@ID62[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 14:39:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:40:35
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:40:35
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:40:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:40:37
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:40:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083829464571372
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:52
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083829464571372')	


-----------------------------------------------------------------------------
2020-08-28 14:40:52
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083829464571372


-----------------------------------------------------------------------------
2020-08-28 14:40:52
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083829464571372


-----------------------------------------------------------------------------
2020-08-28 14:40:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:40:59
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:40:59
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:40:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:41:01
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28,@ComponentCode29,@ComponentCode30)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:41:07
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode31,@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode31[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type34[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:41:13
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:41:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode35) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart36)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId37,@MxGjId38)) 	
Parameters:
@SiteCode35[String] = 6373083923489249281
@RevokeStart36[String] = 未撤销
@MxGjId37[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId38[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 14:41:13
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode39,@ComponentCode40)) AND ([TbModelOtherInfo].[Type] = @Type41) 	
Parameters:
@ComponentCode39[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode40[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type41[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:42:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode42) AND ([TbModelOtherInfo].[Type] = @Type43) 	
Parameters:
@ComponentCode42[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type43[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:42:08
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime45 WHERE [TbModelOtherInfo].[ID] = @ID44	
Parameters:
@PlanTime45[DateTime] = 2020/8/1 0:00:00
@ID44[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 14:43:22
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type46) 	
Parameters:
@Type46[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:43:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:43:58
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:43:58
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:43:58
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type47) AND ([TbOrganizationMap].[ProjectId] = @ProjectId48)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54,@CompanyCode55,@CompanyCode56)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode57))) 	
Parameters:
@Type47[Int32] = 1
@ProjectId48[String] = 6372912251695766465
@CompanyCode49[String] = 6373083923489249281
@CompanyCode50[String] = 6373083925531366080
@CompanyCode51[String] = 6373083927883400612
@CompanyCode52[String] = 6373083918575368225
@CompanyCode53[String] = 6373083920445075162
@CompanyCode54[String] = 6373083908618598731
@CompanyCode55[String] = 6373083911842783146
@CompanyCode56[String] = 6373083913928202424
@ParentCompanyCode57[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type58) AND ([TbOrganizationMap].[ProjectId] = @ProjectId59)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65,@CompanyCode66,@CompanyCode67)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode68))) 	
Parameters:
@Type58[Int32] = 2
@ProjectId59[String] = 6372912251695766465
@CompanyCode60[String] = 6373083923489249281
@CompanyCode61[String] = 6373083925531366080
@CompanyCode62[String] = 6373083927883400612
@CompanyCode63[String] = 6373083918575368225
@CompanyCode64[String] = 6373083920445075162
@CompanyCode65[String] = 6373083908618598731
@CompanyCode66[String] = 6373083911842783146
@CompanyCode67[String] = 6373083913928202424
@ParentCompanyCode68[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:43:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:44:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:44:05
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:44:05
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:44:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:44:06
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode70) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode71) 	
Parameters:
@SiteCode70[String] = 6373083923489249281
@ComponentCode71[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode72) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart73)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode74,@ComponentCode75,@ComponentCode76)) 	
Parameters:
@SiteCode72[String] = 6373083923489249281
@RevokeStart73[String] = 未撤销
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:44:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode77,@ComponentCode78,@ComponentCode79)) AND ([TbModelOtherInfo].[Type] = @Type80) 	
Parameters:
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type80[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:44:15
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:44:15
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode81) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart82)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId83,@MxGjId84)) 	
Parameters:
@SiteCode81[String] = 6373083923489249281
@RevokeStart82[String] = 未撤销
@MxGjId83[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId84[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 14:44:15
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode85,@ComponentCode86)) AND ([TbModelOtherInfo].[Type] = @Type87) 	
Parameters:
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode86[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type87[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:44:32
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode88) AND ([TbModelOtherInfo].[Type] = @Type89) 	
Parameters:
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type89[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:44:32
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime91 WHERE [TbModelOtherInfo].[ID] = @ID90	
Parameters:
@PlanTime91[DateTime] = 2020/8/2 0:00:00
@ID90[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 14:44:32
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type92) 	
Parameters:
@Type92[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:45:47
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode93) AND ([TbModelOtherInfo].[Type] = @Type94) 	
Parameters:
@ComponentCode93[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type94[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:45:54
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime96 WHERE [TbModelOtherInfo].[ID] = @ID95	
Parameters:
@PlanTime96[DateTime] = 2020/8/10 0:00:00
@ID95[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:45:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type97) 	
Parameters:
@Type97[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:46:58
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:47:13
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:47:13
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:47:13
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type98) AND ([TbOrganizationMap].[ProjectId] = @ProjectId99)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode100,@CompanyCode101,@CompanyCode102,@CompanyCode103,@CompanyCode104,@CompanyCode105,@CompanyCode106,@CompanyCode107)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode108))) 	
Parameters:
@Type98[Int32] = 1
@ProjectId99[String] = 6372912251695766465
@CompanyCode100[String] = 6373083923489249281
@CompanyCode101[String] = 6373083925531366080
@CompanyCode102[String] = 6373083927883400612
@CompanyCode103[String] = 6373083918575368225
@CompanyCode104[String] = 6373083920445075162
@CompanyCode105[String] = 6373083908618598731
@CompanyCode106[String] = 6373083911842783146
@CompanyCode107[String] = 6373083913928202424
@ParentCompanyCode108[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type109) AND ([TbOrganizationMap].[ProjectId] = @ProjectId110)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode111,@CompanyCode112,@CompanyCode113,@CompanyCode114,@CompanyCode115,@CompanyCode116,@CompanyCode117,@CompanyCode118)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode119))) 	
Parameters:
@Type109[Int32] = 2
@ProjectId110[String] = 6372912251695766465
@CompanyCode111[String] = 6373083923489249281
@CompanyCode112[String] = 6373083925531366080
@CompanyCode113[String] = 6373083927883400612
@CompanyCode114[String] = 6373083918575368225
@CompanyCode115[String] = 6373083920445075162
@CompanyCode116[String] = 6373083908618598731
@CompanyCode117[String] = 6373083911842783146
@CompanyCode118[String] = 6373083913928202424
@ParentCompanyCode119[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:47:14
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:47:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:47:19
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:47:19
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:47:19
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:47:20
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:47:25
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode121) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode122) 	
Parameters:
@SiteCode121[String] = 6373083923489249281
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:47:25
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:47:26
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:47:26
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:47:26
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode123) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart124)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode125,@ComponentCode126,@ComponentCode127)) 	
Parameters:
@SiteCode123[String] = 6373083923489249281
@RevokeStart124[String] = 未撤销
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:47:26
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode128,@ComponentCode129,@ComponentCode130)) AND ([TbModelOtherInfo].[Type] = @Type131) 	
Parameters:
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode130[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type131[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:47:28
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 14:47:28
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode132) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart133)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId134,@MxGjId135)) 	
Parameters:
@SiteCode132[String] = 6373083923489249281
@RevokeStart133[String] = 未撤销
@MxGjId134[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId135[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 14:47:28
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode136,@ComponentCode137)) AND ([TbModelOtherInfo].[Type] = @Type138) 	
Parameters:
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type138[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:48:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode139) AND ([TbModelOtherInfo].[Type] = @Type140) 	
Parameters:
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type140[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:48:29
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime142 WHERE [TbModelOtherInfo].[ID] = @ID141	
Parameters:
@PlanTime142[DateTime] = 2020/8/2 0:00:00
@ID141[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 14:48:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type143) 	
Parameters:
@Type143[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:49:52
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:49:52
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:49:52
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type144) AND ([TbOrganizationMap].[ProjectId] = @ProjectId145)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode146,@CompanyCode147,@CompanyCode148,@CompanyCode149,@CompanyCode150,@CompanyCode151,@CompanyCode152,@CompanyCode153)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode154))) 	
Parameters:
@Type144[Int32] = 1
@ProjectId145[String] = 6372912251695766465
@CompanyCode146[String] = 6373083923489249281
@CompanyCode147[String] = 6373083925531366080
@CompanyCode148[String] = 6373083927883400612
@CompanyCode149[String] = 6373083918575368225
@CompanyCode150[String] = 6373083920445075162
@CompanyCode151[String] = 6373083908618598731
@CompanyCode152[String] = 6373083911842783146
@CompanyCode153[String] = 6373083913928202424
@ParentCompanyCode154[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type155) AND ([TbOrganizationMap].[ProjectId] = @ProjectId156)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode157,@CompanyCode158,@CompanyCode159,@CompanyCode160,@CompanyCode161,@CompanyCode162,@CompanyCode163,@CompanyCode164)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode165))) 	
Parameters:
@Type155[Int32] = 2
@ProjectId156[String] = 6372912251695766465
@CompanyCode157[String] = 6373083923489249281
@CompanyCode158[String] = 6373083925531366080
@CompanyCode159[String] = 6373083927883400612
@CompanyCode160[String] = 6373083918575368225
@CompanyCode161[String] = 6373083920445075162
@CompanyCode162[String] = 6373083908618598731
@CompanyCode163[String] = 6373083911842783146
@CompanyCode164[String] = 6373083913928202424
@ParentCompanyCode165[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:49:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:49:59
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:49:59
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:49:59
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:49:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:50:01
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode167) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode168) 	
Parameters:
@SiteCode167[String] = 6373083923489249281
@ComponentCode168[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode169) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart170)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode171,@ComponentCode172,@ComponentCode173)) 	
Parameters:
@SiteCode169[String] = 6373083923489249281
@RevokeStart170[String] = 未撤销
@ComponentCode171[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode172[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode173[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:50:05
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode174,@ComponentCode175,@ComponentCode176)) AND ([TbModelOtherInfo].[Type] = @Type177) 	
Parameters:
@ComponentCode174[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode175[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode176[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type177[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:50:09
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:50:09
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode178) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart179)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId180,@MxGjId181)) 	
Parameters:
@SiteCode178[String] = 6373083923489249281
@RevokeStart179[String] = 未撤销
@MxGjId180[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId181[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 14:50:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode182,@ComponentCode183)) AND ([TbModelOtherInfo].[Type] = @Type184) 	
Parameters:
@ComponentCode182[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode183[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type184[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:50:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode185) AND ([TbModelOtherInfo].[Type] = @Type186) 	
Parameters:
@ComponentCode185[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type186[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:50:33
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime188 WHERE [TbModelOtherInfo].[ID] = @ID187	
Parameters:
@PlanTime188[DateTime] = 2020/8/1 0:00:00
@ID187[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 14:50:40
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode189) AND ([TbModelOtherInfo].[Type] = @Type190) 	
Parameters:
@ComponentCode189[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@Type190[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:52:52
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:53:00
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 14:53:00
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 14:53:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type191) AND ([TbOrganizationMap].[ProjectId] = @ProjectId192)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode193,@CompanyCode194,@CompanyCode195,@CompanyCode196,@CompanyCode197,@CompanyCode198,@CompanyCode199,@CompanyCode200)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode201))) 	
Parameters:
@Type191[Int32] = 1
@ProjectId192[String] = 6372912251695766465
@CompanyCode193[String] = 6373083923489249281
@CompanyCode194[String] = 6373083925531366080
@CompanyCode195[String] = 6373083927883400612
@CompanyCode196[String] = 6373083918575368225
@CompanyCode197[String] = 6373083920445075162
@CompanyCode198[String] = 6373083908618598731
@CompanyCode199[String] = 6373083911842783146
@CompanyCode200[String] = 6373083913928202424
@ParentCompanyCode201[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type202) AND ([TbOrganizationMap].[ProjectId] = @ProjectId203)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode204,@CompanyCode205,@CompanyCode206,@CompanyCode207,@CompanyCode208,@CompanyCode209,@CompanyCode210,@CompanyCode211)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode212))) 	
Parameters:
@Type202[Int32] = 2
@ProjectId203[String] = 6372912251695766465
@CompanyCode204[String] = 6373083923489249281
@CompanyCode205[String] = 6373083925531366080
@CompanyCode206[String] = 6373083927883400612
@CompanyCode207[String] = 6373083918575368225
@CompanyCode208[String] = 6373083920445075162
@CompanyCode209[String] = 6373083908618598731
@CompanyCode210[String] = 6373083911842783146
@CompanyCode211[String] = 6373083913928202424
@ParentCompanyCode212[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 14:53:03
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 14:53:04
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:53:04
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:53:04
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 14:53:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:53:10
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 14:53:10
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:53:10
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:53:12
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 14:53:16
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode214) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode215) 	
Parameters:
@SiteCode214[String] = 6373083923489249281
@ComponentCode215[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 14:53:17
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:53:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:53:17
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 14:53:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode216) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart217)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode218,@ComponentCode219,@ComponentCode220)) 	
Parameters:
@SiteCode216[String] = 6373083923489249281
@RevokeStart217[String] = 未撤销
@ComponentCode218[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode219[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode220[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 14:53:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode221,@ComponentCode222,@ComponentCode223)) AND ([TbModelOtherInfo].[Type] = @Type224) 	
Parameters:
@ComponentCode221[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode222[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode223[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type224[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:53:20
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 14:53:20
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode225) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart226)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId227,@MxGjId228)) 	
Parameters:
@SiteCode225[String] = 6373083923489249281
@RevokeStart226[String] = 未撤销
@MxGjId227[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId228[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 14:53:20
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode229,@ComponentCode230)) AND ([TbModelOtherInfo].[Type] = @Type231) 	
Parameters:
@ComponentCode229[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode230[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type231[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:53:33
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode232) AND ([TbModelOtherInfo].[Type] = @Type233) 	
Parameters:
@ComponentCode232[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type233[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 14:53:36
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime235 WHERE [TbModelOtherInfo].[ID] = @ID234	
Parameters:
@PlanTime235[DateTime] = 2020/8/3 0:00:00
@ID234[Int32] = 61


-----------------------------------------------------------------------------
2020-08-28 14:53:41
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode236) AND ([TbModelOtherInfo].[Type] = @Type237) 	
Parameters:
@ComponentCode236[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type237[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:54:03
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime239 WHERE [TbModelOtherInfo].[ID] = @ID238	
Parameters:
@PlanTime239[DateTime] = 2020/8/3 0:00:00
@ID238[Int32] = 139


-----------------------------------------------------------------------------
2020-08-28 14:56:14
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode240) AND ([TbModelReporte].[Type] = @Type241) 	
Parameters:
@ComponentCode240[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@Type241[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 14:56:19
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode242) AND ([TbModelOtherInfo].[Type] = @Type243) 	
Parameters:
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF%
@Type243[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 14:56:33
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime245 WHERE [TbModelReporte].[ID] = @ID244	
Parameters:
@PlanTime245[DateTime] = 2020/8/3 0:00:00
@ID244[Int32] = 62


-----------------------------------------------------------------------------
2020-08-28 14:56:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 14:59:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:00:12
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 15:00:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode246) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart247)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId248,@MxGjId249)) 	
Parameters:
@SiteCode246[String] = 6373083923489249281
@RevokeStart247[String] = 未撤销
@MxGjId248[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId249[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 15:00:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode250,@ComponentCode251)) AND ([TbModelOtherInfo].[Type] = @Type252) 	
Parameters:
@ComponentCode250[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type252[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 15:02:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:04:39
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 15:04:39
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 15:04:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type253) AND ([TbOrganizationMap].[ProjectId] = @ProjectId254)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode255,@CompanyCode256,@CompanyCode257,@CompanyCode258,@CompanyCode259,@CompanyCode260,@CompanyCode261,@CompanyCode262)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode263))) 	
Parameters:
@Type253[Int32] = 1
@ProjectId254[String] = 6372912251695766465
@CompanyCode255[String] = 6373083923489249281
@CompanyCode256[String] = 6373083925531366080
@CompanyCode257[String] = 6373083927883400612
@CompanyCode258[String] = 6373083918575368225
@CompanyCode259[String] = 6373083920445075162
@CompanyCode260[String] = 6373083908618598731
@CompanyCode261[String] = 6373083911842783146
@CompanyCode262[String] = 6373083913928202424
@ParentCompanyCode263[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type264) AND ([TbOrganizationMap].[ProjectId] = @ProjectId265)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode266,@CompanyCode267,@CompanyCode268,@CompanyCode269,@CompanyCode270,@CompanyCode271,@CompanyCode272,@CompanyCode273)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode274))) 	
Parameters:
@Type264[Int32] = 2
@ProjectId265[String] = 6372912251695766465
@CompanyCode266[String] = 6373083923489249281
@CompanyCode267[String] = 6373083925531366080
@CompanyCode268[String] = 6373083927883400612
@CompanyCode269[String] = 6373083918575368225
@CompanyCode270[String] = 6373083920445075162
@CompanyCode271[String] = 6373083908618598731
@CompanyCode272[String] = 6373083911842783146
@CompanyCode273[String] = 6373083913928202424
@ParentCompanyCode274[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 15:04:40
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 15:04:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 15:04:54
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 15:04:54
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 15:04:54
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 15:04:55
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode276) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode277) 	
Parameters:
@SiteCode276[String] = 6373083923489249281
@ComponentCode277[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode278) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart279)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode280)) 	
Parameters:
@SiteCode278[String] = 6373083923489249281
@RevokeStart279[String] = 未撤销
@ComponentCode280[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF


-----------------------------------------------------------------------------
2020-08-28 15:05:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode281)) AND ([TbModelOtherInfo].[Type] = @Type282) 	
Parameters:
@ComponentCode281[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type282[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 15:07:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:10:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:13:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:16:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:19:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:22:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:25:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:28:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:31:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:34:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:37:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:40:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:43:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:46:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:49:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:52:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:55:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 15:58:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:01:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:04:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:07:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:10:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:13:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:16:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:18:13
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:18:13
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:18:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:18:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:18:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:18
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:18:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:18:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:23
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:18:23
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:18:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:18:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:18:38
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:18:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:19:12
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/28 16:19:12
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:19:13
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:20:20
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-28 16:20:20
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:20:20
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:20:20
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:20:20
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:20:21
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/28 16:20:21
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-28 16:20:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:20:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:20:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:20:22
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:20:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:20:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:20:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:28
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:20:28
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:20:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:20:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:20:32
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-28 16:22:30
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/28 16:22:30
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-28 16:22:32
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:22:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:22:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:22:33
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:24:08
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:24:09
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:24:09
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:24:10
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:24:41
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:24:41
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:24:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:24:41
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:24:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:25:13
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:25:13
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:25:28
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:26:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:26:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:26:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:26:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:26:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:26:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:26:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:26:18
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:26:18
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:26:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:26:20
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:27:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:28:53
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:28:53
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:28:53
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:28:54
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:31:00
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:31:00
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:31:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:31:01
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:31:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:31:26
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 16:31:26
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:31:26
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:31:28
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode46) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode47) 	
Parameters:
@SiteCode46[String] = 6373083923489249281
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode48) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart49)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode50,@ComponentCode51,@ComponentCode52)) 	
Parameters:
@SiteCode48[String] = 6373083923489249281
@RevokeStart49[String] = 未撤销
@ComponentCode50[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode51[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode52[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 16:31:34
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode53,@ComponentCode54,@ComponentCode55)) AND ([TbModelOtherInfo].[Type] = @Type56) 	
Parameters:
@ComponentCode53[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type56[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:31:40
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 16:31:40
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode57) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart58)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId59,@MxGjId60)) 	
Parameters:
@SiteCode57[String] = 6373083923489249281
@RevokeStart58[String] = 未撤销
@MxGjId59[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId60[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 16:31:40
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode61,@ComponentCode62)) AND ([TbModelOtherInfo].[Type] = @Type63) 	
Parameters:
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type63[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:32:54
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode65) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode66) 	
Parameters:
@SiteCode65[String] = 6373083923489249281
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode68) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode69) 	
Parameters:
@SiteCode68[String] = 6373083923489249281
@ComponentCode69[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode70) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart71)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode72,@ComponentCode73,@ComponentCode74)) 	
Parameters:
@SiteCode70[String] = 6373083923489249281
@RevokeStart71[String] = 未撤销
@ComponentCode72[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode73[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 16:32:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode75,@ComponentCode76,@ComponentCode77)) AND ([TbModelOtherInfo].[Type] = @Type78) 	
Parameters:
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type78[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:34:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:35:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:35:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:35:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:35:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:35:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:35:15
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:35:15
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:35:16
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:35:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:35:20
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 16:35:20
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:35:20
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:35:22
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode24) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode25) 	
Parameters:
@SiteCode24[String] = 6373083923489249281
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode26) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart27)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode28,@ComponentCode29,@ComponentCode30)) 	
Parameters:
@SiteCode26[String] = 6373083923489249281
@RevokeStart27[String] = 未撤销
@ComponentCode28[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode29[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode30[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF


-----------------------------------------------------------------------------
2020-08-28 16:35:26
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode31,@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode31[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type34[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:35:33
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 16:35:33
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode35) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart36)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId37,@MxGjId38)) 	
Parameters:
@SiteCode35[String] = 6373083923489249281
@RevokeStart36[String] = 未撤销
@MxGjId37[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId38[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 16:35:33
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode39,@ComponentCode40)) AND ([TbModelOtherInfo].[Type] = @Type41) 	
Parameters:
@ComponentCode39[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode40[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type41[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:35:41
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 16:35:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode42) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart43)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId44,@MxGjId45)) 	
Parameters:
@SiteCode42[String] = 6373083923489249281
@RevokeStart43[String] = 未撤销
@MxGjId44[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId45[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-28 16:35:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode46,@ComponentCode47)) AND ([TbModelOtherInfo].[Type] = @Type48) 	
Parameters:
@ComponentCode46[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type48[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode50) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode51) 	
Parameters:
@SiteCode50[String] = 6373083923489249281
@ComponentCode51[String] = L21_Z08_00KT_DXT_DXT_MD%


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode52) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart53)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode54,@ComponentCode55,@ComponentCode56,@ComponentCode57,@ComponentCode58,@ComponentCode59,@ComponentCode60,@ComponentCode61,@ComponentCode62)) 	
Parameters:
@SiteCode52[String] = 6373083923489249281
@RevokeStart53[String] = 未撤销
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:35:50
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode63,@ComponentCode64,@ComponentCode65,@ComponentCode66,@ComponentCode67,@ComponentCode68,@ComponentCode69,@ComponentCode70,@ComponentCode71)) AND ([TbModelOtherInfo].[Type] = @Type72) 	
Parameters:
@ComponentCode63[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode64[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode68[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode69[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode70[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode71[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type72[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode74) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode75) 	
Parameters:
@SiteCode74[String] = 6373083923489249281
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode76) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart77)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode78,@ComponentCode79,@ComponentCode80,@ComponentCode81,@ComponentCode82,@ComponentCode83)) 	
Parameters:
@SiteCode76[String] = 6373083923489249281
@RevokeStart77[String] = 未撤销
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode80[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode81[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode82[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode83[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:35:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode84,@ComponentCode85,@ComponentCode86,@ComponentCode87,@ComponentCode88,@ComponentCode89)) AND ([TbModelOtherInfo].[Type] = @Type90) 	
Parameters:
@ComponentCode84[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode86[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode87[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode89[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type90[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:02
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode91) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart92)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId93,@MxGjId94)) 	
Parameters:
@SiteCode91[String] = 6373083923489249281
@RevokeStart92[String] = 未撤销
@MxGjId93[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId94[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:36:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode95,@ComponentCode96)) AND ([TbModelOtherInfo].[Type] = @Type97) 	
Parameters:
@ComponentCode95[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode96[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type97[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:09
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode98) AND ([TbModelOtherInfo].[Type] = @Type99) 	
Parameters:
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type99[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:09
Text:	INSERT INTO [TbModelOtherInfo] ([ComponentCode],[PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@ComponentCode100,@PlanTime101,@Remark102,@SiteCode103,@Type104,@ProjectId105);select scope_identity()	
Parameters:
@ComponentCode100[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@PlanTime101[DateTime] = 2020/8/6 0:00:00
@Remark102[String] = 
@SiteCode103[String] = 6373083923489249281
@Type104[Int32] = 1
@ProjectId105[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:36:09
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode106) AND ([TbModelReporte].[Type] = @Type107) 	
Parameters:
@ComponentCode106[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@Type107[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:36:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode108) AND ([TbModelOtherInfo].[Type] = @Type109) 	
Parameters:
@ComponentCode108[String] = L21_Z08_00KT_DXT_DXT_MD_MD%
@Type109[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:09
Text:	UPDATE [TbModelReporte] SET [PlanTime]=@PlanTime111 WHERE [TbModelReporte].[ID] = @ID110	
Parameters:
@PlanTime111[DateTime] = 2020/8/6 0:00:00
@ID110[Int32] = 63


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode112,@ComponentCode113)) AND ([TbModelOtherInfo].[Type] = @Type114) 	
Parameters:
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type114[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	INSERT INTO [TbModelOtherInfo] ([ComponentCode],[ComponentParentCode],[SiteCode],[ProjectId],[PlanTime],[Type]) VALUES (@ComponentCode115,@ComponentParentCode116,@SiteCode117,@ProjectId118,@PlanTime119,@Type120);select scope_identity()	
Parameters:
@ComponentCode115[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentParentCode116[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@SiteCode117[String] = 6373083923489249281
@ProjectId118[String] = 6372912251695766465
@PlanTime119[DateTime] = 2020/8/6 0:00:00
@Type120[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	INSERT INTO [TbModelOtherInfo] ([ComponentCode],[ComponentParentCode],[SiteCode],[ProjectId],[PlanTime],[Type]) VALUES (@ComponentCode121,@ComponentParentCode122,@SiteCode123,@ProjectId124,@PlanTime125,@Type126);select scope_identity()	
Parameters:
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentParentCode122[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@SiteCode123[String] = 6373083923489249281
@ProjectId124[String] = 6372912251695766465
@PlanTime125[DateTime] = 2020/8/6 0:00:00
@Type126[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode127) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart128)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId129,@MxGjId130)) 	
Parameters:
@SiteCode127[String] = 6373083923489249281
@RevokeStart128[String] = 未撤销
@MxGjId129[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId130[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:36:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode131,@ComponentCode132)) AND ([TbModelOtherInfo].[Type] = @Type133) 	
Parameters:
@ComponentCode131[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode132[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type133[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:17
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:17
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode134) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart135)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140,@ComponentCode141)) 	
Parameters:
@SiteCode134[String] = 6373083923489249281
@RevokeStart135[String] = 未撤销
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:36:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode142,@ComponentCode143,@ComponentCode144,@ComponentCode145,@ComponentCode146,@ComponentCode147)) AND ([TbModelOtherInfo].[Type] = @Type148) 	
Parameters:
@ComponentCode142[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type148[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:20
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:20
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode149) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart150)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId151,@MxGjId152)) 	
Parameters:
@SiteCode149[String] = 6373083923489249281
@RevokeStart150[String] = 未撤销
@MxGjId151[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId152[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:36:20
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode153,@ComponentCode154)) AND ([TbModelOtherInfo].[Type] = @Type155) 	
Parameters:
@ComponentCode153[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type155[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:27
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode156) AND ([TbModelOtherInfo].[Type] = @Type157) 	
Parameters:
@ComponentCode156[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@Type157[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:27
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime159 WHERE [TbModelOtherInfo].[ID] = @ID158	
Parameters:
@PlanTime159[DateTime] = 2020/8/11 0:00:00
@ID158[Int32] = 227


-----------------------------------------------------------------------------
2020-08-28 16:36:27
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode160) AND ([TbModelOtherInfo].[Type] = @Type161) 	
Parameters:
@ComponentCode160[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type161[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode162) AND ([TbModelOtherInfo].[Type] = @Type163) 	
Parameters:
@ComponentCode162[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type163[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:29
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime165 WHERE [TbModelOtherInfo].[ID] = @ID164	
Parameters:
@PlanTime165[DateTime] = 2020/8/6 0:00:00
@ID164[Int32] = 228


-----------------------------------------------------------------------------
2020-08-28 16:36:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode166) AND ([TbModelOtherInfo].[Type] = @Type167) 	
Parameters:
@ComponentCode166[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type167[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:31
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:31
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:31
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode168) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart169)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode170,@ComponentCode171,@ComponentCode172,@ComponentCode173,@ComponentCode174,@ComponentCode175)) 	
Parameters:
@SiteCode168[String] = 6373083923489249281
@RevokeStart169[String] = 未撤销
@ComponentCode170[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode171[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode172[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode173[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode174[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode175[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:36:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode176,@ComponentCode177,@ComponentCode178,@ComponentCode179,@ComponentCode180,@ComponentCode181)) AND ([TbModelOtherInfo].[Type] = @Type182) 	
Parameters:
@ComponentCode176[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode177[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode178[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode179[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode180[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode181[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type182[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:34
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:34
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode183) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart184)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId185,@MxGjId186)) 	
Parameters:
@SiteCode183[String] = 6373083923489249281
@RevokeStart184[String] = 未撤销
@MxGjId185[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId186[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:36:34
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode187,@ComponentCode188)) AND ([TbModelOtherInfo].[Type] = @Type189) 	
Parameters:
@ComponentCode187[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode188[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type189[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:52
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode190) AND ([TbModelOtherInfo].[Type] = @Type191) 	
Parameters:
@ComponentCode190[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@Type191[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:36:52
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime193 WHERE [TbModelOtherInfo].[ID] = @ID192	
Parameters:
@PlanTime193[DateTime] = 2020/8/1 0:00:00
@ID192[Int32] = 227


-----------------------------------------------------------------------------
2020-08-28 16:36:52
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode194) AND ([TbModelOtherInfo].[Type] = @Type195) 	
Parameters:
@ComponentCode194[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type195[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:55
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:55
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:55
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode196) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart197)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode198,@ComponentCode199,@ComponentCode200,@ComponentCode201,@ComponentCode202,@ComponentCode203)) 	
Parameters:
@SiteCode196[String] = 6373083923489249281
@RevokeStart197[String] = 未撤销
@ComponentCode198[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode199[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode200[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode201[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode202[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode203[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:36:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode204,@ComponentCode205,@ComponentCode206,@ComponentCode207,@ComponentCode208,@ComponentCode209)) AND ([TbModelOtherInfo].[Type] = @Type210) 	
Parameters:
@ComponentCode204[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode205[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode206[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode207[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode208[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode209[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type210[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:36:58
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:36:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode211) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart212)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId213,@MxGjId214)) 	
Parameters:
@SiteCode211[String] = 6373083923489249281
@RevokeStart212[String] = 未撤销
@MxGjId213[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId214[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:36:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode215,@ComponentCode216)) AND ([TbModelOtherInfo].[Type] = @Type217) 	
Parameters:
@ComponentCode215[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode216[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type217[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:37:07
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode218) AND ([TbModelOtherInfo].[Type] = @Type219) 	
Parameters:
@ComponentCode218[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type219[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:37:07
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime221 WHERE [TbModelOtherInfo].[ID] = @ID220	
Parameters:
@PlanTime221[DateTime] = 2020/8/28 0:00:00
@ID220[Int32] = 228


-----------------------------------------------------------------------------
2020-08-28 16:37:07
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode222) AND ([TbModelOtherInfo].[Type] = @Type223) 	
Parameters:
@ComponentCode222[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type223[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:37:10
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:37:10
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:37:10
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:37:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode224) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart225)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode226,@ComponentCode227,@ComponentCode228,@ComponentCode229,@ComponentCode230,@ComponentCode231)) 	
Parameters:
@SiteCode224[String] = 6373083923489249281
@RevokeStart225[String] = 未撤销
@ComponentCode226[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode227[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode228[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode229[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode230[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode231[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:37:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode232,@ComponentCode233,@ComponentCode234,@ComponentCode235,@ComponentCode236,@ComponentCode237)) AND ([TbModelOtherInfo].[Type] = @Type238) 	
Parameters:
@ComponentCode232[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode233[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode234[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode235[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode236[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode237[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type238[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:37:13
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:37:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode239) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart240)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId241,@MxGjId242)) 	
Parameters:
@SiteCode239[String] = 6373083923489249281
@RevokeStart240[String] = 未撤销
@MxGjId241[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId242[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:37:13
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode243,@ComponentCode244)) AND ([TbModelOtherInfo].[Type] = @Type245) 	
Parameters:
@ComponentCode243[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode244[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type245[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:37:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode246) AND ([TbModelOtherInfo].[Type] = @Type247) 	
Parameters:
@ComponentCode246[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type247[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:37:59
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime249 WHERE [TbModelOtherInfo].[ID] = @ID248	
Parameters:
@PlanTime249[DateTime] = 2020/8/27 0:00:00
@ID248[Int32] = 228


-----------------------------------------------------------------------------
2020-08-28 16:38:26
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode250) AND ([TbModelOtherInfo].[Type] = @Type251) 	
Parameters:
@ComponentCode250[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type251[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:39:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:41:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:41:20
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1) AND ([TbModelOtherInfo].[Type] = @Type2) 	
Parameters:
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type2[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:41:20
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime4 WHERE [TbModelOtherInfo].[ID] = @ID3	
Parameters:
@PlanTime4[DateTime] = 2020/8/28 0:00:00
@ID3[Int32] = 228


-----------------------------------------------------------------------------
2020-08-28 16:41:22
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode5) AND ([TbModelOtherInfo].[Type] = @Type6) 	
Parameters:
@ComponentCode5[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type6[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:41:31
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime8 WHERE [TbModelOtherInfo].[ID] = @ID7	
Parameters:
@PlanTime8[DateTime] = 2020/8/28 0:00:00
@ID7[Int32] = 226


-----------------------------------------------------------------------------
2020-08-28 16:41:31
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode9) AND ([TbModelReporte].[Type] = @Type10) 	
Parameters:
@ComponentCode9[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@Type10[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:41:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode11) AND ([TbModelOtherInfo].[Type] = @Type12) 	
Parameters:
@ComponentCode11[String] = L21_Z08_00KT_DXT_DXT_MD_MD%
@Type12[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:42:04
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:42:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:42:04
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:42:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode13) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart14)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode15,@ComponentCode16,@ComponentCode17,@ComponentCode18,@ComponentCode19,@ComponentCode20)) 	
Parameters:
@SiteCode13[String] = 6373083923489249281
@RevokeStart14[String] = 未撤销
@ComponentCode15[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode16[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode17[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode18[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode19[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode20[String] = L21_Z08_00KT_DXT_DXT_MD_MD


-----------------------------------------------------------------------------
2020-08-28 16:42:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode21,@ComponentCode22,@ComponentCode23,@ComponentCode24,@ComponentCode25,@ComponentCode26)) AND ([TbModelOtherInfo].[Type] = @Type27) 	
Parameters:
@ComponentCode21[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode22[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode23[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode24[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode25[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode26[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type27[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 16:42:08
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 16:42:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode28) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart29)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId30,@MxGjId31)) 	
Parameters:
@SiteCode28[String] = 6373083923489249281
@RevokeStart29[String] = 未撤销
@MxGjId30[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId31[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7


-----------------------------------------------------------------------------
2020-08-28 16:42:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode32,@ComponentCode33)) AND ([TbModelOtherInfo].[Type] = @Type34) 	
Parameters:
@ComponentCode32[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode33[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@Type34[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:42:31
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x500-1250x500
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_D_%


-----------------------------------------------------------------------------
2020-08-28 16:42:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode35) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart36)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId37)) 	
Parameters:
@SiteCode35[String] = 6373083923489249281
@RevokeStart36[String] = 未撤销
@MxGjId37[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddd6


-----------------------------------------------------------------------------
2020-08-28 16:42:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode38)) AND ([TbModelOtherInfo].[Type] = @Type39) 	
Parameters:
@ComponentCode38[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@Type39[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 16:44:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:45:06
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 16:45:06
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 16:45:06
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select count(*) y, '未开始' as name,'#8E8E8E' as color from TbWorkOrderDetail where 1=1  and ComponentStrat='未加工' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:45:07
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 16:45:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 16:45:40
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 16:45:40
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:45:40
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:45:41
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 16:48:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:51:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:54:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 16:57:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:00:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:03:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:04:21
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 17:04:21
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 17:04:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	 select Sum(y) as y, '未开始' as name,'#8E8E8E' as color from (
                            select (Sum(PlanTotal)-(
                            select Count(*) from TbWorkOrderDetail 
                            where ComponentCode=a.ComponentCode and ComponentStrat='加工中' and RevokeStart='未撤销')
                            ) y
                            from TbModelReporte a 
                             where 1=1 and a.type=5 and State=0 group by ComponentCode) ret
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:04:22
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:04:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:04:28
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 17:04:28
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:04:28
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:04:29
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:05:26
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-28 17:05:26
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-28 17:05:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:05:26
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode desc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            isnull((select min(InsertTime) from TbWorkOrder where SiteCode=a.SiteCode),'') as BginTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中' and RevokeStart='未撤销') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	 select 
                            SiteCode as Code,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag
                            from TbModelReporte a
                            where 1=1
                            group by SiteCode	


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-28 17:05:27
Text:	select count(*) y, '未完成' as name,'#8E8E8E' as color from TbModelReporte where 1=1 and type=5 and state!=3 
                           union all
                           select count(*) y, '超期未完成' as name,'Red' as color from TbModelReporte where 1=1 and type=5 and state!=3 and Difference<0 
                           union all
                           select count(*) y, '超期完成' as name,'#F75000' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference<0 
                           union all
                           select count(*) y, '按期完成' as name,'Green' as color from TbModelReporte where 1=1 and type=5 and state=3 and Difference>=0 	


-----------------------------------------------------------------------------
2020-08-28 17:05:50
Text:	 select Sum(y) as y, '未开始' as name,'#8E8E8E' as color from (
                            select (Sum(PlanTotal)-(
                            select Count(*) from TbWorkOrderDetail 
                            where ComponentCode=a.ComponentCode and ComponentStrat='加工中' and RevokeStart='未撤销')
                            ) y
                            from TbModelReporte a 
                             where 1=1 and a.type=5 and State=0 group by ComponentCode) ret
                           union all
                           select count(*) y, '加工中' as name,'#F75000' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工中' and RevokeStart='未撤销'
                           union all
                           select count(*) y, '加工完成' as name,'blue' as color from TbWorkOrderDetail where 1=1 and ComponentStrat='加工完成' 
                           union all
                           select count(*) y, '安装完成' as name,'Green' as color from TbWorkOrderDetail where 1=1 and IsInstall='是' 	


-----------------------------------------------------------------------------
2020-08-28 17:05:50
Text:	WITH T
                                        AS( 
                                            SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                            UNION ALL 
                                            SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency
                                            FROM TbCompany a INNER JOIN T ON a.CompanyCode=T.ParentCompanyCode  
                                        ) 
                                        SELECT * FROM T  where T.CompanyCode!=@CompanyCode and T.OrgType!=1  order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:05:50
Text:	WITH T
                                     AS( 
                                         SELECT id,CompanyCode,ParentCompanyCode,CompanyFullName,Address,OrgType,LocalCurrency FROM TbCompany WHERE CompanyCode=@CompanyCode 
                                         UNION ALL 
                                         SELECT a.id,a.CompanyCode,a.ParentCompanyCode,a.CompanyFullName,a.Address,a.OrgType,a.LocalCurrency  FROM TbCompany a INNER JOIN T ON a.ParentCompanyCode=T.CompanyCode  
                                     ) 
                                     SELECT T.* FROM T where T.OrgType!=1 order by T.LocalCurrency asc;	
Parameters:
@CompanyCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:05:50
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-28 17:08:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:10:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:10:03
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-28 17:10:03
Text:	 select 
                             ComponentCode as Code,
                            (select PlanTotal from TbModelReporte where ComponentCode=a.ComponentCode) as PlanTotal,
                            (select count(*) from TbWorkOrderDetail where MxGjBm like a.ComponentCode+'_%' and IsInstall='是') as MachinTotal,  
                            (select count(*) from TbModelOtherInfo where ComponentCode like a.ComponentCode+'_%' and type=2 and Difference<0 and IsOver=0) as lag
                            from TbModelReporte a 
                            where type=5 and SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:10:03
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:10:04
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where b.RevokeStart='未撤销' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-28 17:11:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:14:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:17:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode46) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode47) 	
Parameters:
@SiteCode46[String] = 6373083923489249281
@ComponentCode47[String] = L21_Z08_00KT_DXT_DXT%


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode48) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart49)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode50,@ComponentCode51,@ComponentCode52,@ComponentCode53,@ComponentCode54,@ComponentCode55,@ComponentCode56,@ComponentCode57,@ComponentCode58,@ComponentCode59,@ComponentCode60,@ComponentCode61,@ComponentCode62,@ComponentCode63,@ComponentCode64,@ComponentCode65,@ComponentCode66,@ComponentCode67,@ComponentCode68,@ComponentCode69,@ComponentCode70,@ComponentCode71,@ComponentCode72,@ComponentCode73,@ComponentCode74,@ComponentCode75,@ComponentCode76,@ComponentCode77,@ComponentCode78,@ComponentCode79,@ComponentCode80,@ComponentCode81,@ComponentCode82,@ComponentCode83,@ComponentCode84,@ComponentCode85,@ComponentCode86,@ComponentCode87,@ComponentCode88,@ComponentCode89,@ComponentCode90,@ComponentCode91,@ComponentCode92,@ComponentCode93,@ComponentCode94,@ComponentCode95,@ComponentCode96,@ComponentCode97,@ComponentCode98,@ComponentCode99)) 	
Parameters:
@SiteCode48[String] = 6373083923489249281
@RevokeStart49[String] = 未撤销
@ComponentCode50[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode51[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode52[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@ComponentCode53[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode54[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode58[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode59[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B0
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B0
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B0
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B0
@ComponentCode63[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode64[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A0
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@ComponentCode68[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode69[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode70[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode71[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode72[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode73[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode79[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode80[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode81[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode82[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode83[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode84[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode86[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode87[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode89[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode90[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode91[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode92[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode93[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode94[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode95[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode96[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode97[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode99[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-28 17:18:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode100,@ComponentCode101,@ComponentCode102,@ComponentCode103,@ComponentCode104,@ComponentCode105,@ComponentCode106,@ComponentCode107,@ComponentCode108,@ComponentCode109,@ComponentCode110,@ComponentCode111,@ComponentCode112,@ComponentCode113,@ComponentCode114,@ComponentCode115,@ComponentCode116,@ComponentCode117,@ComponentCode118,@ComponentCode119,@ComponentCode120,@ComponentCode121,@ComponentCode122,@ComponentCode123,@ComponentCode124,@ComponentCode125,@ComponentCode126,@ComponentCode127,@ComponentCode128,@ComponentCode129,@ComponentCode130,@ComponentCode131,@ComponentCode132,@ComponentCode133,@ComponentCode134,@ComponentCode135,@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140,@ComponentCode141,@ComponentCode142,@ComponentCode143,@ComponentCode144,@ComponentCode145,@ComponentCode146,@ComponentCode147,@ComponentCode148,@ComponentCode149)) AND ([TbModelOtherInfo].[Type] = @Type150) 	
Parameters:
@ComponentCode100[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode101[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode102[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode103[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode104[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode105[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode106[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode107[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode108[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode109[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode110[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode111[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode115[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode116[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode117[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode130[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode131[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode132[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode135[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode142[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type150[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:18:54
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:18:54
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode151) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart152)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId153,@MxGjId154)) 	
Parameters:
@SiteCode151[String] = 6373083923489249281
@RevokeStart152[String] = 未撤销
@MxGjId153[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId154[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:18:54
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode155,@ComponentCode156)) AND ([TbModelOtherInfo].[Type] = @Type157) 	
Parameters:
@ComponentCode155[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode156[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type157[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode158) AND ([TbModelOtherInfo].[Type] = @Type159) 	
Parameters:
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type159[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime161 WHERE [TbModelOtherInfo].[ID] = @ID160	
Parameters:
@PlanTime161[DateTime] = 2020/8/12 0:00:00
@ID160[Int32] = 94


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode162) AND ([TbModelReporte].[Type] = @Type163) 	
Parameters:
@ComponentCode162[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type163[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode164) AND ([TbModelOtherInfo].[Type] = @Type165) 	
Parameters:
@ComponentCode164[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type165[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode166,@ComponentCode167)) AND ([TbModelOtherInfo].[Type] = @Type168) 	
Parameters:
@ComponentCode166[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode167[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type168[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime170 WHERE [TbModelOtherInfo].[ID] = @ID169	
Parameters:
@PlanTime170[DateTime] = 2020/8/12 0:00:00
@ID169[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime172 WHERE [TbModelOtherInfo].[ID] = @ID171	
Parameters:
@PlanTime172[DateTime] = 2020/8/12 0:00:00
@ID171[Int32] = 60


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode173) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart174)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId175,@MxGjId176)) 	
Parameters:
@SiteCode173[String] = 6373083923489249281
@RevokeStart174[String] = 未撤销
@MxGjId175[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId176[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:19:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode177,@ComponentCode178)) AND ([TbModelOtherInfo].[Type] = @Type179) 	
Parameters:
@ComponentCode177[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode178[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type179[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode180) AND ([TbModelOtherInfo].[Type] = @Type181) 	
Parameters:
@ComponentCode180[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type181[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime183 WHERE [TbModelOtherInfo].[ID] = @ID182	
Parameters:
@PlanTime183[DateTime] = 2020/8/27 0:00:00
@ID182[Int32] = 59


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode184) AND ([TbModelOtherInfo].[Type] = @Type185) 	
Parameters:
@ComponentCode184[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type185[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime187 WHERE [TbModelOtherInfo].[ID] = @ID186	
Parameters:
@PlanTime187[DateTime] = 2020/8/27 0:00:00
@ID186[Int32] = 94


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	 SELECT   TOP 1 * FROM [TbModelReporte]  WHERE ([TbModelReporte].[ComponentCode] = @ComponentCode188) AND ([TbModelReporte].[Type] = @Type189) 	
Parameters:
@ComponentCode188[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@Type189[Int32] = 5


-----------------------------------------------------------------------------
2020-08-28 17:19:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] LIKE @ComponentCode190) AND ([TbModelOtherInfo].[Type] = @Type191) 	
Parameters:
@ComponentCode190[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF%
@Type191[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:19:11
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:19:11
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode,MAX(SystemType) as SystemType
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:19:11
Text:	SELECT ComponentCode from TbModelReporte  where SiteCode=@SiteCode and Type=5  and ( ComponentCode like @ComponentCode )	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-28 17:19:11
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode192) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart193)) AND ([TbWorkOrderDetail].[ComponentCode] IN (@ComponentCode194,@ComponentCode195,@ComponentCode196,@ComponentCode197,@ComponentCode198,@ComponentCode199,@ComponentCode200,@ComponentCode201,@ComponentCode202,@ComponentCode203,@ComponentCode204,@ComponentCode205,@ComponentCode206,@ComponentCode207,@ComponentCode208,@ComponentCode209,@ComponentCode210,@ComponentCode211,@ComponentCode212,@ComponentCode213,@ComponentCode214,@ComponentCode215,@ComponentCode216,@ComponentCode217,@ComponentCode218,@ComponentCode219,@ComponentCode220,@ComponentCode221,@ComponentCode222,@ComponentCode223,@ComponentCode224,@ComponentCode225,@ComponentCode226,@ComponentCode227,@ComponentCode228,@ComponentCode229,@ComponentCode230,@ComponentCode231,@ComponentCode232,@ComponentCode233,@ComponentCode234,@ComponentCode235,@ComponentCode236,@ComponentCode237,@ComponentCode238,@ComponentCode239,@ComponentCode240,@ComponentCode241,@ComponentCode242,@ComponentCode243)) 	
Parameters:
@SiteCode192[String] = 6373083923489249281
@RevokeStart193[String] = 未撤销
@ComponentCode194[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF
@ComponentCode195[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF
@ComponentCode196[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF
@ComponentCode197[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode198[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode199[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode200[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode201[String] = L21_Z08_00KT_DXT_DXT_MD_D
@ComponentCode202[String] = L21_Z08_00KT_DXT_DXT_MD_MD
@ComponentCode203[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B0
@ComponentCode204[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B0
@ComponentCode205[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B0
@ComponentCode206[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B0
@ComponentCode207[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode208[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode209[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A0
@ComponentCode210[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A0
@ComponentCode211[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@ComponentCode212[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode213[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode214[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode215[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@ComponentCode216[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode217[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode218[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode219[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode220[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode221[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode222[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode223[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode224[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode225[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode226[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode227[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode228[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode229[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode230[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode231[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode232[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode233[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode234[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode235[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode236[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode237[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode238[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode239[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode240[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode241[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@ComponentCode243[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-28 17:19:11
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode244,@ComponentCode245,@ComponentCode246,@ComponentCode247,@ComponentCode248,@ComponentCode249,@ComponentCode250,@ComponentCode251,@ComponentCode252,@ComponentCode253,@ComponentCode254,@ComponentCode255,@ComponentCode256,@ComponentCode257,@ComponentCode258,@ComponentCode259,@ComponentCode260,@ComponentCode261,@ComponentCode262,@ComponentCode263,@ComponentCode264,@ComponentCode265,@ComponentCode266,@ComponentCode267,@ComponentCode268,@ComponentCode269,@ComponentCode270,@ComponentCode271,@ComponentCode272,@ComponentCode273,@ComponentCode274,@ComponentCode275,@ComponentCode276,@ComponentCode277,@ComponentCode278,@ComponentCode279,@ComponentCode280,@ComponentCode281,@ComponentCode282,@ComponentCode283,@ComponentCode284,@ComponentCode285,@ComponentCode286,@ComponentCode287,@ComponentCode288,@ComponentCode289,@ComponentCode290,@ComponentCode291,@ComponentCode292,@ComponentCode293)) AND ([TbModelOtherInfo].[Type] = @Type294) 	
Parameters:
@ComponentCode244[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode245[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode246[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode247[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode248[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode249[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode250[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode252[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode253[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode254[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode255[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode259[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode260[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode261[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode262[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode263[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode264[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode265[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode266[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode267[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode268[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode269[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode270[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode271[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode272[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode273[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode274[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode275[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode276[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode277[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode278[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode279[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode280[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode281[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode282[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode283[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode284[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode285[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode286[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode287[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode288[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode289[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode290[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode291[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode292[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode293[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type294[Int32] = 1


-----------------------------------------------------------------------------
2020-08-28 17:19:17
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:19:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode295) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart296)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId297,@MxGjId298)) 	
Parameters:
@SiteCode295[String] = 6373083923489249281
@RevokeStart296[String] = 未撤销
@MxGjId297[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId298[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:19:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode299,@ComponentCode300)) AND ([TbModelOtherInfo].[Type] = @Type301) 	
Parameters:
@ComponentCode299[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode300[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type301[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:19:35
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:19:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode302) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart303)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId304,@MxGjId305)) 	
Parameters:
@SiteCode302[String] = 6373083923489249281
@RevokeStart303[String] = 未撤销
@MxGjId304[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId305[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:19:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode306,@ComponentCode307)) AND ([TbModelOtherInfo].[Type] = @Type308) 	
Parameters:
@ComponentCode306[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode307[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type308[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:20:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:22:02
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-28 17:22:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode309) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart310)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId311,@MxGjId312)) 	
Parameters:
@SiteCode309[String] = 6373083923489249281
@RevokeStart310[String] = 未撤销
@MxGjId311[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId312[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-28 17:22:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode313,@ComponentCode314)) AND ([TbModelOtherInfo].[Type] = @Type315) 	
Parameters:
@ComponentCode313[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode314[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type315[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:23:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:23:51
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:23:51
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode316) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart317)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId318,@MxGjId319)) 	
Parameters:
@SiteCode316[String] = 6373083923489249281
@RevokeStart317[String] = 未撤销
@MxGjId318[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId319[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:23:51
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode320,@ComponentCode321)) AND ([TbModelOtherInfo].[Type] = @Type322) 	
Parameters:
@ComponentCode320[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode321[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type322[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:24:55
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 2500x630-2500x630
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A0_%


-----------------------------------------------------------------------------
2020-08-28 17:24:55
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode323) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart324)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId325,@MxGjId326)) 	
Parameters:
@SiteCode323[String] = 6373083923489249281
@RevokeStart324[String] = 未撤销
@MxGjId325[String] = d43df6dc-647e-49cb-8a6c-c628ff244b31
@MxGjId326[String] = d43df6dc-647e-49cb-8a6c-c628ff244741


-----------------------------------------------------------------------------
2020-08-28 17:24:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode327,@ComponentCode328)) AND ([TbModelOtherInfo].[Type] = @Type329) 	
Parameters:
@ComponentCode327[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A02_000
@ComponentCode328[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@Type329[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:26:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:29:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:30:02
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 2500x630-2500x630
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A0_%


-----------------------------------------------------------------------------
2020-08-28 17:30:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode330) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart331)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId332,@MxGjId333)) 	
Parameters:
@SiteCode330[String] = 6373083923489249281
@RevokeStart331[String] = 未撤销
@MxGjId332[String] = d43df6dc-647e-49cb-8a6c-c628ff244b31
@MxGjId333[String] = d43df6dc-647e-49cb-8a6c-c628ff244741


-----------------------------------------------------------------------------
2020-08-28 17:30:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode334,@ComponentCode335)) AND ([TbModelOtherInfo].[Type] = @Type336) 	
Parameters:
@ComponentCode334[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A02_000
@ComponentCode335[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@Type336[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:30:04
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 2500x630-2500x630
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A0_%


-----------------------------------------------------------------------------
2020-08-28 17:30:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode337) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart338)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId339,@MxGjId340)) 	
Parameters:
@SiteCode337[String] = 6373083923489249281
@RevokeStart338[String] = 未撤销
@MxGjId339[String] = d43df6dc-647e-49cb-8a6c-c628ff244b31
@MxGjId340[String] = d43df6dc-647e-49cb-8a6c-c628ff244741


-----------------------------------------------------------------------------
2020-08-28 17:30:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode341,@ComponentCode342)) AND ([TbModelOtherInfo].[Type] = @Type343) 	
Parameters:
@ComponentCode341[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A02_000
@ComponentCode342[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@Type343[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:30:12
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 800x400-800x400
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-28 17:30:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode344) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart345)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId346,@MxGjId347)) 	
Parameters:
@SiteCode344[String] = 6373083923489249281
@RevokeStart345[String] = 未撤销
@MxGjId346[String] = d43df6dc-647e-49cb-8a6c-c628ff245123
@MxGjId347[String] = 74e538d3-7989-46de-866a-b023c6cfa70d


-----------------------------------------------------------------------------
2020-08-28 17:30:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode348,@ComponentCode349)) AND ([TbModelOtherInfo].[Type] = @Type350) 	
Parameters:
@ComponentCode348[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A02_000
@ComponentCode349[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type350[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:31:07
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 2400x800-2400x800
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_D_%


-----------------------------------------------------------------------------
2020-08-28 17:31:07
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode351) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart352)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId353)) 	
Parameters:
@SiteCode351[String] = 6373083923489249281
@RevokeStart352[String] = 未撤销
@MxGjId353[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7d424


-----------------------------------------------------------------------------
2020-08-28 17:31:07
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode354)) AND ([TbModelOtherInfo].[Type] = @Type355) 	
Parameters:
@ComponentCode354[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@Type355[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:32:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:32:56
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-28 17:32:56
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode356) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart357)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId358,@MxGjId359)) 	
Parameters:
@SiteCode356[String] = 6373083923489249281
@RevokeStart357[String] = 未撤销
@MxGjId358[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId359[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-28 17:32:56
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode360,@ComponentCode361)) AND ([TbModelOtherInfo].[Type] = @Type362) 	
Parameters:
@ComponentCode360[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode361[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type362[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:32:57
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size='' and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-28 17:32:57
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode363) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart364)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId365,@MxGjId366)) 	
Parameters:
@SiteCode363[String] = 6373083923489249281
@RevokeStart364[String] = 未撤销
@MxGjId365[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId366[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-28 17:32:57
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode367,@ComponentCode368)) AND ([TbModelOtherInfo].[Type] = @Type369) 	
Parameters:
@ComponentCode367[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode368[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type369[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:33:01
Text:	SELECT id,ComponentCode, ComponentName as Name,SystemType,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1400x1000-1250x800
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_%


-----------------------------------------------------------------------------
2020-08-28 17:33:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE (([TbWorkOrderDetail].[SiteCode] = @SiteCode370) AND ([TbWorkOrderDetail].[RevokeStart] = @RevokeStart371)) AND ([TbWorkOrderDetail].[MxGjId] IN (@MxGjId372)) 	
Parameters:
@SiteCode370[String] = 6373083923489249281
@RevokeStart371[String] = 未撤销
@MxGjId372[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df0518d


-----------------------------------------------------------------------------
2020-08-28 17:33:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode373)) AND ([TbModelOtherInfo].[Type] = @Type374) 	
Parameters:
@ComponentCode373[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@Type374[Int32] = 2


-----------------------------------------------------------------------------
2020-08-28 17:35:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:35:58
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode376) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode377) 	
Parameters:
@SiteCode376[String] = 6373083923489249281
@ComponentCode377[String] = L21_Z08_00KT_DXT_DXT%


-----------------------------------------------------------------------------
2020-08-28 17:39:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-28 17:41:26
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
