2020-08-18 09:20:37
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 09:20:37
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 09:20:37
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 09:20:37
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 09:20:37
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 09:20:37
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/18 9:20:37
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 09:20:40
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 09:20:40
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 09:20:40
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE (([TbOrganizationMap].[ProjectId] = @ProjectId10) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode11,@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode19))) 	
Parameters:
@ProjectId10[String] = 6372912251695766465
@CompanyCode11[String] = 6373083923489249281
@CompanyCode12[String] = 6373083925531366080
@CompanyCode13[String] = 6373083927883400612
@CompanyCode14[String] = 6373083918575368225
@CompanyCode15[String] = 6373083920445075162
@CompanyCode16[String] = 6373083908618598731
@CompanyCode17[String] = 6373083911842783146
@CompanyCode18[String] = 6373083913928202424
@ParentCompanyCode19[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE (([TbOrganizationMap].[ProjectId] = @ProjectId20) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode21,@CompanyCode22,@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode29))) 	
Parameters:
@ProjectId20[String] = 6372912251695766465
@CompanyCode21[String] = 6373083923489249281
@CompanyCode22[String] = 6373083925531366080
@CompanyCode23[String] = 6373083927883400612
@CompanyCode24[String] = 6373083918575368225
@CompanyCode25[String] = 6373083920445075162
@CompanyCode26[String] = 6373083908618598731
@CompanyCode27[String] = 6373083911842783146
@CompanyCode28[String] = 6373083913928202424
@ParentCompanyCode29[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 09:20:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode57)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId30) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56)))	
Parameters:
@ProjectId30[String] = 6372912251695766465
@SiteCode31[String] = 6373083923489249281
@SiteCode32[String] = 6373083925531366080
@SiteCode33[String] = 6373083927883400612
@SiteCode34[String] = 6373083918575368225
@SiteCode35[String] = 6373083920445075162
@SiteCode36[String] = 6373083908618598731
@SiteCode37[String] = 6373083911842783146
@SiteCode38[String] = 6373083913928202424
@SiteCode39[String] = 6373083877551621804
@SiteCode40[String] = 6373083879921857377
@SiteCode41[String] = 6373083881542550067
@SiteCode42[String] = 6373083883689772886
@SiteCode43[String] = 6373083887136270013
@SiteCode44[String] = 6373083889697116488
@SiteCode45[String] = 6373083891969846476
@SiteCode46[String] = 6373083894422586761
@SiteCode47[String] = 6373083897509963358
@SiteCode48[String] = 6373083900444931227
@SiteCode49[String] = 6373083829464571372
@SiteCode50[String] = 6373083833327492328
@SiteCode51[String] = 6373083841964286321
@SiteCode52[String] = 6373083844982558950
@SiteCode53[String] = 6373083847585007801
@SiteCode54[String] = 6373083856887939900
@SiteCode55[String] = 6373083859102666584
@SiteCode56[String] = 6373083864919499284
@FDictionaryCode57[String] = OrderState
@FDictionaryCode58[String] = UrgentDegree
@FDictionaryCode59[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode58) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode59) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode57)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId30) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId30[String] = 6372912251695766465
@SiteCode31[String] = 6373083923489249281
@SiteCode32[String] = 6373083925531366080
@SiteCode33[String] = 6373083927883400612
@SiteCode34[String] = 6373083918575368225
@SiteCode35[String] = 6373083920445075162
@SiteCode36[String] = 6373083908618598731
@SiteCode37[String] = 6373083911842783146
@SiteCode38[String] = 6373083913928202424
@SiteCode39[String] = 6373083877551621804
@SiteCode40[String] = 6373083879921857377
@SiteCode41[String] = 6373083881542550067
@SiteCode42[String] = 6373083883689772886
@SiteCode43[String] = 6373083887136270013
@SiteCode44[String] = 6373083889697116488
@SiteCode45[String] = 6373083891969846476
@SiteCode46[String] = 6373083894422586761
@SiteCode47[String] = 6373083897509963358
@SiteCode48[String] = 6373083900444931227
@SiteCode49[String] = 6373083829464571372
@SiteCode50[String] = 6373083833327492328
@SiteCode51[String] = 6373083841964286321
@SiteCode52[String] = 6373083844982558950
@SiteCode53[String] = 6373083847585007801
@SiteCode54[String] = 6373083856887939900
@SiteCode55[String] = 6373083859102666584
@SiteCode56[String] = 6373083864919499284
@FDictionaryCode57[String] = OrderState
@FDictionaryCode58[String] = UrgentDegree
@FDictionaryCode59[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 09:20:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 09:20:43
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 09:20:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 09:20:54
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 09:20:55
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 09:20:58
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 09:21:04
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode61) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode62) 	
Parameters:
@SiteCode61[String] = 6373083923489249281
@ComponentCode62[String] = L21_Z08_00GS_GS_GS_SSQ_SSQ%


-----------------------------------------------------------------------------
2020-08-18 09:21:04
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00GS_GS_GS_SSQ_%


-----------------------------------------------------------------------------
2020-08-18 09:21:04
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00GS_GS_GS_SSQ_%


-----------------------------------------------------------------------------
2020-08-18 09:21:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm63) 	
Parameters:
@MxGjBm63[String] = L21_Z08_00GS_GS_GS_SSQ_SSQ


-----------------------------------------------------------------------------
2020-08-18 09:21:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode64)) AND ([TbModelOtherInfo].[Type] = @Type65) 	
Parameters:
@ComponentCode64[String] = L21_Z08_00GS_GS_GS_SSQ_SSQ_000
@Type65[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 10:56:15
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/18 10:56:15
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 10:56:17
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 10:56:17
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 10:56:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode59)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58)))	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@FDictionaryCode59[String] = OrderState
@FDictionaryCode60[String] = UrgentDegree
@FDictionaryCode61[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode61) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode59)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@FDictionaryCode59[String] = OrderState
@FDictionaryCode60[String] = UrgentDegree
@FDictionaryCode61[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 10:56:18
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 10:56:19
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 10:56:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:56:34
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 10:56:34
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 10:56:38
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 10:56:43
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode63) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode64) 	
Parameters:
@SiteCode63[String] = 6373083923489249281
@ComponentCode64[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 10:56:43
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:56:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:56:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm65) 	
Parameters:
@MxGjBm65[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-18 10:56:43
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode66)) AND ([TbModelOtherInfo].[Type] = @Type67) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type67[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 10:56:48
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:56:48
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId68) 	
Parameters:
@MxGjId68[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-18 10:56:48
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode69)) AND ([TbModelOtherInfo].[Type] = @Type70) 	
Parameters:
@ComponentCode69[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type70[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 10:56:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type71) 	
Parameters:
@Type71[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 10:56:56
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu72,@ActionType73,@HostName74,@LogDate75,@UserCode76,@UserIP77);select scope_identity()	
Parameters:
@ActionMenu72[String] = TbModelOtherInfo
@ActionType73[String] = 新增
@HostName74[String] = 
@LogDate75[DateTime] = 2020/8/18 10:56:56
@UserCode76[String] = 500000
@UserIP77[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 10:56:56
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime78,@Remark79,@SiteCode80,@Type81,@ProjectId82);select scope_identity()	
Parameters:
@PlanTime78[DateTime] = 2020/8/14 0:00:00
@Remark79[String] = 
@SiteCode80[String] = 6373083923489249281
@Type81[Int32] = 1
@ProjectId82[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 10:57:01
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode83) AND ([TbModelOtherInfo].[Type] = @Type84) 	
Parameters:
@ComponentCode83[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type84[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 10:57:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu85,@ActionType86,@HostName87,@LogDate88,@UserCode89,@UserIP90);select scope_identity()	
Parameters:
@ActionMenu85[String] = TbModelOtherInfo
@ActionType86[String] = 编辑
@HostName87[String] = 
@LogDate88[DateTime] = 2020/8/18 10:57:01
@UserCode89[String] = 500000
@UserIP90[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 10:57:01
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode92,[Remark]=@Remark93,[SiteCode]=@SiteCode94,[Type]=@Type95,[ProjectId]=@ProjectId96 WHERE [TbModelOtherInfo].[ID] = @ID91	
Parameters:
@ComponentCode92[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Remark93[String] = 
@SiteCode94[String] = 6373083923489249281
@Type95[Int32] = 2
@ProjectId96[String] = 6372912251695766465
@ID91[Int32] = 0


-----------------------------------------------------------------------------
2020-08-18 10:57:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type97) 	
Parameters:
@Type97[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 10:57:04
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu98,@ActionType99,@HostName100,@LogDate101,@UserCode102,@UserIP103);select scope_identity()	
Parameters:
@ActionMenu98[String] = TbModelOtherInfo
@ActionType99[String] = 新增
@HostName100[String] = 
@LogDate101[DateTime] = 2020/8/18 10:57:04
@UserCode102[String] = 500000
@UserIP103[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 10:57:04
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime104,@Remark105,@SiteCode106,@Type107,@ProjectId108);select scope_identity()	
Parameters:
@PlanTime104[DateTime] = 2020/8/27 0:00:00
@Remark105[String] = 
@SiteCode106[String] = 6373083923489249281
@Type107[Int32] = 1
@ProjectId108[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 10:58:18
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 10:58:18
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 10:58:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type109) AND ([TbOrganizationMap].[ProjectId] = @ProjectId110)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode111,@CompanyCode112,@CompanyCode113,@CompanyCode114,@CompanyCode115,@CompanyCode116,@CompanyCode117,@CompanyCode118)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode119))) 	
Parameters:
@Type109[Int32] = 1
@ProjectId110[String] = 6372912251695766465
@CompanyCode111[String] = 6373083923489249281
@CompanyCode112[String] = 6373083925531366080
@CompanyCode113[String] = 6373083927883400612
@CompanyCode114[String] = 6373083918575368225
@CompanyCode115[String] = 6373083920445075162
@CompanyCode116[String] = 6373083908618598731
@CompanyCode117[String] = 6373083911842783146
@CompanyCode118[String] = 6373083913928202424
@ParentCompanyCode119[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type120) AND ([TbOrganizationMap].[ProjectId] = @ProjectId121)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode122,@CompanyCode123,@CompanyCode124,@CompanyCode125,@CompanyCode126,@CompanyCode127,@CompanyCode128,@CompanyCode129)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode130))) 	
Parameters:
@Type120[Int32] = 2
@ProjectId121[String] = 6372912251695766465
@CompanyCode122[String] = 6373083923489249281
@CompanyCode123[String] = 6373083925531366080
@CompanyCode124[String] = 6373083927883400612
@CompanyCode125[String] = 6373083918575368225
@CompanyCode126[String] = 6373083920445075162
@CompanyCode127[String] = 6373083908618598731
@CompanyCode128[String] = 6373083911842783146
@CompanyCode129[String] = 6373083913928202424
@ParentCompanyCode130[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode158)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId131) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode132,@SiteCode133,@SiteCode134,@SiteCode135,@SiteCode136,@SiteCode137,@SiteCode138,@SiteCode139,@SiteCode140,@SiteCode141,@SiteCode142,@SiteCode143,@SiteCode144,@SiteCode145,@SiteCode146,@SiteCode147,@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157)))	
Parameters:
@ProjectId131[String] = 6372912251695766465
@SiteCode132[String] = 6373083923489249281
@SiteCode133[String] = 6373083925531366080
@SiteCode134[String] = 6373083927883400612
@SiteCode135[String] = 6373083918575368225
@SiteCode136[String] = 6373083920445075162
@SiteCode137[String] = 6373083908618598731
@SiteCode138[String] = 6373083911842783146
@SiteCode139[String] = 6373083913928202424
@SiteCode140[String] = 6373083877551621804
@SiteCode141[String] = 6373083879921857377
@SiteCode142[String] = 6373083881542550067
@SiteCode143[String] = 6373083883689772886
@SiteCode144[String] = 6373083887136270013
@SiteCode145[String] = 6373083889697116488
@SiteCode146[String] = 6373083891969846476
@SiteCode147[String] = 6373083894422586761
@SiteCode148[String] = 6373083897509963358
@SiteCode149[String] = 6373083900444931227
@SiteCode150[String] = 6373083829464571372
@SiteCode151[String] = 6373083833327492328
@SiteCode152[String] = 6373083841964286321
@SiteCode153[String] = 6373083844982558950
@SiteCode154[String] = 6373083847585007801
@SiteCode155[String] = 6373083856887939900
@SiteCode156[String] = 6373083859102666584
@SiteCode157[String] = 6373083864919499284
@FDictionaryCode158[String] = OrderState
@FDictionaryCode159[String] = UrgentDegree
@FDictionaryCode160[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode159) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode160) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode158)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId131) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode132,@SiteCode133,@SiteCode134,@SiteCode135,@SiteCode136,@SiteCode137,@SiteCode138,@SiteCode139,@SiteCode140,@SiteCode141,@SiteCode142,@SiteCode143,@SiteCode144,@SiteCode145,@SiteCode146,@SiteCode147,@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId131[String] = 6372912251695766465
@SiteCode132[String] = 6373083923489249281
@SiteCode133[String] = 6373083925531366080
@SiteCode134[String] = 6373083927883400612
@SiteCode135[String] = 6373083918575368225
@SiteCode136[String] = 6373083920445075162
@SiteCode137[String] = 6373083908618598731
@SiteCode138[String] = 6373083911842783146
@SiteCode139[String] = 6373083913928202424
@SiteCode140[String] = 6373083877551621804
@SiteCode141[String] = 6373083879921857377
@SiteCode142[String] = 6373083881542550067
@SiteCode143[String] = 6373083883689772886
@SiteCode144[String] = 6373083887136270013
@SiteCode145[String] = 6373083889697116488
@SiteCode146[String] = 6373083891969846476
@SiteCode147[String] = 6373083894422586761
@SiteCode148[String] = 6373083897509963358
@SiteCode149[String] = 6373083900444931227
@SiteCode150[String] = 6373083829464571372
@SiteCode151[String] = 6373083833327492328
@SiteCode152[String] = 6373083841964286321
@SiteCode153[String] = 6373083844982558950
@SiteCode154[String] = 6373083847585007801
@SiteCode155[String] = 6373083856887939900
@SiteCode156[String] = 6373083859102666584
@SiteCode157[String] = 6373083864919499284
@FDictionaryCode158[String] = OrderState
@FDictionaryCode159[String] = UrgentDegree
@FDictionaryCode160[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 10:58:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 10:58:20
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 10:58:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 10:58:25
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 10:58:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 10:58:28
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 10:58:33
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode162) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode163) 	
Parameters:
@SiteCode162[String] = 6373083923489249281
@ComponentCode163[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 10:58:33
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:58:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:58:34
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm164) 	
Parameters:
@MxGjBm164[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-18 10:58:34
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode165)) AND ([TbModelOtherInfo].[Type] = @Type166) 	
Parameters:
@ComponentCode165[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type166[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 10:58:36
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 10:58:36
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId167) 	
Parameters:
@MxGjId167[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-18 10:58:36
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode168)) AND ([TbModelOtherInfo].[Type] = @Type169) 	
Parameters:
@ComponentCode168[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type169[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 10:58:58
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode170) AND ([TbModelOtherInfo].[Type] = @Type171) 	
Parameters:
@ComponentCode170[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type171[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 10:58:58
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu172,@ActionType173,@HostName174,@LogDate175,@UserCode176,@UserIP177);select scope_identity()	
Parameters:
@ActionMenu172[String] = TbModelOtherInfo
@ActionType173[String] = 编辑
@HostName174[String] = 
@LogDate175[DateTime] = 2020/8/18 10:58:58
@UserCode176[String] = 500000
@UserIP177[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 10:58:58
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode179,[Remark]=@Remark180,[SiteCode]=@SiteCode181,[Type]=@Type182,[ProjectId]=@ProjectId183 WHERE [TbModelOtherInfo].[ID] = @ID178	
Parameters:
@ComponentCode179[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Remark180[String] = 
@SiteCode181[String] = 6373083923489249281
@Type182[Int32] = 2
@ProjectId183[String] = 6372912251695766465
@ID178[Int32] = 0


-----------------------------------------------------------------------------
2020-08-18 11:00:09
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type184) 	
Parameters:
@Type184[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:00:09
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu185,@ActionType186,@HostName187,@LogDate188,@UserCode189,@UserIP190);select scope_identity()	
Parameters:
@ActionMenu185[String] = TbModelOtherInfo
@ActionType186[String] = 新增
@HostName187[String] = 
@LogDate188[DateTime] = 2020/8/18 11:00:09
@UserCode189[String] = 500000
@UserIP190[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 11:00:09
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime191,@Remark192,@SiteCode193,@Type194,@ProjectId195);select scope_identity()	
Parameters:
@PlanTime191[DateTime] = 2020/8/20 0:00:00
@Remark192[String] = 
@SiteCode193[String] = 6373083923489249281
@Type194[Int32] = 1
@ProjectId195[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:03:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:04:07
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode197) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode198) 	
Parameters:
@SiteCode197[String] = 6373083923489249281
@ComponentCode198[String] = L21_Z08_00KT%


-----------------------------------------------------------------------------
2020-08-18 11:04:07
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:04:07
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:04:07
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm199,@MxGjBm200,@MxGjBm201,@MxGjBm202,@MxGjBm203,@MxGjBm204,@MxGjBm205,@MxGjBm206,@MxGjBm207,@MxGjBm208,@MxGjBm209,@MxGjBm210,@MxGjBm211,@MxGjBm212,@MxGjBm213,@MxGjBm214,@MxGjBm215,@MxGjBm216,@MxGjBm217,@MxGjBm218,@MxGjBm219,@MxGjBm220,@MxGjBm221,@MxGjBm222,@MxGjBm223,@MxGjBm224,@MxGjBm225,@MxGjBm226,@MxGjBm227,@MxGjBm228,@MxGjBm229,@MxGjBm230,@MxGjBm231,@MxGjBm232,@MxGjBm233,@MxGjBm234,@MxGjBm235,@MxGjBm236,@MxGjBm237,@MxGjBm238,@MxGjBm239,@MxGjBm240,@MxGjBm241,@MxGjBm242,@MxGjBm243,@MxGjBm244,@MxGjBm245,@MxGjBm246,@MxGjBm247,@MxGjBm248) 	
Parameters:
@MxGjBm199[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm200[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm201[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm202[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm203[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm204[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm205[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm206[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm207[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02
@MxGjBm208[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03
@MxGjBm209[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01
@MxGjBm210[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02
@MxGjBm211[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02
@MxGjBm212[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02
@MxGjBm213[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04
@MxGjBm214[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01
@MxGjBm215[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03
@MxGjBm216[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@MxGjBm217[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm218[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm219[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm220[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm221[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm222[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm223[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm224[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm225[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm226[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm227[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm228[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm229[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm230[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm231[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm232[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm233[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm234[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm235[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm236[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm237[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm238[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm239[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm240[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm241[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm242[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm243[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm244[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm245[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm246[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm247[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm248[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-18 11:04:07
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode249,@ComponentCode250,@ComponentCode251,@ComponentCode252,@ComponentCode253,@ComponentCode254,@ComponentCode255,@ComponentCode256,@ComponentCode257,@ComponentCode258,@ComponentCode259,@ComponentCode260,@ComponentCode261,@ComponentCode262,@ComponentCode263,@ComponentCode264,@ComponentCode265,@ComponentCode266,@ComponentCode267,@ComponentCode268,@ComponentCode269,@ComponentCode270,@ComponentCode271,@ComponentCode272,@ComponentCode273,@ComponentCode274,@ComponentCode275,@ComponentCode276,@ComponentCode277,@ComponentCode278,@ComponentCode279,@ComponentCode280,@ComponentCode281,@ComponentCode282,@ComponentCode283,@ComponentCode284,@ComponentCode285,@ComponentCode286,@ComponentCode287,@ComponentCode288,@ComponentCode289,@ComponentCode290,@ComponentCode291,@ComponentCode292,@ComponentCode293,@ComponentCode294,@ComponentCode295,@ComponentCode296,@ComponentCode297,@ComponentCode298)) AND ([TbModelOtherInfo].[Type] = @Type299) 	
Parameters:
@ComponentCode249[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode250[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode252[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode253[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode254[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode255[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode259[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode260[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode261[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode262[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode263[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode264[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode265[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode266[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode267[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode268[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode269[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode270[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode271[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode272[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode273[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode274[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode275[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode276[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode277[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode278[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode279[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode280[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode281[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode282[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode283[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode284[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode285[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode286[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode287[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode288[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode289[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode290[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode291[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode292[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode293[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode294[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode295[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode296[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode297[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode298[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type299[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:04:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:04:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:04:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:04:21
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId300,@MxGjId301,@MxGjId302,@MxGjId303,@MxGjId304,@MxGjId305) 	
Parameters:
@MxGjId300[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId301[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId302[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId303[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId304[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId305[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:04:21
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode306,@ComponentCode307,@ComponentCode308,@ComponentCode309,@ComponentCode310,@ComponentCode311)) AND ([TbModelOtherInfo].[Type] = @Type312) 	
Parameters:
@ComponentCode306[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode307[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode308[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode309[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode310[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode311[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type312[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:04:28
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_%


-----------------------------------------------------------------------------
2020-08-18 11:04:28
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-18 11:04:28
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId313,@MxGjId314,@MxGjId315,@MxGjId316,@MxGjId317,@MxGjId318,@MxGjId319,@MxGjId320,@MxGjId321,@MxGjId322,@MxGjId323,@MxGjId324,@MxGjId325) 	
Parameters:
@MxGjId313[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId314[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7d424
@MxGjId315[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7
@MxGjId316[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddd6
@MxGjId317[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e11d
@MxGjId318[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e321
@MxGjId319[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e642
@MxGjId320[String] = 74e538d3-7989-46de-866a-b023c6cfa70d
@MxGjId321[String] = d43df6dc-647e-49cb-8a6c-c628ff245123
@MxGjId322[String] = d43df6dc-647e-49cb-8a6c-c628ff2454d7
@MxGjId323[String] = d43df6dc-647e-49cb-8a6c-c628ff245727
@MxGjId324[String] = d43df6dc-647e-49cb-8a6c-c628ff24583e
@MxGjId325[String] = d516917e-9692-43e2-89b5-4781afbe3eaf


-----------------------------------------------------------------------------
2020-08-18 11:04:28
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode326,@ComponentCode327,@ComponentCode328,@ComponentCode329,@ComponentCode330,@ComponentCode331,@ComponentCode332,@ComponentCode333,@ComponentCode334,@ComponentCode335,@ComponentCode336,@ComponentCode337,@ComponentCode338)) AND ([TbModelOtherInfo].[Type] = @Type339) 	
Parameters:
@ComponentCode326[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode327[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode328[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode329[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode330[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B05_000
@ComponentCode331[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B04_000
@ComponentCode332[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode333[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode334[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A02_000
@ComponentCode335[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A04_000
@ComponentCode336[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A03_000
@ComponentCode337[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A06_000
@ComponentCode338[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@Type339[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:07:11
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 11:07:11
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 11:07:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 11:07:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 11:07:13
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 11:08:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:08:49
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 11:08:49
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:08:53
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:08:59
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode54) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode55) 	
Parameters:
@SiteCode54[String] = 6373083923489249281
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 11:08:59
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:08:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:08:59
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm56) 	
Parameters:
@MxGjBm56[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-18 11:08:59
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode57)) AND ([TbModelOtherInfo].[Type] = @Type58) 	
Parameters:
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type58[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:09:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:09:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId59) 	
Parameters:
@MxGjId59[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-18 11:09:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60)) AND ([TbModelOtherInfo].[Type] = @Type61) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type61[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:09:04
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode63) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode64) 	
Parameters:
@SiteCode63[String] = 6373083923489249281
@ComponentCode64[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 11:09:05
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode66) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode67) 	
Parameters:
@SiteCode66[String] = 6373083923489249281
@ComponentCode67[String] = L21_Z08_00KT%


-----------------------------------------------------------------------------
2020-08-18 11:09:05
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:09:05
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:09:05
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm68,@MxGjBm69,@MxGjBm70,@MxGjBm71,@MxGjBm72,@MxGjBm73,@MxGjBm74,@MxGjBm75,@MxGjBm76,@MxGjBm77,@MxGjBm78,@MxGjBm79,@MxGjBm80,@MxGjBm81,@MxGjBm82,@MxGjBm83,@MxGjBm84,@MxGjBm85,@MxGjBm86,@MxGjBm87,@MxGjBm88,@MxGjBm89,@MxGjBm90,@MxGjBm91,@MxGjBm92,@MxGjBm93,@MxGjBm94,@MxGjBm95,@MxGjBm96,@MxGjBm97,@MxGjBm98,@MxGjBm99,@MxGjBm100,@MxGjBm101,@MxGjBm102,@MxGjBm103,@MxGjBm104,@MxGjBm105,@MxGjBm106,@MxGjBm107,@MxGjBm108,@MxGjBm109,@MxGjBm110,@MxGjBm111,@MxGjBm112,@MxGjBm113,@MxGjBm114,@MxGjBm115,@MxGjBm116,@MxGjBm117) 	
Parameters:
@MxGjBm68[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm69[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm70[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm71[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm72[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm73[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm74[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm75[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm76[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02
@MxGjBm77[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03
@MxGjBm78[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01
@MxGjBm79[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02
@MxGjBm80[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02
@MxGjBm81[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02
@MxGjBm82[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04
@MxGjBm83[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01
@MxGjBm84[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03
@MxGjBm85[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@MxGjBm86[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm87[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm88[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm89[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm90[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm91[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm92[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm93[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm94[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm95[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm96[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm97[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm98[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm99[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm100[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm101[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm102[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm103[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm104[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm105[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm106[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm107[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm108[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm109[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm110[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm111[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm112[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm113[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm114[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm115[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm116[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm117[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-18 11:09:05
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode118,@ComponentCode119,@ComponentCode120,@ComponentCode121,@ComponentCode122,@ComponentCode123,@ComponentCode124,@ComponentCode125,@ComponentCode126,@ComponentCode127,@ComponentCode128,@ComponentCode129,@ComponentCode130,@ComponentCode131,@ComponentCode132,@ComponentCode133,@ComponentCode134,@ComponentCode135,@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140,@ComponentCode141,@ComponentCode142,@ComponentCode143,@ComponentCode144,@ComponentCode145,@ComponentCode146,@ComponentCode147,@ComponentCode148,@ComponentCode149,@ComponentCode150,@ComponentCode151,@ComponentCode152,@ComponentCode153,@ComponentCode154,@ComponentCode155,@ComponentCode156,@ComponentCode157,@ComponentCode158,@ComponentCode159,@ComponentCode160,@ComponentCode161,@ComponentCode162,@ComponentCode163,@ComponentCode164,@ComponentCode165,@ComponentCode166,@ComponentCode167)) AND ([TbModelOtherInfo].[Type] = @Type168) 	
Parameters:
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode130[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode131[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode132[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode135[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode142[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode150[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode151[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode152[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode153[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode155[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode156[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode157[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode159[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode160[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode161[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode162[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode163[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode164[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode165[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode166[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode167[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type168[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:09:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_%


-----------------------------------------------------------------------------
2020-08-18 11:09:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-18 11:09:22
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId169,@MxGjId170,@MxGjId171,@MxGjId172,@MxGjId173,@MxGjId174,@MxGjId175,@MxGjId176,@MxGjId177,@MxGjId178,@MxGjId179,@MxGjId180,@MxGjId181) 	
Parameters:
@MxGjId169[String] = 31499740-ddac-46dd-b132-603a309aa1e8
@MxGjId170[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7d424
@MxGjId171[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddb7
@MxGjId172[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7ddd6
@MxGjId173[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e11d
@MxGjId174[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e321
@MxGjId175[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e642
@MxGjId176[String] = 74e538d3-7989-46de-866a-b023c6cfa70d
@MxGjId177[String] = d43df6dc-647e-49cb-8a6c-c628ff245123
@MxGjId178[String] = d43df6dc-647e-49cb-8a6c-c628ff2454d7
@MxGjId179[String] = d43df6dc-647e-49cb-8a6c-c628ff245727
@MxGjId180[String] = d43df6dc-647e-49cb-8a6c-c628ff24583e
@MxGjId181[String] = d516917e-9692-43e2-89b5-4781afbe3eaf


-----------------------------------------------------------------------------
2020-08-18 11:09:22
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode182,@ComponentCode183,@ComponentCode184,@ComponentCode185,@ComponentCode186,@ComponentCode187,@ComponentCode188,@ComponentCode189,@ComponentCode190,@ComponentCode191,@ComponentCode192,@ComponentCode193,@ComponentCode194)) AND ([TbModelOtherInfo].[Type] = @Type195) 	
Parameters:
@ComponentCode182[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A08_000
@ComponentCode183[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode184[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode185[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode186[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B05_000
@ComponentCode187[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B04_000
@ComponentCode188[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode189[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode190[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A02_000
@ComponentCode191[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A04_000
@ComponentCode192[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A03_000
@ComponentCode193[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A06_000
@ComponentCode194[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@Type195[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:10:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:12:22
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 11:12:23
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 11:12:23
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:12:24
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 11:12:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 11:15:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:15:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:15:44
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 11:15:44
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:15:49
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:15:53
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode54) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode55) 	
Parameters:
@SiteCode54[String] = 6373083923489249281
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 11:15:53
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:15:53
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:15:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm56) 	
Parameters:
@MxGjBm56[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-18 11:15:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode57)) AND ([TbModelOtherInfo].[Type] = @Type58) 	
Parameters:
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type58[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:15:59
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode60) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode61) 	
Parameters:
@SiteCode60[String] = 6373083923489249281
@ComponentCode61[String] = L21_Z08_00KT%


-----------------------------------------------------------------------------
2020-08-18 11:15:59
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:15:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:15:59
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm62,@MxGjBm63,@MxGjBm64,@MxGjBm65,@MxGjBm66,@MxGjBm67,@MxGjBm68,@MxGjBm69,@MxGjBm70,@MxGjBm71,@MxGjBm72,@MxGjBm73,@MxGjBm74,@MxGjBm75,@MxGjBm76,@MxGjBm77,@MxGjBm78,@MxGjBm79,@MxGjBm80,@MxGjBm81,@MxGjBm82,@MxGjBm83,@MxGjBm84,@MxGjBm85,@MxGjBm86,@MxGjBm87,@MxGjBm88,@MxGjBm89,@MxGjBm90,@MxGjBm91,@MxGjBm92,@MxGjBm93,@MxGjBm94,@MxGjBm95,@MxGjBm96,@MxGjBm97,@MxGjBm98,@MxGjBm99,@MxGjBm100,@MxGjBm101,@MxGjBm102,@MxGjBm103,@MxGjBm104,@MxGjBm105,@MxGjBm106,@MxGjBm107,@MxGjBm108,@MxGjBm109,@MxGjBm110,@MxGjBm111) 	
Parameters:
@MxGjBm62[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm63[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm64[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm65[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm66[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm67[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm68[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm69[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm70[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02
@MxGjBm71[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03
@MxGjBm72[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01
@MxGjBm73[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02
@MxGjBm74[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02
@MxGjBm75[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02
@MxGjBm76[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04
@MxGjBm77[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01
@MxGjBm78[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03
@MxGjBm79[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@MxGjBm80[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm81[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm82[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm83[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm84[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm85[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm86[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm87[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm88[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm89[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm90[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm91[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm92[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm93[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm94[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm95[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm96[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm97[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm98[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm99[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm100[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm101[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm102[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm103[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm104[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm105[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm106[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm107[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm108[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm109[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm110[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm111[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-18 11:15:59
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode112,@ComponentCode113,@ComponentCode114,@ComponentCode115,@ComponentCode116,@ComponentCode117,@ComponentCode118,@ComponentCode119,@ComponentCode120,@ComponentCode121,@ComponentCode122,@ComponentCode123,@ComponentCode124,@ComponentCode125,@ComponentCode126,@ComponentCode127,@ComponentCode128,@ComponentCode129,@ComponentCode130,@ComponentCode131,@ComponentCode132,@ComponentCode133,@ComponentCode134,@ComponentCode135,@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140,@ComponentCode141,@ComponentCode142,@ComponentCode143,@ComponentCode144,@ComponentCode145,@ComponentCode146,@ComponentCode147,@ComponentCode148,@ComponentCode149,@ComponentCode150,@ComponentCode151,@ComponentCode152,@ComponentCode153,@ComponentCode154,@ComponentCode155,@ComponentCode156,@ComponentCode157,@ComponentCode158,@ComponentCode159,@ComponentCode160,@ComponentCode161)) AND ([TbModelOtherInfo].[Type] = @Type162) 	
Parameters:
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode115[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode116[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode117[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode130[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode131[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode132[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode135[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode142[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode150[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode151[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode152[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode153[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode155[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode156[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode157[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode159[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode160[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode161[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type162[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:16:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x1400-1600x1400
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_%


-----------------------------------------------------------------------------
2020-08-18 11:16:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x1400-1600x1400
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-18 11:16:09
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId163,@MxGjId164,@MxGjId165,@MxGjId166,@MxGjId167,@MxGjId168) 	
Parameters:
@MxGjId163[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e11d
@MxGjId164[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e321
@MxGjId165[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e642
@MxGjId166[String] = d43df6dc-647e-49cb-8a6c-c628ff2454d7
@MxGjId167[String] = d43df6dc-647e-49cb-8a6c-c628ff245727
@MxGjId168[String] = d43df6dc-647e-49cb-8a6c-c628ff24583e


-----------------------------------------------------------------------------
2020-08-18 11:16:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode169,@ComponentCode170,@ComponentCode171,@ComponentCode172,@ComponentCode173,@ComponentCode174)) AND ([TbModelOtherInfo].[Type] = @Type175) 	
Parameters:
@ComponentCode169[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B05_000
@ComponentCode170[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B04_000
@ComponentCode171[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode172[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A04_000
@ComponentCode173[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A03_000
@ComponentCode174[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A06_000
@Type175[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:16:17
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:16:17
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:16:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId176,@MxGjId177,@MxGjId178,@MxGjId179,@MxGjId180,@MxGjId181) 	
Parameters:
@MxGjId176[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId177[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId178[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId179[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId180[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId181[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:16:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode182,@ComponentCode183,@ComponentCode184,@ComponentCode185,@ComponentCode186,@ComponentCode187)) AND ([TbModelOtherInfo].[Type] = @Type188) 	
Parameters:
@ComponentCode182[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode183[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode184[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode185[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode186[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode187[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type188[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:16:37
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:16:37
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x1000-1250x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_%


-----------------------------------------------------------------------------
2020-08-18 11:16:37
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId189,@MxGjId190,@MxGjId191) 	
Parameters:
@MxGjId189[String] = 31499740-ddac-46dd-b132-603a309aaf8d
@MxGjId190[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7c8fb
@MxGjId191[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7dc9b


-----------------------------------------------------------------------------
2020-08-18 11:16:37
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode192,@ComponentCode193,@ComponentCode194)) AND ([TbModelOtherInfo].[Type] = @Type195) 	
Parameters:
@ComponentCode192[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A05_000
@ComponentCode193[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B01_000
@ComponentCode194[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@Type195[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:16:42
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1250x500-1250x500
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_%


-----------------------------------------------------------------------------
2020-08-18 11:16:42
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId196) 	
Parameters:
@MxGjId196[String] = dd95b700-feba-4c9e-bba7-8437b38d9bb3


-----------------------------------------------------------------------------
2020-08-18 11:16:42
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode197)) AND ([TbModelOtherInfo].[Type] = @Type198) 	
Parameters:
@ComponentCode197[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@Type198[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:16:48
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x800-1600x800
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_%


-----------------------------------------------------------------------------
2020-08-18 11:16:48
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x800-1600x800
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_%


-----------------------------------------------------------------------------
2020-08-18 11:16:48
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId199,@MxGjId200) 	
Parameters:
@MxGjId199[String] = d516917e-9692-43e2-89b5-4781afbe39a7
@MxGjId200[String] = d516917e-9692-43e2-89b5-4781afbe3fef


-----------------------------------------------------------------------------
2020-08-18 11:16:48
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode201,@ComponentCode202)) AND ([TbModelOtherInfo].[Type] = @Type203) 	
Parameters:
@ComponentCode201[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode202[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A03_000
@Type203[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:16:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 2000x1000-2000x1000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_%


-----------------------------------------------------------------------------
2020-08-18 11:16:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId204) 	
Parameters:
@MxGjId204[String] = d43df6dc-647e-49cb-8a6c-c628ff245e40


-----------------------------------------------------------------------------
2020-08-18 11:16:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode205)) AND ([TbModelOtherInfo].[Type] = @Type206) 	
Parameters:
@ComponentCode205[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@Type206[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:17:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:17:04
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:17:04
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId207,@MxGjId208,@MxGjId209,@MxGjId210,@MxGjId211,@MxGjId212) 	
Parameters:
@MxGjId207[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId208[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId209[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId210[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId211[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId212[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:17:04
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode213,@ComponentCode214,@ComponentCode215,@ComponentCode216,@ComponentCode217,@ComponentCode218)) AND ([TbModelOtherInfo].[Type] = @Type219) 	
Parameters:
@ComponentCode213[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode214[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode215[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode216[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode217[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode218[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type219[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:17:05
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:17:05
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:17:05
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId220,@MxGjId221,@MxGjId222,@MxGjId223,@MxGjId224,@MxGjId225) 	
Parameters:
@MxGjId220[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId221[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId222[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId223[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId224[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId225[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:17:05
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode226,@ComponentCode227,@ComponentCode228,@ComponentCode229,@ComponentCode230,@ComponentCode231)) AND ([TbModelOtherInfo].[Type] = @Type232) 	
Parameters:
@ComponentCode226[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode227[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode228[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode229[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode230[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode231[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type232[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:17:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:17:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:17:09
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId233,@MxGjId234,@MxGjId235,@MxGjId236,@MxGjId237,@MxGjId238) 	
Parameters:
@MxGjId233[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId234[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId235[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId236[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId237[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId238[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:17:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode239,@ComponentCode240,@ComponentCode241,@ComponentCode242,@ComponentCode243,@ComponentCode244)) AND ([TbModelOtherInfo].[Type] = @Type245) 	
Parameters:
@ComponentCode239[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode240[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode241[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode243[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode244[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type245[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:18:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:19:37
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:20:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-18 11:20:28
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId246,@MxGjId247,@MxGjId248,@MxGjId249,@MxGjId250,@MxGjId251) 	
Parameters:
@MxGjId246[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId247[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037
@MxGjId248[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId249[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb
@MxGjId250[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId251[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:20:28
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode252,@ComponentCode253,@ComponentCode254,@ComponentCode255,@ComponentCode256,@ComponentCode257)) AND ([TbModelOtherInfo].[Type] = @Type258) 	
Parameters:
@ComponentCode252[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode253[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode254[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode255[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type258[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:21:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:24:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:27:22
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:28:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 11:28:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 11:28:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode50)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@FDictionaryCode50[String] = OrderState
@FDictionaryCode51[String] = UrgentDegree
@FDictionaryCode52[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 11:28:22
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 11:31:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:32:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 11:32:03
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 11:32:03
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:32:08
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 11:32:13
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode54) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode55) 	
Parameters:
@SiteCode54[String] = 6373083923489249281
@ComponentCode55[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 11:32:13
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:32:13
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:32:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm56) 	
Parameters:
@MxGjBm56[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-18 11:32:13
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode57)) AND ([TbModelOtherInfo].[Type] = @Type58) 	
Parameters:
@ComponentCode57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type58[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:32:15
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode60) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode61) 	
Parameters:
@SiteCode60[String] = 6373083923489249281
@ComponentCode61[String] = L21_Z08_00KT_DXT%


-----------------------------------------------------------------------------
2020-08-18 11:32:15
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:32:15
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                        where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-18 11:32:15
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm62,@MxGjBm63,@MxGjBm64,@MxGjBm65,@MxGjBm66,@MxGjBm67,@MxGjBm68,@MxGjBm69,@MxGjBm70,@MxGjBm71,@MxGjBm72,@MxGjBm73,@MxGjBm74,@MxGjBm75,@MxGjBm76,@MxGjBm77,@MxGjBm78,@MxGjBm79,@MxGjBm80,@MxGjBm81,@MxGjBm82,@MxGjBm83,@MxGjBm84,@MxGjBm85,@MxGjBm86,@MxGjBm87,@MxGjBm88,@MxGjBm89,@MxGjBm90,@MxGjBm91,@MxGjBm92,@MxGjBm93,@MxGjBm94,@MxGjBm95,@MxGjBm96,@MxGjBm97,@MxGjBm98,@MxGjBm99,@MxGjBm100,@MxGjBm101,@MxGjBm102,@MxGjBm103,@MxGjBm104,@MxGjBm105,@MxGjBm106,@MxGjBm107,@MxGjBm108,@MxGjBm109,@MxGjBm110,@MxGjBm111) 	
Parameters:
@MxGjBm62[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm63[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm64[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm65[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm66[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm67[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm68[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm69[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm70[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02
@MxGjBm71[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03
@MxGjBm72[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01
@MxGjBm73[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02
@MxGjBm74[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02
@MxGjBm75[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02
@MxGjBm76[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04
@MxGjBm77[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01
@MxGjBm78[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03
@MxGjBm79[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@MxGjBm80[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm81[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm82[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm83[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm84[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm85[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm86[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm87[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm88[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm89[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm90[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm91[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm92[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm93[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm94[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm95[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm96[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm97[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm98[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm99[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm100[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm101[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm102[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm103[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm104[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm105[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm106[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm107[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm108[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm109[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm110[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm111[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-18 11:32:15
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode112,@ComponentCode113,@ComponentCode114,@ComponentCode115,@ComponentCode116,@ComponentCode117,@ComponentCode118,@ComponentCode119,@ComponentCode120,@ComponentCode121,@ComponentCode122,@ComponentCode123,@ComponentCode124,@ComponentCode125,@ComponentCode126,@ComponentCode127,@ComponentCode128,@ComponentCode129,@ComponentCode130,@ComponentCode131,@ComponentCode132,@ComponentCode133,@ComponentCode134,@ComponentCode135,@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140,@ComponentCode141,@ComponentCode142,@ComponentCode143,@ComponentCode144,@ComponentCode145,@ComponentCode146,@ComponentCode147,@ComponentCode148,@ComponentCode149,@ComponentCode150,@ComponentCode151,@ComponentCode152,@ComponentCode153,@ComponentCode154,@ComponentCode155,@ComponentCode156,@ComponentCode157,@ComponentCode158,@ComponentCode159,@ComponentCode160,@ComponentCode161)) AND ([TbModelOtherInfo].[Type] = @Type162) 	
Parameters:
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode115[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode116[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode117[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode125[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode127[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode130[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode131[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode132[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode135[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode136[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode141[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode142[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode147[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode150[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode151[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode152[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode153[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode155[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode156[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode157[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode159[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode160[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode161[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type162[Int32] = 1


-----------------------------------------------------------------------------
2020-08-18 11:32:25
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x1400-1600x1400
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_%


-----------------------------------------------------------------------------
2020-08-18 11:32:25
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1600x1400-1600x1400
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_MD_MD_%


-----------------------------------------------------------------------------
2020-08-18 11:32:25
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId163,@MxGjId164,@MxGjId165,@MxGjId166,@MxGjId167,@MxGjId168) 	
Parameters:
@MxGjId163[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e11d
@MxGjId164[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e321
@MxGjId165[String] = 5f6dc3f7-becb-4e1f-8022-eb05daa7e642
@MxGjId166[String] = d43df6dc-647e-49cb-8a6c-c628ff2454d7
@MxGjId167[String] = d43df6dc-647e-49cb-8a6c-c628ff245727
@MxGjId168[String] = d43df6dc-647e-49cb-8a6c-c628ff24583e


-----------------------------------------------------------------------------
2020-08-18 11:32:25
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode169,@ComponentCode170,@ComponentCode171,@ComponentCode172,@ComponentCode173,@ComponentCode174)) AND ([TbModelOtherInfo].[Type] = @Type175) 	
Parameters:
@ComponentCode169[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B05_000
@ComponentCode170[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B04_000
@ComponentCode171[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode172[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A04_000
@ComponentCode173[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A03_000
@ComponentCode174[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A06_000
@Type175[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:32:31
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-18 11:32:31
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-18 11:32:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId176,@MxGjId177) 	
Parameters:
@MxGjId176[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId177[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-18 11:32:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode178,@ComponentCode179)) AND ([TbModelOtherInfo].[Type] = @Type180) 	
Parameters:
@ComponentCode178[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode179[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type180[Int32] = 2


-----------------------------------------------------------------------------
2020-08-18 11:32:39
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode182) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode183) 	
Parameters:
@SiteCode182[String] = 6373083923489249281
@ComponentCode183[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 11:34:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:37:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:40:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:43:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:46:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:49:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:52:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:55:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 11:58:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:01:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:04:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:07:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:10:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:13:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:16:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:18:04
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.id asc	


-----------------------------------------------------------------------------
2020-08-18 12:18:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 12:18:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 12:18:12
Text:	 SELECT   [TbCompany].* FROM [TbCompany]  	


-----------------------------------------------------------------------------
2020-08-18 12:18:12
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = OrgType


-----------------------------------------------------------------------------
2020-08-18 12:19:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:22:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:25:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:28:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 12:31:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:00:54
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/18 16:00:54
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 16:00:56
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:00:56
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:00:56
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59)))	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:00:57
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode61) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode62) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:00:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:00:58
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:00:58
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:00:58
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:00:58
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:01:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:01:38
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:01:38
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:01:42
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:01:49
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode64) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode65) 	
Parameters:
@SiteCode64[String] = 6373083923489249281
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 16:02:17
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:02:17
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:02:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type66) AND ([TbOrganizationMap].[ProjectId] = @ProjectId67)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode68,@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72,@CompanyCode73,@CompanyCode74,@CompanyCode75)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode76))) 	
Parameters:
@Type66[Int32] = 1
@ProjectId67[String] = 6372912251695766465
@CompanyCode68[String] = 6373083923489249281
@CompanyCode69[String] = 6373083925531366080
@CompanyCode70[String] = 6373083927883400612
@CompanyCode71[String] = 6373083918575368225
@CompanyCode72[String] = 6373083920445075162
@CompanyCode73[String] = 6373083908618598731
@CompanyCode74[String] = 6373083911842783146
@CompanyCode75[String] = 6373083913928202424
@ParentCompanyCode76[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type77) AND ([TbOrganizationMap].[ProjectId] = @ProjectId78)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode79,@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83,@CompanyCode84,@CompanyCode85,@CompanyCode86)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode87))) 	
Parameters:
@Type77[Int32] = 2
@ProjectId78[String] = 6372912251695766465
@CompanyCode79[String] = 6373083923489249281
@CompanyCode80[String] = 6373083925531366080
@CompanyCode81[String] = 6373083927883400612
@CompanyCode82[String] = 6373083918575368225
@CompanyCode83[String] = 6373083920445075162
@CompanyCode84[String] = 6373083908618598731
@CompanyCode85[String] = 6373083911842783146
@CompanyCode86[String] = 6373083913928202424
@ParentCompanyCode87[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode116)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId88) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111,@SiteCode112,@SiteCode113,@SiteCode114,@SiteCode115)))	
Parameters:
@ProjectId88[String] = 6372912251695766465
@SiteCode89[String] = 6373083923489249281
@SiteCode90[String] = 6373083925531366080
@SiteCode91[String] = 6373083927883400612
@SiteCode92[String] = 6373083918575368225
@SiteCode93[String] = 6373083920445075162
@SiteCode94[String] = 6373083908618598731
@SiteCode95[String] = 6373083911842783146
@SiteCode96[String] = 6373083913928202424
@SiteCode97[String] = 6373083877551621804
@SiteCode98[String] = 6373083879921857377
@SiteCode99[String] = 6373083881542550067
@SiteCode100[String] = 6373083883689772886
@SiteCode101[String] = 6373083887136270013
@SiteCode102[String] = 6373083889697116488
@SiteCode103[String] = 6373083891969846476
@SiteCode104[String] = 6373083894422586761
@SiteCode105[String] = 6373083897509963358
@SiteCode106[String] = 6373083900444931227
@SiteCode107[String] = 6373083829464571372
@SiteCode108[String] = 6373083833327492328
@SiteCode109[String] = 6373083841964286321
@SiteCode110[String] = 6373083844982558950
@SiteCode111[String] = 6373083847585007801
@SiteCode112[String] = 6373083856887939900
@SiteCode113[String] = 6373083859102666584
@SiteCode114[String] = 6373083864919499284
@SiteCode115[String] = 6373334974514214221
@FDictionaryCode116[String] = OrderState
@FDictionaryCode117[String] = UrgentDegree
@FDictionaryCode118[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:02:18
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode117) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode118) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode116)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId88) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111,@SiteCode112,@SiteCode113,@SiteCode114,@SiteCode115))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId88[String] = 6372912251695766465
@SiteCode89[String] = 6373083923489249281
@SiteCode90[String] = 6373083925531366080
@SiteCode91[String] = 6373083927883400612
@SiteCode92[String] = 6373083918575368225
@SiteCode93[String] = 6373083920445075162
@SiteCode94[String] = 6373083908618598731
@SiteCode95[String] = 6373083911842783146
@SiteCode96[String] = 6373083913928202424
@SiteCode97[String] = 6373083877551621804
@SiteCode98[String] = 6373083879921857377
@SiteCode99[String] = 6373083881542550067
@SiteCode100[String] = 6373083883689772886
@SiteCode101[String] = 6373083887136270013
@SiteCode102[String] = 6373083889697116488
@SiteCode103[String] = 6373083891969846476
@SiteCode104[String] = 6373083894422586761
@SiteCode105[String] = 6373083897509963358
@SiteCode106[String] = 6373083900444931227
@SiteCode107[String] = 6373083829464571372
@SiteCode108[String] = 6373083833327492328
@SiteCode109[String] = 6373083841964286321
@SiteCode110[String] = 6373083844982558950
@SiteCode111[String] = 6373083847585007801
@SiteCode112[String] = 6373083856887939900
@SiteCode113[String] = 6373083859102666584
@SiteCode114[String] = 6373083864919499284
@SiteCode115[String] = 6373334974514214221
@FDictionaryCode116[String] = OrderState
@FDictionaryCode117[String] = UrgentDegree
@FDictionaryCode118[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:02:19
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:02:19
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:02:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:02:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:02:19
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:02:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:02:23
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:02:23
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:02:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:02:32
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode120) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode121) 	
Parameters:
@SiteCode120[String] = 6373083923489249281
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:05:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:06:29
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:06:29
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:06:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type122) AND ([TbOrganizationMap].[ProjectId] = @ProjectId123)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode124,@CompanyCode125,@CompanyCode126,@CompanyCode127,@CompanyCode128,@CompanyCode129,@CompanyCode130,@CompanyCode131)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode132))) 	
Parameters:
@Type122[Int32] = 1
@ProjectId123[String] = 6372912251695766465
@CompanyCode124[String] = 6373083923489249281
@CompanyCode125[String] = 6373083925531366080
@CompanyCode126[String] = 6373083927883400612
@CompanyCode127[String] = 6373083918575368225
@CompanyCode128[String] = 6373083920445075162
@CompanyCode129[String] = 6373083908618598731
@CompanyCode130[String] = 6373083911842783146
@CompanyCode131[String] = 6373083913928202424
@ParentCompanyCode132[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type133) AND ([TbOrganizationMap].[ProjectId] = @ProjectId134)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode135,@CompanyCode136,@CompanyCode137,@CompanyCode138,@CompanyCode139,@CompanyCode140,@CompanyCode141,@CompanyCode142)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode143))) 	
Parameters:
@Type133[Int32] = 2
@ProjectId134[String] = 6372912251695766465
@CompanyCode135[String] = 6373083923489249281
@CompanyCode136[String] = 6373083925531366080
@CompanyCode137[String] = 6373083927883400612
@CompanyCode138[String] = 6373083918575368225
@CompanyCode139[String] = 6373083920445075162
@CompanyCode140[String] = 6373083908618598731
@CompanyCode141[String] = 6373083911842783146
@CompanyCode142[String] = 6373083913928202424
@ParentCompanyCode143[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode172)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId144) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode145,@SiteCode146,@SiteCode147,@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157,@SiteCode158,@SiteCode159,@SiteCode160,@SiteCode161,@SiteCode162,@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171)))	
Parameters:
@ProjectId144[String] = 6372912251695766465
@SiteCode145[String] = 6373083923489249281
@SiteCode146[String] = 6373083925531366080
@SiteCode147[String] = 6373083927883400612
@SiteCode148[String] = 6373083918575368225
@SiteCode149[String] = 6373083920445075162
@SiteCode150[String] = 6373083908618598731
@SiteCode151[String] = 6373083911842783146
@SiteCode152[String] = 6373083913928202424
@SiteCode153[String] = 6373083877551621804
@SiteCode154[String] = 6373083879921857377
@SiteCode155[String] = 6373083881542550067
@SiteCode156[String] = 6373083883689772886
@SiteCode157[String] = 6373083887136270013
@SiteCode158[String] = 6373083889697116488
@SiteCode159[String] = 6373083891969846476
@SiteCode160[String] = 6373083894422586761
@SiteCode161[String] = 6373083897509963358
@SiteCode162[String] = 6373083900444931227
@SiteCode163[String] = 6373083829464571372
@SiteCode164[String] = 6373083833327492328
@SiteCode165[String] = 6373083841964286321
@SiteCode166[String] = 6373083844982558950
@SiteCode167[String] = 6373083847585007801
@SiteCode168[String] = 6373083856887939900
@SiteCode169[String] = 6373083859102666584
@SiteCode170[String] = 6373083864919499284
@SiteCode171[String] = 6373334974514214221
@FDictionaryCode172[String] = OrderState
@FDictionaryCode173[String] = UrgentDegree
@FDictionaryCode174[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:06:30
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode173) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode174) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode172)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId144) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode145,@SiteCode146,@SiteCode147,@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157,@SiteCode158,@SiteCode159,@SiteCode160,@SiteCode161,@SiteCode162,@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId144[String] = 6372912251695766465
@SiteCode145[String] = 6373083923489249281
@SiteCode146[String] = 6373083925531366080
@SiteCode147[String] = 6373083927883400612
@SiteCode148[String] = 6373083918575368225
@SiteCode149[String] = 6373083920445075162
@SiteCode150[String] = 6373083908618598731
@SiteCode151[String] = 6373083911842783146
@SiteCode152[String] = 6373083913928202424
@SiteCode153[String] = 6373083877551621804
@SiteCode154[String] = 6373083879921857377
@SiteCode155[String] = 6373083881542550067
@SiteCode156[String] = 6373083883689772886
@SiteCode157[String] = 6373083887136270013
@SiteCode158[String] = 6373083889697116488
@SiteCode159[String] = 6373083891969846476
@SiteCode160[String] = 6373083894422586761
@SiteCode161[String] = 6373083897509963358
@SiteCode162[String] = 6373083900444931227
@SiteCode163[String] = 6373083829464571372
@SiteCode164[String] = 6373083833327492328
@SiteCode165[String] = 6373083841964286321
@SiteCode166[String] = 6373083844982558950
@SiteCode167[String] = 6373083847585007801
@SiteCode168[String] = 6373083856887939900
@SiteCode169[String] = 6373083859102666584
@SiteCode170[String] = 6373083864919499284
@SiteCode171[String] = 6373334974514214221
@FDictionaryCode172[String] = OrderState
@FDictionaryCode173[String] = UrgentDegree
@FDictionaryCode174[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:06:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:06:31
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:06:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:06:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:06:31
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:06:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:06:35
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:06:35
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:06:40
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:06:45
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode176) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode177) 	
Parameters:
@SiteCode176[String] = 6373083923489249281
@ComponentCode177[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:09:05
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:09:05
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:09:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type178) AND ([TbOrganizationMap].[ProjectId] = @ProjectId179)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode180,@CompanyCode181,@CompanyCode182,@CompanyCode183,@CompanyCode184,@CompanyCode185,@CompanyCode186,@CompanyCode187)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode188))) 	
Parameters:
@Type178[Int32] = 1
@ProjectId179[String] = 6372912251695766465
@CompanyCode180[String] = 6373083923489249281
@CompanyCode181[String] = 6373083925531366080
@CompanyCode182[String] = 6373083927883400612
@CompanyCode183[String] = 6373083918575368225
@CompanyCode184[String] = 6373083920445075162
@CompanyCode185[String] = 6373083908618598731
@CompanyCode186[String] = 6373083911842783146
@CompanyCode187[String] = 6373083913928202424
@ParentCompanyCode188[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type189) AND ([TbOrganizationMap].[ProjectId] = @ProjectId190)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode191,@CompanyCode192,@CompanyCode193,@CompanyCode194,@CompanyCode195,@CompanyCode196,@CompanyCode197,@CompanyCode198)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode199))) 	
Parameters:
@Type189[Int32] = 2
@ProjectId190[String] = 6372912251695766465
@CompanyCode191[String] = 6373083923489249281
@CompanyCode192[String] = 6373083925531366080
@CompanyCode193[String] = 6373083927883400612
@CompanyCode194[String] = 6373083918575368225
@CompanyCode195[String] = 6373083920445075162
@CompanyCode196[String] = 6373083908618598731
@CompanyCode197[String] = 6373083911842783146
@CompanyCode198[String] = 6373083913928202424
@ParentCompanyCode199[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode228)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId200) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209,@SiteCode210,@SiteCode211,@SiteCode212,@SiteCode213,@SiteCode214,@SiteCode215,@SiteCode216,@SiteCode217,@SiteCode218,@SiteCode219,@SiteCode220,@SiteCode221,@SiteCode222,@SiteCode223,@SiteCode224,@SiteCode225,@SiteCode226,@SiteCode227)))	
Parameters:
@ProjectId200[String] = 6372912251695766465
@SiteCode201[String] = 6373083923489249281
@SiteCode202[String] = 6373083925531366080
@SiteCode203[String] = 6373083927883400612
@SiteCode204[String] = 6373083918575368225
@SiteCode205[String] = 6373083920445075162
@SiteCode206[String] = 6373083908618598731
@SiteCode207[String] = 6373083911842783146
@SiteCode208[String] = 6373083913928202424
@SiteCode209[String] = 6373083877551621804
@SiteCode210[String] = 6373083879921857377
@SiteCode211[String] = 6373083881542550067
@SiteCode212[String] = 6373083883689772886
@SiteCode213[String] = 6373083887136270013
@SiteCode214[String] = 6373083889697116488
@SiteCode215[String] = 6373083891969846476
@SiteCode216[String] = 6373083894422586761
@SiteCode217[String] = 6373083897509963358
@SiteCode218[String] = 6373083900444931227
@SiteCode219[String] = 6373083829464571372
@SiteCode220[String] = 6373083833327492328
@SiteCode221[String] = 6373083841964286321
@SiteCode222[String] = 6373083844982558950
@SiteCode223[String] = 6373083847585007801
@SiteCode224[String] = 6373083856887939900
@SiteCode225[String] = 6373083859102666584
@SiteCode226[String] = 6373083864919499284
@SiteCode227[String] = 6373334974514214221
@FDictionaryCode228[String] = OrderState
@FDictionaryCode229[String] = UrgentDegree
@FDictionaryCode230[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode229) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode230) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode228)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId200) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209,@SiteCode210,@SiteCode211,@SiteCode212,@SiteCode213,@SiteCode214,@SiteCode215,@SiteCode216,@SiteCode217,@SiteCode218,@SiteCode219,@SiteCode220,@SiteCode221,@SiteCode222,@SiteCode223,@SiteCode224,@SiteCode225,@SiteCode226,@SiteCode227))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId200[String] = 6372912251695766465
@SiteCode201[String] = 6373083923489249281
@SiteCode202[String] = 6373083925531366080
@SiteCode203[String] = 6373083927883400612
@SiteCode204[String] = 6373083918575368225
@SiteCode205[String] = 6373083920445075162
@SiteCode206[String] = 6373083908618598731
@SiteCode207[String] = 6373083911842783146
@SiteCode208[String] = 6373083913928202424
@SiteCode209[String] = 6373083877551621804
@SiteCode210[String] = 6373083879921857377
@SiteCode211[String] = 6373083881542550067
@SiteCode212[String] = 6373083883689772886
@SiteCode213[String] = 6373083887136270013
@SiteCode214[String] = 6373083889697116488
@SiteCode215[String] = 6373083891969846476
@SiteCode216[String] = 6373083894422586761
@SiteCode217[String] = 6373083897509963358
@SiteCode218[String] = 6373083900444931227
@SiteCode219[String] = 6373083829464571372
@SiteCode220[String] = 6373083833327492328
@SiteCode221[String] = 6373083841964286321
@SiteCode222[String] = 6373083844982558950
@SiteCode223[String] = 6373083847585007801
@SiteCode224[String] = 6373083856887939900
@SiteCode225[String] = 6373083859102666584
@SiteCode226[String] = 6373083864919499284
@SiteCode227[String] = 6373334974514214221
@FDictionaryCode228[String] = OrderState
@FDictionaryCode229[String] = UrgentDegree
@FDictionaryCode230[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:09:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:09:07
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:09:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:09:23
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:09:23
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:09:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:09:36
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode232) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode233) 	
Parameters:
@SiteCode232[String] = 6373083923489249281
@ComponentCode233[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:15:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:18:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:20:33
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode235) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode236) 	
Parameters:
@SiteCode235[String] = 6373083923489249281
@ComponentCode236[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:40
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode238) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode239) 	
Parameters:
@SiteCode238[String] = 6373083923489249281
@ComponentCode239[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:41
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode241) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode242) 	
Parameters:
@SiteCode241[String] = 6373083923489249281
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:45
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode244) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode245) 	
Parameters:
@SiteCode244[String] = 6373083923489249281
@ComponentCode245[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:48
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode247) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode248) 	
Parameters:
@SiteCode247[String] = 6373083923489249281
@ComponentCode248[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:51
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode250) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode251) 	
Parameters:
@SiteCode250[String] = 6373083923489249281
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:52
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode253) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode254) 	
Parameters:
@SiteCode253[String] = 6373083923489249281
@ComponentCode254[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:53
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode256) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode257) 	
Parameters:
@SiteCode256[String] = 6373083923489249281
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:54
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode259) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode260) 	
Parameters:
@SiteCode259[String] = 6373083923489249281
@ComponentCode260[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:55
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode262) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode263) 	
Parameters:
@SiteCode262[String] = 6373083923489249281
@ComponentCode263[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:20:56
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode265) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode266) 	
Parameters:
@SiteCode265[String] = 6373083923489249281
@ComponentCode266[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:21:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:24:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:26:07
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:26:07
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:26:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type267) AND ([TbOrganizationMap].[ProjectId] = @ProjectId268)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode269,@CompanyCode270,@CompanyCode271,@CompanyCode272,@CompanyCode273,@CompanyCode274,@CompanyCode275,@CompanyCode276)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode277))) 	
Parameters:
@Type267[Int32] = 1
@ProjectId268[String] = 6372912251695766465
@CompanyCode269[String] = 6373083923489249281
@CompanyCode270[String] = 6373083925531366080
@CompanyCode271[String] = 6373083927883400612
@CompanyCode272[String] = 6373083918575368225
@CompanyCode273[String] = 6373083920445075162
@CompanyCode274[String] = 6373083908618598731
@CompanyCode275[String] = 6373083911842783146
@CompanyCode276[String] = 6373083913928202424
@ParentCompanyCode277[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type278) AND ([TbOrganizationMap].[ProjectId] = @ProjectId279)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode280,@CompanyCode281,@CompanyCode282,@CompanyCode283,@CompanyCode284,@CompanyCode285,@CompanyCode286,@CompanyCode287)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode288))) 	
Parameters:
@Type278[Int32] = 2
@ProjectId279[String] = 6372912251695766465
@CompanyCode280[String] = 6373083923489249281
@CompanyCode281[String] = 6373083925531366080
@CompanyCode282[String] = 6373083927883400612
@CompanyCode283[String] = 6373083918575368225
@CompanyCode284[String] = 6373083920445075162
@CompanyCode285[String] = 6373083908618598731
@CompanyCode286[String] = 6373083911842783146
@CompanyCode287[String] = 6373083913928202424
@ParentCompanyCode288[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode317)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId289) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode290,@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294,@SiteCode295,@SiteCode296,@SiteCode297,@SiteCode298,@SiteCode299,@SiteCode300,@SiteCode301,@SiteCode302,@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316)))	
Parameters:
@ProjectId289[String] = 6372912251695766465
@SiteCode290[String] = 6373083923489249281
@SiteCode291[String] = 6373083925531366080
@SiteCode292[String] = 6373083927883400612
@SiteCode293[String] = 6373083918575368225
@SiteCode294[String] = 6373083920445075162
@SiteCode295[String] = 6373083908618598731
@SiteCode296[String] = 6373083911842783146
@SiteCode297[String] = 6373083913928202424
@SiteCode298[String] = 6373083877551621804
@SiteCode299[String] = 6373083879921857377
@SiteCode300[String] = 6373083881542550067
@SiteCode301[String] = 6373083883689772886
@SiteCode302[String] = 6373083887136270013
@SiteCode303[String] = 6373083889697116488
@SiteCode304[String] = 6373083891969846476
@SiteCode305[String] = 6373083894422586761
@SiteCode306[String] = 6373083897509963358
@SiteCode307[String] = 6373083900444931227
@SiteCode308[String] = 6373083829464571372
@SiteCode309[String] = 6373083833327492328
@SiteCode310[String] = 6373083841964286321
@SiteCode311[String] = 6373083844982558950
@SiteCode312[String] = 6373083847585007801
@SiteCode313[String] = 6373083856887939900
@SiteCode314[String] = 6373083859102666584
@SiteCode315[String] = 6373083864919499284
@SiteCode316[String] = 6373334974514214221
@FDictionaryCode317[String] = OrderState
@FDictionaryCode318[String] = UrgentDegree
@FDictionaryCode319[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode318) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode319) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode317)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId289) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode290,@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294,@SiteCode295,@SiteCode296,@SiteCode297,@SiteCode298,@SiteCode299,@SiteCode300,@SiteCode301,@SiteCode302,@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId289[String] = 6372912251695766465
@SiteCode290[String] = 6373083923489249281
@SiteCode291[String] = 6373083925531366080
@SiteCode292[String] = 6373083927883400612
@SiteCode293[String] = 6373083918575368225
@SiteCode294[String] = 6373083920445075162
@SiteCode295[String] = 6373083908618598731
@SiteCode296[String] = 6373083911842783146
@SiteCode297[String] = 6373083913928202424
@SiteCode298[String] = 6373083877551621804
@SiteCode299[String] = 6373083879921857377
@SiteCode300[String] = 6373083881542550067
@SiteCode301[String] = 6373083883689772886
@SiteCode302[String] = 6373083887136270013
@SiteCode303[String] = 6373083889697116488
@SiteCode304[String] = 6373083891969846476
@SiteCode305[String] = 6373083894422586761
@SiteCode306[String] = 6373083897509963358
@SiteCode307[String] = 6373083900444931227
@SiteCode308[String] = 6373083829464571372
@SiteCode309[String] = 6373083833327492328
@SiteCode310[String] = 6373083841964286321
@SiteCode311[String] = 6373083844982558950
@SiteCode312[String] = 6373083847585007801
@SiteCode313[String] = 6373083856887939900
@SiteCode314[String] = 6373083859102666584
@SiteCode315[String] = 6373083864919499284
@SiteCode316[String] = 6373334974514214221
@FDictionaryCode317[String] = OrderState
@FDictionaryCode318[String] = UrgentDegree
@FDictionaryCode319[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:26:08
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:26:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:26:17
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:26:17
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:26:21
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:26:27
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode321) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode322) 	
Parameters:
@SiteCode321[String] = 6373083923489249281
@ComponentCode322[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-18 16:35:45
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:38:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:41:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:44:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:44:33
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode324) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode325) 	
Parameters:
@SiteCode324[String] = 6373083923489249281
@ComponentCode325[String] = L21_Z08_00GS_GS%


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode326) AND ([TbUser].[UserPwd] = @UserPwd327) 	
Parameters:
@UserCode326[String] = 500000
@UserPwd327[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode328 	
Parameters:
@UserCode328[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 16:56:37
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu329,@ActionType330,@HostName331,@LogDate332,@UserCode333,@UserIP334);select scope_identity()	
Parameters:
@ActionMenu329[String] = 0
@ActionType330[String] = 登录系统
@HostName331[String] = 
@LogDate332[DateTime] = 2020/8/18 16:56:37
@UserCode333[String] = 500000
@UserIP334[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 16:56:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:56:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:56:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type335) AND ([TbOrganizationMap].[ProjectId] = @ProjectId336)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode337,@CompanyCode338,@CompanyCode339,@CompanyCode340,@CompanyCode341,@CompanyCode342,@CompanyCode343,@CompanyCode344)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode345))) 	
Parameters:
@Type335[Int32] = 1
@ProjectId336[String] = 6372912251695766465
@CompanyCode337[String] = 6373083923489249281
@CompanyCode338[String] = 6373083925531366080
@CompanyCode339[String] = 6373083927883400612
@CompanyCode340[String] = 6373083918575368225
@CompanyCode341[String] = 6373083920445075162
@CompanyCode342[String] = 6373083908618598731
@CompanyCode343[String] = 6373083911842783146
@CompanyCode344[String] = 6373083913928202424
@ParentCompanyCode345[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type346) AND ([TbOrganizationMap].[ProjectId] = @ProjectId347)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode348,@CompanyCode349,@CompanyCode350,@CompanyCode351,@CompanyCode352,@CompanyCode353,@CompanyCode354,@CompanyCode355)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode356))) 	
Parameters:
@Type346[Int32] = 2
@ProjectId347[String] = 6372912251695766465
@CompanyCode348[String] = 6373083923489249281
@CompanyCode349[String] = 6373083925531366080
@CompanyCode350[String] = 6373083927883400612
@CompanyCode351[String] = 6373083918575368225
@CompanyCode352[String] = 6373083920445075162
@CompanyCode353[String] = 6373083908618598731
@CompanyCode354[String] = 6373083911842783146
@CompanyCode355[String] = 6373083913928202424
@ParentCompanyCode356[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode385)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId357) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode358,@SiteCode359,@SiteCode360,@SiteCode361,@SiteCode362,@SiteCode363,@SiteCode364,@SiteCode365,@SiteCode366,@SiteCode367,@SiteCode368,@SiteCode369,@SiteCode370,@SiteCode371,@SiteCode372,@SiteCode373,@SiteCode374,@SiteCode375,@SiteCode376,@SiteCode377,@SiteCode378,@SiteCode379,@SiteCode380,@SiteCode381,@SiteCode382,@SiteCode383,@SiteCode384)))	
Parameters:
@ProjectId357[String] = 6372912251695766465
@SiteCode358[String] = 6373083923489249281
@SiteCode359[String] = 6373083925531366080
@SiteCode360[String] = 6373083927883400612
@SiteCode361[String] = 6373083918575368225
@SiteCode362[String] = 6373083920445075162
@SiteCode363[String] = 6373083908618598731
@SiteCode364[String] = 6373083911842783146
@SiteCode365[String] = 6373083913928202424
@SiteCode366[String] = 6373083877551621804
@SiteCode367[String] = 6373083879921857377
@SiteCode368[String] = 6373083881542550067
@SiteCode369[String] = 6373083883689772886
@SiteCode370[String] = 6373083887136270013
@SiteCode371[String] = 6373083889697116488
@SiteCode372[String] = 6373083891969846476
@SiteCode373[String] = 6373083894422586761
@SiteCode374[String] = 6373083897509963358
@SiteCode375[String] = 6373083900444931227
@SiteCode376[String] = 6373083829464571372
@SiteCode377[String] = 6373083833327492328
@SiteCode378[String] = 6373083841964286321
@SiteCode379[String] = 6373083844982558950
@SiteCode380[String] = 6373083847585007801
@SiteCode381[String] = 6373083856887939900
@SiteCode382[String] = 6373083859102666584
@SiteCode383[String] = 6373083864919499284
@SiteCode384[String] = 6373334974514214221
@FDictionaryCode385[String] = OrderState
@FDictionaryCode386[String] = UrgentDegree
@FDictionaryCode387[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:56:43
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode386) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode387) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode385)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId357) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode358,@SiteCode359,@SiteCode360,@SiteCode361,@SiteCode362,@SiteCode363,@SiteCode364,@SiteCode365,@SiteCode366,@SiteCode367,@SiteCode368,@SiteCode369,@SiteCode370,@SiteCode371,@SiteCode372,@SiteCode373,@SiteCode374,@SiteCode375,@SiteCode376,@SiteCode377,@SiteCode378,@SiteCode379,@SiteCode380,@SiteCode381,@SiteCode382,@SiteCode383,@SiteCode384))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId357[String] = 6372912251695766465
@SiteCode358[String] = 6373083923489249281
@SiteCode359[String] = 6373083925531366080
@SiteCode360[String] = 6373083927883400612
@SiteCode361[String] = 6373083918575368225
@SiteCode362[String] = 6373083920445075162
@SiteCode363[String] = 6373083908618598731
@SiteCode364[String] = 6373083911842783146
@SiteCode365[String] = 6373083913928202424
@SiteCode366[String] = 6373083877551621804
@SiteCode367[String] = 6373083879921857377
@SiteCode368[String] = 6373083881542550067
@SiteCode369[String] = 6373083883689772886
@SiteCode370[String] = 6373083887136270013
@SiteCode371[String] = 6373083889697116488
@SiteCode372[String] = 6373083891969846476
@SiteCode373[String] = 6373083894422586761
@SiteCode374[String] = 6373083897509963358
@SiteCode375[String] = 6373083900444931227
@SiteCode376[String] = 6373083829464571372
@SiteCode377[String] = 6373083833327492328
@SiteCode378[String] = 6373083841964286321
@SiteCode379[String] = 6373083844982558950
@SiteCode380[String] = 6373083847585007801
@SiteCode381[String] = 6373083856887939900
@SiteCode382[String] = 6373083859102666584
@SiteCode383[String] = 6373083864919499284
@SiteCode384[String] = 6373334974514214221
@FDictionaryCode385[String] = OrderState
@FDictionaryCode386[String] = UrgentDegree
@FDictionaryCode387[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:56:44
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:56:44
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:56:44
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:56:44
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:56:44
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:56:57
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:56:57
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 16:56:57
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:57:01
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 16:58:32
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:58:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:58:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:58:46
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:58:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:58:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type388) AND ([TbOrganizationMap].[ProjectId] = @ProjectId389)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode390,@CompanyCode391,@CompanyCode392,@CompanyCode393,@CompanyCode394,@CompanyCode395,@CompanyCode396,@CompanyCode397)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode398))) 	
Parameters:
@Type388[Int32] = 1
@ProjectId389[String] = 6372912251695766465
@CompanyCode390[String] = 6373083923489249281
@CompanyCode391[String] = 6373083925531366080
@CompanyCode392[String] = 6373083927883400612
@CompanyCode393[String] = 6373083918575368225
@CompanyCode394[String] = 6373083920445075162
@CompanyCode395[String] = 6373083908618598731
@CompanyCode396[String] = 6373083911842783146
@CompanyCode397[String] = 6373083913928202424
@ParentCompanyCode398[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:58:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:58:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type399) AND ([TbOrganizationMap].[ProjectId] = @ProjectId400)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode401,@CompanyCode402,@CompanyCode403,@CompanyCode404,@CompanyCode405,@CompanyCode406,@CompanyCode407,@CompanyCode408)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode409))) 	
Parameters:
@Type399[Int32] = 2
@ProjectId400[String] = 6372912251695766465
@CompanyCode401[String] = 6373083923489249281
@CompanyCode402[String] = 6373083925531366080
@CompanyCode403[String] = 6373083927883400612
@CompanyCode404[String] = 6373083918575368225
@CompanyCode405[String] = 6373083920445075162
@CompanyCode406[String] = 6373083908618598731
@CompanyCode407[String] = 6373083911842783146
@CompanyCode408[String] = 6373083913928202424
@ParentCompanyCode409[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:58:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:58:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:58:47
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode438)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId410) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode411,@SiteCode412,@SiteCode413,@SiteCode414,@SiteCode415,@SiteCode416,@SiteCode417,@SiteCode418,@SiteCode419,@SiteCode420,@SiteCode421,@SiteCode422,@SiteCode423,@SiteCode424,@SiteCode425,@SiteCode426,@SiteCode427,@SiteCode428,@SiteCode429,@SiteCode430,@SiteCode431,@SiteCode432,@SiteCode433,@SiteCode434,@SiteCode435,@SiteCode436,@SiteCode437)))	
Parameters:
@ProjectId410[String] = 6372912251695766465
@SiteCode411[String] = 6373083923489249281
@SiteCode412[String] = 6373083925531366080
@SiteCode413[String] = 6373083927883400612
@SiteCode414[String] = 6373083918575368225
@SiteCode415[String] = 6373083920445075162
@SiteCode416[String] = 6373083908618598731
@SiteCode417[String] = 6373083911842783146
@SiteCode418[String] = 6373083913928202424
@SiteCode419[String] = 6373083877551621804
@SiteCode420[String] = 6373083879921857377
@SiteCode421[String] = 6373083881542550067
@SiteCode422[String] = 6373083883689772886
@SiteCode423[String] = 6373083887136270013
@SiteCode424[String] = 6373083889697116488
@SiteCode425[String] = 6373083891969846476
@SiteCode426[String] = 6373083894422586761
@SiteCode427[String] = 6373083897509963358
@SiteCode428[String] = 6373083900444931227
@SiteCode429[String] = 6373083829464571372
@SiteCode430[String] = 6373083833327492328
@SiteCode431[String] = 6373083841964286321
@SiteCode432[String] = 6373083844982558950
@SiteCode433[String] = 6373083847585007801
@SiteCode434[String] = 6373083856887939900
@SiteCode435[String] = 6373083859102666584
@SiteCode436[String] = 6373083864919499284
@SiteCode437[String] = 6373334974514214221
@FDictionaryCode438[String] = OrderState
@FDictionaryCode439[String] = UrgentDegree
@FDictionaryCode440[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:58:47
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode439) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode440) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode438)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId410) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode411,@SiteCode412,@SiteCode413,@SiteCode414,@SiteCode415,@SiteCode416,@SiteCode417,@SiteCode418,@SiteCode419,@SiteCode420,@SiteCode421,@SiteCode422,@SiteCode423,@SiteCode424,@SiteCode425,@SiteCode426,@SiteCode427,@SiteCode428,@SiteCode429,@SiteCode430,@SiteCode431,@SiteCode432,@SiteCode433,@SiteCode434,@SiteCode435,@SiteCode436,@SiteCode437))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId410[String] = 6372912251695766465
@SiteCode411[String] = 6373083923489249281
@SiteCode412[String] = 6373083925531366080
@SiteCode413[String] = 6373083927883400612
@SiteCode414[String] = 6373083918575368225
@SiteCode415[String] = 6373083920445075162
@SiteCode416[String] = 6373083908618598731
@SiteCode417[String] = 6373083911842783146
@SiteCode418[String] = 6373083913928202424
@SiteCode419[String] = 6373083877551621804
@SiteCode420[String] = 6373083879921857377
@SiteCode421[String] = 6373083881542550067
@SiteCode422[String] = 6373083883689772886
@SiteCode423[String] = 6373083887136270013
@SiteCode424[String] = 6373083889697116488
@SiteCode425[String] = 6373083891969846476
@SiteCode426[String] = 6373083894422586761
@SiteCode427[String] = 6373083897509963358
@SiteCode428[String] = 6373083900444931227
@SiteCode429[String] = 6373083829464571372
@SiteCode430[String] = 6373083833327492328
@SiteCode431[String] = 6373083841964286321
@SiteCode432[String] = 6373083844982558950
@SiteCode433[String] = 6373083847585007801
@SiteCode434[String] = 6373083856887939900
@SiteCode435[String] = 6373083859102666584
@SiteCode436[String] = 6373083864919499284
@SiteCode437[String] = 6373334974514214221
@FDictionaryCode438[String] = OrderState
@FDictionaryCode439[String] = UrgentDegree
@FDictionaryCode440[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:58:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 16:59:01
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 16:59:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 16:59:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 16:59:02
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 16:59:54
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 16:59:54
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 16:59:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type441) AND ([TbOrganizationMap].[ProjectId] = @ProjectId442)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode443,@CompanyCode444,@CompanyCode445,@CompanyCode446,@CompanyCode447,@CompanyCode448,@CompanyCode449,@CompanyCode450)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode451))) 	
Parameters:
@Type441[Int32] = 1
@ProjectId442[String] = 6372912251695766465
@CompanyCode443[String] = 6373083923489249281
@CompanyCode444[String] = 6373083925531366080
@CompanyCode445[String] = 6373083927883400612
@CompanyCode446[String] = 6373083918575368225
@CompanyCode447[String] = 6373083920445075162
@CompanyCode448[String] = 6373083908618598731
@CompanyCode449[String] = 6373083911842783146
@CompanyCode450[String] = 6373083913928202424
@ParentCompanyCode451[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type452) AND ([TbOrganizationMap].[ProjectId] = @ProjectId453)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode454,@CompanyCode455,@CompanyCode456,@CompanyCode457,@CompanyCode458,@CompanyCode459,@CompanyCode460,@CompanyCode461)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode462))) 	
Parameters:
@Type452[Int32] = 2
@ProjectId453[String] = 6372912251695766465
@CompanyCode454[String] = 6373083923489249281
@CompanyCode455[String] = 6373083925531366080
@CompanyCode456[String] = 6373083927883400612
@CompanyCode457[String] = 6373083918575368225
@CompanyCode458[String] = 6373083920445075162
@CompanyCode459[String] = 6373083908618598731
@CompanyCode460[String] = 6373083911842783146
@CompanyCode461[String] = 6373083913928202424
@ParentCompanyCode462[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode491)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId463) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode464,@SiteCode465,@SiteCode466,@SiteCode467,@SiteCode468,@SiteCode469,@SiteCode470,@SiteCode471,@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490)))	
Parameters:
@ProjectId463[String] = 6372912251695766465
@SiteCode464[String] = 6373083923489249281
@SiteCode465[String] = 6373083925531366080
@SiteCode466[String] = 6373083927883400612
@SiteCode467[String] = 6373083918575368225
@SiteCode468[String] = 6373083920445075162
@SiteCode469[String] = 6373083908618598731
@SiteCode470[String] = 6373083911842783146
@SiteCode471[String] = 6373083913928202424
@SiteCode472[String] = 6373083877551621804
@SiteCode473[String] = 6373083879921857377
@SiteCode474[String] = 6373083881542550067
@SiteCode475[String] = 6373083883689772886
@SiteCode476[String] = 6373083887136270013
@SiteCode477[String] = 6373083889697116488
@SiteCode478[String] = 6373083891969846476
@SiteCode479[String] = 6373083894422586761
@SiteCode480[String] = 6373083897509963358
@SiteCode481[String] = 6373083900444931227
@SiteCode482[String] = 6373083829464571372
@SiteCode483[String] = 6373083833327492328
@SiteCode484[String] = 6373083841964286321
@SiteCode485[String] = 6373083844982558950
@SiteCode486[String] = 6373083847585007801
@SiteCode487[String] = 6373083856887939900
@SiteCode488[String] = 6373083859102666584
@SiteCode489[String] = 6373083864919499284
@SiteCode490[String] = 6373334974514214221
@FDictionaryCode491[String] = OrderState
@FDictionaryCode492[String] = UrgentDegree
@FDictionaryCode493[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:59:55
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode492) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode493) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode491)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId463) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode464,@SiteCode465,@SiteCode466,@SiteCode467,@SiteCode468,@SiteCode469,@SiteCode470,@SiteCode471,@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId463[String] = 6372912251695766465
@SiteCode464[String] = 6373083923489249281
@SiteCode465[String] = 6373083925531366080
@SiteCode466[String] = 6373083927883400612
@SiteCode467[String] = 6373083918575368225
@SiteCode468[String] = 6373083920445075162
@SiteCode469[String] = 6373083908618598731
@SiteCode470[String] = 6373083911842783146
@SiteCode471[String] = 6373083913928202424
@SiteCode472[String] = 6373083877551621804
@SiteCode473[String] = 6373083879921857377
@SiteCode474[String] = 6373083881542550067
@SiteCode475[String] = 6373083883689772886
@SiteCode476[String] = 6373083887136270013
@SiteCode477[String] = 6373083889697116488
@SiteCode478[String] = 6373083891969846476
@SiteCode479[String] = 6373083894422586761
@SiteCode480[String] = 6373083897509963358
@SiteCode481[String] = 6373083900444931227
@SiteCode482[String] = 6373083829464571372
@SiteCode483[String] = 6373083833327492328
@SiteCode484[String] = 6373083841964286321
@SiteCode485[String] = 6373083844982558950
@SiteCode486[String] = 6373083847585007801
@SiteCode487[String] = 6373083856887939900
@SiteCode488[String] = 6373083859102666584
@SiteCode489[String] = 6373083864919499284
@SiteCode490[String] = 6373334974514214221
@FDictionaryCode491[String] = OrderState
@FDictionaryCode492[String] = UrgentDegree
@FDictionaryCode493[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 16:59:56
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:00:02
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:00:02
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:00:02
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:00:02
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:02:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:06:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:08:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:11:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:14:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:14:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:14:42
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:14:46
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:14:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:15:04
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:15:04
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:15:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:15:29
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:15:30
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:15:43
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:15:43
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:15:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:15:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:18:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:20:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:20:08
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:20:08
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:20:13
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:21:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode54) AND ([TbUser].[UserPwd] = @UserPwd55) 	
Parameters:
@UserCode54[String] = 500000
@UserPwd55[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode56 	
Parameters:
@UserCode56[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:22:43
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu57,@ActionType58,@HostName59,@LogDate60,@UserCode61,@UserIP62);select scope_identity()	
Parameters:
@ActionMenu57[String] = 0
@ActionType58[String] = 登录系统
@HostName59[String] = 
@LogDate60[DateTime] = 2020/8/18 17:22:43
@UserCode61[String] = 500000
@UserIP62[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 17:22:45
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:22:45
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:22:45
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type63) AND ([TbOrganizationMap].[ProjectId] = @ProjectId64)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode65,@CompanyCode66,@CompanyCode67,@CompanyCode68,@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode73))) 	
Parameters:
@Type63[Int32] = 1
@ProjectId64[String] = 6372912251695766465
@CompanyCode65[String] = 6373083923489249281
@CompanyCode66[String] = 6373083925531366080
@CompanyCode67[String] = 6373083927883400612
@CompanyCode68[String] = 6373083918575368225
@CompanyCode69[String] = 6373083920445075162
@CompanyCode70[String] = 6373083908618598731
@CompanyCode71[String] = 6373083911842783146
@CompanyCode72[String] = 6373083913928202424
@ParentCompanyCode73[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type74) AND ([TbOrganizationMap].[ProjectId] = @ProjectId75)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode76,@CompanyCode77,@CompanyCode78,@CompanyCode79,@CompanyCode80,@CompanyCode81,@CompanyCode82,@CompanyCode83)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode84))) 	
Parameters:
@Type74[Int32] = 2
@ProjectId75[String] = 6372912251695766465
@CompanyCode76[String] = 6373083923489249281
@CompanyCode77[String] = 6373083925531366080
@CompanyCode78[String] = 6373083927883400612
@CompanyCode79[String] = 6373083918575368225
@CompanyCode80[String] = 6373083920445075162
@CompanyCode81[String] = 6373083908618598731
@CompanyCode82[String] = 6373083911842783146
@CompanyCode83[String] = 6373083913928202424
@ParentCompanyCode84[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode113)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId85) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111,@SiteCode112)))	
Parameters:
@ProjectId85[String] = 6372912251695766465
@SiteCode86[String] = 6373083923489249281
@SiteCode87[String] = 6373083925531366080
@SiteCode88[String] = 6373083927883400612
@SiteCode89[String] = 6373083918575368225
@SiteCode90[String] = 6373083920445075162
@SiteCode91[String] = 6373083908618598731
@SiteCode92[String] = 6373083911842783146
@SiteCode93[String] = 6373083913928202424
@SiteCode94[String] = 6373083877551621804
@SiteCode95[String] = 6373083879921857377
@SiteCode96[String] = 6373083881542550067
@SiteCode97[String] = 6373083883689772886
@SiteCode98[String] = 6373083887136270013
@SiteCode99[String] = 6373083889697116488
@SiteCode100[String] = 6373083891969846476
@SiteCode101[String] = 6373083894422586761
@SiteCode102[String] = 6373083897509963358
@SiteCode103[String] = 6373083900444931227
@SiteCode104[String] = 6373083829464571372
@SiteCode105[String] = 6373083833327492328
@SiteCode106[String] = 6373083841964286321
@SiteCode107[String] = 6373083844982558950
@SiteCode108[String] = 6373083847585007801
@SiteCode109[String] = 6373083856887939900
@SiteCode110[String] = 6373083859102666584
@SiteCode111[String] = 6373083864919499284
@SiteCode112[String] = 6373334974514214221
@FDictionaryCode113[String] = OrderState
@FDictionaryCode114[String] = UrgentDegree
@FDictionaryCode115[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:22:48
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode114) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode115) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode113)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId85) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode86,@SiteCode87,@SiteCode88,@SiteCode89,@SiteCode90,@SiteCode91,@SiteCode92,@SiteCode93,@SiteCode94,@SiteCode95,@SiteCode96,@SiteCode97,@SiteCode98,@SiteCode99,@SiteCode100,@SiteCode101,@SiteCode102,@SiteCode103,@SiteCode104,@SiteCode105,@SiteCode106,@SiteCode107,@SiteCode108,@SiteCode109,@SiteCode110,@SiteCode111,@SiteCode112))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId85[String] = 6372912251695766465
@SiteCode86[String] = 6373083923489249281
@SiteCode87[String] = 6373083925531366080
@SiteCode88[String] = 6373083927883400612
@SiteCode89[String] = 6373083918575368225
@SiteCode90[String] = 6373083920445075162
@SiteCode91[String] = 6373083908618598731
@SiteCode92[String] = 6373083911842783146
@SiteCode93[String] = 6373083913928202424
@SiteCode94[String] = 6373083877551621804
@SiteCode95[String] = 6373083879921857377
@SiteCode96[String] = 6373083881542550067
@SiteCode97[String] = 6373083883689772886
@SiteCode98[String] = 6373083887136270013
@SiteCode99[String] = 6373083889697116488
@SiteCode100[String] = 6373083891969846476
@SiteCode101[String] = 6373083894422586761
@SiteCode102[String] = 6373083897509963358
@SiteCode103[String] = 6373083900444931227
@SiteCode104[String] = 6373083829464571372
@SiteCode105[String] = 6373083833327492328
@SiteCode106[String] = 6373083841964286321
@SiteCode107[String] = 6373083844982558950
@SiteCode108[String] = 6373083847585007801
@SiteCode109[String] = 6373083856887939900
@SiteCode110[String] = 6373083859102666584
@SiteCode111[String] = 6373083864919499284
@SiteCode112[String] = 6373334974514214221
@FDictionaryCode113[String] = OrderState
@FDictionaryCode114[String] = UrgentDegree
@FDictionaryCode115[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:22:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:22:49
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:22:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:22:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:22:50
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:23:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:23:31
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:23:31
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode116) AND ([TbUser].[UserPwd] = @UserPwd117) 	
Parameters:
@UserCode116[String] = 500000
@UserPwd117[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode118 	
Parameters:
@UserCode118[String] = 500000


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu119,@ActionType120,@HostName121,@LogDate122,@UserCode123,@UserIP124);select scope_identity()	
Parameters:
@ActionMenu119[String] = 0
@ActionType120[String] = 登录系统
@HostName121[String] = 
@LogDate122[DateTime] = 2020/8/18 17:24:25
@UserCode123[String] = 500000
@UserIP124[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:24:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type125) AND ([TbOrganizationMap].[ProjectId] = @ProjectId126)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode127,@CompanyCode128,@CompanyCode129,@CompanyCode130,@CompanyCode131,@CompanyCode132,@CompanyCode133,@CompanyCode134)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode135))) 	
Parameters:
@Type125[Int32] = 1
@ProjectId126[String] = 6372912251695766465
@CompanyCode127[String] = 6373083923489249281
@CompanyCode128[String] = 6373083925531366080
@CompanyCode129[String] = 6373083927883400612
@CompanyCode130[String] = 6373083918575368225
@CompanyCode131[String] = 6373083920445075162
@CompanyCode132[String] = 6373083908618598731
@CompanyCode133[String] = 6373083911842783146
@CompanyCode134[String] = 6373083913928202424
@ParentCompanyCode135[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type136) AND ([TbOrganizationMap].[ProjectId] = @ProjectId137)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode138,@CompanyCode139,@CompanyCode140,@CompanyCode141,@CompanyCode142,@CompanyCode143,@CompanyCode144,@CompanyCode145)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode146))) 	
Parameters:
@Type136[Int32] = 2
@ProjectId137[String] = 6372912251695766465
@CompanyCode138[String] = 6373083923489249281
@CompanyCode139[String] = 6373083925531366080
@CompanyCode140[String] = 6373083927883400612
@CompanyCode141[String] = 6373083918575368225
@CompanyCode142[String] = 6373083920445075162
@CompanyCode143[String] = 6373083908618598731
@CompanyCode144[String] = 6373083911842783146
@CompanyCode145[String] = 6373083913928202424
@ParentCompanyCode146[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode175)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId147) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157,@SiteCode158,@SiteCode159,@SiteCode160,@SiteCode161,@SiteCode162,@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171,@SiteCode172,@SiteCode173,@SiteCode174)))	
Parameters:
@ProjectId147[String] = 6372912251695766465
@SiteCode148[String] = 6373083923489249281
@SiteCode149[String] = 6373083925531366080
@SiteCode150[String] = 6373083927883400612
@SiteCode151[String] = 6373083918575368225
@SiteCode152[String] = 6373083920445075162
@SiteCode153[String] = 6373083908618598731
@SiteCode154[String] = 6373083911842783146
@SiteCode155[String] = 6373083913928202424
@SiteCode156[String] = 6373083877551621804
@SiteCode157[String] = 6373083879921857377
@SiteCode158[String] = 6373083881542550067
@SiteCode159[String] = 6373083883689772886
@SiteCode160[String] = 6373083887136270013
@SiteCode161[String] = 6373083889697116488
@SiteCode162[String] = 6373083891969846476
@SiteCode163[String] = 6373083894422586761
@SiteCode164[String] = 6373083897509963358
@SiteCode165[String] = 6373083900444931227
@SiteCode166[String] = 6373083829464571372
@SiteCode167[String] = 6373083833327492328
@SiteCode168[String] = 6373083841964286321
@SiteCode169[String] = 6373083844982558950
@SiteCode170[String] = 6373083847585007801
@SiteCode171[String] = 6373083856887939900
@SiteCode172[String] = 6373083859102666584
@SiteCode173[String] = 6373083864919499284
@SiteCode174[String] = 6373334974514214221
@FDictionaryCode175[String] = OrderState
@FDictionaryCode176[String] = UrgentDegree
@FDictionaryCode177[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:24:26
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode176) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode177) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode175)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId147) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode148,@SiteCode149,@SiteCode150,@SiteCode151,@SiteCode152,@SiteCode153,@SiteCode154,@SiteCode155,@SiteCode156,@SiteCode157,@SiteCode158,@SiteCode159,@SiteCode160,@SiteCode161,@SiteCode162,@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171,@SiteCode172,@SiteCode173,@SiteCode174))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId147[String] = 6372912251695766465
@SiteCode148[String] = 6373083923489249281
@SiteCode149[String] = 6373083925531366080
@SiteCode150[String] = 6373083927883400612
@SiteCode151[String] = 6373083918575368225
@SiteCode152[String] = 6373083920445075162
@SiteCode153[String] = 6373083908618598731
@SiteCode154[String] = 6373083911842783146
@SiteCode155[String] = 6373083913928202424
@SiteCode156[String] = 6373083877551621804
@SiteCode157[String] = 6373083879921857377
@SiteCode158[String] = 6373083881542550067
@SiteCode159[String] = 6373083883689772886
@SiteCode160[String] = 6373083887136270013
@SiteCode161[String] = 6373083889697116488
@SiteCode162[String] = 6373083891969846476
@SiteCode163[String] = 6373083894422586761
@SiteCode164[String] = 6373083897509963358
@SiteCode165[String] = 6373083900444931227
@SiteCode166[String] = 6373083829464571372
@SiteCode167[String] = 6373083833327492328
@SiteCode168[String] = 6373083841964286321
@SiteCode169[String] = 6373083844982558950
@SiteCode170[String] = 6373083847585007801
@SiteCode171[String] = 6373083856887939900
@SiteCode172[String] = 6373083859102666584
@SiteCode173[String] = 6373083864919499284
@SiteCode174[String] = 6373334974514214221
@FDictionaryCode175[String] = OrderState
@FDictionaryCode176[String] = UrgentDegree
@FDictionaryCode177[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:24:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:24:27
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:24:27
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:24:27
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:24:27
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:24:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:24:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:24:42
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:24:46
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:24:58
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode179) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode180) 	
Parameters:
@SiteCode179[String] = 6373083923489249281
@ComponentCode180[String] = L21_Z08_00GS_GS_GS%


-----------------------------------------------------------------------------
2020-08-18 17:25:01
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode182) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode183) 	
Parameters:
@SiteCode182[String] = 6373083923489249281
@ComponentCode183[String] = L21_Z08_00GS_GS%


-----------------------------------------------------------------------------
2020-08-18 17:25:06
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode185) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode186) 	
Parameters:
@SiteCode185[String] = 6373083923489249281
@ComponentCode186[String] = L21_Z08_00GS_GS_GS%


-----------------------------------------------------------------------------
2020-08-18 17:25:17
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode188) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode189) 	
Parameters:
@SiteCode188[String] = 6373083923489249281
@ComponentCode189[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 17:25:28
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode191) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode192) 	
Parameters:
@SiteCode191[String] = 6373083923489249281
@ComponentCode192[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 17:27:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:28:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /OA/MyApproval/Index


-----------------------------------------------------------------------------
2020-08-18 17:28:39
Text:	select Tb1.*,isnull(Tb2.PerformStateCount,0) as PerformStateCount from (
select -1 as PerformState,'db' as PerformStateName
						   union all
						   select 7,'dbyy'
                           union all
                           select 0,'cs'
                           union all
                           select 1,'ty'
                           union all
                           select 3,'th'
                           union all
                           select 4,'cx'
                           union all
                           select 9,'qtyh') as Tb1
                           left join
                           (select o.PerformState,
                                  case o.PerformState when -1 then COUNT(1)
                                  when 7 then COUNT(1)
                                  when 0 then COUNT(1) 
                                  when 1 then COUNT(1)
                                  when 2 then COUNT(1)
                                  when 3 then COUNT(1) 
                                  when 4 then COUNT(1)
                                  when 5 then COUNT(1) 
                                  when 9 then COUNT(1)  end as PerformStateCount 
                                  from TbFlowPerformOpinions o
                                  left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                                  left join TbFlowDefine d on p.FlowCode=d.FlowCode
                                  where o.UserCode=@UserCode
                                  and (ISNULL(@SDT,'')='' or o.PreNodeCompleteDate>=@SDT) 
                                  and (ISNULL(@EDT,'')='' or o.PreNodeCompleteDate<@EDT)
                                  and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId)
                                  group by o.PerformState) as Tb2 on Tb1.PerformState=Tb2.PerformState	
Parameters:
@UserCode[String] = 6372930471544160074
@SDT[DateTime] = 
@EDT[DateTime] = 
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:28:39
Text:	select o.PreNodeCompleteDate,o.FlowNodeCode,o.FlowPerformID,f.FlowCode,f.FormCode,f.MenuName,f.UserName,f.FormDataCode,o.UserType,
	fd.FlowName,
	case fp.FlowState when -1 then '审批中' when 9 then '审核完成' when 3 then '已退回' when 4 then '已终止' when 2 then '已撤销' end as FlowState,
	case o.PerformState when -1 then '未阅' 
	when 0 then '抄送人(已阅)' 
	when 7 then '执行人(已阅)'
	when 1 then '同意'
	when 2 then '不同意' when 3 then '退回'
	when 4 then '撤销' when 5 then '超时跳过'
	when 9 then '非会签其他用户已处理' end as PerformState,
	case f.FlowLevel when 0 then '普通' when 1 then '加急' when 2 then '紧急' End as FlowLevel,
	f.FlowTitle,f.BeginTime,f.EndTime,n.FlowNodeName,fd.FlowType
	from TbFlowPerformOpinions o
	left join (
	select s.MenuName,a.FormDataCode,a.FormCode,a.FlowCode,a.FlowPerformID,a.FlowLevel,a.FlowTitle,a.BeginTime,
	a.EndTime,b.UserCode,b.UserName from TbFlowPerform a 
	left join TbUser b on a.UserCode=b.UserCode
	left join TbSysMenu s on a.FormCode=s.MenuCode
	) f on o.FlowPerformID=f.FlowPerformID 
	left join TbFlowPerformNode n on o.FlowPerformID=n.FlowPerformID and o.FlowNodeCode=n.FlowNodeCode
	left join TbFlowPerform fp on fp.FlowPerformID=o.FlowPerformID
	left join TbFlowDefine fd on fp.FlowCode=fd.FlowCode where 1=1 
    and (ISNULL(@SDT,'')='' or o.PreNodeCompleteDate>=@SDT) 
    and (ISNULL(@EDT,'')='' or o.PreNodeCompleteDate<@EDT)  and o.UserCode=@UserId and fd.ProjectId=@ProjectId and (o.PerformState=-1 or o.PerformState=7)	
Parameters:
@UserId[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465
@SDT[DateTime] = 
@EDT[DateTime] = 
@PerformState[Int32] = -1


-----------------------------------------------------------------------------
2020-08-18 17:28:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by FlowPerformID desc)AS Row, * from (select o.PreNodeCompleteDate,o.FlowNodeCode,o.FlowPerformID,f.FlowCode,f.FormCode,f.MenuName,f.UserName,f.FormDataCode,o.UserType,
	fd.FlowName,
	case fp.FlowState when -1 then '审批中' when 9 then '审核完成' when 3 then '已退回' when 4 then '已终止' when 2 then '已撤销' end as FlowState,
	case o.PerformState when -1 then '未阅' 
	when 0 then '抄送人(已阅)' 
	when 7 then '执行人(已阅)'
	when 1 then '同意'
	when 2 then '不同意' when 3 then '退回'
	when 4 then '撤销' when 5 then '超时跳过'
	when 9 then '非会签其他用户已处理' end as PerformState,
	case f.FlowLevel when 0 then '普通' when 1 then '加急' when 2 then '紧急' End as FlowLevel,
	f.FlowTitle,f.BeginTime,f.EndTime,n.FlowNodeName,fd.FlowType
	from TbFlowPerformOpinions o
	left join (
	select s.MenuName,a.FormDataCode,a.FormCode,a.FlowCode,a.FlowPerformID,a.FlowLevel,a.FlowTitle,a.BeginTime,
	a.EndTime,b.UserCode,b.UserName from TbFlowPerform a 
	left join TbUser b on a.UserCode=b.UserCode
	left join TbSysMenu s on a.FormCode=s.MenuCode
	) f on o.FlowPerformID=f.FlowPerformID 
	left join TbFlowPerformNode n on o.FlowPerformID=n.FlowPerformID and o.FlowNodeCode=n.FlowNodeCode
	left join TbFlowPerform fp on fp.FlowPerformID=o.FlowPerformID
	left join TbFlowDefine fd on fp.FlowCode=fd.FlowCode where 1=1 
    and (ISNULL(@SDT,'')='' or o.PreNodeCompleteDate>=@SDT) 
    and (ISNULL(@EDT,'')='' or o.PreNodeCompleteDate<@EDT)  and o.UserCode=@UserId and fd.ProjectId=@ProjectId and (o.PerformState=-1 or o.PerformState=7)) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@UserId[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465
@SDT[DateTime] = 
@EDT[DateTime] = 
@PerformState[Int32] = -1


-----------------------------------------------------------------------------
2020-08-18 17:30:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:33:25
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:34:59
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:34:59
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:34:59
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:35:02
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:35:02
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:35:02
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type193) AND ([TbOrganizationMap].[ProjectId] = @ProjectId194)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode195,@CompanyCode196,@CompanyCode197,@CompanyCode198,@CompanyCode199,@CompanyCode200,@CompanyCode201,@CompanyCode202)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode203))) 	
Parameters:
@Type193[Int32] = 1
@ProjectId194[String] = 6372912251695766465
@CompanyCode195[String] = 6373083923489249281
@CompanyCode196[String] = 6373083925531366080
@CompanyCode197[String] = 6373083927883400612
@CompanyCode198[String] = 6373083918575368225
@CompanyCode199[String] = 6373083920445075162
@CompanyCode200[String] = 6373083908618598731
@CompanyCode201[String] = 6373083911842783146
@CompanyCode202[String] = 6373083913928202424
@ParentCompanyCode203[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:35:02
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:35:02
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type204) AND ([TbOrganizationMap].[ProjectId] = @ProjectId205)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode206,@CompanyCode207,@CompanyCode208,@CompanyCode209,@CompanyCode210,@CompanyCode211,@CompanyCode212,@CompanyCode213)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode214))) 	
Parameters:
@Type204[Int32] = 2
@ProjectId205[String] = 6372912251695766465
@CompanyCode206[String] = 6373083923489249281
@CompanyCode207[String] = 6373083925531366080
@CompanyCode208[String] = 6373083927883400612
@CompanyCode209[String] = 6373083918575368225
@CompanyCode210[String] = 6373083920445075162
@CompanyCode211[String] = 6373083908618598731
@CompanyCode212[String] = 6373083911842783146
@CompanyCode213[String] = 6373083913928202424
@ParentCompanyCode214[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:35:36
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:35:36
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:35:36
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type215) AND ([TbOrganizationMap].[ProjectId] = @ProjectId216)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode217,@CompanyCode218,@CompanyCode219,@CompanyCode220,@CompanyCode221,@CompanyCode222,@CompanyCode223,@CompanyCode224)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode225))) 	
Parameters:
@Type215[Int32] = 1
@ProjectId216[String] = 6372912251695766465
@CompanyCode217[String] = 6373083923489249281
@CompanyCode218[String] = 6373083925531366080
@CompanyCode219[String] = 6373083927883400612
@CompanyCode220[String] = 6373083918575368225
@CompanyCode221[String] = 6373083920445075162
@CompanyCode222[String] = 6373083908618598731
@CompanyCode223[String] = 6373083911842783146
@CompanyCode224[String] = 6373083913928202424
@ParentCompanyCode225[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type226) AND ([TbOrganizationMap].[ProjectId] = @ProjectId227)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode228,@CompanyCode229,@CompanyCode230,@CompanyCode231,@CompanyCode232,@CompanyCode233,@CompanyCode234,@CompanyCode235)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode236))) 	
Parameters:
@Type226[Int32] = 2
@ProjectId227[String] = 6372912251695766465
@CompanyCode228[String] = 6373083923489249281
@CompanyCode229[String] = 6373083925531366080
@CompanyCode230[String] = 6373083927883400612
@CompanyCode231[String] = 6373083918575368225
@CompanyCode232[String] = 6373083920445075162
@CompanyCode233[String] = 6373083908618598731
@CompanyCode234[String] = 6373083911842783146
@CompanyCode235[String] = 6373083913928202424
@ParentCompanyCode236[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode265)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId237) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode238,@SiteCode239,@SiteCode240,@SiteCode241,@SiteCode242,@SiteCode243,@SiteCode244,@SiteCode245,@SiteCode246,@SiteCode247,@SiteCode248,@SiteCode249,@SiteCode250,@SiteCode251,@SiteCode252,@SiteCode253,@SiteCode254,@SiteCode255,@SiteCode256,@SiteCode257,@SiteCode258,@SiteCode259,@SiteCode260,@SiteCode261,@SiteCode262,@SiteCode263,@SiteCode264)))	
Parameters:
@ProjectId237[String] = 6372912251695766465
@SiteCode238[String] = 6373083923489249281
@SiteCode239[String] = 6373083925531366080
@SiteCode240[String] = 6373083927883400612
@SiteCode241[String] = 6373083918575368225
@SiteCode242[String] = 6373083920445075162
@SiteCode243[String] = 6373083908618598731
@SiteCode244[String] = 6373083911842783146
@SiteCode245[String] = 6373083913928202424
@SiteCode246[String] = 6373083877551621804
@SiteCode247[String] = 6373083879921857377
@SiteCode248[String] = 6373083881542550067
@SiteCode249[String] = 6373083883689772886
@SiteCode250[String] = 6373083887136270013
@SiteCode251[String] = 6373083889697116488
@SiteCode252[String] = 6373083891969846476
@SiteCode253[String] = 6373083894422586761
@SiteCode254[String] = 6373083897509963358
@SiteCode255[String] = 6373083900444931227
@SiteCode256[String] = 6373083829464571372
@SiteCode257[String] = 6373083833327492328
@SiteCode258[String] = 6373083841964286321
@SiteCode259[String] = 6373083844982558950
@SiteCode260[String] = 6373083847585007801
@SiteCode261[String] = 6373083856887939900
@SiteCode262[String] = 6373083859102666584
@SiteCode263[String] = 6373083864919499284
@SiteCode264[String] = 6373334974514214221
@FDictionaryCode265[String] = OrderState
@FDictionaryCode266[String] = UrgentDegree
@FDictionaryCode267[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode266) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode267) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode265)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId237) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode238,@SiteCode239,@SiteCode240,@SiteCode241,@SiteCode242,@SiteCode243,@SiteCode244,@SiteCode245,@SiteCode246,@SiteCode247,@SiteCode248,@SiteCode249,@SiteCode250,@SiteCode251,@SiteCode252,@SiteCode253,@SiteCode254,@SiteCode255,@SiteCode256,@SiteCode257,@SiteCode258,@SiteCode259,@SiteCode260,@SiteCode261,@SiteCode262,@SiteCode263,@SiteCode264))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId237[String] = 6372912251695766465
@SiteCode238[String] = 6373083923489249281
@SiteCode239[String] = 6373083925531366080
@SiteCode240[String] = 6373083927883400612
@SiteCode241[String] = 6373083918575368225
@SiteCode242[String] = 6373083920445075162
@SiteCode243[String] = 6373083908618598731
@SiteCode244[String] = 6373083911842783146
@SiteCode245[String] = 6373083913928202424
@SiteCode246[String] = 6373083877551621804
@SiteCode247[String] = 6373083879921857377
@SiteCode248[String] = 6373083881542550067
@SiteCode249[String] = 6373083883689772886
@SiteCode250[String] = 6373083887136270013
@SiteCode251[String] = 6373083889697116488
@SiteCode252[String] = 6373083891969846476
@SiteCode253[String] = 6373083894422586761
@SiteCode254[String] = 6373083897509963358
@SiteCode255[String] = 6373083900444931227
@SiteCode256[String] = 6373083829464571372
@SiteCode257[String] = 6373083833327492328
@SiteCode258[String] = 6373083841964286321
@SiteCode259[String] = 6373083844982558950
@SiteCode260[String] = 6373083847585007801
@SiteCode261[String] = 6373083856887939900
@SiteCode262[String] = 6373083859102666584
@SiteCode263[String] = 6373083864919499284
@SiteCode264[String] = 6373334974514214221
@FDictionaryCode265[String] = OrderState
@FDictionaryCode266[String] = UrgentDegree
@FDictionaryCode267[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:35:37
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:35:38
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type268) AND ([TbOrganizationMap].[ProjectId] = @ProjectId269)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode270,@CompanyCode271,@CompanyCode272,@CompanyCode273,@CompanyCode274,@CompanyCode275,@CompanyCode276,@CompanyCode277)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode278))) 	
Parameters:
@Type268[Int32] = 1
@ProjectId269[String] = 6372912251695766465
@CompanyCode270[String] = 6373083923489249281
@CompanyCode271[String] = 6373083925531366080
@CompanyCode272[String] = 6373083927883400612
@CompanyCode273[String] = 6373083918575368225
@CompanyCode274[String] = 6373083920445075162
@CompanyCode275[String] = 6373083908618598731
@CompanyCode276[String] = 6373083911842783146
@CompanyCode277[String] = 6373083913928202424
@ParentCompanyCode278[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type279) AND ([TbOrganizationMap].[ProjectId] = @ProjectId280)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode281,@CompanyCode282,@CompanyCode283,@CompanyCode284,@CompanyCode285,@CompanyCode286,@CompanyCode287,@CompanyCode288)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode289))) 	
Parameters:
@Type279[Int32] = 2
@ProjectId280[String] = 6372912251695766465
@CompanyCode281[String] = 6373083923489249281
@CompanyCode282[String] = 6373083925531366080
@CompanyCode283[String] = 6373083927883400612
@CompanyCode284[String] = 6373083918575368225
@CompanyCode285[String] = 6373083920445075162
@CompanyCode286[String] = 6373083908618598731
@CompanyCode287[String] = 6373083911842783146
@CompanyCode288[String] = 6373083913928202424
@ParentCompanyCode289[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode318)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId290) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294,@SiteCode295,@SiteCode296,@SiteCode297,@SiteCode298,@SiteCode299,@SiteCode300,@SiteCode301,@SiteCode302,@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316,@SiteCode317)))	
Parameters:
@ProjectId290[String] = 6372912251695766465
@SiteCode291[String] = 6373083923489249281
@SiteCode292[String] = 6373083925531366080
@SiteCode293[String] = 6373083927883400612
@SiteCode294[String] = 6373083918575368225
@SiteCode295[String] = 6373083920445075162
@SiteCode296[String] = 6373083908618598731
@SiteCode297[String] = 6373083911842783146
@SiteCode298[String] = 6373083913928202424
@SiteCode299[String] = 6373083877551621804
@SiteCode300[String] = 6373083879921857377
@SiteCode301[String] = 6373083881542550067
@SiteCode302[String] = 6373083883689772886
@SiteCode303[String] = 6373083887136270013
@SiteCode304[String] = 6373083889697116488
@SiteCode305[String] = 6373083891969846476
@SiteCode306[String] = 6373083894422586761
@SiteCode307[String] = 6373083897509963358
@SiteCode308[String] = 6373083900444931227
@SiteCode309[String] = 6373083829464571372
@SiteCode310[String] = 6373083833327492328
@SiteCode311[String] = 6373083841964286321
@SiteCode312[String] = 6373083844982558950
@SiteCode313[String] = 6373083847585007801
@SiteCode314[String] = 6373083856887939900
@SiteCode315[String] = 6373083859102666584
@SiteCode316[String] = 6373083864919499284
@SiteCode317[String] = 6373334974514214221
@FDictionaryCode318[String] = OrderState
@FDictionaryCode319[String] = UrgentDegree
@FDictionaryCode320[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:36:15
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode319) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode320) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode318)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId290) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode291,@SiteCode292,@SiteCode293,@SiteCode294,@SiteCode295,@SiteCode296,@SiteCode297,@SiteCode298,@SiteCode299,@SiteCode300,@SiteCode301,@SiteCode302,@SiteCode303,@SiteCode304,@SiteCode305,@SiteCode306,@SiteCode307,@SiteCode308,@SiteCode309,@SiteCode310,@SiteCode311,@SiteCode312,@SiteCode313,@SiteCode314,@SiteCode315,@SiteCode316,@SiteCode317))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId290[String] = 6372912251695766465
@SiteCode291[String] = 6373083923489249281
@SiteCode292[String] = 6373083925531366080
@SiteCode293[String] = 6373083927883400612
@SiteCode294[String] = 6373083918575368225
@SiteCode295[String] = 6373083920445075162
@SiteCode296[String] = 6373083908618598731
@SiteCode297[String] = 6373083911842783146
@SiteCode298[String] = 6373083913928202424
@SiteCode299[String] = 6373083877551621804
@SiteCode300[String] = 6373083879921857377
@SiteCode301[String] = 6373083881542550067
@SiteCode302[String] = 6373083883689772886
@SiteCode303[String] = 6373083887136270013
@SiteCode304[String] = 6373083889697116488
@SiteCode305[String] = 6373083891969846476
@SiteCode306[String] = 6373083894422586761
@SiteCode307[String] = 6373083897509963358
@SiteCode308[String] = 6373083900444931227
@SiteCode309[String] = 6373083829464571372
@SiteCode310[String] = 6373083833327492328
@SiteCode311[String] = 6373083841964286321
@SiteCode312[String] = 6373083844982558950
@SiteCode313[String] = 6373083847585007801
@SiteCode314[String] = 6373083856887939900
@SiteCode315[String] = 6373083859102666584
@SiteCode316[String] = 6373083864919499284
@SiteCode317[String] = 6373334974514214221
@FDictionaryCode318[String] = OrderState
@FDictionaryCode319[String] = UrgentDegree
@FDictionaryCode320[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:36:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:36:16
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:36:16
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:36:16
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:36:17
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:36:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:36:21
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:36:21
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:36:28
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode322) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode323) 	
Parameters:
@SiteCode322[String] = 6373083923489249281
@ComponentCode323[String] = L21_Z08_00KT_DXT_DXT%


-----------------------------------------------------------------------------
2020-08-18 17:36:38
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:36:52
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode325) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode326) 	
Parameters:
@SiteCode325[String] = 6373083923489249281
@ComponentCode326[String] = L21_Z08_00KT_DXT%


-----------------------------------------------------------------------------
2020-08-18 17:36:57
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode328) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode329) 	
Parameters:
@SiteCode328[String] = 6373083923489249281
@ComponentCode329[String] = L21_Z08_00KT%


-----------------------------------------------------------------------------
2020-08-18 17:39:06
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode331) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode332) 	
Parameters:
@SiteCode331[String] = 6373083923489249281
@ComponentCode332[String] = L21_Z08_00KT_DXT%


-----------------------------------------------------------------------------
2020-08-18 17:39:10
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:39:11
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode334) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode335) 	
Parameters:
@SiteCode334[String] = 6373083923489249281
@ComponentCode335[String] = L21_Z08_00KT%


-----------------------------------------------------------------------------
2020-08-18 17:39:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083920445075162
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:39:46
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083920445075162')	


-----------------------------------------------------------------------------
2020-08-18 17:39:46
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083920445075162


-----------------------------------------------------------------------------
2020-08-18 17:41:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:38
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:41
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:43
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:45
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:45
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:41:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083911842783146
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:41:46
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083911842783146')	


-----------------------------------------------------------------------------
2020-08-18 17:42:06
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:42:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083829464571372
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:42:10
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083829464571372')	


-----------------------------------------------------------------------------
2020-08-18 17:42:10
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083829464571372


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type336) AND ([TbOrganizationMap].[ProjectId] = @ProjectId337)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode338,@CompanyCode339,@CompanyCode340,@CompanyCode341,@CompanyCode342,@CompanyCode343,@CompanyCode344,@CompanyCode345)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode346))) 	
Parameters:
@Type336[Int32] = 1
@ProjectId337[String] = 6372912251695766465
@CompanyCode338[String] = 6373083923489249281
@CompanyCode339[String] = 6373083925531366080
@CompanyCode340[String] = 6373083927883400612
@CompanyCode341[String] = 6373083918575368225
@CompanyCode342[String] = 6373083920445075162
@CompanyCode343[String] = 6373083908618598731
@CompanyCode344[String] = 6373083911842783146
@CompanyCode345[String] = 6373083913928202424
@ParentCompanyCode346[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type347) AND ([TbOrganizationMap].[ProjectId] = @ProjectId348)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode349,@CompanyCode350,@CompanyCode351,@CompanyCode352,@CompanyCode353,@CompanyCode354,@CompanyCode355,@CompanyCode356)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode357))) 	
Parameters:
@Type347[Int32] = 2
@ProjectId348[String] = 6372912251695766465
@CompanyCode349[String] = 6373083923489249281
@CompanyCode350[String] = 6373083925531366080
@CompanyCode351[String] = 6373083927883400612
@CompanyCode352[String] = 6373083918575368225
@CompanyCode353[String] = 6373083920445075162
@CompanyCode354[String] = 6373083908618598731
@CompanyCode355[String] = 6373083911842783146
@CompanyCode356[String] = 6373083913928202424
@ParentCompanyCode357[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode386)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId358) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode359,@SiteCode360,@SiteCode361,@SiteCode362,@SiteCode363,@SiteCode364,@SiteCode365,@SiteCode366,@SiteCode367,@SiteCode368,@SiteCode369,@SiteCode370,@SiteCode371,@SiteCode372,@SiteCode373,@SiteCode374,@SiteCode375,@SiteCode376,@SiteCode377,@SiteCode378,@SiteCode379,@SiteCode380,@SiteCode381,@SiteCode382,@SiteCode383,@SiteCode384,@SiteCode385)))	
Parameters:
@ProjectId358[String] = 6372912251695766465
@SiteCode359[String] = 6373083923489249281
@SiteCode360[String] = 6373083925531366080
@SiteCode361[String] = 6373083927883400612
@SiteCode362[String] = 6373083918575368225
@SiteCode363[String] = 6373083920445075162
@SiteCode364[String] = 6373083908618598731
@SiteCode365[String] = 6373083911842783146
@SiteCode366[String] = 6373083913928202424
@SiteCode367[String] = 6373083877551621804
@SiteCode368[String] = 6373083879921857377
@SiteCode369[String] = 6373083881542550067
@SiteCode370[String] = 6373083883689772886
@SiteCode371[String] = 6373083887136270013
@SiteCode372[String] = 6373083889697116488
@SiteCode373[String] = 6373083891969846476
@SiteCode374[String] = 6373083894422586761
@SiteCode375[String] = 6373083897509963358
@SiteCode376[String] = 6373083900444931227
@SiteCode377[String] = 6373083829464571372
@SiteCode378[String] = 6373083833327492328
@SiteCode379[String] = 6373083841964286321
@SiteCode380[String] = 6373083844982558950
@SiteCode381[String] = 6373083847585007801
@SiteCode382[String] = 6373083856887939900
@SiteCode383[String] = 6373083859102666584
@SiteCode384[String] = 6373083864919499284
@SiteCode385[String] = 6373334974514214221
@FDictionaryCode386[String] = OrderState
@FDictionaryCode387[String] = UrgentDegree
@FDictionaryCode388[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:44:20
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode387) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode388) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode386)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId358) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode359,@SiteCode360,@SiteCode361,@SiteCode362,@SiteCode363,@SiteCode364,@SiteCode365,@SiteCode366,@SiteCode367,@SiteCode368,@SiteCode369,@SiteCode370,@SiteCode371,@SiteCode372,@SiteCode373,@SiteCode374,@SiteCode375,@SiteCode376,@SiteCode377,@SiteCode378,@SiteCode379,@SiteCode380,@SiteCode381,@SiteCode382,@SiteCode383,@SiteCode384,@SiteCode385))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId358[String] = 6372912251695766465
@SiteCode359[String] = 6373083923489249281
@SiteCode360[String] = 6373083925531366080
@SiteCode361[String] = 6373083927883400612
@SiteCode362[String] = 6373083918575368225
@SiteCode363[String] = 6373083920445075162
@SiteCode364[String] = 6373083908618598731
@SiteCode365[String] = 6373083911842783146
@SiteCode366[String] = 6373083913928202424
@SiteCode367[String] = 6373083877551621804
@SiteCode368[String] = 6373083879921857377
@SiteCode369[String] = 6373083881542550067
@SiteCode370[String] = 6373083883689772886
@SiteCode371[String] = 6373083887136270013
@SiteCode372[String] = 6373083889697116488
@SiteCode373[String] = 6373083891969846476
@SiteCode374[String] = 6373083894422586761
@SiteCode375[String] = 6373083897509963358
@SiteCode376[String] = 6373083900444931227
@SiteCode377[String] = 6373083829464571372
@SiteCode378[String] = 6373083833327492328
@SiteCode379[String] = 6373083841964286321
@SiteCode380[String] = 6373083844982558950
@SiteCode381[String] = 6373083847585007801
@SiteCode382[String] = 6373083856887939900
@SiteCode383[String] = 6373083859102666584
@SiteCode384[String] = 6373083864919499284
@SiteCode385[String] = 6373334974514214221
@FDictionaryCode386[String] = OrderState
@FDictionaryCode387[String] = UrgentDegree
@FDictionaryCode388[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:44:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:44:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:44:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:44:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:44:21
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:44:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:44:25
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:44:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type389) AND ([TbOrganizationMap].[ProjectId] = @ProjectId390)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode391,@CompanyCode392,@CompanyCode393,@CompanyCode394,@CompanyCode395,@CompanyCode396,@CompanyCode397,@CompanyCode398)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode399))) 	
Parameters:
@Type389[Int32] = 1
@ProjectId390[String] = 6372912251695766465
@CompanyCode391[String] = 6373083923489249281
@CompanyCode392[String] = 6373083925531366080
@CompanyCode393[String] = 6373083927883400612
@CompanyCode394[String] = 6373083918575368225
@CompanyCode395[String] = 6373083920445075162
@CompanyCode396[String] = 6373083908618598731
@CompanyCode397[String] = 6373083911842783146
@CompanyCode398[String] = 6373083913928202424
@ParentCompanyCode399[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type400) AND ([TbOrganizationMap].[ProjectId] = @ProjectId401)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode402,@CompanyCode403,@CompanyCode404,@CompanyCode405,@CompanyCode406,@CompanyCode407,@CompanyCode408,@CompanyCode409)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode410))) 	
Parameters:
@Type400[Int32] = 2
@ProjectId401[String] = 6372912251695766465
@CompanyCode402[String] = 6373083923489249281
@CompanyCode403[String] = 6373083925531366080
@CompanyCode404[String] = 6373083927883400612
@CompanyCode405[String] = 6373083918575368225
@CompanyCode406[String] = 6373083920445075162
@CompanyCode407[String] = 6373083908618598731
@CompanyCode408[String] = 6373083911842783146
@CompanyCode409[String] = 6373083913928202424
@ParentCompanyCode410[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode439)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId411) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode412,@SiteCode413,@SiteCode414,@SiteCode415,@SiteCode416,@SiteCode417,@SiteCode418,@SiteCode419,@SiteCode420,@SiteCode421,@SiteCode422,@SiteCode423,@SiteCode424,@SiteCode425,@SiteCode426,@SiteCode427,@SiteCode428,@SiteCode429,@SiteCode430,@SiteCode431,@SiteCode432,@SiteCode433,@SiteCode434,@SiteCode435,@SiteCode436,@SiteCode437,@SiteCode438)))	
Parameters:
@ProjectId411[String] = 6372912251695766465
@SiteCode412[String] = 6373083923489249281
@SiteCode413[String] = 6373083925531366080
@SiteCode414[String] = 6373083927883400612
@SiteCode415[String] = 6373083918575368225
@SiteCode416[String] = 6373083920445075162
@SiteCode417[String] = 6373083908618598731
@SiteCode418[String] = 6373083911842783146
@SiteCode419[String] = 6373083913928202424
@SiteCode420[String] = 6373083877551621804
@SiteCode421[String] = 6373083879921857377
@SiteCode422[String] = 6373083881542550067
@SiteCode423[String] = 6373083883689772886
@SiteCode424[String] = 6373083887136270013
@SiteCode425[String] = 6373083889697116488
@SiteCode426[String] = 6373083891969846476
@SiteCode427[String] = 6373083894422586761
@SiteCode428[String] = 6373083897509963358
@SiteCode429[String] = 6373083900444931227
@SiteCode430[String] = 6373083829464571372
@SiteCode431[String] = 6373083833327492328
@SiteCode432[String] = 6373083841964286321
@SiteCode433[String] = 6373083844982558950
@SiteCode434[String] = 6373083847585007801
@SiteCode435[String] = 6373083856887939900
@SiteCode436[String] = 6373083859102666584
@SiteCode437[String] = 6373083864919499284
@SiteCode438[String] = 6373334974514214221
@FDictionaryCode439[String] = OrderState
@FDictionaryCode440[String] = UrgentDegree
@FDictionaryCode441[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:45:05
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode440) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode441) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode439)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId411) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode412,@SiteCode413,@SiteCode414,@SiteCode415,@SiteCode416,@SiteCode417,@SiteCode418,@SiteCode419,@SiteCode420,@SiteCode421,@SiteCode422,@SiteCode423,@SiteCode424,@SiteCode425,@SiteCode426,@SiteCode427,@SiteCode428,@SiteCode429,@SiteCode430,@SiteCode431,@SiteCode432,@SiteCode433,@SiteCode434,@SiteCode435,@SiteCode436,@SiteCode437,@SiteCode438))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId411[String] = 6372912251695766465
@SiteCode412[String] = 6373083923489249281
@SiteCode413[String] = 6373083925531366080
@SiteCode414[String] = 6373083927883400612
@SiteCode415[String] = 6373083918575368225
@SiteCode416[String] = 6373083920445075162
@SiteCode417[String] = 6373083908618598731
@SiteCode418[String] = 6373083911842783146
@SiteCode419[String] = 6373083913928202424
@SiteCode420[String] = 6373083877551621804
@SiteCode421[String] = 6373083879921857377
@SiteCode422[String] = 6373083881542550067
@SiteCode423[String] = 6373083883689772886
@SiteCode424[String] = 6373083887136270013
@SiteCode425[String] = 6373083889697116488
@SiteCode426[String] = 6373083891969846476
@SiteCode427[String] = 6373083894422586761
@SiteCode428[String] = 6373083897509963358
@SiteCode429[String] = 6373083900444931227
@SiteCode430[String] = 6373083829464571372
@SiteCode431[String] = 6373083833327492328
@SiteCode432[String] = 6373083841964286321
@SiteCode433[String] = 6373083844982558950
@SiteCode434[String] = 6373083847585007801
@SiteCode435[String] = 6373083856887939900
@SiteCode436[String] = 6373083859102666584
@SiteCode437[String] = 6373083864919499284
@SiteCode438[String] = 6373334974514214221
@FDictionaryCode439[String] = OrderState
@FDictionaryCode440[String] = UrgentDegree
@FDictionaryCode441[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:45:06
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:45:06
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:45:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:45:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:45:06
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:45:12
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:12
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:45:12
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type442) AND ([TbOrganizationMap].[ProjectId] = @ProjectId443)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode444,@CompanyCode445,@CompanyCode446,@CompanyCode447,@CompanyCode448,@CompanyCode449,@CompanyCode450,@CompanyCode451)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode452))) 	
Parameters:
@Type442[Int32] = 1
@ProjectId443[String] = 6372912251695766465
@CompanyCode444[String] = 6373083923489249281
@CompanyCode445[String] = 6373083925531366080
@CompanyCode446[String] = 6373083927883400612
@CompanyCode447[String] = 6373083918575368225
@CompanyCode448[String] = 6373083920445075162
@CompanyCode449[String] = 6373083908618598731
@CompanyCode450[String] = 6373083911842783146
@CompanyCode451[String] = 6373083913928202424
@ParentCompanyCode452[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type453) AND ([TbOrganizationMap].[ProjectId] = @ProjectId454)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode455,@CompanyCode456,@CompanyCode457,@CompanyCode458,@CompanyCode459,@CompanyCode460,@CompanyCode461,@CompanyCode462)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode463))) 	
Parameters:
@Type453[Int32] = 2
@ProjectId454[String] = 6372912251695766465
@CompanyCode455[String] = 6373083923489249281
@CompanyCode456[String] = 6373083925531366080
@CompanyCode457[String] = 6373083927883400612
@CompanyCode458[String] = 6373083918575368225
@CompanyCode459[String] = 6373083920445075162
@CompanyCode460[String] = 6373083908618598731
@CompanyCode461[String] = 6373083911842783146
@CompanyCode462[String] = 6373083913928202424
@ParentCompanyCode463[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode492)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId464) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode465,@SiteCode466,@SiteCode467,@SiteCode468,@SiteCode469,@SiteCode470,@SiteCode471,@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490,@SiteCode491)))	
Parameters:
@ProjectId464[String] = 6372912251695766465
@SiteCode465[String] = 6373083923489249281
@SiteCode466[String] = 6373083925531366080
@SiteCode467[String] = 6373083927883400612
@SiteCode468[String] = 6373083918575368225
@SiteCode469[String] = 6373083920445075162
@SiteCode470[String] = 6373083908618598731
@SiteCode471[String] = 6373083911842783146
@SiteCode472[String] = 6373083913928202424
@SiteCode473[String] = 6373083877551621804
@SiteCode474[String] = 6373083879921857377
@SiteCode475[String] = 6373083881542550067
@SiteCode476[String] = 6373083883689772886
@SiteCode477[String] = 6373083887136270013
@SiteCode478[String] = 6373083889697116488
@SiteCode479[String] = 6373083891969846476
@SiteCode480[String] = 6373083894422586761
@SiteCode481[String] = 6373083897509963358
@SiteCode482[String] = 6373083900444931227
@SiteCode483[String] = 6373083829464571372
@SiteCode484[String] = 6373083833327492328
@SiteCode485[String] = 6373083841964286321
@SiteCode486[String] = 6373083844982558950
@SiteCode487[String] = 6373083847585007801
@SiteCode488[String] = 6373083856887939900
@SiteCode489[String] = 6373083859102666584
@SiteCode490[String] = 6373083864919499284
@SiteCode491[String] = 6373334974514214221
@FDictionaryCode492[String] = OrderState
@FDictionaryCode493[String] = UrgentDegree
@FDictionaryCode494[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:45:58
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode493) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode494) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode492)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId464) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode465,@SiteCode466,@SiteCode467,@SiteCode468,@SiteCode469,@SiteCode470,@SiteCode471,@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490,@SiteCode491))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId464[String] = 6372912251695766465
@SiteCode465[String] = 6373083923489249281
@SiteCode466[String] = 6373083925531366080
@SiteCode467[String] = 6373083927883400612
@SiteCode468[String] = 6373083918575368225
@SiteCode469[String] = 6373083920445075162
@SiteCode470[String] = 6373083908618598731
@SiteCode471[String] = 6373083911842783146
@SiteCode472[String] = 6373083913928202424
@SiteCode473[String] = 6373083877551621804
@SiteCode474[String] = 6373083879921857377
@SiteCode475[String] = 6373083881542550067
@SiteCode476[String] = 6373083883689772886
@SiteCode477[String] = 6373083887136270013
@SiteCode478[String] = 6373083889697116488
@SiteCode479[String] = 6373083891969846476
@SiteCode480[String] = 6373083894422586761
@SiteCode481[String] = 6373083897509963358
@SiteCode482[String] = 6373083900444931227
@SiteCode483[String] = 6373083829464571372
@SiteCode484[String] = 6373083833327492328
@SiteCode485[String] = 6373083841964286321
@SiteCode486[String] = 6373083844982558950
@SiteCode487[String] = 6373083847585007801
@SiteCode488[String] = 6373083856887939900
@SiteCode489[String] = 6373083859102666584
@SiteCode490[String] = 6373083864919499284
@SiteCode491[String] = 6373334974514214221
@FDictionaryCode492[String] = OrderState
@FDictionaryCode493[String] = UrgentDegree
@FDictionaryCode494[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:45:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:45:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:45:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:45:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:46:00
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:46:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:46:03
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:46:04
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:46:10
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode496) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode497) 	
Parameters:
@SiteCode496[String] = 6373083923489249281
@ComponentCode497[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 17:46:14
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:46:14
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode499) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode500) 	
Parameters:
@SiteCode499[String] = 6373083923489249281
@ComponentCode500[String] = L21_Z08_00KT_DXT_DXT_MD%


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type501) AND ([TbOrganizationMap].[ProjectId] = @ProjectId502)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode503,@CompanyCode504,@CompanyCode505,@CompanyCode506,@CompanyCode507,@CompanyCode508,@CompanyCode509,@CompanyCode510)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode511))) 	
Parameters:
@Type501[Int32] = 1
@ProjectId502[String] = 6372912251695766465
@CompanyCode503[String] = 6373083923489249281
@CompanyCode504[String] = 6373083925531366080
@CompanyCode505[String] = 6373083927883400612
@CompanyCode506[String] = 6373083918575368225
@CompanyCode507[String] = 6373083920445075162
@CompanyCode508[String] = 6373083908618598731
@CompanyCode509[String] = 6373083911842783146
@CompanyCode510[String] = 6373083913928202424
@ParentCompanyCode511[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type512) AND ([TbOrganizationMap].[ProjectId] = @ProjectId513)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode514,@CompanyCode515,@CompanyCode516,@CompanyCode517,@CompanyCode518,@CompanyCode519,@CompanyCode520,@CompanyCode521)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode522))) 	
Parameters:
@Type512[Int32] = 2
@ProjectId513[String] = 6372912251695766465
@CompanyCode514[String] = 6373083923489249281
@CompanyCode515[String] = 6373083925531366080
@CompanyCode516[String] = 6373083927883400612
@CompanyCode517[String] = 6373083918575368225
@CompanyCode518[String] = 6373083920445075162
@CompanyCode519[String] = 6373083908618598731
@CompanyCode520[String] = 6373083911842783146
@CompanyCode521[String] = 6373083913928202424
@ParentCompanyCode522[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode551)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId523) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode524,@SiteCode525,@SiteCode526,@SiteCode527,@SiteCode528,@SiteCode529,@SiteCode530,@SiteCode531,@SiteCode532,@SiteCode533,@SiteCode534,@SiteCode535,@SiteCode536,@SiteCode537,@SiteCode538,@SiteCode539,@SiteCode540,@SiteCode541,@SiteCode542,@SiteCode543,@SiteCode544,@SiteCode545,@SiteCode546,@SiteCode547,@SiteCode548,@SiteCode549,@SiteCode550)))	
Parameters:
@ProjectId523[String] = 6372912251695766465
@SiteCode524[String] = 6373083923489249281
@SiteCode525[String] = 6373083925531366080
@SiteCode526[String] = 6373083927883400612
@SiteCode527[String] = 6373083918575368225
@SiteCode528[String] = 6373083920445075162
@SiteCode529[String] = 6373083908618598731
@SiteCode530[String] = 6373083911842783146
@SiteCode531[String] = 6373083913928202424
@SiteCode532[String] = 6373083877551621804
@SiteCode533[String] = 6373083879921857377
@SiteCode534[String] = 6373083881542550067
@SiteCode535[String] = 6373083883689772886
@SiteCode536[String] = 6373083887136270013
@SiteCode537[String] = 6373083889697116488
@SiteCode538[String] = 6373083891969846476
@SiteCode539[String] = 6373083894422586761
@SiteCode540[String] = 6373083897509963358
@SiteCode541[String] = 6373083900444931227
@SiteCode542[String] = 6373083829464571372
@SiteCode543[String] = 6373083833327492328
@SiteCode544[String] = 6373083841964286321
@SiteCode545[String] = 6373083844982558950
@SiteCode546[String] = 6373083847585007801
@SiteCode547[String] = 6373083856887939900
@SiteCode548[String] = 6373083859102666584
@SiteCode549[String] = 6373083864919499284
@SiteCode550[String] = 6373334974514214221
@FDictionaryCode551[String] = OrderState
@FDictionaryCode552[String] = UrgentDegree
@FDictionaryCode553[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:47:24
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode552) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode553) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode551)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId523) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode524,@SiteCode525,@SiteCode526,@SiteCode527,@SiteCode528,@SiteCode529,@SiteCode530,@SiteCode531,@SiteCode532,@SiteCode533,@SiteCode534,@SiteCode535,@SiteCode536,@SiteCode537,@SiteCode538,@SiteCode539,@SiteCode540,@SiteCode541,@SiteCode542,@SiteCode543,@SiteCode544,@SiteCode545,@SiteCode546,@SiteCode547,@SiteCode548,@SiteCode549,@SiteCode550))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId523[String] = 6372912251695766465
@SiteCode524[String] = 6373083923489249281
@SiteCode525[String] = 6373083925531366080
@SiteCode526[String] = 6373083927883400612
@SiteCode527[String] = 6373083918575368225
@SiteCode528[String] = 6373083920445075162
@SiteCode529[String] = 6373083908618598731
@SiteCode530[String] = 6373083911842783146
@SiteCode531[String] = 6373083913928202424
@SiteCode532[String] = 6373083877551621804
@SiteCode533[String] = 6373083879921857377
@SiteCode534[String] = 6373083881542550067
@SiteCode535[String] = 6373083883689772886
@SiteCode536[String] = 6373083887136270013
@SiteCode537[String] = 6373083889697116488
@SiteCode538[String] = 6373083891969846476
@SiteCode539[String] = 6373083894422586761
@SiteCode540[String] = 6373083897509963358
@SiteCode541[String] = 6373083900444931227
@SiteCode542[String] = 6373083829464571372
@SiteCode543[String] = 6373083833327492328
@SiteCode544[String] = 6373083841964286321
@SiteCode545[String] = 6373083844982558950
@SiteCode546[String] = 6373083847585007801
@SiteCode547[String] = 6373083856887939900
@SiteCode548[String] = 6373083859102666584
@SiteCode549[String] = 6373083864919499284
@SiteCode550[String] = 6373334974514214221
@FDictionaryCode551[String] = OrderState
@FDictionaryCode552[String] = UrgentDegree
@FDictionaryCode553[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:47:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:47:25
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:47:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:47:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:47:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:47:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:47:29
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-18 17:47:29
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:47:34
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode555) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode556) 	
Parameters:
@SiteCode555[String] = 6373083923489249281
@ComponentCode556[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-18 17:47:37
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-18 17:47:37
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode558) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode559) 	
Parameters:
@SiteCode558[String] = 6373083923489249281
@ComponentCode559[String] = L21_Z08_00KT_DXT_DXT_MD%


-----------------------------------------------------------------------------
2020-08-18 17:48:19
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:48:19
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:48:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:48:19
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type560) AND ([TbOrganizationMap].[ProjectId] = @ProjectId561)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode562,@CompanyCode563,@CompanyCode564,@CompanyCode565,@CompanyCode566,@CompanyCode567,@CompanyCode568,@CompanyCode569)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode570))) 	
Parameters:
@Type560[Int32] = 1
@ProjectId561[String] = 6372912251695766465
@CompanyCode562[String] = 6373083923489249281
@CompanyCode563[String] = 6373083925531366080
@CompanyCode564[String] = 6373083927883400612
@CompanyCode565[String] = 6373083918575368225
@CompanyCode566[String] = 6373083920445075162
@CompanyCode567[String] = 6373083908618598731
@CompanyCode568[String] = 6373083911842783146
@CompanyCode569[String] = 6373083913928202424
@ParentCompanyCode570[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type571) AND ([TbOrganizationMap].[ProjectId] = @ProjectId572)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode573,@CompanyCode574,@CompanyCode575,@CompanyCode576,@CompanyCode577,@CompanyCode578,@CompanyCode579,@CompanyCode580)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode581))) 	
Parameters:
@Type571[Int32] = 2
@ProjectId572[String] = 6372912251695766465
@CompanyCode573[String] = 6373083923489249281
@CompanyCode574[String] = 6373083925531366080
@CompanyCode575[String] = 6373083927883400612
@CompanyCode576[String] = 6373083918575368225
@CompanyCode577[String] = 6373083920445075162
@CompanyCode578[String] = 6373083908618598731
@CompanyCode579[String] = 6373083911842783146
@CompanyCode580[String] = 6373083913928202424
@ParentCompanyCode581[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode610)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId582) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode583,@SiteCode584,@SiteCode585,@SiteCode586,@SiteCode587,@SiteCode588,@SiteCode589,@SiteCode590,@SiteCode591,@SiteCode592,@SiteCode593,@SiteCode594,@SiteCode595,@SiteCode596,@SiteCode597,@SiteCode598,@SiteCode599,@SiteCode600,@SiteCode601,@SiteCode602,@SiteCode603,@SiteCode604,@SiteCode605,@SiteCode606,@SiteCode607,@SiteCode608,@SiteCode609)))	
Parameters:
@ProjectId582[String] = 6372912251695766465
@SiteCode583[String] = 6373083923489249281
@SiteCode584[String] = 6373083925531366080
@SiteCode585[String] = 6373083927883400612
@SiteCode586[String] = 6373083918575368225
@SiteCode587[String] = 6373083920445075162
@SiteCode588[String] = 6373083908618598731
@SiteCode589[String] = 6373083911842783146
@SiteCode590[String] = 6373083913928202424
@SiteCode591[String] = 6373083877551621804
@SiteCode592[String] = 6373083879921857377
@SiteCode593[String] = 6373083881542550067
@SiteCode594[String] = 6373083883689772886
@SiteCode595[String] = 6373083887136270013
@SiteCode596[String] = 6373083889697116488
@SiteCode597[String] = 6373083891969846476
@SiteCode598[String] = 6373083894422586761
@SiteCode599[String] = 6373083897509963358
@SiteCode600[String] = 6373083900444931227
@SiteCode601[String] = 6373083829464571372
@SiteCode602[String] = 6373083833327492328
@SiteCode603[String] = 6373083841964286321
@SiteCode604[String] = 6373083844982558950
@SiteCode605[String] = 6373083847585007801
@SiteCode606[String] = 6373083856887939900
@SiteCode607[String] = 6373083859102666584
@SiteCode608[String] = 6373083864919499284
@SiteCode609[String] = 6373334974514214221
@FDictionaryCode610[String] = OrderState
@FDictionaryCode611[String] = UrgentDegree
@FDictionaryCode612[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode611) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode612) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode610)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId582) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode583,@SiteCode584,@SiteCode585,@SiteCode586,@SiteCode587,@SiteCode588,@SiteCode589,@SiteCode590,@SiteCode591,@SiteCode592,@SiteCode593,@SiteCode594,@SiteCode595,@SiteCode596,@SiteCode597,@SiteCode598,@SiteCode599,@SiteCode600,@SiteCode601,@SiteCode602,@SiteCode603,@SiteCode604,@SiteCode605,@SiteCode606,@SiteCode607,@SiteCode608,@SiteCode609))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId582[String] = 6372912251695766465
@SiteCode583[String] = 6373083923489249281
@SiteCode584[String] = 6373083925531366080
@SiteCode585[String] = 6373083927883400612
@SiteCode586[String] = 6373083918575368225
@SiteCode587[String] = 6373083920445075162
@SiteCode588[String] = 6373083908618598731
@SiteCode589[String] = 6373083911842783146
@SiteCode590[String] = 6373083913928202424
@SiteCode591[String] = 6373083877551621804
@SiteCode592[String] = 6373083879921857377
@SiteCode593[String] = 6373083881542550067
@SiteCode594[String] = 6373083883689772886
@SiteCode595[String] = 6373083887136270013
@SiteCode596[String] = 6373083889697116488
@SiteCode597[String] = 6373083891969846476
@SiteCode598[String] = 6373083894422586761
@SiteCode599[String] = 6373083897509963358
@SiteCode600[String] = 6373083900444931227
@SiteCode601[String] = 6373083829464571372
@SiteCode602[String] = 6373083833327492328
@SiteCode603[String] = 6373083841964286321
@SiteCode604[String] = 6373083844982558950
@SiteCode605[String] = 6373083847585007801
@SiteCode606[String] = 6373083856887939900
@SiteCode607[String] = 6373083859102666584
@SiteCode608[String] = 6373083864919499284
@SiteCode609[String] = 6373334974514214221
@FDictionaryCode610[String] = OrderState
@FDictionaryCode611[String] = UrgentDegree
@FDictionaryCode612[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:48:20
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:48:21
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:51:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type613) AND ([TbOrganizationMap].[ProjectId] = @ProjectId614)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode615,@CompanyCode616,@CompanyCode617,@CompanyCode618,@CompanyCode619,@CompanyCode620,@CompanyCode621,@CompanyCode622)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode623))) 	
Parameters:
@Type613[Int32] = 1
@ProjectId614[String] = 6372912251695766465
@CompanyCode615[String] = 6373083923489249281
@CompanyCode616[String] = 6373083925531366080
@CompanyCode617[String] = 6373083927883400612
@CompanyCode618[String] = 6373083918575368225
@CompanyCode619[String] = 6373083920445075162
@CompanyCode620[String] = 6373083908618598731
@CompanyCode621[String] = 6373083911842783146
@CompanyCode622[String] = 6373083913928202424
@ParentCompanyCode623[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type624) AND ([TbOrganizationMap].[ProjectId] = @ProjectId625)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode626,@CompanyCode627,@CompanyCode628,@CompanyCode629,@CompanyCode630,@CompanyCode631,@CompanyCode632,@CompanyCode633)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode634))) 	
Parameters:
@Type624[Int32] = 2
@ProjectId625[String] = 6372912251695766465
@CompanyCode626[String] = 6373083923489249281
@CompanyCode627[String] = 6373083925531366080
@CompanyCode628[String] = 6373083927883400612
@CompanyCode629[String] = 6373083918575368225
@CompanyCode630[String] = 6373083920445075162
@CompanyCode631[String] = 6373083908618598731
@CompanyCode632[String] = 6373083911842783146
@CompanyCode633[String] = 6373083913928202424
@ParentCompanyCode634[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode663)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId635) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648,@SiteCode649,@SiteCode650,@SiteCode651,@SiteCode652,@SiteCode653,@SiteCode654,@SiteCode655,@SiteCode656,@SiteCode657,@SiteCode658,@SiteCode659,@SiteCode660,@SiteCode661,@SiteCode662)))	
Parameters:
@ProjectId635[String] = 6372912251695766465
@SiteCode636[String] = 6373083923489249281
@SiteCode637[String] = 6373083925531366080
@SiteCode638[String] = 6373083927883400612
@SiteCode639[String] = 6373083918575368225
@SiteCode640[String] = 6373083920445075162
@SiteCode641[String] = 6373083908618598731
@SiteCode642[String] = 6373083911842783146
@SiteCode643[String] = 6373083913928202424
@SiteCode644[String] = 6373083877551621804
@SiteCode645[String] = 6373083879921857377
@SiteCode646[String] = 6373083881542550067
@SiteCode647[String] = 6373083883689772886
@SiteCode648[String] = 6373083887136270013
@SiteCode649[String] = 6373083889697116488
@SiteCode650[String] = 6373083891969846476
@SiteCode651[String] = 6373083894422586761
@SiteCode652[String] = 6373083897509963358
@SiteCode653[String] = 6373083900444931227
@SiteCode654[String] = 6373083829464571372
@SiteCode655[String] = 6373083833327492328
@SiteCode656[String] = 6373083841964286321
@SiteCode657[String] = 6373083844982558950
@SiteCode658[String] = 6373083847585007801
@SiteCode659[String] = 6373083856887939900
@SiteCode660[String] = 6373083859102666584
@SiteCode661[String] = 6373083864919499284
@SiteCode662[String] = 6373334974514214221
@FDictionaryCode663[String] = OrderState
@FDictionaryCode664[String] = UrgentDegree
@FDictionaryCode665[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode664) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode665) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode663)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId635) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648,@SiteCode649,@SiteCode650,@SiteCode651,@SiteCode652,@SiteCode653,@SiteCode654,@SiteCode655,@SiteCode656,@SiteCode657,@SiteCode658,@SiteCode659,@SiteCode660,@SiteCode661,@SiteCode662))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId635[String] = 6372912251695766465
@SiteCode636[String] = 6373083923489249281
@SiteCode637[String] = 6373083925531366080
@SiteCode638[String] = 6373083927883400612
@SiteCode639[String] = 6373083918575368225
@SiteCode640[String] = 6373083920445075162
@SiteCode641[String] = 6373083908618598731
@SiteCode642[String] = 6373083911842783146
@SiteCode643[String] = 6373083913928202424
@SiteCode644[String] = 6373083877551621804
@SiteCode645[String] = 6373083879921857377
@SiteCode646[String] = 6373083881542550067
@SiteCode647[String] = 6373083883689772886
@SiteCode648[String] = 6373083887136270013
@SiteCode649[String] = 6373083889697116488
@SiteCode650[String] = 6373083891969846476
@SiteCode651[String] = 6373083894422586761
@SiteCode652[String] = 6373083897509963358
@SiteCode653[String] = 6373083900444931227
@SiteCode654[String] = 6373083829464571372
@SiteCode655[String] = 6373083833327492328
@SiteCode656[String] = 6373083841964286321
@SiteCode657[String] = 6373083844982558950
@SiteCode658[String] = 6373083847585007801
@SiteCode659[String] = 6373083856887939900
@SiteCode660[String] = 6373083859102666584
@SiteCode661[String] = 6373083864919499284
@SiteCode662[String] = 6373334974514214221
@FDictionaryCode663[String] = OrderState
@FDictionaryCode664[String] = UrgentDegree
@FDictionaryCode665[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:53:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	select b.*,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName,a.SignForState from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465'	


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select b.*,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName,a.SignForState from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465') as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:53:34
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:53:57
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /SystemManage/Menu/Index


-----------------------------------------------------------------------------
2020-08-18 17:53:57
Text:	 SELECT   * FROM [TbSysMenu]  ORDER BY [TbSysMenu].[Sort] ASC 	


-----------------------------------------------------------------------------
2020-08-18 17:54:12
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /SystemManage/OrganizationMap/Index


-----------------------------------------------------------------------------
2020-08-18 17:54:12
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:54:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:54:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:54:13
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:54:13
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')	


-----------------------------------------------------------------------------
2020-08-18 17:54:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type666) AND ([TbOrganizationMap].[ProjectId] = @ProjectId667)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode668,@CompanyCode669,@CompanyCode670,@CompanyCode671,@CompanyCode672,@CompanyCode673,@CompanyCode674,@CompanyCode675)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode676))) 	
Parameters:
@Type666[Int32] = 1
@ProjectId667[String] = 6372912251695766465
@CompanyCode668[String] = 6373083923489249281
@CompanyCode669[String] = 6373083925531366080
@CompanyCode670[String] = 6373083927883400612
@CompanyCode671[String] = 6373083918575368225
@CompanyCode672[String] = 6373083920445075162
@CompanyCode673[String] = 6373083908618598731
@CompanyCode674[String] = 6373083911842783146
@CompanyCode675[String] = 6373083913928202424
@ParentCompanyCode676[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type677) AND ([TbOrganizationMap].[ProjectId] = @ProjectId678)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode679,@CompanyCode680,@CompanyCode681,@CompanyCode682,@CompanyCode683,@CompanyCode684,@CompanyCode685,@CompanyCode686)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode687))) 	
Parameters:
@Type677[Int32] = 2
@ProjectId678[String] = 6372912251695766465
@CompanyCode679[String] = 6373083923489249281
@CompanyCode680[String] = 6373083925531366080
@CompanyCode681[String] = 6373083927883400612
@CompanyCode682[String] = 6373083918575368225
@CompanyCode683[String] = 6373083920445075162
@CompanyCode684[String] = 6373083908618598731
@CompanyCode685[String] = 6373083911842783146
@CompanyCode686[String] = 6373083913928202424
@ParentCompanyCode687[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode716)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId688) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode689,@SiteCode690,@SiteCode691,@SiteCode692,@SiteCode693,@SiteCode694,@SiteCode695,@SiteCode696,@SiteCode697,@SiteCode698,@SiteCode699,@SiteCode700,@SiteCode701,@SiteCode702,@SiteCode703,@SiteCode704,@SiteCode705,@SiteCode706,@SiteCode707,@SiteCode708,@SiteCode709,@SiteCode710,@SiteCode711,@SiteCode712,@SiteCode713,@SiteCode714,@SiteCode715)))	
Parameters:
@ProjectId688[String] = 6372912251695766465
@SiteCode689[String] = 6373083923489249281
@SiteCode690[String] = 6373083925531366080
@SiteCode691[String] = 6373083927883400612
@SiteCode692[String] = 6373083918575368225
@SiteCode693[String] = 6373083920445075162
@SiteCode694[String] = 6373083908618598731
@SiteCode695[String] = 6373083911842783146
@SiteCode696[String] = 6373083913928202424
@SiteCode697[String] = 6373083877551621804
@SiteCode698[String] = 6373083879921857377
@SiteCode699[String] = 6373083881542550067
@SiteCode700[String] = 6373083883689772886
@SiteCode701[String] = 6373083887136270013
@SiteCode702[String] = 6373083889697116488
@SiteCode703[String] = 6373083891969846476
@SiteCode704[String] = 6373083894422586761
@SiteCode705[String] = 6373083897509963358
@SiteCode706[String] = 6373083900444931227
@SiteCode707[String] = 6373083829464571372
@SiteCode708[String] = 6373083833327492328
@SiteCode709[String] = 6373083841964286321
@SiteCode710[String] = 6373083844982558950
@SiteCode711[String] = 6373083847585007801
@SiteCode712[String] = 6373083856887939900
@SiteCode713[String] = 6373083859102666584
@SiteCode714[String] = 6373083864919499284
@SiteCode715[String] = 6373334974514214221
@FDictionaryCode716[String] = OrderState
@FDictionaryCode717[String] = UrgentDegree
@FDictionaryCode718[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:55:47
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode717) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode718) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode716)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId688) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode689,@SiteCode690,@SiteCode691,@SiteCode692,@SiteCode693,@SiteCode694,@SiteCode695,@SiteCode696,@SiteCode697,@SiteCode698,@SiteCode699,@SiteCode700,@SiteCode701,@SiteCode702,@SiteCode703,@SiteCode704,@SiteCode705,@SiteCode706,@SiteCode707,@SiteCode708,@SiteCode709,@SiteCode710,@SiteCode711,@SiteCode712,@SiteCode713,@SiteCode714,@SiteCode715))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId688[String] = 6372912251695766465
@SiteCode689[String] = 6373083923489249281
@SiteCode690[String] = 6373083925531366080
@SiteCode691[String] = 6373083927883400612
@SiteCode692[String] = 6373083918575368225
@SiteCode693[String] = 6373083920445075162
@SiteCode694[String] = 6373083908618598731
@SiteCode695[String] = 6373083911842783146
@SiteCode696[String] = 6373083913928202424
@SiteCode697[String] = 6373083877551621804
@SiteCode698[String] = 6373083879921857377
@SiteCode699[String] = 6373083881542550067
@SiteCode700[String] = 6373083883689772886
@SiteCode701[String] = 6373083887136270013
@SiteCode702[String] = 6373083889697116488
@SiteCode703[String] = 6373083891969846476
@SiteCode704[String] = 6373083894422586761
@SiteCode705[String] = 6373083897509963358
@SiteCode706[String] = 6373083900444931227
@SiteCode707[String] = 6373083829464571372
@SiteCode708[String] = 6373083833327492328
@SiteCode709[String] = 6373083841964286321
@SiteCode710[String] = 6373083844982558950
@SiteCode711[String] = 6373083847585007801
@SiteCode712[String] = 6373083856887939900
@SiteCode713[String] = 6373083859102666584
@SiteCode714[String] = 6373083864919499284
@SiteCode715[String] = 6373334974514214221
@FDictionaryCode716[String] = OrderState
@FDictionaryCode717[String] = UrgentDegree
@FDictionaryCode718[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:55:48
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:55:48
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:55:48
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:55:48
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:55:49
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-18 17:56:51
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-18 17:56:51
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-18 17:56:51
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-18 17:56:52
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
