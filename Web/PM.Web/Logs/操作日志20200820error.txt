2020-08-20 10:35:26
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-20 10:35:26
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 10:35:26
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 10:35:26
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:35:26
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 10:35:26
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/20 10:35:26
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:35:29
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59)))	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:35:30
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode61) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode62) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:35:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 10:35:30
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 10:35:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 10:35:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 10:35:31
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:37:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:37:47
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 10:37:47
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:37:49
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:38:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:41:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:44:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:47:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:49:29
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode64) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode65) 	
Parameters:
@SiteCode64[String] = 6373083923489249281
@ComponentCode65[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-20 10:49:29
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:29
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:29
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm66) 	
Parameters:
@MxGjBm66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:49:29
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode67)) AND ([TbModelOtherInfo].[Type] = @Type68) 	
Parameters:
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type68[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:49:31
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId69) 	
Parameters:
@MxGjId69[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 10:49:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode70)) AND ([TbModelOtherInfo].[Type] = @Type71) 	
Parameters:
@ComponentCode70[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type71[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:49:35
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode73) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode74) 	
Parameters:
@SiteCode73[String] = 6373083923489249281
@ComponentCode74[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01%


-----------------------------------------------------------------------------
2020-08-20 10:49:35
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:35
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm75,@MxGjBm76) 	
Parameters:
@MxGjBm75[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm76[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01


-----------------------------------------------------------------------------
2020-08-20 10:49:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode77,@ComponentCode78)) AND ([TbModelOtherInfo].[Type] = @Type79) 	
Parameters:
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type79[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:49:38
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:38
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId80) 	
Parameters:
@MxGjId80[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 10:49:38
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode81)) AND ([TbModelOtherInfo].[Type] = @Type82) 	
Parameters:
@ComponentCode81[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type82[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:49:39
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:49:39
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId83) 	
Parameters:
@MxGjId83[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 10:49:39
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode84)) AND ([TbModelOtherInfo].[Type] = @Type85) 	
Parameters:
@ComponentCode84[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type85[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:49:45
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type86) 	
Parameters:
@Type86[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:49:45
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu87,@ActionType88,@HostName89,@LogDate90,@UserCode91,@UserIP92);select scope_identity()	
Parameters:
@ActionMenu87[String] = TbModelOtherInfo
@ActionType88[String] = 新增
@HostName89[String] = 
@LogDate90[DateTime] = 2020/8/20 10:49:45
@UserCode91[String] = 500000
@UserIP92[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:49:45
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode93,@Type94,@ProjectId95);select scope_identity()	
Parameters:
@SiteCode93[String] = 6373083923489249281
@Type94[Int32] = 1
@ProjectId95[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:49:50
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type96) 	
Parameters:
@Type96[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:49:50
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu97,@ActionType98,@HostName99,@LogDate100,@UserCode101,@UserIP102);select scope_identity()	
Parameters:
@ActionMenu97[String] = TbModelOtherInfo
@ActionType98[String] = 新增
@HostName99[String] = 
@LogDate100[DateTime] = 2020/8/20 10:49:50
@UserCode101[String] = 500000
@UserIP102[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:49:50
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime103,@Remark104,@SiteCode105,@Type106,@ProjectId107);select scope_identity()	
Parameters:
@PlanTime103[DateTime] = 2020/8/18 0:00:00
@Remark104[String] = 
@SiteCode105[String] = 6373083923489249281
@Type106[Int32] = 1
@ProjectId107[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:02
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type108) 	
Parameters:
@Type108[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:02
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu109,@ActionType110,@HostName111,@LogDate112,@UserCode113,@UserIP114);select scope_identity()	
Parameters:
@ActionMenu109[String] = TbModelOtherInfo
@ActionType110[String] = 新增
@HostName111[String] = 
@LogDate112[DateTime] = 2020/8/20 10:50:02
@UserCode113[String] = 500000
@UserIP114[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:02
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode115,@Type116,@ProjectId117);select scope_identity()	
Parameters:
@SiteCode115[String] = 6373083923489249281
@Type116[Int32] = 1
@ProjectId117[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:06
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type118) 	
Parameters:
@Type118[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:06
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu119,@ActionType120,@HostName121,@LogDate122,@UserCode123,@UserIP124);select scope_identity()	
Parameters:
@ActionMenu119[String] = TbModelOtherInfo
@ActionType120[String] = 新增
@HostName121[String] = 
@LogDate122[DateTime] = 2020/8/20 10:50:06
@UserCode123[String] = 500000
@UserIP124[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:06
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode125,@Type126,@ProjectId127);select scope_identity()	
Parameters:
@SiteCode125[String] = 6373083923489249281
@Type126[Int32] = 1
@ProjectId127[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type128) 	
Parameters:
@Type128[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:08
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu129,@ActionType130,@HostName131,@LogDate132,@UserCode133,@UserIP134);select scope_identity()	
Parameters:
@ActionMenu129[String] = TbModelOtherInfo
@ActionType130[String] = 新增
@HostName131[String] = 
@LogDate132[DateTime] = 2020/8/20 10:50:08
@UserCode133[String] = 500000
@UserIP134[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:08
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode135,@Type136,@ProjectId137);select scope_identity()	
Parameters:
@SiteCode135[String] = 6373083923489249281
@Type136[Int32] = 1
@ProjectId137[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:18
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode139) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode140) 	
Parameters:
@SiteCode139[String] = 6373083923489249281
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-20 10:50:18
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:50:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:50:18
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm141,@MxGjBm142,@MxGjBm143) 	
Parameters:
@MxGjBm141[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm142[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm143[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:50:18
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode144,@ComponentCode145,@ComponentCode146)) AND ([TbModelOtherInfo].[Type] = @Type147) 	
Parameters:
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode145[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode146[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type147[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:19
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:50:19
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 10:50:19
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId148,@MxGjId149) 	
Parameters:
@MxGjId148[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId149[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 10:50:19
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode150,@ComponentCode151)) AND ([TbModelOtherInfo].[Type] = @Type152) 	
Parameters:
@ComponentCode150[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode151[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type152[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:26
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type153) 	
Parameters:
@Type153[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:26
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu154,@ActionType155,@HostName156,@LogDate157,@UserCode158,@UserIP159);select scope_identity()	
Parameters:
@ActionMenu154[String] = TbModelOtherInfo
@ActionType155[String] = 新增
@HostName156[String] = 
@LogDate157[DateTime] = 2020/8/20 10:50:26
@UserCode158[String] = 500000
@UserIP159[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:26
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode160,@Type161,@ProjectId162);select scope_identity()	
Parameters:
@SiteCode160[String] = 6373083923489249281
@Type161[Int32] = 1
@ProjectId162[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:28
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode163) AND ([TbModelOtherInfo].[Type] = @Type164) 	
Parameters:
@ComponentCode163[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type164[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:28
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu165,@ActionType166,@HostName167,@LogDate168,@UserCode169,@UserIP170);select scope_identity()	
Parameters:
@ActionMenu165[String] = TbModelOtherInfo
@ActionType166[String] = 编辑
@HostName167[String] = 
@LogDate168[DateTime] = 2020/8/20 10:50:28
@UserCode169[String] = 500000
@UserIP170[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:28
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode172,[PlanTime]=@PlanTime173,[Remark]=@Remark174,[SiteCode]=@SiteCode175,[Type]=@Type176,[ProjectId]=@ProjectId177 WHERE [TbModelOtherInfo].[ID] = @ID171	
Parameters:
@ComponentCode172[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime173[DateTime] = 2020/8/26 0:00:00
@Remark174[String] = 
@SiteCode175[String] = 6373083923489249281
@Type176[Int32] = 2
@ProjectId177[String] = 6372912251695766465
@ID171[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type178) 	
Parameters:
@Type178[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:29
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu179,@ActionType180,@HostName181,@LogDate182,@UserCode183,@UserIP184);select scope_identity()	
Parameters:
@ActionMenu179[String] = TbModelOtherInfo
@ActionType180[String] = 新增
@HostName181[String] = 
@LogDate182[DateTime] = 2020/8/20 10:50:29
@UserCode183[String] = 500000
@UserIP184[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:29
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode185,@Type186,@ProjectId187);select scope_identity()	
Parameters:
@SiteCode185[String] = 6373083923489249281
@Type186[Int32] = 1
@ProjectId187[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode188) AND ([TbModelOtherInfo].[Type] = @Type189) 	
Parameters:
@ComponentCode188[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type189[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu190,@ActionType191,@HostName192,@LogDate193,@UserCode194,@UserIP195);select scope_identity()	
Parameters:
@ActionMenu190[String] = TbModelOtherInfo
@ActionType191[String] = 编辑
@HostName192[String] = 
@LogDate193[DateTime] = 2020/8/20 10:50:31
@UserCode194[String] = 500000
@UserIP195[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode197,[PlanTime]=@PlanTime198,[Remark]=@Remark199,[SiteCode]=@SiteCode200,[Type]=@Type201,[ProjectId]=@ProjectId202 WHERE [TbModelOtherInfo].[ID] = @ID196	
Parameters:
@ComponentCode197[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime198[DateTime] = 2020/8/3 0:00:00
@Remark199[String] = 
@SiteCode200[String] = 6373083923489249281
@Type201[Int32] = 2
@ProjectId202[String] = 6372912251695766465
@ID196[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode203) AND ([TbModelOtherInfo].[Type] = @Type204) 	
Parameters:
@ComponentCode203[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type204[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu205,@ActionType206,@HostName207,@LogDate208,@UserCode209,@UserIP210);select scope_identity()	
Parameters:
@ActionMenu205[String] = TbModelOtherInfo
@ActionType206[String] = 编辑
@HostName207[String] = 
@LogDate208[DateTime] = 2020/8/20 10:50:31
@UserCode209[String] = 500000
@UserIP210[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:31
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode212,[PlanTime]=@PlanTime213,[Remark]=@Remark214,[SiteCode]=@SiteCode215,[Type]=@Type216,[ProjectId]=@ProjectId217 WHERE [TbModelOtherInfo].[ID] = @ID211	
Parameters:
@ComponentCode212[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime213[DateTime] = 2020/8/26 0:00:00
@Remark214[String] = 
@SiteCode215[String] = 6373083923489249281
@Type216[Int32] = 2
@ProjectId217[String] = 6372912251695766465
@ID211[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:34
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode218) AND ([TbModelOtherInfo].[Type] = @Type219) 	
Parameters:
@ComponentCode218[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type219[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:34
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu220,@ActionType221,@HostName222,@LogDate223,@UserCode224,@UserIP225);select scope_identity()	
Parameters:
@ActionMenu220[String] = TbModelOtherInfo
@ActionType221[String] = 编辑
@HostName222[String] = 
@LogDate223[DateTime] = 2020/8/20 10:50:34
@UserCode224[String] = 500000
@UserIP225[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:34
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode227,[PlanTime]=@PlanTime228,[Remark]=@Remark229,[SiteCode]=@SiteCode230,[Type]=@Type231,[ProjectId]=@ProjectId232 WHERE [TbModelOtherInfo].[ID] = @ID226	
Parameters:
@ComponentCode227[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime228[DateTime] = 2020/8/3 0:00:00
@Remark229[String] = 
@SiteCode230[String] = 6373083923489249281
@Type231[Int32] = 2
@ProjectId232[String] = 6372912251695766465
@ID226[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:35
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode233) AND ([TbModelOtherInfo].[Type] = @Type234) 	
Parameters:
@ComponentCode233[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type234[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:35
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu235,@ActionType236,@HostName237,@LogDate238,@UserCode239,@UserIP240);select scope_identity()	
Parameters:
@ActionMenu235[String] = TbModelOtherInfo
@ActionType236[String] = 编辑
@HostName237[String] = 
@LogDate238[DateTime] = 2020/8/20 10:50:35
@UserCode239[String] = 500000
@UserIP240[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:35
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode242,[PlanTime]=@PlanTime243,[Remark]=@Remark244,[SiteCode]=@SiteCode245,[Type]=@Type246,[ProjectId]=@ProjectId247 WHERE [TbModelOtherInfo].[ID] = @ID241	
Parameters:
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime243[DateTime] = 2020/8/26 0:00:00
@Remark244[String] = 
@SiteCode245[String] = 6373083923489249281
@Type246[Int32] = 2
@ProjectId247[String] = 6372912251695766465
@ID241[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type248) 	
Parameters:
@Type248[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu249,@ActionType250,@HostName251,@LogDate252,@UserCode253,@UserIP254);select scope_identity()	
Parameters:
@ActionMenu249[String] = TbModelOtherInfo
@ActionType250[String] = 新增
@HostName251[String] = 
@LogDate252[DateTime] = 2020/8/20 10:50:37
@UserCode253[String] = 500000
@UserIP254[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode255,@Type256,@ProjectId257);select scope_identity()	
Parameters:
@SiteCode255[String] = 6373083923489249281
@Type256[Int32] = 1
@ProjectId257[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode258) AND ([TbModelOtherInfo].[Type] = @Type259) 	
Parameters:
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type259[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu260,@ActionType261,@HostName262,@LogDate263,@UserCode264,@UserIP265);select scope_identity()	
Parameters:
@ActionMenu260[String] = TbModelOtherInfo
@ActionType261[String] = 编辑
@HostName262[String] = 
@LogDate263[DateTime] = 2020/8/20 10:50:37
@UserCode264[String] = 500000
@UserIP265[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:37
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode267,[PlanTime]=@PlanTime268,[Remark]=@Remark269,[SiteCode]=@SiteCode270,[Type]=@Type271,[ProjectId]=@ProjectId272 WHERE [TbModelOtherInfo].[ID] = @ID266	
Parameters:
@ComponentCode267[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime268[DateTime] = 2020/8/25 0:00:00
@Remark269[String] = 
@SiteCode270[String] = 6373083923489249281
@Type271[Int32] = 2
@ProjectId272[String] = 6372912251695766465
@ID266[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:38
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode273) AND ([TbModelOtherInfo].[Type] = @Type274) 	
Parameters:
@ComponentCode273[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type274[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:38
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu275,@ActionType276,@HostName277,@LogDate278,@UserCode279,@UserIP280);select scope_identity()	
Parameters:
@ActionMenu275[String] = TbModelOtherInfo
@ActionType276[String] = 编辑
@HostName277[String] = 
@LogDate278[DateTime] = 2020/8/20 10:50:38
@UserCode279[String] = 500000
@UserIP280[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:38
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode282,[PlanTime]=@PlanTime283,[Remark]=@Remark284,[SiteCode]=@SiteCode285,[Type]=@Type286,[ProjectId]=@ProjectId287 WHERE [TbModelOtherInfo].[ID] = @ID281	
Parameters:
@ComponentCode282[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime283[DateTime] = 2020/8/26 0:00:00
@Remark284[String] = 
@SiteCode285[String] = 6373083923489249281
@Type286[Int32] = 2
@ProjectId287[String] = 6372912251695766465
@ID281[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:39
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode288) AND ([TbModelOtherInfo].[Type] = @Type289) 	
Parameters:
@ComponentCode288[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type289[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:39
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu290,@ActionType291,@HostName292,@LogDate293,@UserCode294,@UserIP295);select scope_identity()	
Parameters:
@ActionMenu290[String] = TbModelOtherInfo
@ActionType291[String] = 编辑
@HostName292[String] = 
@LogDate293[DateTime] = 2020/8/20 10:50:39
@UserCode294[String] = 500000
@UserIP295[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:39
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode297,[PlanTime]=@PlanTime298,[Remark]=@Remark299,[SiteCode]=@SiteCode300,[Type]=@Type301,[ProjectId]=@ProjectId302 WHERE [TbModelOtherInfo].[ID] = @ID296	
Parameters:
@ComponentCode297[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime298[DateTime] = 2020/8/25 0:00:00
@Remark299[String] = 
@SiteCode300[String] = 6373083923489249281
@Type301[Int32] = 2
@ProjectId302[String] = 6372912251695766465
@ID296[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:42
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type303) 	
Parameters:
@Type303[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:42
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu304,@ActionType305,@HostName306,@LogDate307,@UserCode308,@UserIP309);select scope_identity()	
Parameters:
@ActionMenu304[String] = TbModelOtherInfo
@ActionType305[String] = 新增
@HostName306[String] = 
@LogDate307[DateTime] = 2020/8/20 10:50:42
@UserCode308[String] = 500000
@UserIP309[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:42
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime310,@Remark311,@SiteCode312,@Type313,@ProjectId314);select scope_identity()	
Parameters:
@PlanTime310[DateTime] = 2020/8/26 0:00:00
@Remark311[String] = 
@SiteCode312[String] = 6373083923489249281
@Type313[Int32] = 1
@ProjectId314[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:44
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode315) AND ([TbModelOtherInfo].[Type] = @Type316) 	
Parameters:
@ComponentCode315[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type316[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:44
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu317,@ActionType318,@HostName319,@LogDate320,@UserCode321,@UserIP322);select scope_identity()	
Parameters:
@ActionMenu317[String] = TbModelOtherInfo
@ActionType318[String] = 编辑
@HostName319[String] = 
@LogDate320[DateTime] = 2020/8/20 10:50:44
@UserCode321[String] = 500000
@UserIP322[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:44
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode324,[PlanTime]=@PlanTime325,[Remark]=@Remark326,[SiteCode]=@SiteCode327,[Type]=@Type328,[ProjectId]=@ProjectId329 WHERE [TbModelOtherInfo].[ID] = @ID323	
Parameters:
@ComponentCode324[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime325[DateTime] = 2020/8/26 0:00:00
@Remark326[String] = 
@SiteCode327[String] = 6373083923489249281
@Type328[Int32] = 2
@ProjectId329[String] = 6372912251695766465
@ID323[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:45
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode330) AND ([TbModelOtherInfo].[Type] = @Type331) 	
Parameters:
@ComponentCode330[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type331[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:50:45
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu332,@ActionType333,@HostName334,@LogDate335,@UserCode336,@UserIP337);select scope_identity()	
Parameters:
@ActionMenu332[String] = TbModelOtherInfo
@ActionType333[String] = 编辑
@HostName334[String] = 
@LogDate335[DateTime] = 2020/8/20 10:50:45
@UserCode336[String] = 500000
@UserIP337[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:45
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode339,[PlanTime]=@PlanTime340,[Remark]=@Remark341,[SiteCode]=@SiteCode342,[Type]=@Type343,[ProjectId]=@ProjectId344 WHERE [TbModelOtherInfo].[ID] = @ID338	
Parameters:
@ComponentCode339[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime340[DateTime] = 2020/8/25 0:00:00
@Remark341[String] = 
@SiteCode342[String] = 6373083923489249281
@Type343[Int32] = 2
@ProjectId344[String] = 6372912251695766465
@ID338[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:50:46
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type345) 	
Parameters:
@Type345[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:46
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu346,@ActionType347,@HostName348,@LogDate349,@UserCode350,@UserIP351);select scope_identity()	
Parameters:
@ActionMenu346[String] = TbModelOtherInfo
@ActionType347[String] = 新增
@HostName348[String] = 
@LogDate349[DateTime] = 2020/8/20 10:50:46
@UserCode350[String] = 500000
@UserIP351[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:46
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime352,@Remark353,@SiteCode354,@Type355,@ProjectId356);select scope_identity()	
Parameters:
@PlanTime352[DateTime] = 2020/8/26 0:00:00
@Remark353[String] = 
@SiteCode354[String] = 6373083923489249281
@Type355[Int32] = 1
@ProjectId356[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:48
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type357) 	
Parameters:
@Type357[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:48
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu358,@ActionType359,@HostName360,@LogDate361,@UserCode362,@UserIP363);select scope_identity()	
Parameters:
@ActionMenu358[String] = TbModelOtherInfo
@ActionType359[String] = 新增
@HostName360[String] = 
@LogDate361[DateTime] = 2020/8/20 10:50:48
@UserCode362[String] = 500000
@UserIP363[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:48
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime364,@Remark365,@SiteCode366,@Type367,@ProjectId368);select scope_identity()	
Parameters:
@PlanTime364[DateTime] = 2020/8/21 0:00:00
@Remark365[String] = 
@SiteCode366[String] = 6373083923489249281
@Type367[Int32] = 1
@ProjectId368[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type369) 	
Parameters:
@Type369[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:57
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu370,@ActionType371,@HostName372,@LogDate373,@UserCode374,@UserIP375);select scope_identity()	
Parameters:
@ActionMenu370[String] = TbModelOtherInfo
@ActionType371[String] = 新增
@HostName372[String] = 
@LogDate373[DateTime] = 2020/8/20 10:50:57
@UserCode374[String] = 500000
@UserIP375[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:57
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime376,@Remark377,@SiteCode378,@Type379,@ProjectId380);select scope_identity()	
Parameters:
@PlanTime376[DateTime] = 2020/8/26 0:00:00
@Remark377[String] = 
@SiteCode378[String] = 6373083923489249281
@Type379[Int32] = 1
@ProjectId380[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:50:59
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type381) 	
Parameters:
@Type381[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:50:59
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu382,@ActionType383,@HostName384,@LogDate385,@UserCode386,@UserIP387);select scope_identity()	
Parameters:
@ActionMenu382[String] = TbModelOtherInfo
@ActionType383[String] = 新增
@HostName384[String] = 
@LogDate385[DateTime] = 2020/8/20 10:50:59
@UserCode386[String] = 500000
@UserIP387[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:50:59
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode388,@Type389,@ProjectId390);select scope_identity()	
Parameters:
@SiteCode388[String] = 6373083923489249281
@Type389[Int32] = 1
@ProjectId390[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode391) AND ([TbModelOtherInfo].[Type] = @Type392) 	
Parameters:
@ComponentCode391[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type392[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu393,@ActionType394,@HostName395,@LogDate396,@UserCode397,@UserIP398);select scope_identity()	
Parameters:
@ActionMenu393[String] = TbModelOtherInfo
@ActionType394[String] = 编辑
@HostName395[String] = 
@LogDate396[DateTime] = 2020/8/20 10:51:00
@UserCode397[String] = 500000
@UserIP398[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:00
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode400,[PlanTime]=@PlanTime401,[Remark]=@Remark402,[SiteCode]=@SiteCode403,[Type]=@Type404,[ProjectId]=@ProjectId405 WHERE [TbModelOtherInfo].[ID] = @ID399	
Parameters:
@ComponentCode400[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime401[DateTime] = 2020/8/17 0:00:00
@Remark402[String] = 
@SiteCode403[String] = 6373083923489249281
@Type404[Int32] = 2
@ProjectId405[String] = 6372912251695766465
@ID399[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:01
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode406) AND ([TbModelOtherInfo].[Type] = @Type407) 	
Parameters:
@ComponentCode406[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type407[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu408,@ActionType409,@HostName410,@LogDate411,@UserCode412,@UserIP413);select scope_identity()	
Parameters:
@ActionMenu408[String] = TbModelOtherInfo
@ActionType409[String] = 编辑
@HostName410[String] = 
@LogDate411[DateTime] = 2020/8/20 10:51:01
@UserCode412[String] = 500000
@UserIP413[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:01
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode415,[PlanTime]=@PlanTime416,[Remark]=@Remark417,[SiteCode]=@SiteCode418,[Type]=@Type419,[ProjectId]=@ProjectId420 WHERE [TbModelOtherInfo].[ID] = @ID414	
Parameters:
@ComponentCode415[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime416[DateTime] = 2020/8/26 0:00:00
@Remark417[String] = 
@SiteCode418[String] = 6373083923489249281
@Type419[Int32] = 2
@ProjectId420[String] = 6372912251695766465
@ID414[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode421) AND ([TbModelOtherInfo].[Type] = @Type422) 	
Parameters:
@ComponentCode421[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type422[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:08
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu423,@ActionType424,@HostName425,@LogDate426,@UserCode427,@UserIP428);select scope_identity()	
Parameters:
@ActionMenu423[String] = TbModelOtherInfo
@ActionType424[String] = 编辑
@HostName425[String] = 
@LogDate426[DateTime] = 2020/8/20 10:51:08
@UserCode427[String] = 500000
@UserIP428[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:08
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode430,[PlanTime]=@PlanTime431,[Remark]=@Remark432,[SiteCode]=@SiteCode433,[Type]=@Type434,[ProjectId]=@ProjectId435 WHERE [TbModelOtherInfo].[ID] = @ID429	
Parameters:
@ComponentCode430[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime431[DateTime] = 2020/8/26 0:00:00
@Remark432[String] = 
@SiteCode433[String] = 6373083923489249281
@Type434[Int32] = 2
@ProjectId435[String] = 6372912251695766465
@ID429[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:13
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode436) AND ([TbModelOtherInfo].[Type] = @Type437) 	
Parameters:
@ComponentCode436[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type437[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:13
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu438,@ActionType439,@HostName440,@LogDate441,@UserCode442,@UserIP443);select scope_identity()	
Parameters:
@ActionMenu438[String] = TbModelOtherInfo
@ActionType439[String] = 编辑
@HostName440[String] = 
@LogDate441[DateTime] = 2020/8/20 10:51:13
@UserCode442[String] = 500000
@UserIP443[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:13
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode445,[Remark]=@Remark446,[SiteCode]=@SiteCode447,[Type]=@Type448,[ProjectId]=@ProjectId449 WHERE [TbModelOtherInfo].[ID] = @ID444	
Parameters:
@ComponentCode445[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Remark446[String] = 
@SiteCode447[String] = 6373083923489249281
@Type448[Int32] = 2
@ProjectId449[String] = 6372912251695766465
@ID444[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:15
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode450) AND ([TbModelOtherInfo].[Type] = @Type451) 	
Parameters:
@ComponentCode450[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type451[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:15
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu452,@ActionType453,@HostName454,@LogDate455,@UserCode456,@UserIP457);select scope_identity()	
Parameters:
@ActionMenu452[String] = TbModelOtherInfo
@ActionType453[String] = 编辑
@HostName454[String] = 
@LogDate455[DateTime] = 2020/8/20 10:51:15
@UserCode456[String] = 500000
@UserIP457[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:15
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode459,[PlanTime]=@PlanTime460,[Remark]=@Remark461,[SiteCode]=@SiteCode462,[Type]=@Type463,[ProjectId]=@ProjectId464 WHERE [TbModelOtherInfo].[ID] = @ID458	
Parameters:
@ComponentCode459[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime460[DateTime] = 2020/8/26 0:00:00
@Remark461[String] = 
@SiteCode462[String] = 6373083923489249281
@Type463[Int32] = 2
@ProjectId464[String] = 6372912251695766465
@ID458[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:16
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type465) 	
Parameters:
@Type465[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:16
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu466,@ActionType467,@HostName468,@LogDate469,@UserCode470,@UserIP471);select scope_identity()	
Parameters:
@ActionMenu466[String] = TbModelOtherInfo
@ActionType467[String] = 新增
@HostName468[String] = 
@LogDate469[DateTime] = 2020/8/20 10:51:16
@UserCode470[String] = 500000
@UserIP471[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:16
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode472,@Type473,@ProjectId474);select scope_identity()	
Parameters:
@SiteCode472[String] = 6373083923489249281
@Type473[Int32] = 1
@ProjectId474[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:25
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode475) AND ([TbModelOtherInfo].[Type] = @Type476) 	
Parameters:
@ComponentCode475[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type476[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:25
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu477,@ActionType478,@HostName479,@LogDate480,@UserCode481,@UserIP482);select scope_identity()	
Parameters:
@ActionMenu477[String] = TbModelOtherInfo
@ActionType478[String] = 编辑
@HostName479[String] = 
@LogDate480[DateTime] = 2020/8/20 10:51:25
@UserCode481[String] = 500000
@UserIP482[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:25
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode484,[PlanTime]=@PlanTime485,[Remark]=@Remark486,[SiteCode]=@SiteCode487,[Type]=@Type488,[ProjectId]=@ProjectId489 WHERE [TbModelOtherInfo].[ID] = @ID483	
Parameters:
@ComponentCode484[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime485[DateTime] = 2020/8/26 0:00:00
@Remark486[String] = 
@SiteCode487[String] = 6373083923489249281
@Type488[Int32] = 2
@ProjectId489[String] = 6372912251695766465
@ID483[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:28
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type490) 	
Parameters:
@Type490[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:28
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu491,@ActionType492,@HostName493,@LogDate494,@UserCode495,@UserIP496);select scope_identity()	
Parameters:
@ActionMenu491[String] = TbModelOtherInfo
@ActionType492[String] = 新增
@HostName493[String] = 
@LogDate494[DateTime] = 2020/8/20 10:51:28
@UserCode495[String] = 500000
@UserIP496[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:28
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime497,@Remark498,@SiteCode499,@Type500,@ProjectId501);select scope_identity()	
Parameters:
@PlanTime497[DateTime] = 2020/8/26 0:00:00
@Remark498[String] = 
@SiteCode499[String] = 6373083923489249281
@Type500[Int32] = 1
@ProjectId501[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:36
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode502) AND ([TbModelOtherInfo].[Type] = @Type503) 	
Parameters:
@ComponentCode502[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type503[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:36
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu504,@ActionType505,@HostName506,@LogDate507,@UserCode508,@UserIP509);select scope_identity()	
Parameters:
@ActionMenu504[String] = TbModelOtherInfo
@ActionType505[String] = 编辑
@HostName506[String] = 
@LogDate507[DateTime] = 2020/8/20 10:51:36
@UserCode508[String] = 500000
@UserIP509[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:36
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode511,[PlanTime]=@PlanTime512,[Remark]=@Remark513,[SiteCode]=@SiteCode514,[Type]=@Type515,[ProjectId]=@ProjectId516 WHERE [TbModelOtherInfo].[ID] = @ID510	
Parameters:
@ComponentCode511[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime512[DateTime] = 2020/8/21 0:00:00
@Remark513[String] = 
@SiteCode514[String] = 6373083923489249281
@Type515[Int32] = 1
@ProjectId516[String] = 6372912251695766465
@ID510[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:39
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode517) AND ([TbModelOtherInfo].[Type] = @Type518) 	
Parameters:
@ComponentCode517[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type518[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:39
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu519,@ActionType520,@HostName521,@LogDate522,@UserCode523,@UserIP524);select scope_identity()	
Parameters:
@ActionMenu519[String] = TbModelOtherInfo
@ActionType520[String] = 编辑
@HostName521[String] = 
@LogDate522[DateTime] = 2020/8/20 10:51:39
@UserCode523[String] = 500000
@UserIP524[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:39
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode526,[PlanTime]=@PlanTime527,[Remark]=@Remark528,[SiteCode]=@SiteCode529,[Type]=@Type530,[ProjectId]=@ProjectId531 WHERE [TbModelOtherInfo].[ID] = @ID525	
Parameters:
@ComponentCode526[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime527[DateTime] = 2020/8/18 0:00:00
@Remark528[String] = 
@SiteCode529[String] = 6373083923489249281
@Type530[Int32] = 2
@ProjectId531[String] = 6372912251695766465
@ID525[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:41
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode532) AND ([TbModelOtherInfo].[Type] = @Type533) 	
Parameters:
@ComponentCode532[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type533[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:41
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu534,@ActionType535,@HostName536,@LogDate537,@UserCode538,@UserIP539);select scope_identity()	
Parameters:
@ActionMenu534[String] = TbModelOtherInfo
@ActionType535[String] = 编辑
@HostName536[String] = 
@LogDate537[DateTime] = 2020/8/20 10:51:41
@UserCode538[String] = 500000
@UserIP539[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:41
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode541,[PlanTime]=@PlanTime542,[Remark]=@Remark543,[SiteCode]=@SiteCode544,[Type]=@Type545,[ProjectId]=@ProjectId546 WHERE [TbModelOtherInfo].[ID] = @ID540	
Parameters:
@ComponentCode541[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime542[DateTime] = 2020/8/26 0:00:00
@Remark543[String] = 
@SiteCode544[String] = 6373083923489249281
@Type545[Int32] = 2
@ProjectId546[String] = 6372912251695766465
@ID540[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:42
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode547) AND ([TbModelOtherInfo].[Type] = @Type548) 	
Parameters:
@ComponentCode547[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type548[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:42
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu549,@ActionType550,@HostName551,@LogDate552,@UserCode553,@UserIP554);select scope_identity()	
Parameters:
@ActionMenu549[String] = TbModelOtherInfo
@ActionType550[String] = 编辑
@HostName551[String] = 
@LogDate552[DateTime] = 2020/8/20 10:51:42
@UserCode553[String] = 500000
@UserIP554[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:42
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode556,[PlanTime]=@PlanTime557,[Remark]=@Remark558,[SiteCode]=@SiteCode559,[Type]=@Type560,[ProjectId]=@ProjectId561 WHERE [TbModelOtherInfo].[ID] = @ID555	
Parameters:
@ComponentCode556[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime557[DateTime] = 2020/8/18 0:00:00
@Remark558[String] = 
@SiteCode559[String] = 6373083923489249281
@Type560[Int32] = 2
@ProjectId561[String] = 6372912251695766465
@ID555[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:43
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type562) 	
Parameters:
@Type562[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:43
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu563,@ActionType564,@HostName565,@LogDate566,@UserCode567,@UserIP568);select scope_identity()	
Parameters:
@ActionMenu563[String] = TbModelOtherInfo
@ActionType564[String] = 新增
@HostName565[String] = 
@LogDate566[DateTime] = 2020/8/20 10:51:43
@UserCode567[String] = 500000
@UserIP568[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:43
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime569,@Remark570,@SiteCode571,@Type572,@ProjectId573);select scope_identity()	
Parameters:
@PlanTime569[DateTime] = 2020/8/26 0:00:00
@Remark570[String] = 
@SiteCode571[String] = 6373083923489249281
@Type572[Int32] = 1
@ProjectId573[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:44
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type574) 	
Parameters:
@Type574[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:44
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu575,@ActionType576,@HostName577,@LogDate578,@UserCode579,@UserIP580);select scope_identity()	
Parameters:
@ActionMenu575[String] = TbModelOtherInfo
@ActionType576[String] = 新增
@HostName577[String] = 
@LogDate578[DateTime] = 2020/8/20 10:51:44
@UserCode579[String] = 500000
@UserIP580[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:44
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime581,@Remark582,@SiteCode583,@Type584,@ProjectId585);select scope_identity()	
Parameters:
@PlanTime581[DateTime] = 2020/8/21 0:00:00
@Remark582[String] = 
@SiteCode583[String] = 6373083923489249281
@Type584[Int32] = 1
@ProjectId585[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:46
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode586) AND ([TbModelOtherInfo].[Type] = @Type587) 	
Parameters:
@ComponentCode586[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type587[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:46
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu588,@ActionType589,@HostName590,@LogDate591,@UserCode592,@UserIP593);select scope_identity()	
Parameters:
@ActionMenu588[String] = TbModelOtherInfo
@ActionType589[String] = 编辑
@HostName590[String] = 
@LogDate591[DateTime] = 2020/8/20 10:51:46
@UserCode592[String] = 500000
@UserIP593[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:46
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode595,[PlanTime]=@PlanTime596,[Remark]=@Remark597,[SiteCode]=@SiteCode598,[Type]=@Type599,[ProjectId]=@ProjectId600 WHERE [TbModelOtherInfo].[ID] = @ID594	
Parameters:
@ComponentCode595[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime596[DateTime] = 2020/8/26 0:00:00
@Remark597[String] = 
@SiteCode598[String] = 6373083923489249281
@Type599[Int32] = 2
@ProjectId600[String] = 6372912251695766465
@ID594[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode601) AND ([TbModelOtherInfo].[Type] = @Type602) 	
Parameters:
@ComponentCode601[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type602[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu603,@ActionType604,@HostName605,@LogDate606,@UserCode607,@UserIP608);select scope_identity()	
Parameters:
@ActionMenu603[String] = TbModelOtherInfo
@ActionType604[String] = 编辑
@HostName605[String] = 
@LogDate606[DateTime] = 2020/8/20 10:51:47
@UserCode607[String] = 500000
@UserIP608[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode610,[PlanTime]=@PlanTime611,[Remark]=@Remark612,[SiteCode]=@SiteCode613,[Type]=@Type614,[ProjectId]=@ProjectId615 WHERE [TbModelOtherInfo].[ID] = @ID609	
Parameters:
@ComponentCode610[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime611[DateTime] = 2020/8/18 0:00:00
@Remark612[String] = 
@SiteCode613[String] = 6373083923489249281
@Type614[Int32] = 2
@ProjectId615[String] = 6372912251695766465
@ID609[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type616) 	
Parameters:
@Type616[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu617,@ActionType618,@HostName619,@LogDate620,@UserCode621,@UserIP622);select scope_identity()	
Parameters:
@ActionMenu617[String] = TbModelOtherInfo
@ActionType618[String] = 新增
@HostName619[String] = 
@LogDate620[DateTime] = 2020/8/20 10:51:47
@UserCode621[String] = 500000
@UserIP622[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:47
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime623,@Remark624,@SiteCode625,@Type626,@ProjectId627);select scope_identity()	
Parameters:
@PlanTime623[DateTime] = 2020/8/26 0:00:00
@Remark624[String] = 
@SiteCode625[String] = 6373083923489249281
@Type626[Int32] = 1
@ProjectId627[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:48
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type628) 	
Parameters:
@Type628[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:48
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu629,@ActionType630,@HostName631,@LogDate632,@UserCode633,@UserIP634);select scope_identity()	
Parameters:
@ActionMenu629[String] = TbModelOtherInfo
@ActionType630[String] = 新增
@HostName631[String] = 
@LogDate632[DateTime] = 2020/8/20 10:51:48
@UserCode633[String] = 500000
@UserIP634[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:48
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime635,@Remark636,@SiteCode637,@Type638,@ProjectId639);select scope_identity()	
Parameters:
@PlanTime635[DateTime] = 2020/8/21 0:00:00
@Remark636[String] = 
@SiteCode637[String] = 6373083923489249281
@Type638[Int32] = 1
@ProjectId639[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:49
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type640) 	
Parameters:
@Type640[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:51:49
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu641,@ActionType642,@HostName643,@LogDate644,@UserCode645,@UserIP646);select scope_identity()	
Parameters:
@ActionMenu641[String] = TbModelOtherInfo
@ActionType642[String] = 新增
@HostName643[String] = 
@LogDate644[DateTime] = 2020/8/20 10:51:49
@UserCode645[String] = 500000
@UserIP646[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:49
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime647,@Remark648,@SiteCode649,@Type650,@ProjectId651);select scope_identity()	
Parameters:
@PlanTime647[DateTime] = 2020/8/20 0:00:00
@Remark648[String] = 
@SiteCode649[String] = 6373083923489249281
@Type650[Int32] = 1
@ProjectId651[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:51:51
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode652) AND ([TbModelOtherInfo].[Type] = @Type653) 	
Parameters:
@ComponentCode652[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type653[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:51
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu654,@ActionType655,@HostName656,@LogDate657,@UserCode658,@UserIP659);select scope_identity()	
Parameters:
@ActionMenu654[String] = TbModelOtherInfo
@ActionType655[String] = 编辑
@HostName656[String] = 
@LogDate657[DateTime] = 2020/8/20 10:51:51
@UserCode658[String] = 500000
@UserIP659[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:51
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode661,[PlanTime]=@PlanTime662,[Remark]=@Remark663,[SiteCode]=@SiteCode664,[Type]=@Type665,[ProjectId]=@ProjectId666 WHERE [TbModelOtherInfo].[ID] = @ID660	
Parameters:
@ComponentCode661[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime662[DateTime] = 2020/8/18 0:00:00
@Remark663[String] = 
@SiteCode664[String] = 6373083923489249281
@Type665[Int32] = 2
@ProjectId666[String] = 6372912251695766465
@ID660[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:51:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode667) AND ([TbModelOtherInfo].[Type] = @Type668) 	
Parameters:
@ComponentCode667[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type668[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:51:56
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu669,@ActionType670,@HostName671,@LogDate672,@UserCode673,@UserIP674);select scope_identity()	
Parameters:
@ActionMenu669[String] = TbModelOtherInfo
@ActionType670[String] = 编辑
@HostName671[String] = 
@LogDate672[DateTime] = 2020/8/20 10:51:56
@UserCode673[String] = 500000
@UserIP674[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:51:56
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode676,[PlanTime]=@PlanTime677,[Remark]=@Remark678,[SiteCode]=@SiteCode679,[Type]=@Type680,[ProjectId]=@ProjectId681 WHERE [TbModelOtherInfo].[ID] = @ID675	
Parameters:
@ComponentCode676[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime677[DateTime] = 2020/8/26 0:00:00
@Remark678[String] = 
@SiteCode679[String] = 6373083923489249281
@Type680[Int32] = 2
@ProjectId681[String] = 6372912251695766465
@ID675[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:06
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode682) AND ([TbModelOtherInfo].[Type] = @Type683) 	
Parameters:
@ComponentCode682[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type683[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:06
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu684,@ActionType685,@HostName686,@LogDate687,@UserCode688,@UserIP689);select scope_identity()	
Parameters:
@ActionMenu684[String] = TbModelOtherInfo
@ActionType685[String] = 编辑
@HostName686[String] = 
@LogDate687[DateTime] = 2020/8/20 10:52:06
@UserCode688[String] = 500000
@UserIP689[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:06
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode691,[PlanTime]=@PlanTime692,[Remark]=@Remark693,[SiteCode]=@SiteCode694,[Type]=@Type695,[ProjectId]=@ProjectId696 WHERE [TbModelOtherInfo].[ID] = @ID690	
Parameters:
@ComponentCode691[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime692[DateTime] = 2020/8/26 0:00:00
@Remark693[String] = 
@SiteCode694[String] = 6373083923489249281
@Type695[Int32] = 2
@ProjectId696[String] = 6372912251695766465
@ID690[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:07
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type697) 	
Parameters:
@Type697[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:52:07
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu698,@ActionType699,@HostName700,@LogDate701,@UserCode702,@UserIP703);select scope_identity()	
Parameters:
@ActionMenu698[String] = TbModelOtherInfo
@ActionType699[String] = 新增
@HostName700[String] = 
@LogDate701[DateTime] = 2020/8/20 10:52:07
@UserCode702[String] = 500000
@UserIP703[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:07
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime704,@Remark705,@SiteCode706,@Type707,@ProjectId708);select scope_identity()	
Parameters:
@PlanTime704[DateTime] = 2020/8/26 0:00:00
@Remark705[String] = 
@SiteCode706[String] = 6373083923489249281
@Type707[Int32] = 1
@ProjectId708[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:52:10
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode709) AND ([TbModelOtherInfo].[Type] = @Type710) 	
Parameters:
@ComponentCode709[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type710[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:10
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu711,@ActionType712,@HostName713,@LogDate714,@UserCode715,@UserIP716);select scope_identity()	
Parameters:
@ActionMenu711[String] = TbModelOtherInfo
@ActionType712[String] = 编辑
@HostName713[String] = 
@LogDate714[DateTime] = 2020/8/20 10:52:10
@UserCode715[String] = 500000
@UserIP716[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:10
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode718,[PlanTime]=@PlanTime719,[Remark]=@Remark720,[SiteCode]=@SiteCode721,[Type]=@Type722,[ProjectId]=@ProjectId723 WHERE [TbModelOtherInfo].[ID] = @ID717	
Parameters:
@ComponentCode718[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime719[DateTime] = 2020/8/18 0:00:00
@Remark720[String] = 
@SiteCode721[String] = 6373083923489249281
@Type722[Int32] = 2
@ProjectId723[String] = 6372912251695766465
@ID717[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:13
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode724) AND ([TbModelOtherInfo].[Type] = @Type725) 	
Parameters:
@ComponentCode724[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type725[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:13
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu726,@ActionType727,@HostName728,@LogDate729,@UserCode730,@UserIP731);select scope_identity()	
Parameters:
@ActionMenu726[String] = TbModelOtherInfo
@ActionType727[String] = 编辑
@HostName728[String] = 
@LogDate729[DateTime] = 2020/8/20 10:52:13
@UserCode730[String] = 500000
@UserIP731[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:13
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode733,[PlanTime]=@PlanTime734,[Remark]=@Remark735,[SiteCode]=@SiteCode736,[Type]=@Type737,[ProjectId]=@ProjectId738 WHERE [TbModelOtherInfo].[ID] = @ID732	
Parameters:
@ComponentCode733[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime734[DateTime] = 2020/8/26 0:00:00
@Remark735[String] = 
@SiteCode736[String] = 6373083923489249281
@Type737[Int32] = 2
@ProjectId738[String] = 6372912251695766465
@ID732[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:30
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 10:52:30
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 10:52:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type739) AND ([TbOrganizationMap].[ProjectId] = @ProjectId740)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode741,@CompanyCode742,@CompanyCode743,@CompanyCode744,@CompanyCode745,@CompanyCode746,@CompanyCode747,@CompanyCode748)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode749))) 	
Parameters:
@Type739[Int32] = 1
@ProjectId740[String] = 6372912251695766465
@CompanyCode741[String] = 6373083923489249281
@CompanyCode742[String] = 6373083925531366080
@CompanyCode743[String] = 6373083927883400612
@CompanyCode744[String] = 6373083918575368225
@CompanyCode745[String] = 6373083920445075162
@CompanyCode746[String] = 6373083908618598731
@CompanyCode747[String] = 6373083911842783146
@CompanyCode748[String] = 6373083913928202424
@ParentCompanyCode749[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type750) AND ([TbOrganizationMap].[ProjectId] = @ProjectId751)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode752,@CompanyCode753,@CompanyCode754,@CompanyCode755,@CompanyCode756,@CompanyCode757,@CompanyCode758,@CompanyCode759)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode760))) 	
Parameters:
@Type750[Int32] = 2
@ProjectId751[String] = 6372912251695766465
@CompanyCode752[String] = 6373083923489249281
@CompanyCode753[String] = 6373083925531366080
@CompanyCode754[String] = 6373083927883400612
@CompanyCode755[String] = 6373083918575368225
@CompanyCode756[String] = 6373083920445075162
@CompanyCode757[String] = 6373083908618598731
@CompanyCode758[String] = 6373083911842783146
@CompanyCode759[String] = 6373083913928202424
@ParentCompanyCode760[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode789)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId761) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode762,@SiteCode763,@SiteCode764,@SiteCode765,@SiteCode766,@SiteCode767,@SiteCode768,@SiteCode769,@SiteCode770,@SiteCode771,@SiteCode772,@SiteCode773,@SiteCode774,@SiteCode775,@SiteCode776,@SiteCode777,@SiteCode778,@SiteCode779,@SiteCode780,@SiteCode781,@SiteCode782,@SiteCode783,@SiteCode784,@SiteCode785,@SiteCode786,@SiteCode787,@SiteCode788)))	
Parameters:
@ProjectId761[String] = 6372912251695766465
@SiteCode762[String] = 6373083923489249281
@SiteCode763[String] = 6373083925531366080
@SiteCode764[String] = 6373083927883400612
@SiteCode765[String] = 6373083918575368225
@SiteCode766[String] = 6373083920445075162
@SiteCode767[String] = 6373083908618598731
@SiteCode768[String] = 6373083911842783146
@SiteCode769[String] = 6373083913928202424
@SiteCode770[String] = 6373083877551621804
@SiteCode771[String] = 6373083879921857377
@SiteCode772[String] = 6373083881542550067
@SiteCode773[String] = 6373083883689772886
@SiteCode774[String] = 6373083887136270013
@SiteCode775[String] = 6373083889697116488
@SiteCode776[String] = 6373083891969846476
@SiteCode777[String] = 6373083894422586761
@SiteCode778[String] = 6373083897509963358
@SiteCode779[String] = 6373083900444931227
@SiteCode780[String] = 6373083829464571372
@SiteCode781[String] = 6373083833327492328
@SiteCode782[String] = 6373083841964286321
@SiteCode783[String] = 6373083844982558950
@SiteCode784[String] = 6373083847585007801
@SiteCode785[String] = 6373083856887939900
@SiteCode786[String] = 6373083859102666584
@SiteCode787[String] = 6373083864919499284
@SiteCode788[String] = 6373334974514214221
@FDictionaryCode789[String] = OrderState
@FDictionaryCode790[String] = UrgentDegree
@FDictionaryCode791[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:52:31
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode790) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode791) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode789)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId761) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode762,@SiteCode763,@SiteCode764,@SiteCode765,@SiteCode766,@SiteCode767,@SiteCode768,@SiteCode769,@SiteCode770,@SiteCode771,@SiteCode772,@SiteCode773,@SiteCode774,@SiteCode775,@SiteCode776,@SiteCode777,@SiteCode778,@SiteCode779,@SiteCode780,@SiteCode781,@SiteCode782,@SiteCode783,@SiteCode784,@SiteCode785,@SiteCode786,@SiteCode787,@SiteCode788))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId761[String] = 6372912251695766465
@SiteCode762[String] = 6373083923489249281
@SiteCode763[String] = 6373083925531366080
@SiteCode764[String] = 6373083927883400612
@SiteCode765[String] = 6373083918575368225
@SiteCode766[String] = 6373083920445075162
@SiteCode767[String] = 6373083908618598731
@SiteCode768[String] = 6373083911842783146
@SiteCode769[String] = 6373083913928202424
@SiteCode770[String] = 6373083877551621804
@SiteCode771[String] = 6373083879921857377
@SiteCode772[String] = 6373083881542550067
@SiteCode773[String] = 6373083883689772886
@SiteCode774[String] = 6373083887136270013
@SiteCode775[String] = 6373083889697116488
@SiteCode776[String] = 6373083891969846476
@SiteCode777[String] = 6373083894422586761
@SiteCode778[String] = 6373083897509963358
@SiteCode779[String] = 6373083900444931227
@SiteCode780[String] = 6373083829464571372
@SiteCode781[String] = 6373083833327492328
@SiteCode782[String] = 6373083841964286321
@SiteCode783[String] = 6373083844982558950
@SiteCode784[String] = 6373083847585007801
@SiteCode785[String] = 6373083856887939900
@SiteCode786[String] = 6373083859102666584
@SiteCode787[String] = 6373083864919499284
@SiteCode788[String] = 6373334974514214221
@FDictionaryCode789[String] = OrderState
@FDictionaryCode790[String] = UrgentDegree
@FDictionaryCode791[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:52:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 10:52:32
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 10:52:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 10:52:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 10:52:32
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:52:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:52:36
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 10:52:36
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:52:36
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:52:41
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode793) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode794) 	
Parameters:
@SiteCode793[String] = 6373083923489249281
@ComponentCode794[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 10:52:41
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:52:41
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:52:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm795,@MxGjBm796,@MxGjBm797) 	
Parameters:
@MxGjBm795[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm796[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm797[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:52:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode798,@ComponentCode799,@ComponentCode800)) AND ([TbModelOtherInfo].[Type] = @Type801) 	
Parameters:
@ComponentCode798[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode799[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode800[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type801[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:52:44
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:52:44
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 10:52:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId802,@MxGjId803) 	
Parameters:
@MxGjId802[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId803[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 10:52:44
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode804,@ComponentCode805)) AND ([TbModelOtherInfo].[Type] = @Type806) 	
Parameters:
@ComponentCode804[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode805[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type806[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode807) AND ([TbModelOtherInfo].[Type] = @Type808) 	
Parameters:
@ComponentCode807[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type808[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:54
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu809,@ActionType810,@HostName811,@LogDate812,@UserCode813,@UserIP814);select scope_identity()	
Parameters:
@ActionMenu809[String] = TbModelOtherInfo
@ActionType810[String] = 编辑
@HostName811[String] = 
@LogDate812[DateTime] = 2020/8/20 10:52:54
@UserCode813[String] = 500000
@UserIP814[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:54
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode816,[PlanTime]=@PlanTime817,[Remark]=@Remark818,[SiteCode]=@SiteCode819,[Type]=@Type820,[ProjectId]=@ProjectId821 WHERE [TbModelOtherInfo].[ID] = @ID815	
Parameters:
@ComponentCode816[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime817[DateTime] = 2020/8/12 0:00:00
@Remark818[String] = 
@SiteCode819[String] = 6373083923489249281
@Type820[Int32] = 2
@ProjectId821[String] = 6372912251695766465
@ID815[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode822) AND ([TbModelOtherInfo].[Type] = @Type823) 	
Parameters:
@ComponentCode822[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type823[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:56
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu824,@ActionType825,@HostName826,@LogDate827,@UserCode828,@UserIP829);select scope_identity()	
Parameters:
@ActionMenu824[String] = TbModelOtherInfo
@ActionType825[String] = 编辑
@HostName826[String] = 
@LogDate827[DateTime] = 2020/8/20 10:52:56
@UserCode828[String] = 500000
@UserIP829[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:56
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode831,[PlanTime]=@PlanTime832,[Remark]=@Remark833,[SiteCode]=@SiteCode834,[Type]=@Type835,[ProjectId]=@ProjectId836 WHERE [TbModelOtherInfo].[ID] = @ID830	
Parameters:
@ComponentCode831[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime832[DateTime] = 2020/8/4 0:00:00
@Remark833[String] = 
@SiteCode834[String] = 6373083923489249281
@Type835[Int32] = 2
@ProjectId836[String] = 6372912251695766465
@ID830[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:52:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode837) AND ([TbModelOtherInfo].[Type] = @Type838) 	
Parameters:
@ComponentCode837[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type838[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:52:57
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu839,@ActionType840,@HostName841,@LogDate842,@UserCode843,@UserIP844);select scope_identity()	
Parameters:
@ActionMenu839[String] = TbModelOtherInfo
@ActionType840[String] = 编辑
@HostName841[String] = 
@LogDate842[DateTime] = 2020/8/20 10:52:57
@UserCode843[String] = 500000
@UserIP844[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:52:57
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode846,[PlanTime]=@PlanTime847,[Remark]=@Remark848,[SiteCode]=@SiteCode849,[Type]=@Type850,[ProjectId]=@ProjectId851 WHERE [TbModelOtherInfo].[ID] = @ID845	
Parameters:
@ComponentCode846[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime847[DateTime] = 2020/8/12 0:00:00
@Remark848[String] = 
@SiteCode849[String] = 6373083923489249281
@Type850[Int32] = 2
@ProjectId851[String] = 6372912251695766465
@ID845[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type852) AND ([TbOrganizationMap].[ProjectId] = @ProjectId853)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode854,@CompanyCode855,@CompanyCode856,@CompanyCode857,@CompanyCode858,@CompanyCode859,@CompanyCode860,@CompanyCode861)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode862))) 	
Parameters:
@Type852[Int32] = 1
@ProjectId853[String] = 6372912251695766465
@CompanyCode854[String] = 6373083923489249281
@CompanyCode855[String] = 6373083925531366080
@CompanyCode856[String] = 6373083927883400612
@CompanyCode857[String] = 6373083918575368225
@CompanyCode858[String] = 6373083920445075162
@CompanyCode859[String] = 6373083908618598731
@CompanyCode860[String] = 6373083911842783146
@CompanyCode861[String] = 6373083913928202424
@ParentCompanyCode862[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type863) AND ([TbOrganizationMap].[ProjectId] = @ProjectId864)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode865,@CompanyCode866,@CompanyCode867,@CompanyCode868,@CompanyCode869,@CompanyCode870,@CompanyCode871,@CompanyCode872)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode873))) 	
Parameters:
@Type863[Int32] = 2
@ProjectId864[String] = 6372912251695766465
@CompanyCode865[String] = 6373083923489249281
@CompanyCode866[String] = 6373083925531366080
@CompanyCode867[String] = 6373083927883400612
@CompanyCode868[String] = 6373083918575368225
@CompanyCode869[String] = 6373083920445075162
@CompanyCode870[String] = 6373083908618598731
@CompanyCode871[String] = 6373083911842783146
@CompanyCode872[String] = 6373083913928202424
@ParentCompanyCode873[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode902)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId874) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode875,@SiteCode876,@SiteCode877,@SiteCode878,@SiteCode879,@SiteCode880,@SiteCode881,@SiteCode882,@SiteCode883,@SiteCode884,@SiteCode885,@SiteCode886,@SiteCode887,@SiteCode888,@SiteCode889,@SiteCode890,@SiteCode891,@SiteCode892,@SiteCode893,@SiteCode894,@SiteCode895,@SiteCode896,@SiteCode897,@SiteCode898,@SiteCode899,@SiteCode900,@SiteCode901)))	
Parameters:
@ProjectId874[String] = 6372912251695766465
@SiteCode875[String] = 6373083923489249281
@SiteCode876[String] = 6373083925531366080
@SiteCode877[String] = 6373083927883400612
@SiteCode878[String] = 6373083918575368225
@SiteCode879[String] = 6373083920445075162
@SiteCode880[String] = 6373083908618598731
@SiteCode881[String] = 6373083911842783146
@SiteCode882[String] = 6373083913928202424
@SiteCode883[String] = 6373083877551621804
@SiteCode884[String] = 6373083879921857377
@SiteCode885[String] = 6373083881542550067
@SiteCode886[String] = 6373083883689772886
@SiteCode887[String] = 6373083887136270013
@SiteCode888[String] = 6373083889697116488
@SiteCode889[String] = 6373083891969846476
@SiteCode890[String] = 6373083894422586761
@SiteCode891[String] = 6373083897509963358
@SiteCode892[String] = 6373083900444931227
@SiteCode893[String] = 6373083829464571372
@SiteCode894[String] = 6373083833327492328
@SiteCode895[String] = 6373083841964286321
@SiteCode896[String] = 6373083844982558950
@SiteCode897[String] = 6373083847585007801
@SiteCode898[String] = 6373083856887939900
@SiteCode899[String] = 6373083859102666584
@SiteCode900[String] = 6373083864919499284
@SiteCode901[String] = 6373334974514214221
@FDictionaryCode902[String] = OrderState
@FDictionaryCode903[String] = UrgentDegree
@FDictionaryCode904[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:53:32
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode903) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode904) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode902)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId874) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode875,@SiteCode876,@SiteCode877,@SiteCode878,@SiteCode879,@SiteCode880,@SiteCode881,@SiteCode882,@SiteCode883,@SiteCode884,@SiteCode885,@SiteCode886,@SiteCode887,@SiteCode888,@SiteCode889,@SiteCode890,@SiteCode891,@SiteCode892,@SiteCode893,@SiteCode894,@SiteCode895,@SiteCode896,@SiteCode897,@SiteCode898,@SiteCode899,@SiteCode900,@SiteCode901))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId874[String] = 6372912251695766465
@SiteCode875[String] = 6373083923489249281
@SiteCode876[String] = 6373083925531366080
@SiteCode877[String] = 6373083927883400612
@SiteCode878[String] = 6373083918575368225
@SiteCode879[String] = 6373083920445075162
@SiteCode880[String] = 6373083908618598731
@SiteCode881[String] = 6373083911842783146
@SiteCode882[String] = 6373083913928202424
@SiteCode883[String] = 6373083877551621804
@SiteCode884[String] = 6373083879921857377
@SiteCode885[String] = 6373083881542550067
@SiteCode886[String] = 6373083883689772886
@SiteCode887[String] = 6373083887136270013
@SiteCode888[String] = 6373083889697116488
@SiteCode889[String] = 6373083891969846476
@SiteCode890[String] = 6373083894422586761
@SiteCode891[String] = 6373083897509963358
@SiteCode892[String] = 6373083900444931227
@SiteCode893[String] = 6373083829464571372
@SiteCode894[String] = 6373083833327492328
@SiteCode895[String] = 6373083841964286321
@SiteCode896[String] = 6373083844982558950
@SiteCode897[String] = 6373083847585007801
@SiteCode898[String] = 6373083856887939900
@SiteCode899[String] = 6373083859102666584
@SiteCode900[String] = 6373083864919499284
@SiteCode901[String] = 6373334974514214221
@FDictionaryCode902[String] = OrderState
@FDictionaryCode903[String] = UrgentDegree
@FDictionaryCode904[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:53:33
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 10:53:33
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 10:53:33
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 10:53:33
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 10:53:33
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:53:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:53:37
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 10:53:37
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:53:38
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:53:42
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode906) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode907) 	
Parameters:
@SiteCode906[String] = 6373083923489249281
@ComponentCode907[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 10:53:42
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:53:42
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:53:42
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm908,@MxGjBm909,@MxGjBm910) 	
Parameters:
@MxGjBm908[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm909[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm910[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:53:42
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode911,@ComponentCode912,@ComponentCode913)) AND ([TbModelOtherInfo].[Type] = @Type914) 	
Parameters:
@ComponentCode911[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode912[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode913[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type914[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:53:45
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:53:45
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 10:53:45
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId915,@MxGjId916) 	
Parameters:
@MxGjId915[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId916[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 10:53:45
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode917,@ComponentCode918)) AND ([TbModelOtherInfo].[Type] = @Type919) 	
Parameters:
@ComponentCode917[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode918[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type919[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:53:50
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type920) 	
Parameters:
@Type920[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:53:50
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu921,@ActionType922,@HostName923,@LogDate924,@UserCode925,@UserIP926);select scope_identity()	
Parameters:
@ActionMenu921[String] = TbModelOtherInfo
@ActionType922[String] = 新增
@HostName923[String] = 
@LogDate924[DateTime] = 2020/8/20 10:53:50
@UserCode925[String] = 500000
@UserIP926[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:53:50
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime927,@Remark928,@SiteCode929,@Type930,@ProjectId931);select scope_identity()	
Parameters:
@PlanTime927[DateTime] = 2020/8/12 0:00:00
@Remark928[String] = 
@SiteCode929[String] = 6373083923489249281
@Type930[Int32] = 2
@ProjectId931[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:53:54
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type932) 	
Parameters:
@Type932[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:53:54
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu933,@ActionType934,@HostName935,@LogDate936,@UserCode937,@UserIP938);select scope_identity()	
Parameters:
@ActionMenu933[String] = TbModelOtherInfo
@ActionType934[String] = 新增
@HostName935[String] = 
@LogDate936[DateTime] = 2020/8/20 10:53:54
@UserCode937[String] = 500000
@UserIP938[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:53:54
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime939,@Remark940,@SiteCode941,@Type942,@ProjectId943);select scope_identity()	
Parameters:
@PlanTime939[DateTime] = 2020/8/12 0:00:00
@Remark940[String] = 
@SiteCode941[String] = 6373083923489249281
@Type942[Int32] = 2
@ProjectId943[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:53:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode944) AND ([TbModelOtherInfo].[Type] = @Type945) 	
Parameters:
@ComponentCode944[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type945[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:53:56
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu946,@ActionType947,@HostName948,@LogDate949,@UserCode950,@UserIP951);select scope_identity()	
Parameters:
@ActionMenu946[String] = TbModelOtherInfo
@ActionType947[String] = 编辑
@HostName948[String] = 
@LogDate949[DateTime] = 2020/8/20 10:53:56
@UserCode950[String] = 500000
@UserIP951[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:53:56
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode953,[PlanTime]=@PlanTime954,[Remark]=@Remark955,[SiteCode]=@SiteCode956,[Type]=@Type957,[ProjectId]=@ProjectId958 WHERE [TbModelOtherInfo].[ID] = @ID952	
Parameters:
@ComponentCode953[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime954[DateTime] = 2020/8/12 0:00:00
@Remark955[String] = 
@SiteCode956[String] = 6373083923489249281
@Type957[Int32] = 2
@ProjectId958[String] = 6372912251695766465
@ID952[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode959) AND ([TbModelOtherInfo].[Type] = @Type960) 	
Parameters:
@ComponentCode959[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type960[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu961,@ActionType962,@HostName963,@LogDate964,@UserCode965,@UserIP966);select scope_identity()	
Parameters:
@ActionMenu961[String] = TbModelOtherInfo
@ActionType962[String] = 编辑
@HostName963[String] = 
@LogDate964[DateTime] = 2020/8/20 10:54:00
@UserCode965[String] = 500000
@UserIP966[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:00
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode968,[PlanTime]=@PlanTime969,[Remark]=@Remark970,[SiteCode]=@SiteCode971,[Type]=@Type972,[ProjectId]=@ProjectId973 WHERE [TbModelOtherInfo].[ID] = @ID967	
Parameters:
@ComponentCode968[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime969[DateTime] = 2020/8/4 0:00:00
@Remark970[String] = 
@SiteCode971[String] = 6373083923489249281
@Type972[Int32] = 2
@ProjectId973[String] = 6372912251695766465
@ID967[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:01
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type974) 	
Parameters:
@Type974[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu975,@ActionType976,@HostName977,@LogDate978,@UserCode979,@UserIP980);select scope_identity()	
Parameters:
@ActionMenu975[String] = TbModelOtherInfo
@ActionType976[String] = 新增
@HostName977[String] = 
@LogDate978[DateTime] = 2020/8/20 10:54:01
@UserCode979[String] = 500000
@UserIP980[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:01
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime981,@Remark982,@SiteCode983,@Type984,@ProjectId985);select scope_identity()	
Parameters:
@PlanTime981[DateTime] = 2020/8/12 0:00:00
@Remark982[String] = 
@SiteCode983[String] = 6373083923489249281
@Type984[Int32] = 2
@ProjectId985[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:54:03
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode986) AND ([TbModelOtherInfo].[Type] = @Type987) 	
Parameters:
@ComponentCode986[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type987[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:03
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu988,@ActionType989,@HostName990,@LogDate991,@UserCode992,@UserIP993);select scope_identity()	
Parameters:
@ActionMenu988[String] = TbModelOtherInfo
@ActionType989[String] = 编辑
@HostName990[String] = 
@LogDate991[DateTime] = 2020/8/20 10:54:03
@UserCode992[String] = 500000
@UserIP993[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:03
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode995,[PlanTime]=@PlanTime996,[Remark]=@Remark997,[SiteCode]=@SiteCode998,[Type]=@Type999,[ProjectId]=@ProjectId1000 WHERE [TbModelOtherInfo].[ID] = @ID994	
Parameters:
@ComponentCode995[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime996[DateTime] = 2020/8/12 0:00:00
@Remark997[String] = 
@SiteCode998[String] = 6373083923489249281
@Type999[Int32] = 2
@ProjectId1000[String] = 6372912251695766465
@ID994[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:10
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1001) 	
Parameters:
@Type1001[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:10
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1002,@ActionType1003,@HostName1004,@LogDate1005,@UserCode1006,@UserIP1007);select scope_identity()	
Parameters:
@ActionMenu1002[String] = TbModelOtherInfo
@ActionType1003[String] = 新增
@HostName1004[String] = 
@LogDate1005[DateTime] = 2020/8/20 10:54:10
@UserCode1006[String] = 500000
@UserIP1007[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:10
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1008,@Remark1009,@SiteCode1010,@Type1011,@ProjectId1012);select scope_identity()	
Parameters:
@PlanTime1008[DateTime] = 2020/8/4 0:00:00
@Remark1009[String] = 
@SiteCode1010[String] = 6373083923489249281
@Type1011[Int32] = 2
@ProjectId1012[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1013) 	
Parameters:
@Type1013[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1014,@ActionType1015,@HostName1016,@LogDate1017,@UserCode1018,@UserIP1019);select scope_identity()	
Parameters:
@ActionMenu1014[String] = TbModelOtherInfo
@ActionType1015[String] = 新增
@HostName1016[String] = 
@LogDate1017[DateTime] = 2020/8/20 10:54:14
@UserCode1018[String] = 500000
@UserIP1019[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode1020,@Type1021,@ProjectId1022);select scope_identity()	
Parameters:
@SiteCode1020[String] = 6373083923489249281
@Type1021[Int32] = 1
@ProjectId1022[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1023) AND ([TbModelOtherInfo].[Type] = @Type1024) 	
Parameters:
@ComponentCode1023[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1024[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1025,@ActionType1026,@HostName1027,@LogDate1028,@UserCode1029,@UserIP1030);select scope_identity()	
Parameters:
@ActionMenu1025[String] = TbModelOtherInfo
@ActionType1026[String] = 编辑
@HostName1027[String] = 
@LogDate1028[DateTime] = 2020/8/20 10:54:14
@UserCode1029[String] = 500000
@UserIP1030[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:14
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1032,[PlanTime]=@PlanTime1033,[Remark]=@Remark1034,[SiteCode]=@SiteCode1035,[Type]=@Type1036,[ProjectId]=@ProjectId1037 WHERE [TbModelOtherInfo].[ID] = @ID1031	
Parameters:
@ComponentCode1032[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1033[DateTime] = 2020/8/18 0:00:00
@Remark1034[String] = 
@SiteCode1035[String] = 6373083923489249281
@Type1036[Int32] = 2
@ProjectId1037[String] = 6372912251695766465
@ID1031[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:15
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1038) AND ([TbModelOtherInfo].[Type] = @Type1039) 	
Parameters:
@ComponentCode1038[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1039[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:15
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1040,@ActionType1041,@HostName1042,@LogDate1043,@UserCode1044,@UserIP1045);select scope_identity()	
Parameters:
@ActionMenu1040[String] = TbModelOtherInfo
@ActionType1041[String] = 编辑
@HostName1042[String] = 
@LogDate1043[DateTime] = 2020/8/20 10:54:15
@UserCode1044[String] = 500000
@UserIP1045[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:15
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1047,[PlanTime]=@PlanTime1048,[Remark]=@Remark1049,[SiteCode]=@SiteCode1050,[Type]=@Type1051,[ProjectId]=@ProjectId1052 WHERE [TbModelOtherInfo].[ID] = @ID1046	
Parameters:
@ComponentCode1047[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1048[DateTime] = 2020/8/4 0:00:00
@Remark1049[String] = 
@SiteCode1050[String] = 6373083923489249281
@Type1051[Int32] = 2
@ProjectId1052[String] = 6372912251695766465
@ID1046[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1053) 	
Parameters:
@Type1053[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:18
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1054,@ActionType1055,@HostName1056,@LogDate1057,@UserCode1058,@UserIP1059);select scope_identity()	
Parameters:
@ActionMenu1054[String] = TbModelOtherInfo
@ActionType1055[String] = 新增
@HostName1056[String] = 
@LogDate1057[DateTime] = 2020/8/20 10:54:18
@UserCode1058[String] = 500000
@UserIP1059[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:18
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1060,@Remark1061,@SiteCode1062,@Type1063,@ProjectId1064);select scope_identity()	
Parameters:
@PlanTime1060[DateTime] = 2020/8/18 0:00:00
@Remark1061[String] = 
@SiteCode1062[String] = 6373083923489249281
@Type1063[Int32] = 1
@ProjectId1064[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:54:23
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1065) 	
Parameters:
@Type1065[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:23
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1066,@ActionType1067,@HostName1068,@LogDate1069,@UserCode1070,@UserIP1071);select scope_identity()	
Parameters:
@ActionMenu1066[String] = TbModelOtherInfo
@ActionType1067[String] = 新增
@HostName1068[String] = 
@LogDate1069[DateTime] = 2020/8/20 10:54:23
@UserCode1070[String] = 500000
@UserIP1071[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:23
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1072,@Remark1073,@SiteCode1074,@Type1075,@ProjectId1076);select scope_identity()	
Parameters:
@PlanTime1072[DateTime] = 2020/8/18 0:00:00
@Remark1073[String] = 
@SiteCode1074[String] = 6373083923489249281
@Type1075[Int32] = 1
@ProjectId1076[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:54:26
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:54:26
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1105)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1077) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1078,@SiteCode1079,@SiteCode1080,@SiteCode1081,@SiteCode1082,@SiteCode1083,@SiteCode1084,@SiteCode1085,@SiteCode1086,@SiteCode1087,@SiteCode1088,@SiteCode1089,@SiteCode1090,@SiteCode1091,@SiteCode1092,@SiteCode1093,@SiteCode1094,@SiteCode1095,@SiteCode1096,@SiteCode1097,@SiteCode1098,@SiteCode1099,@SiteCode1100,@SiteCode1101,@SiteCode1102,@SiteCode1103,@SiteCode1104)))	
Parameters:
@ProjectId1077[String] = 6372912251695766465
@SiteCode1078[String] = 6373083923489249281
@SiteCode1079[String] = 6373083925531366080
@SiteCode1080[String] = 6373083927883400612
@SiteCode1081[String] = 6373083918575368225
@SiteCode1082[String] = 6373083920445075162
@SiteCode1083[String] = 6373083908618598731
@SiteCode1084[String] = 6373083911842783146
@SiteCode1085[String] = 6373083913928202424
@SiteCode1086[String] = 6373083877551621804
@SiteCode1087[String] = 6373083879921857377
@SiteCode1088[String] = 6373083881542550067
@SiteCode1089[String] = 6373083883689772886
@SiteCode1090[String] = 6373083887136270013
@SiteCode1091[String] = 6373083889697116488
@SiteCode1092[String] = 6373083891969846476
@SiteCode1093[String] = 6373083894422586761
@SiteCode1094[String] = 6373083897509963358
@SiteCode1095[String] = 6373083900444931227
@SiteCode1096[String] = 6373083829464571372
@SiteCode1097[String] = 6373083833327492328
@SiteCode1098[String] = 6373083841964286321
@SiteCode1099[String] = 6373083844982558950
@SiteCode1100[String] = 6373083847585007801
@SiteCode1101[String] = 6373083856887939900
@SiteCode1102[String] = 6373083859102666584
@SiteCode1103[String] = 6373083864919499284
@SiteCode1104[String] = 6373334974514214221
@FDictionaryCode1105[String] = OrderState
@FDictionaryCode1106[String] = UrgentDegree
@FDictionaryCode1107[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:54:26
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1106) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1107) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1105)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1077) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1078,@SiteCode1079,@SiteCode1080,@SiteCode1081,@SiteCode1082,@SiteCode1083,@SiteCode1084,@SiteCode1085,@SiteCode1086,@SiteCode1087,@SiteCode1088,@SiteCode1089,@SiteCode1090,@SiteCode1091,@SiteCode1092,@SiteCode1093,@SiteCode1094,@SiteCode1095,@SiteCode1096,@SiteCode1097,@SiteCode1098,@SiteCode1099,@SiteCode1100,@SiteCode1101,@SiteCode1102,@SiteCode1103,@SiteCode1104))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1077[String] = 6372912251695766465
@SiteCode1078[String] = 6373083923489249281
@SiteCode1079[String] = 6373083925531366080
@SiteCode1080[String] = 6373083927883400612
@SiteCode1081[String] = 6373083918575368225
@SiteCode1082[String] = 6373083920445075162
@SiteCode1083[String] = 6373083908618598731
@SiteCode1084[String] = 6373083911842783146
@SiteCode1085[String] = 6373083913928202424
@SiteCode1086[String] = 6373083877551621804
@SiteCode1087[String] = 6373083879921857377
@SiteCode1088[String] = 6373083881542550067
@SiteCode1089[String] = 6373083883689772886
@SiteCode1090[String] = 6373083887136270013
@SiteCode1091[String] = 6373083889697116488
@SiteCode1092[String] = 6373083891969846476
@SiteCode1093[String] = 6373083894422586761
@SiteCode1094[String] = 6373083897509963358
@SiteCode1095[String] = 6373083900444931227
@SiteCode1096[String] = 6373083829464571372
@SiteCode1097[String] = 6373083833327492328
@SiteCode1098[String] = 6373083841964286321
@SiteCode1099[String] = 6373083844982558950
@SiteCode1100[String] = 6373083847585007801
@SiteCode1101[String] = 6373083856887939900
@SiteCode1102[String] = 6373083859102666584
@SiteCode1103[String] = 6373083864919499284
@SiteCode1104[String] = 6373334974514214221
@FDictionaryCode1105[String] = OrderState
@FDictionaryCode1106[String] = UrgentDegree
@FDictionaryCode1107[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:54:28
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1108) AND ([TbModelOtherInfo].[Type] = @Type1109) 	
Parameters:
@ComponentCode1108[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type1109[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:28
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1110,@ActionType1111,@HostName1112,@LogDate1113,@UserCode1114,@UserIP1115);select scope_identity()	
Parameters:
@ActionMenu1110[String] = TbModelOtherInfo
@ActionType1111[String] = 编辑
@HostName1112[String] = 
@LogDate1113[DateTime] = 2020/8/20 10:54:28
@UserCode1114[String] = 500000
@UserIP1115[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:28
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1117,[PlanTime]=@PlanTime1118,[Remark]=@Remark1119,[SiteCode]=@SiteCode1120,[Type]=@Type1121,[ProjectId]=@ProjectId1122 WHERE [TbModelOtherInfo].[ID] = @ID1116	
Parameters:
@ComponentCode1117[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime1118[DateTime] = 2020/8/21 0:00:00
@Remark1119[String] = 
@SiteCode1120[String] = 6373083923489249281
@Type1121[Int32] = 1
@ProjectId1122[String] = 6372912251695766465
@ID1116[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:34
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1123) AND ([TbModelOtherInfo].[Type] = @Type1124) 	
Parameters:
@ComponentCode1123[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1124[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:34
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1125,@ActionType1126,@HostName1127,@LogDate1128,@UserCode1129,@UserIP1130);select scope_identity()	
Parameters:
@ActionMenu1125[String] = TbModelOtherInfo
@ActionType1126[String] = 编辑
@HostName1127[String] = 
@LogDate1128[DateTime] = 2020/8/20 10:54:34
@UserCode1129[String] = 500000
@UserIP1130[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:34
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1132,[PlanTime]=@PlanTime1133,[Remark]=@Remark1134,[SiteCode]=@SiteCode1135,[Type]=@Type1136,[ProjectId]=@ProjectId1137 WHERE [TbModelOtherInfo].[ID] = @ID1131	
Parameters:
@ComponentCode1132[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1133[DateTime] = 2020/8/18 0:00:00
@Remark1134[String] = 
@SiteCode1135[String] = 6373083923489249281
@Type1136[Int32] = 2
@ProjectId1137[String] = 6372912251695766465
@ID1131[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:35
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1138) AND ([TbModelOtherInfo].[Type] = @Type1139) 	
Parameters:
@ComponentCode1138[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1139[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:54:35
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1140,@ActionType1141,@HostName1142,@LogDate1143,@UserCode1144,@UserIP1145);select scope_identity()	
Parameters:
@ActionMenu1140[String] = TbModelOtherInfo
@ActionType1141[String] = 编辑
@HostName1142[String] = 
@LogDate1143[DateTime] = 2020/8/20 10:54:35
@UserCode1144[String] = 500000
@UserIP1145[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:35
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1147,[PlanTime]=@PlanTime1148,[Remark]=@Remark1149,[SiteCode]=@SiteCode1150,[Type]=@Type1151,[ProjectId]=@ProjectId1152 WHERE [TbModelOtherInfo].[ID] = @ID1146	
Parameters:
@ComponentCode1147[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1148[DateTime] = 2020/8/4 0:00:00
@Remark1149[String] = 
@SiteCode1150[String] = 6373083923489249281
@Type1151[Int32] = 2
@ProjectId1152[String] = 6372912251695766465
@ID1146[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:49
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1153) AND ([TbModelOtherInfo].[Type] = @Type1154) 	
Parameters:
@ComponentCode1153[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type1154[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:49
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1155,@ActionType1156,@HostName1157,@LogDate1158,@UserCode1159,@UserIP1160);select scope_identity()	
Parameters:
@ActionMenu1155[String] = TbModelOtherInfo
@ActionType1156[String] = 编辑
@HostName1157[String] = 
@LogDate1158[DateTime] = 2020/8/20 10:54:49
@UserCode1159[String] = 500000
@UserIP1160[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:49
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1162,[PlanTime]=@PlanTime1163,[Remark]=@Remark1164,[SiteCode]=@SiteCode1165,[Type]=@Type1166,[ProjectId]=@ProjectId1167 WHERE [TbModelOtherInfo].[ID] = @ID1161	
Parameters:
@ComponentCode1162[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@PlanTime1163[DateTime] = 2020/8/21 0:00:00
@Remark1164[String] = 
@SiteCode1165[String] = 6373083923489249281
@Type1166[Int32] = 1
@ProjectId1167[String] = 6372912251695766465
@ID1161[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:54:51
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1168) AND ([TbModelOtherInfo].[Type] = @Type1169) 	
Parameters:
@ComponentCode1168[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type1169[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:54:51
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1170,@ActionType1171,@HostName1172,@LogDate1173,@UserCode1174,@UserIP1175);select scope_identity()	
Parameters:
@ActionMenu1170[String] = TbModelOtherInfo
@ActionType1171[String] = 编辑
@HostName1172[String] = 
@LogDate1173[DateTime] = 2020/8/20 10:54:51
@UserCode1174[String] = 500000
@UserIP1175[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:54:51
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1177,[PlanTime]=@PlanTime1178,[Remark]=@Remark1179,[SiteCode]=@SiteCode1180,[Type]=@Type1181,[ProjectId]=@ProjectId1182 WHERE [TbModelOtherInfo].[ID] = @ID1176	
Parameters:
@ComponentCode1177[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime1178[DateTime] = 2020/8/20 0:00:00
@Remark1179[String] = 
@SiteCode1180[String] = 6373083923489249281
@Type1181[Int32] = 1
@ProjectId1182[String] = 6372912251695766465
@ID1176[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:56:31
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1183) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1184)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1185,@CompanyCode1186,@CompanyCode1187,@CompanyCode1188,@CompanyCode1189,@CompanyCode1190,@CompanyCode1191,@CompanyCode1192)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1193))) 	
Parameters:
@Type1183[Int32] = 1
@ProjectId1184[String] = 6372912251695766465
@CompanyCode1185[String] = 6373083923489249281
@CompanyCode1186[String] = 6373083925531366080
@CompanyCode1187[String] = 6373083927883400612
@CompanyCode1188[String] = 6373083918575368225
@CompanyCode1189[String] = 6373083920445075162
@CompanyCode1190[String] = 6373083908618598731
@CompanyCode1191[String] = 6373083911842783146
@CompanyCode1192[String] = 6373083913928202424
@ParentCompanyCode1193[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1194) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1195)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1196,@CompanyCode1197,@CompanyCode1198,@CompanyCode1199,@CompanyCode1200,@CompanyCode1201,@CompanyCode1202,@CompanyCode1203)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1204))) 	
Parameters:
@Type1194[Int32] = 2
@ProjectId1195[String] = 6372912251695766465
@CompanyCode1196[String] = 6373083923489249281
@CompanyCode1197[String] = 6373083925531366080
@CompanyCode1198[String] = 6373083927883400612
@CompanyCode1199[String] = 6373083918575368225
@CompanyCode1200[String] = 6373083920445075162
@CompanyCode1201[String] = 6373083908618598731
@CompanyCode1202[String] = 6373083911842783146
@CompanyCode1203[String] = 6373083913928202424
@ParentCompanyCode1204[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:56:35
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1233)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1205) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1206,@SiteCode1207,@SiteCode1208,@SiteCode1209,@SiteCode1210,@SiteCode1211,@SiteCode1212,@SiteCode1213,@SiteCode1214,@SiteCode1215,@SiteCode1216,@SiteCode1217,@SiteCode1218,@SiteCode1219,@SiteCode1220,@SiteCode1221,@SiteCode1222,@SiteCode1223,@SiteCode1224,@SiteCode1225,@SiteCode1226,@SiteCode1227,@SiteCode1228,@SiteCode1229,@SiteCode1230,@SiteCode1231,@SiteCode1232)))	
Parameters:
@ProjectId1205[String] = 6372912251695766465
@SiteCode1206[String] = 6373083923489249281
@SiteCode1207[String] = 6373083925531366080
@SiteCode1208[String] = 6373083927883400612
@SiteCode1209[String] = 6373083918575368225
@SiteCode1210[String] = 6373083920445075162
@SiteCode1211[String] = 6373083908618598731
@SiteCode1212[String] = 6373083911842783146
@SiteCode1213[String] = 6373083913928202424
@SiteCode1214[String] = 6373083877551621804
@SiteCode1215[String] = 6373083879921857377
@SiteCode1216[String] = 6373083881542550067
@SiteCode1217[String] = 6373083883689772886
@SiteCode1218[String] = 6373083887136270013
@SiteCode1219[String] = 6373083889697116488
@SiteCode1220[String] = 6373083891969846476
@SiteCode1221[String] = 6373083894422586761
@SiteCode1222[String] = 6373083897509963358
@SiteCode1223[String] = 6373083900444931227
@SiteCode1224[String] = 6373083829464571372
@SiteCode1225[String] = 6373083833327492328
@SiteCode1226[String] = 6373083841964286321
@SiteCode1227[String] = 6373083844982558950
@SiteCode1228[String] = 6373083847585007801
@SiteCode1229[String] = 6373083856887939900
@SiteCode1230[String] = 6373083859102666584
@SiteCode1231[String] = 6373083864919499284
@SiteCode1232[String] = 6373334974514214221
@FDictionaryCode1233[String] = OrderState
@FDictionaryCode1234[String] = UrgentDegree
@FDictionaryCode1235[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1234) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1235) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1233)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1205) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1206,@SiteCode1207,@SiteCode1208,@SiteCode1209,@SiteCode1210,@SiteCode1211,@SiteCode1212,@SiteCode1213,@SiteCode1214,@SiteCode1215,@SiteCode1216,@SiteCode1217,@SiteCode1218,@SiteCode1219,@SiteCode1220,@SiteCode1221,@SiteCode1222,@SiteCode1223,@SiteCode1224,@SiteCode1225,@SiteCode1226,@SiteCode1227,@SiteCode1228,@SiteCode1229,@SiteCode1230,@SiteCode1231,@SiteCode1232))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1205[String] = 6372912251695766465
@SiteCode1206[String] = 6373083923489249281
@SiteCode1207[String] = 6373083925531366080
@SiteCode1208[String] = 6373083927883400612
@SiteCode1209[String] = 6373083918575368225
@SiteCode1210[String] = 6373083920445075162
@SiteCode1211[String] = 6373083908618598731
@SiteCode1212[String] = 6373083911842783146
@SiteCode1213[String] = 6373083913928202424
@SiteCode1214[String] = 6373083877551621804
@SiteCode1215[String] = 6373083879921857377
@SiteCode1216[String] = 6373083881542550067
@SiteCode1217[String] = 6373083883689772886
@SiteCode1218[String] = 6373083887136270013
@SiteCode1219[String] = 6373083889697116488
@SiteCode1220[String] = 6373083891969846476
@SiteCode1221[String] = 6373083894422586761
@SiteCode1222[String] = 6373083897509963358
@SiteCode1223[String] = 6373083900444931227
@SiteCode1224[String] = 6373083829464571372
@SiteCode1225[String] = 6373083833327492328
@SiteCode1226[String] = 6373083841964286321
@SiteCode1227[String] = 6373083844982558950
@SiteCode1228[String] = 6373083847585007801
@SiteCode1229[String] = 6373083856887939900
@SiteCode1230[String] = 6373083859102666584
@SiteCode1231[String] = 6373083864919499284
@SiteCode1232[String] = 6373334974514214221
@FDictionaryCode1233[String] = OrderState
@FDictionaryCode1234[String] = UrgentDegree
@FDictionaryCode1235[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 10:56:36
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 10:56:37
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:56:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:56:40
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 10:56:40
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:56:41
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:56:46
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1237) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1238) 	
Parameters:
@SiteCode1237[String] = 6373083923489249281
@ComponentCode1238[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 10:56:46
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:56:46
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:56:46
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1239,@MxGjBm1240,@MxGjBm1241) 	
Parameters:
@MxGjBm1239[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1240[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1241[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:56:46
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1242,@ComponentCode1243,@ComponentCode1244)) AND ([TbModelOtherInfo].[Type] = @Type1245) 	
Parameters:
@ComponentCode1242[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1243[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1244[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1245[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:56:49
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:56:49
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 10:56:49
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId1246,@MxGjId1247) 	
Parameters:
@MxGjId1246[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId1247[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 10:56:49
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1248,@ComponentCode1249)) AND ([TbModelOtherInfo].[Type] = @Type1250) 	
Parameters:
@ComponentCode1248[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode1249[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1250[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:56:52
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1251) AND ([TbModelOtherInfo].[Type] = @Type1252) 	
Parameters:
@ComponentCode1251[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1252[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:56:52
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1253,@ActionType1254,@HostName1255,@LogDate1256,@UserCode1257,@UserIP1258);select scope_identity()	
Parameters:
@ActionMenu1253[String] = TbModelOtherInfo
@ActionType1254[String] = 编辑
@HostName1255[String] = 
@LogDate1256[DateTime] = 2020/8/20 10:56:52
@UserCode1257[String] = 500000
@UserIP1258[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:56:52
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1260,[PlanTime]=@PlanTime1261,[Remark]=@Remark1262,[SiteCode]=@SiteCode1263,[Type]=@Type1264,[ProjectId]=@ProjectId1265 WHERE [TbModelOtherInfo].[ID] = @ID1259	
Parameters:
@ComponentCode1260[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1261[DateTime] = 2020/8/12 0:00:00
@Remark1262[String] = 
@SiteCode1263[String] = 6373083923489249281
@Type1264[Int32] = 2
@ProjectId1265[String] = 6372912251695766465
@ID1259[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:56:53
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1266) AND ([TbModelOtherInfo].[Type] = @Type1267) 	
Parameters:
@ComponentCode1266[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1267[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:56:53
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1268,@ActionType1269,@HostName1270,@LogDate1271,@UserCode1272,@UserIP1273);select scope_identity()	
Parameters:
@ActionMenu1268[String] = TbModelOtherInfo
@ActionType1269[String] = 编辑
@HostName1270[String] = 
@LogDate1271[DateTime] = 2020/8/20 10:56:53
@UserCode1272[String] = 500000
@UserIP1273[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:56:53
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1275,[PlanTime]=@PlanTime1276,[Remark]=@Remark1277,[SiteCode]=@SiteCode1278,[Type]=@Type1279,[ProjectId]=@ProjectId1280 WHERE [TbModelOtherInfo].[ID] = @ID1274	
Parameters:
@ComponentCode1275[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1276[DateTime] = 2020/8/4 0:00:00
@Remark1277[String] = 
@SiteCode1278[String] = 6373083923489249281
@Type1279[Int32] = 2
@ProjectId1280[String] = 6372912251695766465
@ID1274[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:56:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1281) AND ([TbModelOtherInfo].[Type] = @Type1282) 	
Parameters:
@ComponentCode1281[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1282[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:56:56
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1283,@ActionType1284,@HostName1285,@LogDate1286,@UserCode1287,@UserIP1288);select scope_identity()	
Parameters:
@ActionMenu1283[String] = TbModelOtherInfo
@ActionType1284[String] = 编辑
@HostName1285[String] = 
@LogDate1286[DateTime] = 2020/8/20 10:56:56
@UserCode1287[String] = 500000
@UserIP1288[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:56:56
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1290,[PlanTime]=@PlanTime1291,[Remark]=@Remark1292,[SiteCode]=@SiteCode1293,[Type]=@Type1294,[ProjectId]=@ProjectId1295 WHERE [TbModelOtherInfo].[ID] = @ID1289	
Parameters:
@ComponentCode1290[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1291[DateTime] = 2020/8/12 0:00:00
@Remark1292[String] = 
@SiteCode1293[String] = 6373083923489249281
@Type1294[Int32] = 2
@ProjectId1295[String] = 6372912251695766465
@ID1289[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:56:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1296) AND ([TbModelOtherInfo].[Type] = @Type1297) 	
Parameters:
@ComponentCode1296[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1297[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:56:57
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1298,@ActionType1299,@HostName1300,@LogDate1301,@UserCode1302,@UserIP1303);select scope_identity()	
Parameters:
@ActionMenu1298[String] = TbModelOtherInfo
@ActionType1299[String] = 编辑
@HostName1300[String] = 
@LogDate1301[DateTime] = 2020/8/20 10:56:57
@UserCode1302[String] = 500000
@UserIP1303[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:56:57
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1305,[PlanTime]=@PlanTime1306,[Remark]=@Remark1307,[SiteCode]=@SiteCode1308,[Type]=@Type1309,[ProjectId]=@ProjectId1310 WHERE [TbModelOtherInfo].[ID] = @ID1304	
Parameters:
@ComponentCode1305[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1306[DateTime] = 2020/8/4 0:00:00
@Remark1307[String] = 
@SiteCode1308[String] = 6373083923489249281
@Type1309[Int32] = 2
@ProjectId1310[String] = 6372912251695766465
@ID1304[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:56:58
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1311) 	
Parameters:
@Type1311[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:56:58
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1312,@ActionType1313,@HostName1314,@LogDate1315,@UserCode1316,@UserIP1317);select scope_identity()	
Parameters:
@ActionMenu1312[String] = TbModelOtherInfo
@ActionType1313[String] = 新增
@HostName1314[String] = 
@LogDate1315[DateTime] = 2020/8/20 10:56:58
@UserCode1316[String] = 500000
@UserIP1317[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:56:58
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1318,@Remark1319,@SiteCode1320,@Type1321,@ProjectId1322);select scope_identity()	
Parameters:
@PlanTime1318[DateTime] = 2020/8/20 0:00:00
@Remark1319[String] = 
@SiteCode1320[String] = 6373083923489249281
@Type1321[Int32] = 1
@ProjectId1322[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:57:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1323) AND ([TbModelOtherInfo].[Type] = @Type1324) 	
Parameters:
@ComponentCode1323[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1324[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:57:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1325,@ActionType1326,@HostName1327,@LogDate1328,@UserCode1329,@UserIP1330);select scope_identity()	
Parameters:
@ActionMenu1325[String] = TbModelOtherInfo
@ActionType1326[String] = 编辑
@HostName1327[String] = 
@LogDate1328[DateTime] = 2020/8/20 10:57:00
@UserCode1329[String] = 500000
@UserIP1330[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:00
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1332,[PlanTime]=@PlanTime1333,[Remark]=@Remark1334,[SiteCode]=@SiteCode1335,[Type]=@Type1336,[ProjectId]=@ProjectId1337 WHERE [TbModelOtherInfo].[ID] = @ID1331	
Parameters:
@ComponentCode1332[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1333[DateTime] = 2020/8/4 0:00:00
@Remark1334[String] = 
@SiteCode1335[String] = 6373083923489249281
@Type1336[Int32] = 2
@ProjectId1337[String] = 6372912251695766465
@ID1331[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:57:01
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1338) AND ([TbModelOtherInfo].[Type] = @Type1339) 	
Parameters:
@ComponentCode1338[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1339[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:57:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1340,@ActionType1341,@HostName1342,@LogDate1343,@UserCode1344,@UserIP1345);select scope_identity()	
Parameters:
@ActionMenu1340[String] = TbModelOtherInfo
@ActionType1341[String] = 编辑
@HostName1342[String] = 
@LogDate1343[DateTime] = 2020/8/20 10:57:01
@UserCode1344[String] = 500000
@UserIP1345[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:01
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1347,[PlanTime]=@PlanTime1348,[Remark]=@Remark1349,[SiteCode]=@SiteCode1350,[Type]=@Type1351,[ProjectId]=@ProjectId1352 WHERE [TbModelOtherInfo].[ID] = @ID1346	
Parameters:
@ComponentCode1347[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1348[DateTime] = 2020/8/12 0:00:00
@Remark1349[String] = 
@SiteCode1350[String] = 6373083923489249281
@Type1351[Int32] = 2
@ProjectId1352[String] = 6372912251695766465
@ID1346[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:57:02
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1353) 	
Parameters:
@Type1353[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:02
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1354,@ActionType1355,@HostName1356,@LogDate1357,@UserCode1358,@UserIP1359);select scope_identity()	
Parameters:
@ActionMenu1354[String] = TbModelOtherInfo
@ActionType1355[String] = 新增
@HostName1356[String] = 
@LogDate1357[DateTime] = 2020/8/20 10:57:02
@UserCode1358[String] = 500000
@UserIP1359[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:02
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1360,@Remark1361,@SiteCode1362,@Type1363,@ProjectId1364);select scope_identity()	
Parameters:
@PlanTime1360[DateTime] = 2020/8/20 0:00:00
@Remark1361[String] = 
@SiteCode1362[String] = 6373083923489249281
@Type1363[Int32] = 1
@ProjectId1364[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:57:03
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1365) 	
Parameters:
@Type1365[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:03
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1366,@ActionType1367,@HostName1368,@LogDate1369,@UserCode1370,@UserIP1371);select scope_identity()	
Parameters:
@ActionMenu1366[String] = TbModelOtherInfo
@ActionType1367[String] = 新增
@HostName1368[String] = 
@LogDate1369[DateTime] = 2020/8/20 10:57:03
@UserCode1370[String] = 500000
@UserIP1371[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:03
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1372,@Remark1373,@SiteCode1374,@Type1375,@ProjectId1376);select scope_identity()	
Parameters:
@PlanTime1372[DateTime] = 2020/8/21 0:00:00
@Remark1373[String] = 
@SiteCode1374[String] = 6373083923489249281
@Type1375[Int32] = 1
@ProjectId1376[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1377) AND ([TbModelOtherInfo].[Type] = @Type1378) 	
Parameters:
@ComponentCode1377[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1378[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1379,@ActionType1380,@HostName1381,@LogDate1382,@UserCode1383,@UserIP1384);select scope_identity()	
Parameters:
@ActionMenu1379[String] = TbModelOtherInfo
@ActionType1380[String] = 编辑
@HostName1381[String] = 
@LogDate1382[DateTime] = 2020/8/20 10:57:12
@UserCode1383[String] = 500000
@UserIP1384[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1386,[PlanTime]=@PlanTime1387,[Remark]=@Remark1388,[SiteCode]=@SiteCode1389,[Type]=@Type1390,[ProjectId]=@ProjectId1391 WHERE [TbModelOtherInfo].[ID] = @ID1385	
Parameters:
@ComponentCode1386[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1387[DateTime] = 2020/8/20 0:00:00
@Remark1388[String] = 
@SiteCode1389[String] = 6373083923489249281
@Type1390[Int32] = 1
@ProjectId1391[String] = 6372912251695766465
@ID1385[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1392) AND ([TbModelOtherInfo].[Type] = @Type1393) 	
Parameters:
@ComponentCode1392[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type1393[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1394,@ActionType1395,@HostName1396,@LogDate1397,@UserCode1398,@UserIP1399);select scope_identity()	
Parameters:
@ActionMenu1394[String] = TbModelOtherInfo
@ActionType1395[String] = 编辑
@HostName1396[String] = 
@LogDate1397[DateTime] = 2020/8/20 10:57:12
@UserCode1398[String] = 500000
@UserIP1399[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:12
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1401,[PlanTime]=@PlanTime1402,[Remark]=@Remark1403,[SiteCode]=@SiteCode1404,[Type]=@Type1405,[ProjectId]=@ProjectId1406 WHERE [TbModelOtherInfo].[ID] = @ID1400	
Parameters:
@ComponentCode1401[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime1402[DateTime] = 2020/8/20 0:00:00
@Remark1403[String] = 
@SiteCode1404[String] = 6373083923489249281
@Type1405[Int32] = 1
@ProjectId1406[String] = 6372912251695766465
@ID1400[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:57:16
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1407) 	
Parameters:
@Type1407[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:16
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1408,@ActionType1409,@HostName1410,@LogDate1411,@UserCode1412,@UserIP1413);select scope_identity()	
Parameters:
@ActionMenu1408[String] = TbModelOtherInfo
@ActionType1409[String] = 新增
@HostName1410[String] = 
@LogDate1411[DateTime] = 2020/8/20 10:57:16
@UserCode1412[String] = 500000
@UserIP1413[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:16
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1414,@Remark1415,@SiteCode1416,@Type1417,@ProjectId1418);select scope_identity()	
Parameters:
@PlanTime1414[DateTime] = 2020/8/20 0:00:00
@Remark1415[String] = 
@SiteCode1416[String] = 6373083923489249281
@Type1417[Int32] = 1
@ProjectId1418[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:57:17
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1419) 	
Parameters:
@Type1419[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:57:17
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1420,@ActionType1421,@HostName1422,@LogDate1423,@UserCode1424,@UserIP1425);select scope_identity()	
Parameters:
@ActionMenu1420[String] = TbModelOtherInfo
@ActionType1421[String] = 新增
@HostName1422[String] = 
@LogDate1423[DateTime] = 2020/8/20 10:57:17
@UserCode1424[String] = 500000
@UserIP1425[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:57:17
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1426,@Remark1427,@SiteCode1428,@Type1429,@ProjectId1430);select scope_identity()	
Parameters:
@PlanTime1426[DateTime] = 2020/8/21 0:00:00
@Remark1427[String] = 
@SiteCode1428[String] = 6373083923489249281
@Type1429[Int32] = 1
@ProjectId1430[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1431) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1432)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1433,@CompanyCode1434,@CompanyCode1435,@CompanyCode1436,@CompanyCode1437,@CompanyCode1438,@CompanyCode1439,@CompanyCode1440)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1441))) 	
Parameters:
@Type1431[Int32] = 1
@ProjectId1432[String] = 6372912251695766465
@CompanyCode1433[String] = 6373083923489249281
@CompanyCode1434[String] = 6373083925531366080
@CompanyCode1435[String] = 6373083927883400612
@CompanyCode1436[String] = 6373083918575368225
@CompanyCode1437[String] = 6373083920445075162
@CompanyCode1438[String] = 6373083908618598731
@CompanyCode1439[String] = 6373083911842783146
@CompanyCode1440[String] = 6373083913928202424
@ParentCompanyCode1441[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1442) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1443)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1444,@CompanyCode1445,@CompanyCode1446,@CompanyCode1447,@CompanyCode1448,@CompanyCode1449,@CompanyCode1450,@CompanyCode1451)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1452))) 	
Parameters:
@Type1442[Int32] = 2
@ProjectId1443[String] = 6372912251695766465
@CompanyCode1444[String] = 6373083923489249281
@CompanyCode1445[String] = 6373083925531366080
@CompanyCode1446[String] = 6373083927883400612
@CompanyCode1447[String] = 6373083918575368225
@CompanyCode1448[String] = 6373083920445075162
@CompanyCode1449[String] = 6373083908618598731
@CompanyCode1450[String] = 6373083911842783146
@CompanyCode1451[String] = 6373083913928202424
@ParentCompanyCode1452[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1481)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1453) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1454,@SiteCode1455,@SiteCode1456,@SiteCode1457,@SiteCode1458,@SiteCode1459,@SiteCode1460,@SiteCode1461,@SiteCode1462,@SiteCode1463,@SiteCode1464,@SiteCode1465,@SiteCode1466,@SiteCode1467,@SiteCode1468,@SiteCode1469,@SiteCode1470,@SiteCode1471,@SiteCode1472,@SiteCode1473,@SiteCode1474,@SiteCode1475,@SiteCode1476,@SiteCode1477,@SiteCode1478,@SiteCode1479,@SiteCode1480)))	
Parameters:
@ProjectId1453[String] = 6372912251695766465
@SiteCode1454[String] = 6373083923489249281
@SiteCode1455[String] = 6373083925531366080
@SiteCode1456[String] = 6373083927883400612
@SiteCode1457[String] = 6373083918575368225
@SiteCode1458[String] = 6373083920445075162
@SiteCode1459[String] = 6373083908618598731
@SiteCode1460[String] = 6373083911842783146
@SiteCode1461[String] = 6373083913928202424
@SiteCode1462[String] = 6373083877551621804
@SiteCode1463[String] = 6373083879921857377
@SiteCode1464[String] = 6373083881542550067
@SiteCode1465[String] = 6373083883689772886
@SiteCode1466[String] = 6373083887136270013
@SiteCode1467[String] = 6373083889697116488
@SiteCode1468[String] = 6373083891969846476
@SiteCode1469[String] = 6373083894422586761
@SiteCode1470[String] = 6373083897509963358
@SiteCode1471[String] = 6373083900444931227
@SiteCode1472[String] = 6373083829464571372
@SiteCode1473[String] = 6373083833327492328
@SiteCode1474[String] = 6373083841964286321
@SiteCode1475[String] = 6373083844982558950
@SiteCode1476[String] = 6373083847585007801
@SiteCode1477[String] = 6373083856887939900
@SiteCode1478[String] = 6373083859102666584
@SiteCode1479[String] = 6373083864919499284
@SiteCode1480[String] = 6373334974514214221
@FDictionaryCode1481[String] = OrderState
@FDictionaryCode1482[String] = UrgentDegree
@FDictionaryCode1483[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:58:03
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1482) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1483) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1481)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1453) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1454,@SiteCode1455,@SiteCode1456,@SiteCode1457,@SiteCode1458,@SiteCode1459,@SiteCode1460,@SiteCode1461,@SiteCode1462,@SiteCode1463,@SiteCode1464,@SiteCode1465,@SiteCode1466,@SiteCode1467,@SiteCode1468,@SiteCode1469,@SiteCode1470,@SiteCode1471,@SiteCode1472,@SiteCode1473,@SiteCode1474,@SiteCode1475,@SiteCode1476,@SiteCode1477,@SiteCode1478,@SiteCode1479,@SiteCode1480))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1453[String] = 6372912251695766465
@SiteCode1454[String] = 6373083923489249281
@SiteCode1455[String] = 6373083925531366080
@SiteCode1456[String] = 6373083927883400612
@SiteCode1457[String] = 6373083918575368225
@SiteCode1458[String] = 6373083920445075162
@SiteCode1459[String] = 6373083908618598731
@SiteCode1460[String] = 6373083911842783146
@SiteCode1461[String] = 6373083913928202424
@SiteCode1462[String] = 6373083877551621804
@SiteCode1463[String] = 6373083879921857377
@SiteCode1464[String] = 6373083881542550067
@SiteCode1465[String] = 6373083883689772886
@SiteCode1466[String] = 6373083887136270013
@SiteCode1467[String] = 6373083889697116488
@SiteCode1468[String] = 6373083891969846476
@SiteCode1469[String] = 6373083894422586761
@SiteCode1470[String] = 6373083897509963358
@SiteCode1471[String] = 6373083900444931227
@SiteCode1472[String] = 6373083829464571372
@SiteCode1473[String] = 6373083833327492328
@SiteCode1474[String] = 6373083841964286321
@SiteCode1475[String] = 6373083844982558950
@SiteCode1476[String] = 6373083847585007801
@SiteCode1477[String] = 6373083856887939900
@SiteCode1478[String] = 6373083859102666584
@SiteCode1479[String] = 6373083864919499284
@SiteCode1480[String] = 6373334974514214221
@FDictionaryCode1481[String] = OrderState
@FDictionaryCode1482[String] = UrgentDegree
@FDictionaryCode1483[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 10:58:04
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 10:58:04
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 10:58:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 10:58:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 10:58:04
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 10:58:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 10:58:08
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 10:58:08
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:58:09
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 10:58:14
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1485) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1486) 	
Parameters:
@SiteCode1485[String] = 6373083923489249281
@ComponentCode1486[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 10:58:14
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:58:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 10:58:14
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1487,@MxGjBm1488,@MxGjBm1489) 	
Parameters:
@MxGjBm1487[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1488[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1489[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 10:58:14
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1490,@ComponentCode1491,@ComponentCode1492)) AND ([TbModelOtherInfo].[Type] = @Type1493) 	
Parameters:
@ComponentCode1490[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1491[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1492[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1493[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 10:58:19
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 10:58:19
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 10:58:20
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId1494,@MxGjId1495) 	
Parameters:
@MxGjId1494[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId1495[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 10:58:20
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1496,@ComponentCode1497)) AND ([TbModelOtherInfo].[Type] = @Type1498) 	
Parameters:
@ComponentCode1496[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode1497[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1498[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:58:23
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1499) AND ([TbModelOtherInfo].[Type] = @Type1500) 	
Parameters:
@ComponentCode1499[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1500[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:58:23
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1501,@ActionType1502,@HostName1503,@LogDate1504,@UserCode1505,@UserIP1506);select scope_identity()	
Parameters:
@ActionMenu1501[String] = TbModelOtherInfo
@ActionType1502[String] = 编辑
@HostName1503[String] = 
@LogDate1504[DateTime] = 2020/8/20 10:58:23
@UserCode1505[String] = 500000
@UserIP1506[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:58:23
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1508,[PlanTime]=@PlanTime1509,[Remark]=@Remark1510,[SiteCode]=@SiteCode1511,[Type]=@Type1512,[ProjectId]=@ProjectId1513 WHERE [TbModelOtherInfo].[ID] = @ID1507	
Parameters:
@ComponentCode1508[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1509[DateTime] = 2020/8/12 0:00:00
@Remark1510[String] = 
@SiteCode1511[String] = 6373083923489249281
@Type1512[Int32] = 2
@ProjectId1513[String] = 6372912251695766465
@ID1507[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:58:24
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1514) AND ([TbModelOtherInfo].[Type] = @Type1515) 	
Parameters:
@ComponentCode1514[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1515[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:58:24
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1516,@ActionType1517,@HostName1518,@LogDate1519,@UserCode1520,@UserIP1521);select scope_identity()	
Parameters:
@ActionMenu1516[String] = TbModelOtherInfo
@ActionType1517[String] = 编辑
@HostName1518[String] = 
@LogDate1519[DateTime] = 2020/8/20 10:58:24
@UserCode1520[String] = 500000
@UserIP1521[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:58:24
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1523,[PlanTime]=@PlanTime1524,[Remark]=@Remark1525,[SiteCode]=@SiteCode1526,[Type]=@Type1527,[ProjectId]=@ProjectId1528 WHERE [TbModelOtherInfo].[ID] = @ID1522	
Parameters:
@ComponentCode1523[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1524[DateTime] = 2020/8/4 0:00:00
@Remark1525[String] = 
@SiteCode1526[String] = 6373083923489249281
@Type1527[Int32] = 2
@ProjectId1528[String] = 6372912251695766465
@ID1522[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 10:58:31
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1529) AND ([TbModelOtherInfo].[Type] = @Type1530) 	
Parameters:
@ComponentCode1529[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1530[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 10:58:31
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1531,@ActionType1532,@HostName1533,@LogDate1534,@UserCode1535,@UserIP1536);select scope_identity()	
Parameters:
@ActionMenu1531[String] = TbModelOtherInfo
@ActionType1532[String] = 编辑
@HostName1533[String] = 
@LogDate1534[DateTime] = 2020/8/20 10:58:31
@UserCode1535[String] = 500000
@UserIP1536[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 10:58:31
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1538,[PlanTime]=@PlanTime1539,[Remark]=@Remark1540,[SiteCode]=@SiteCode1541,[Type]=@Type1542,[ProjectId]=@ProjectId1543 WHERE [TbModelOtherInfo].[ID] = @ID1537	
Parameters:
@ComponentCode1538[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1539[DateTime] = 2020/8/12 0:00:00
@Remark1540[String] = 
@SiteCode1541[String] = 6373083923489249281
@Type1542[Int32] = 2
@ProjectId1543[String] = 6372912251695766465
@ID1537[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:01:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:01:45
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:01:45
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:01:45
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1544) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1545)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1546,@CompanyCode1547,@CompanyCode1548,@CompanyCode1549,@CompanyCode1550,@CompanyCode1551,@CompanyCode1552,@CompanyCode1553)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1554))) 	
Parameters:
@Type1544[Int32] = 1
@ProjectId1545[String] = 6372912251695766465
@CompanyCode1546[String] = 6373083923489249281
@CompanyCode1547[String] = 6373083925531366080
@CompanyCode1548[String] = 6373083927883400612
@CompanyCode1549[String] = 6373083918575368225
@CompanyCode1550[String] = 6373083920445075162
@CompanyCode1551[String] = 6373083908618598731
@CompanyCode1552[String] = 6373083911842783146
@CompanyCode1553[String] = 6373083913928202424
@ParentCompanyCode1554[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1555) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1556)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1557,@CompanyCode1558,@CompanyCode1559,@CompanyCode1560,@CompanyCode1561,@CompanyCode1562,@CompanyCode1563,@CompanyCode1564)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1565))) 	
Parameters:
@Type1555[Int32] = 2
@ProjectId1556[String] = 6372912251695766465
@CompanyCode1557[String] = 6373083923489249281
@CompanyCode1558[String] = 6373083925531366080
@CompanyCode1559[String] = 6373083927883400612
@CompanyCode1560[String] = 6373083918575368225
@CompanyCode1561[String] = 6373083920445075162
@CompanyCode1562[String] = 6373083908618598731
@CompanyCode1563[String] = 6373083911842783146
@CompanyCode1564[String] = 6373083913928202424
@ParentCompanyCode1565[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1594)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1566) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1567,@SiteCode1568,@SiteCode1569,@SiteCode1570,@SiteCode1571,@SiteCode1572,@SiteCode1573,@SiteCode1574,@SiteCode1575,@SiteCode1576,@SiteCode1577,@SiteCode1578,@SiteCode1579,@SiteCode1580,@SiteCode1581,@SiteCode1582,@SiteCode1583,@SiteCode1584,@SiteCode1585,@SiteCode1586,@SiteCode1587,@SiteCode1588,@SiteCode1589,@SiteCode1590,@SiteCode1591,@SiteCode1592,@SiteCode1593)))	
Parameters:
@ProjectId1566[String] = 6372912251695766465
@SiteCode1567[String] = 6373083923489249281
@SiteCode1568[String] = 6373083925531366080
@SiteCode1569[String] = 6373083927883400612
@SiteCode1570[String] = 6373083918575368225
@SiteCode1571[String] = 6373083920445075162
@SiteCode1572[String] = 6373083908618598731
@SiteCode1573[String] = 6373083911842783146
@SiteCode1574[String] = 6373083913928202424
@SiteCode1575[String] = 6373083877551621804
@SiteCode1576[String] = 6373083879921857377
@SiteCode1577[String] = 6373083881542550067
@SiteCode1578[String] = 6373083883689772886
@SiteCode1579[String] = 6373083887136270013
@SiteCode1580[String] = 6373083889697116488
@SiteCode1581[String] = 6373083891969846476
@SiteCode1582[String] = 6373083894422586761
@SiteCode1583[String] = 6373083897509963358
@SiteCode1584[String] = 6373083900444931227
@SiteCode1585[String] = 6373083829464571372
@SiteCode1586[String] = 6373083833327492328
@SiteCode1587[String] = 6373083841964286321
@SiteCode1588[String] = 6373083844982558950
@SiteCode1589[String] = 6373083847585007801
@SiteCode1590[String] = 6373083856887939900
@SiteCode1591[String] = 6373083859102666584
@SiteCode1592[String] = 6373083864919499284
@SiteCode1593[String] = 6373334974514214221
@FDictionaryCode1594[String] = OrderState
@FDictionaryCode1595[String] = UrgentDegree
@FDictionaryCode1596[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1595) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1596) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1594)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1566) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1567,@SiteCode1568,@SiteCode1569,@SiteCode1570,@SiteCode1571,@SiteCode1572,@SiteCode1573,@SiteCode1574,@SiteCode1575,@SiteCode1576,@SiteCode1577,@SiteCode1578,@SiteCode1579,@SiteCode1580,@SiteCode1581,@SiteCode1582,@SiteCode1583,@SiteCode1584,@SiteCode1585,@SiteCode1586,@SiteCode1587,@SiteCode1588,@SiteCode1589,@SiteCode1590,@SiteCode1591,@SiteCode1592,@SiteCode1593))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1566[String] = 6372912251695766465
@SiteCode1567[String] = 6373083923489249281
@SiteCode1568[String] = 6373083925531366080
@SiteCode1569[String] = 6373083927883400612
@SiteCode1570[String] = 6373083918575368225
@SiteCode1571[String] = 6373083920445075162
@SiteCode1572[String] = 6373083908618598731
@SiteCode1573[String] = 6373083911842783146
@SiteCode1574[String] = 6373083913928202424
@SiteCode1575[String] = 6373083877551621804
@SiteCode1576[String] = 6373083879921857377
@SiteCode1577[String] = 6373083881542550067
@SiteCode1578[String] = 6373083883689772886
@SiteCode1579[String] = 6373083887136270013
@SiteCode1580[String] = 6373083889697116488
@SiteCode1581[String] = 6373083891969846476
@SiteCode1582[String] = 6373083894422586761
@SiteCode1583[String] = 6373083897509963358
@SiteCode1584[String] = 6373083900444931227
@SiteCode1585[String] = 6373083829464571372
@SiteCode1586[String] = 6373083833327492328
@SiteCode1587[String] = 6373083841964286321
@SiteCode1588[String] = 6373083844982558950
@SiteCode1589[String] = 6373083847585007801
@SiteCode1590[String] = 6373083856887939900
@SiteCode1591[String] = 6373083859102666584
@SiteCode1592[String] = 6373083864919499284
@SiteCode1593[String] = 6373334974514214221
@FDictionaryCode1594[String] = OrderState
@FDictionaryCode1595[String] = UrgentDegree
@FDictionaryCode1596[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:01:46
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:01:47
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:01:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:01:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:01:47
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:01:50
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:01:50
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:01:50
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:01:51
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:01:58
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1598) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1599) 	
Parameters:
@SiteCode1598[String] = 6373083923489249281
@ComponentCode1599[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-20 11:01:58
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:01:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:01:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1600) 	
Parameters:
@MxGjBm1600[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:01:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1601)) AND ([TbModelOtherInfo].[Type] = @Type1602) 	
Parameters:
@ComponentCode1601[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type1602[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:01:59
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1604) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1605) 	
Parameters:
@SiteCode1604[String] = 6373083923489249281
@ComponentCode1605[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01%


-----------------------------------------------------------------------------
2020-08-20 11:01:59
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:01:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:01:59
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1606,@MxGjBm1607) 	
Parameters:
@MxGjBm1606[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1607[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01


-----------------------------------------------------------------------------
2020-08-20 11:01:59
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1608,@ComponentCode1609)) AND ([TbModelOtherInfo].[Type] = @Type1610) 	
Parameters:
@ComponentCode1608[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1609[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type1610[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:00
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1612) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1613) 	
Parameters:
@SiteCode1612[String] = 6373083923489249281
@ComponentCode1613[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01%


-----------------------------------------------------------------------------
2020-08-20 11:02:00
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:02:00
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:02:00
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1614,@MxGjBm1615,@MxGjBm1616) 	
Parameters:
@MxGjBm1614[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1615[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1616[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:02:00
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1617,@ComponentCode1618,@ComponentCode1619)) AND ([TbModelOtherInfo].[Type] = @Type1620) 	
Parameters:
@ComponentCode1617[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1618[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1619[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1620[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:02:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 11:02:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId1621,@MxGjId1622) 	
Parameters:
@MxGjId1621[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId1622[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 11:02:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1623,@ComponentCode1624)) AND ([TbModelOtherInfo].[Type] = @Type1625) 	
Parameters:
@ComponentCode1623[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode1624[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1625[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1626) AND ([TbModelOtherInfo].[Type] = @Type1627) 	
Parameters:
@ComponentCode1626[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1627[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:08
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1628,@ActionType1629,@HostName1630,@LogDate1631,@UserCode1632,@UserIP1633);select scope_identity()	
Parameters:
@ActionMenu1628[String] = TbModelOtherInfo
@ActionType1629[String] = 编辑
@HostName1630[String] = 
@LogDate1631[DateTime] = 2020/8/20 11:02:08
@UserCode1632[String] = 500000
@UserIP1633[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:08
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1635,[PlanTime]=@PlanTime1636,[Remark]=@Remark1637,[SiteCode]=@SiteCode1638,[Type]=@Type1639,[ProjectId]=@ProjectId1640 WHERE [TbModelOtherInfo].[ID] = @ID1634	
Parameters:
@ComponentCode1635[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1636[DateTime] = 2020/8/12 0:00:00
@Remark1637[String] = 
@SiteCode1638[String] = 6373083923489249281
@Type1639[Int32] = 2
@ProjectId1640[String] = 6372912251695766465
@ID1634[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:02:09
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1641) AND ([TbModelOtherInfo].[Type] = @Type1642) 	
Parameters:
@ComponentCode1641[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1642[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:09
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1643,@ActionType1644,@HostName1645,@LogDate1646,@UserCode1647,@UserIP1648);select scope_identity()	
Parameters:
@ActionMenu1643[String] = TbModelOtherInfo
@ActionType1644[String] = 编辑
@HostName1645[String] = 
@LogDate1646[DateTime] = 2020/8/20 11:02:09
@UserCode1647[String] = 500000
@UserIP1648[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:09
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1650,[PlanTime]=@PlanTime1651,[Remark]=@Remark1652,[SiteCode]=@SiteCode1653,[Type]=@Type1654,[ProjectId]=@ProjectId1655 WHERE [TbModelOtherInfo].[ID] = @ID1649	
Parameters:
@ComponentCode1650[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1651[DateTime] = 2020/8/4 0:00:00
@Remark1652[String] = 
@SiteCode1653[String] = 6373083923489249281
@Type1654[Int32] = 2
@ProjectId1655[String] = 6372912251695766465
@ID1649[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1656) 	
Parameters:
@Type1656[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1657,@ActionType1658,@HostName1659,@LogDate1660,@UserCode1661,@UserIP1662);select scope_identity()	
Parameters:
@ActionMenu1657[String] = TbModelOtherInfo
@ActionType1658[String] = 新增
@HostName1659[String] = 
@LogDate1660[DateTime] = 2020/8/20 11:02:11
@UserCode1661[String] = 500000
@UserIP1662[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1663,@Remark1664,@SiteCode1665,@Type1666,@ProjectId1667);select scope_identity()	
Parameters:
@PlanTime1663[DateTime] = 2020/8/20 0:00:00
@Remark1664[String] = 
@SiteCode1665[String] = 6373083923489249281
@Type1666[Int32] = 1
@ProjectId1667[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1668) 	
Parameters:
@Type1668[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1669,@ActionType1670,@HostName1671,@LogDate1672,@UserCode1673,@UserIP1674);select scope_identity()	
Parameters:
@ActionMenu1669[String] = TbModelOtherInfo
@ActionType1670[String] = 新增
@HostName1671[String] = 
@LogDate1672[DateTime] = 2020/8/20 11:02:11
@UserCode1673[String] = 500000
@UserIP1674[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:11
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1675,@Remark1676,@SiteCode1677,@Type1678,@ProjectId1679);select scope_identity()	
Parameters:
@PlanTime1675[DateTime] = 2020/8/21 0:00:00
@Remark1676[String] = 
@SiteCode1677[String] = 6373083923489249281
@Type1678[Int32] = 1
@ProjectId1679[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:02:16
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1680) 	
Parameters:
@Type1680[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:16
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1681,@ActionType1682,@HostName1683,@LogDate1684,@UserCode1685,@UserIP1686);select scope_identity()	
Parameters:
@ActionMenu1681[String] = TbModelOtherInfo
@ActionType1682[String] = 新增
@HostName1683[String] = 
@LogDate1684[DateTime] = 2020/8/20 11:02:16
@UserCode1685[String] = 500000
@UserIP1686[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:16
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1687,@Remark1688,@SiteCode1689,@Type1690,@ProjectId1691);select scope_identity()	
Parameters:
@PlanTime1687[DateTime] = 2020/8/20 0:00:00
@Remark1688[String] = 
@SiteCode1689[String] = 6373083923489249281
@Type1690[Int32] = 1
@ProjectId1691[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:02:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1692) 	
Parameters:
@Type1692[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:02:18
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1693,@ActionType1694,@HostName1695,@LogDate1696,@UserCode1697,@UserIP1698);select scope_identity()	
Parameters:
@ActionMenu1693[String] = TbModelOtherInfo
@ActionType1694[String] = 新增
@HostName1695[String] = 
@LogDate1696[DateTime] = 2020/8/20 11:02:18
@UserCode1697[String] = 500000
@UserIP1698[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:18
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1699,@Remark1700,@SiteCode1701,@Type1702,@ProjectId1703);select scope_identity()	
Parameters:
@PlanTime1699[DateTime] = 2020/8/21 0:00:00
@Remark1700[String] = 
@SiteCode1701[String] = 6373083923489249281
@Type1702[Int32] = 1
@ProjectId1703[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:02:19
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1704) AND ([TbModelOtherInfo].[Type] = @Type1705) 	
Parameters:
@ComponentCode1704[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1705[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:19
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1706,@ActionType1707,@HostName1708,@LogDate1709,@UserCode1710,@UserIP1711);select scope_identity()	
Parameters:
@ActionMenu1706[String] = TbModelOtherInfo
@ActionType1707[String] = 编辑
@HostName1708[String] = 
@LogDate1709[DateTime] = 2020/8/20 11:02:19
@UserCode1710[String] = 500000
@UserIP1711[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:19
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1713,[PlanTime]=@PlanTime1714,[Remark]=@Remark1715,[SiteCode]=@SiteCode1716,[Type]=@Type1717,[ProjectId]=@ProjectId1718 WHERE [TbModelOtherInfo].[ID] = @ID1712	
Parameters:
@ComponentCode1713[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1714[DateTime] = 2020/8/4 0:00:00
@Remark1715[String] = 
@SiteCode1716[String] = 6373083923489249281
@Type1717[Int32] = 2
@ProjectId1718[String] = 6372912251695766465
@ID1712[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:02:20
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1719) AND ([TbModelOtherInfo].[Type] = @Type1720) 	
Parameters:
@ComponentCode1719[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1720[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:20
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1721,@ActionType1722,@HostName1723,@LogDate1724,@UserCode1725,@UserIP1726);select scope_identity()	
Parameters:
@ActionMenu1721[String] = TbModelOtherInfo
@ActionType1722[String] = 编辑
@HostName1723[String] = 
@LogDate1724[DateTime] = 2020/8/20 11:02:20
@UserCode1725[String] = 500000
@UserIP1726[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:20
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1728,[PlanTime]=@PlanTime1729,[Remark]=@Remark1730,[SiteCode]=@SiteCode1731,[Type]=@Type1732,[ProjectId]=@ProjectId1733 WHERE [TbModelOtherInfo].[ID] = @ID1727	
Parameters:
@ComponentCode1728[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1729[DateTime] = 2020/8/12 0:00:00
@Remark1730[String] = 
@SiteCode1731[String] = 6373083923489249281
@Type1732[Int32] = 2
@ProjectId1733[String] = 6372912251695766465
@ID1727[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:02:23
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1734) AND ([TbModelOtherInfo].[Type] = @Type1735) 	
Parameters:
@ComponentCode1734[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1735[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:23
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1736,@ActionType1737,@HostName1738,@LogDate1739,@UserCode1740,@UserIP1741);select scope_identity()	
Parameters:
@ActionMenu1736[String] = TbModelOtherInfo
@ActionType1737[String] = 编辑
@HostName1738[String] = 
@LogDate1739[DateTime] = 2020/8/20 11:02:23
@UserCode1740[String] = 500000
@UserIP1741[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:23
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1743,[PlanTime]=@PlanTime1744,[Remark]=@Remark1745,[SiteCode]=@SiteCode1746,[Type]=@Type1747,[ProjectId]=@ProjectId1748 WHERE [TbModelOtherInfo].[ID] = @ID1742	
Parameters:
@ComponentCode1743[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@PlanTime1744[DateTime] = 2020/8/12 0:00:00
@Remark1745[String] = 
@SiteCode1746[String] = 6373083923489249281
@Type1747[Int32] = 2
@ProjectId1748[String] = 6372912251695766465
@ID1742[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:02:25
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1749) AND ([TbModelOtherInfo].[Type] = @Type1750) 	
Parameters:
@ComponentCode1749[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@Type1750[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:02:25
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1751,@ActionType1752,@HostName1753,@LogDate1754,@UserCode1755,@UserIP1756);select scope_identity()	
Parameters:
@ActionMenu1751[String] = TbModelOtherInfo
@ActionType1752[String] = 编辑
@HostName1753[String] = 
@LogDate1754[DateTime] = 2020/8/20 11:02:25
@UserCode1755[String] = 500000
@UserIP1756[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:02:25
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1758,[PlanTime]=@PlanTime1759,[Remark]=@Remark1760,[SiteCode]=@SiteCode1761,[Type]=@Type1762,[ProjectId]=@ProjectId1763 WHERE [TbModelOtherInfo].[ID] = @ID1757	
Parameters:
@ComponentCode1758[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@PlanTime1759[DateTime] = 2020/8/4 0:00:00
@Remark1760[String] = 
@SiteCode1761[String] = 6373083923489249281
@Type1762[Int32] = 2
@ProjectId1763[String] = 6372912251695766465
@ID1757[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1764) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1765)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1766,@CompanyCode1767,@CompanyCode1768,@CompanyCode1769,@CompanyCode1770,@CompanyCode1771,@CompanyCode1772,@CompanyCode1773)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1774))) 	
Parameters:
@Type1764[Int32] = 1
@ProjectId1765[String] = 6372912251695766465
@CompanyCode1766[String] = 6373083923489249281
@CompanyCode1767[String] = 6373083925531366080
@CompanyCode1768[String] = 6373083927883400612
@CompanyCode1769[String] = 6373083918575368225
@CompanyCode1770[String] = 6373083920445075162
@CompanyCode1771[String] = 6373083908618598731
@CompanyCode1772[String] = 6373083911842783146
@CompanyCode1773[String] = 6373083913928202424
@ParentCompanyCode1774[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1775) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1776)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1777,@CompanyCode1778,@CompanyCode1779,@CompanyCode1780,@CompanyCode1781,@CompanyCode1782,@CompanyCode1783,@CompanyCode1784)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1785))) 	
Parameters:
@Type1775[Int32] = 2
@ProjectId1776[String] = 6372912251695766465
@CompanyCode1777[String] = 6373083923489249281
@CompanyCode1778[String] = 6373083925531366080
@CompanyCode1779[String] = 6373083927883400612
@CompanyCode1780[String] = 6373083918575368225
@CompanyCode1781[String] = 6373083920445075162
@CompanyCode1782[String] = 6373083908618598731
@CompanyCode1783[String] = 6373083911842783146
@CompanyCode1784[String] = 6373083913928202424
@ParentCompanyCode1785[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1814)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1786) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1787,@SiteCode1788,@SiteCode1789,@SiteCode1790,@SiteCode1791,@SiteCode1792,@SiteCode1793,@SiteCode1794,@SiteCode1795,@SiteCode1796,@SiteCode1797,@SiteCode1798,@SiteCode1799,@SiteCode1800,@SiteCode1801,@SiteCode1802,@SiteCode1803,@SiteCode1804,@SiteCode1805,@SiteCode1806,@SiteCode1807,@SiteCode1808,@SiteCode1809,@SiteCode1810,@SiteCode1811,@SiteCode1812,@SiteCode1813)))	
Parameters:
@ProjectId1786[String] = 6372912251695766465
@SiteCode1787[String] = 6373083923489249281
@SiteCode1788[String] = 6373083925531366080
@SiteCode1789[String] = 6373083927883400612
@SiteCode1790[String] = 6373083918575368225
@SiteCode1791[String] = 6373083920445075162
@SiteCode1792[String] = 6373083908618598731
@SiteCode1793[String] = 6373083911842783146
@SiteCode1794[String] = 6373083913928202424
@SiteCode1795[String] = 6373083877551621804
@SiteCode1796[String] = 6373083879921857377
@SiteCode1797[String] = 6373083881542550067
@SiteCode1798[String] = 6373083883689772886
@SiteCode1799[String] = 6373083887136270013
@SiteCode1800[String] = 6373083889697116488
@SiteCode1801[String] = 6373083891969846476
@SiteCode1802[String] = 6373083894422586761
@SiteCode1803[String] = 6373083897509963358
@SiteCode1804[String] = 6373083900444931227
@SiteCode1805[String] = 6373083829464571372
@SiteCode1806[String] = 6373083833327492328
@SiteCode1807[String] = 6373083841964286321
@SiteCode1808[String] = 6373083844982558950
@SiteCode1809[String] = 6373083847585007801
@SiteCode1810[String] = 6373083856887939900
@SiteCode1811[String] = 6373083859102666584
@SiteCode1812[String] = 6373083864919499284
@SiteCode1813[String] = 6373334974514214221
@FDictionaryCode1814[String] = OrderState
@FDictionaryCode1815[String] = UrgentDegree
@FDictionaryCode1816[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1815) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1816) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1814)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1786) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1787,@SiteCode1788,@SiteCode1789,@SiteCode1790,@SiteCode1791,@SiteCode1792,@SiteCode1793,@SiteCode1794,@SiteCode1795,@SiteCode1796,@SiteCode1797,@SiteCode1798,@SiteCode1799,@SiteCode1800,@SiteCode1801,@SiteCode1802,@SiteCode1803,@SiteCode1804,@SiteCode1805,@SiteCode1806,@SiteCode1807,@SiteCode1808,@SiteCode1809,@SiteCode1810,@SiteCode1811,@SiteCode1812,@SiteCode1813))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1786[String] = 6372912251695766465
@SiteCode1787[String] = 6373083923489249281
@SiteCode1788[String] = 6373083925531366080
@SiteCode1789[String] = 6373083927883400612
@SiteCode1790[String] = 6373083918575368225
@SiteCode1791[String] = 6373083920445075162
@SiteCode1792[String] = 6373083908618598731
@SiteCode1793[String] = 6373083911842783146
@SiteCode1794[String] = 6373083913928202424
@SiteCode1795[String] = 6373083877551621804
@SiteCode1796[String] = 6373083879921857377
@SiteCode1797[String] = 6373083881542550067
@SiteCode1798[String] = 6373083883689772886
@SiteCode1799[String] = 6373083887136270013
@SiteCode1800[String] = 6373083889697116488
@SiteCode1801[String] = 6373083891969846476
@SiteCode1802[String] = 6373083894422586761
@SiteCode1803[String] = 6373083897509963358
@SiteCode1804[String] = 6373083900444931227
@SiteCode1805[String] = 6373083829464571372
@SiteCode1806[String] = 6373083833327492328
@SiteCode1807[String] = 6373083841964286321
@SiteCode1808[String] = 6373083844982558950
@SiteCode1809[String] = 6373083847585007801
@SiteCode1810[String] = 6373083856887939900
@SiteCode1811[String] = 6373083859102666584
@SiteCode1812[String] = 6373083864919499284
@SiteCode1813[String] = 6373334974514214221
@FDictionaryCode1814[String] = OrderState
@FDictionaryCode1815[String] = UrgentDegree
@FDictionaryCode1816[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:03:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:03:10
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:03:10
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:03:10
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:03:10
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:06:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:06:05
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:06:05
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:06:06
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:06:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:06:11
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1818) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1819) 	
Parameters:
@SiteCode1818[String] = 6373083923489249281
@ComponentCode1819[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:06:11
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:11
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:11
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1820,@MxGjBm1821,@MxGjBm1822) 	
Parameters:
@MxGjBm1820[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1821[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1822[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:06:11
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1823,@ComponentCode1824,@ComponentCode1825)) AND ([TbModelOtherInfo].[Type] = @Type1826) 	
Parameters:
@ComponentCode1823[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1824[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1825[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1826[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:06:55
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:55
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:55
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1827,@MxGjBm1828,@MxGjBm1829) 	
Parameters:
@MxGjBm1827[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1828[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1829[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:06:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1830,@ComponentCode1831,@ComponentCode1832)) AND ([TbModelOtherInfo].[Type] = @Type1833) 	
Parameters:
@ComponentCode1830[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1831[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1832[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1833[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:06:57
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:57
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:06:57
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1834,@MxGjBm1835,@MxGjBm1836) 	
Parameters:
@MxGjBm1834[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1835[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1836[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:06:57
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1837,@ComponentCode1838,@ComponentCode1839)) AND ([TbModelOtherInfo].[Type] = @Type1840) 	
Parameters:
@ComponentCode1837[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1838[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1839[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1840[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:07:02
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:07:02
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:07:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1841) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1842)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1843,@CompanyCode1844,@CompanyCode1845,@CompanyCode1846,@CompanyCode1847,@CompanyCode1848,@CompanyCode1849,@CompanyCode1850)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1851))) 	
Parameters:
@Type1841[Int32] = 1
@ProjectId1842[String] = 6372912251695766465
@CompanyCode1843[String] = 6373083923489249281
@CompanyCode1844[String] = 6373083925531366080
@CompanyCode1845[String] = 6373083927883400612
@CompanyCode1846[String] = 6373083918575368225
@CompanyCode1847[String] = 6373083920445075162
@CompanyCode1848[String] = 6373083908618598731
@CompanyCode1849[String] = 6373083911842783146
@CompanyCode1850[String] = 6373083913928202424
@ParentCompanyCode1851[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1852) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1853)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1854,@CompanyCode1855,@CompanyCode1856,@CompanyCode1857,@CompanyCode1858,@CompanyCode1859,@CompanyCode1860,@CompanyCode1861)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1862))) 	
Parameters:
@Type1852[Int32] = 2
@ProjectId1853[String] = 6372912251695766465
@CompanyCode1854[String] = 6373083923489249281
@CompanyCode1855[String] = 6373083925531366080
@CompanyCode1856[String] = 6373083927883400612
@CompanyCode1857[String] = 6373083918575368225
@CompanyCode1858[String] = 6373083920445075162
@CompanyCode1859[String] = 6373083908618598731
@CompanyCode1860[String] = 6373083911842783146
@CompanyCode1861[String] = 6373083913928202424
@ParentCompanyCode1862[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1891)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1863) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1864,@SiteCode1865,@SiteCode1866,@SiteCode1867,@SiteCode1868,@SiteCode1869,@SiteCode1870,@SiteCode1871,@SiteCode1872,@SiteCode1873,@SiteCode1874,@SiteCode1875,@SiteCode1876,@SiteCode1877,@SiteCode1878,@SiteCode1879,@SiteCode1880,@SiteCode1881,@SiteCode1882,@SiteCode1883,@SiteCode1884,@SiteCode1885,@SiteCode1886,@SiteCode1887,@SiteCode1888,@SiteCode1889,@SiteCode1890)))	
Parameters:
@ProjectId1863[String] = 6372912251695766465
@SiteCode1864[String] = 6373083923489249281
@SiteCode1865[String] = 6373083925531366080
@SiteCode1866[String] = 6373083927883400612
@SiteCode1867[String] = 6373083918575368225
@SiteCode1868[String] = 6373083920445075162
@SiteCode1869[String] = 6373083908618598731
@SiteCode1870[String] = 6373083911842783146
@SiteCode1871[String] = 6373083913928202424
@SiteCode1872[String] = 6373083877551621804
@SiteCode1873[String] = 6373083879921857377
@SiteCode1874[String] = 6373083881542550067
@SiteCode1875[String] = 6373083883689772886
@SiteCode1876[String] = 6373083887136270013
@SiteCode1877[String] = 6373083889697116488
@SiteCode1878[String] = 6373083891969846476
@SiteCode1879[String] = 6373083894422586761
@SiteCode1880[String] = 6373083897509963358
@SiteCode1881[String] = 6373083900444931227
@SiteCode1882[String] = 6373083829464571372
@SiteCode1883[String] = 6373083833327492328
@SiteCode1884[String] = 6373083841964286321
@SiteCode1885[String] = 6373083844982558950
@SiteCode1886[String] = 6373083847585007801
@SiteCode1887[String] = 6373083856887939900
@SiteCode1888[String] = 6373083859102666584
@SiteCode1889[String] = 6373083864919499284
@SiteCode1890[String] = 6373334974514214221
@FDictionaryCode1891[String] = OrderState
@FDictionaryCode1892[String] = UrgentDegree
@FDictionaryCode1893[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1892) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1893) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1891)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1863) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1864,@SiteCode1865,@SiteCode1866,@SiteCode1867,@SiteCode1868,@SiteCode1869,@SiteCode1870,@SiteCode1871,@SiteCode1872,@SiteCode1873,@SiteCode1874,@SiteCode1875,@SiteCode1876,@SiteCode1877,@SiteCode1878,@SiteCode1879,@SiteCode1880,@SiteCode1881,@SiteCode1882,@SiteCode1883,@SiteCode1884,@SiteCode1885,@SiteCode1886,@SiteCode1887,@SiteCode1888,@SiteCode1889,@SiteCode1890))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1863[String] = 6372912251695766465
@SiteCode1864[String] = 6373083923489249281
@SiteCode1865[String] = 6373083925531366080
@SiteCode1866[String] = 6373083927883400612
@SiteCode1867[String] = 6373083918575368225
@SiteCode1868[String] = 6373083920445075162
@SiteCode1869[String] = 6373083908618598731
@SiteCode1870[String] = 6373083911842783146
@SiteCode1871[String] = 6373083913928202424
@SiteCode1872[String] = 6373083877551621804
@SiteCode1873[String] = 6373083879921857377
@SiteCode1874[String] = 6373083881542550067
@SiteCode1875[String] = 6373083883689772886
@SiteCode1876[String] = 6373083887136270013
@SiteCode1877[String] = 6373083889697116488
@SiteCode1878[String] = 6373083891969846476
@SiteCode1879[String] = 6373083894422586761
@SiteCode1880[String] = 6373083897509963358
@SiteCode1881[String] = 6373083900444931227
@SiteCode1882[String] = 6373083829464571372
@SiteCode1883[String] = 6373083833327492328
@SiteCode1884[String] = 6373083841964286321
@SiteCode1885[String] = 6373083844982558950
@SiteCode1886[String] = 6373083847585007801
@SiteCode1887[String] = 6373083856887939900
@SiteCode1888[String] = 6373083859102666584
@SiteCode1889[String] = 6373083864919499284
@SiteCode1890[String] = 6373334974514214221
@FDictionaryCode1891[String] = OrderState
@FDictionaryCode1892[String] = UrgentDegree
@FDictionaryCode1893[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:07:03
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:07:04
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:07:07
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:07:07
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:07:07
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:07:08
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:07:13
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1895) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1896) 	
Parameters:
@SiteCode1895[String] = 6373083923489249281
@ComponentCode1896[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:07:13
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:07:13
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:07:13
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1897,@MxGjBm1898,@MxGjBm1899) 	
Parameters:
@MxGjBm1897[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1898[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1899[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:07:13
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1900,@ComponentCode1901,@ComponentCode1902)) AND ([TbModelOtherInfo].[Type] = @Type1903) 	
Parameters:
@ComponentCode1900[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1901[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1902[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1903[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:10:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:10:36
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:10:36
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:10:36
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1904) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1905)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1906,@CompanyCode1907,@CompanyCode1908,@CompanyCode1909,@CompanyCode1910,@CompanyCode1911,@CompanyCode1912,@CompanyCode1913)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1914))) 	
Parameters:
@Type1904[Int32] = 1
@ProjectId1905[String] = 6372912251695766465
@CompanyCode1906[String] = 6373083923489249281
@CompanyCode1907[String] = 6373083925531366080
@CompanyCode1908[String] = 6373083927883400612
@CompanyCode1909[String] = 6373083918575368225
@CompanyCode1910[String] = 6373083920445075162
@CompanyCode1911[String] = 6373083908618598731
@CompanyCode1912[String] = 6373083911842783146
@CompanyCode1913[String] = 6373083913928202424
@ParentCompanyCode1914[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1915) AND ([TbOrganizationMap].[ProjectId] = @ProjectId1916)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode1917,@CompanyCode1918,@CompanyCode1919,@CompanyCode1920,@CompanyCode1921,@CompanyCode1922,@CompanyCode1923,@CompanyCode1924)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode1925))) 	
Parameters:
@Type1915[Int32] = 2
@ProjectId1916[String] = 6372912251695766465
@CompanyCode1917[String] = 6373083923489249281
@CompanyCode1918[String] = 6373083925531366080
@CompanyCode1919[String] = 6373083927883400612
@CompanyCode1920[String] = 6373083918575368225
@CompanyCode1921[String] = 6373083920445075162
@CompanyCode1922[String] = 6373083908618598731
@CompanyCode1923[String] = 6373083911842783146
@CompanyCode1924[String] = 6373083913928202424
@ParentCompanyCode1925[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1954)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1926) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1927,@SiteCode1928,@SiteCode1929,@SiteCode1930,@SiteCode1931,@SiteCode1932,@SiteCode1933,@SiteCode1934,@SiteCode1935,@SiteCode1936,@SiteCode1937,@SiteCode1938,@SiteCode1939,@SiteCode1940,@SiteCode1941,@SiteCode1942,@SiteCode1943,@SiteCode1944,@SiteCode1945,@SiteCode1946,@SiteCode1947,@SiteCode1948,@SiteCode1949,@SiteCode1950,@SiteCode1951,@SiteCode1952,@SiteCode1953)))	
Parameters:
@ProjectId1926[String] = 6372912251695766465
@SiteCode1927[String] = 6373083923489249281
@SiteCode1928[String] = 6373083925531366080
@SiteCode1929[String] = 6373083927883400612
@SiteCode1930[String] = 6373083918575368225
@SiteCode1931[String] = 6373083920445075162
@SiteCode1932[String] = 6373083908618598731
@SiteCode1933[String] = 6373083911842783146
@SiteCode1934[String] = 6373083913928202424
@SiteCode1935[String] = 6373083877551621804
@SiteCode1936[String] = 6373083879921857377
@SiteCode1937[String] = 6373083881542550067
@SiteCode1938[String] = 6373083883689772886
@SiteCode1939[String] = 6373083887136270013
@SiteCode1940[String] = 6373083889697116488
@SiteCode1941[String] = 6373083891969846476
@SiteCode1942[String] = 6373083894422586761
@SiteCode1943[String] = 6373083897509963358
@SiteCode1944[String] = 6373083900444931227
@SiteCode1945[String] = 6373083829464571372
@SiteCode1946[String] = 6373083833327492328
@SiteCode1947[String] = 6373083841964286321
@SiteCode1948[String] = 6373083844982558950
@SiteCode1949[String] = 6373083847585007801
@SiteCode1950[String] = 6373083856887939900
@SiteCode1951[String] = 6373083859102666584
@SiteCode1952[String] = 6373083864919499284
@SiteCode1953[String] = 6373334974514214221
@FDictionaryCode1954[String] = OrderState
@FDictionaryCode1955[String] = UrgentDegree
@FDictionaryCode1956[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:10:37
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1955) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1956) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode1954)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId1926) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode1927,@SiteCode1928,@SiteCode1929,@SiteCode1930,@SiteCode1931,@SiteCode1932,@SiteCode1933,@SiteCode1934,@SiteCode1935,@SiteCode1936,@SiteCode1937,@SiteCode1938,@SiteCode1939,@SiteCode1940,@SiteCode1941,@SiteCode1942,@SiteCode1943,@SiteCode1944,@SiteCode1945,@SiteCode1946,@SiteCode1947,@SiteCode1948,@SiteCode1949,@SiteCode1950,@SiteCode1951,@SiteCode1952,@SiteCode1953))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId1926[String] = 6372912251695766465
@SiteCode1927[String] = 6373083923489249281
@SiteCode1928[String] = 6373083925531366080
@SiteCode1929[String] = 6373083927883400612
@SiteCode1930[String] = 6373083918575368225
@SiteCode1931[String] = 6373083920445075162
@SiteCode1932[String] = 6373083908618598731
@SiteCode1933[String] = 6373083911842783146
@SiteCode1934[String] = 6373083913928202424
@SiteCode1935[String] = 6373083877551621804
@SiteCode1936[String] = 6373083879921857377
@SiteCode1937[String] = 6373083881542550067
@SiteCode1938[String] = 6373083883689772886
@SiteCode1939[String] = 6373083887136270013
@SiteCode1940[String] = 6373083889697116488
@SiteCode1941[String] = 6373083891969846476
@SiteCode1942[String] = 6373083894422586761
@SiteCode1943[String] = 6373083897509963358
@SiteCode1944[String] = 6373083900444931227
@SiteCode1945[String] = 6373083829464571372
@SiteCode1946[String] = 6373083833327492328
@SiteCode1947[String] = 6373083841964286321
@SiteCode1948[String] = 6373083844982558950
@SiteCode1949[String] = 6373083847585007801
@SiteCode1950[String] = 6373083856887939900
@SiteCode1951[String] = 6373083859102666584
@SiteCode1952[String] = 6373083864919499284
@SiteCode1953[String] = 6373334974514214221
@FDictionaryCode1954[String] = OrderState
@FDictionaryCode1955[String] = UrgentDegree
@FDictionaryCode1956[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:10:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:10:38
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:10:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:10:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:10:38
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:10:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:10:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:10:42
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:10:43
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:10:47
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1958) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1959) 	
Parameters:
@SiteCode1958[String] = 6373083923489249281
@ComponentCode1959[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:10:47
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:10:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:10:47
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1960,@MxGjBm1961,@MxGjBm1962) 	
Parameters:
@MxGjBm1960[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm1961[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm1962[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:10:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1963,@ComponentCode1964,@ComponentCode1965)) AND ([TbModelOtherInfo].[Type] = @Type1966) 	
Parameters:
@ComponentCode1963[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode1964[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode1965[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type1966[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:10:50
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:10:50
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:10:50
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId1967,@MxGjId1968) 	
Parameters:
@MxGjId1967[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId1968[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:10:50
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1969,@ComponentCode1970)) AND ([TbModelOtherInfo].[Type] = @Type1971) 	
Parameters:
@ComponentCode1969[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode1970[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type1971[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:10:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type1972) 	
Parameters:
@Type1972[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:10:57
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1973,@ActionType1974,@HostName1975,@LogDate1976,@UserCode1977,@UserIP1978);select scope_identity()	
Parameters:
@ActionMenu1973[String] = TbModelOtherInfo
@ActionType1974[String] = 新增
@HostName1975[String] = 
@LogDate1976[DateTime] = 2020/8/20 11:10:57
@UserCode1977[String] = 500000
@UserIP1978[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:10:57
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime1979,@Remark1980,@SiteCode1981,@Type1982,@ProjectId1983);select scope_identity()	
Parameters:
@PlanTime1979[DateTime] = 2020/8/20 0:00:00
@Remark1980[String] = 
@SiteCode1981[String] = 6373083923489249281
@Type1982[Int32] = 1
@ProjectId1983[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:10:59
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1984) AND ([TbModelOtherInfo].[Type] = @Type1985) 	
Parameters:
@ComponentCode1984[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type1985[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:10:59
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu1986,@ActionType1987,@HostName1988,@LogDate1989,@UserCode1990,@UserIP1991);select scope_identity()	
Parameters:
@ActionMenu1986[String] = TbModelOtherInfo
@ActionType1987[String] = 编辑
@HostName1988[String] = 
@LogDate1989[DateTime] = 2020/8/20 11:10:59
@UserCode1990[String] = 500000
@UserIP1991[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:10:59
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode1993,[PlanTime]=@PlanTime1994,[Remark]=@Remark1995,[SiteCode]=@SiteCode1996,[Type]=@Type1997,[ProjectId]=@ProjectId1998 WHERE [TbModelOtherInfo].[ID] = @ID1992	
Parameters:
@ComponentCode1993[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime1994[DateTime] = 2020/8/20 0:00:00
@Remark1995[String] = 
@SiteCode1996[String] = 6373083923489249281
@Type1997[Int32] = 2
@ProjectId1998[String] = 6372912251695766465
@ID1992[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:11:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode1999) AND ([TbModelOtherInfo].[Type] = @Type2000) 	
Parameters:
@ComponentCode1999[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type2000[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:11:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2001,@ActionType2002,@HostName2003,@LogDate2004,@UserCode2005,@UserIP2006);select scope_identity()	
Parameters:
@ActionMenu2001[String] = TbModelOtherInfo
@ActionType2002[String] = 编辑
@HostName2003[String] = 
@LogDate2004[DateTime] = 2020/8/20 11:11:00
@UserCode2005[String] = 500000
@UserIP2006[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:00
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode2008,[PlanTime]=@PlanTime2009,[Remark]=@Remark2010,[SiteCode]=@SiteCode2011,[Type]=@Type2012,[ProjectId]=@ProjectId2013 WHERE [TbModelOtherInfo].[ID] = @ID2007	
Parameters:
@ComponentCode2008[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime2009[DateTime] = 2020/8/11 0:00:00
@Remark2010[String] = 
@SiteCode2011[String] = 6373083923489249281
@Type2012[Int32] = 2
@ProjectId2013[String] = 6372912251695766465
@ID2007[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:11:01
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2014) 	
Parameters:
@Type2014[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:11:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2015,@ActionType2016,@HostName2017,@LogDate2018,@UserCode2019,@UserIP2020);select scope_identity()	
Parameters:
@ActionMenu2015[String] = TbModelOtherInfo
@ActionType2016[String] = 新增
@HostName2017[String] = 
@LogDate2018[DateTime] = 2020/8/20 11:11:01
@UserCode2019[String] = 500000
@UserIP2020[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:01
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2021,@Remark2022,@SiteCode2023,@Type2024,@ProjectId2025);select scope_identity()	
Parameters:
@PlanTime2021[DateTime] = 2020/8/20 0:00:00
@Remark2022[String] = 
@SiteCode2023[String] = 6373083923489249281
@Type2024[Int32] = 1
@ProjectId2025[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:11:02
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode2026) AND ([TbModelOtherInfo].[Type] = @Type2027) 	
Parameters:
@ComponentCode2026[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type2027[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:11:02
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2028,@ActionType2029,@HostName2030,@LogDate2031,@UserCode2032,@UserIP2033);select scope_identity()	
Parameters:
@ActionMenu2028[String] = TbModelOtherInfo
@ActionType2029[String] = 编辑
@HostName2030[String] = 
@LogDate2031[DateTime] = 2020/8/20 11:11:02
@UserCode2032[String] = 500000
@UserIP2033[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:02
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode2035,[PlanTime]=@PlanTime2036,[Remark]=@Remark2037,[SiteCode]=@SiteCode2038,[Type]=@Type2039,[ProjectId]=@ProjectId2040 WHERE [TbModelOtherInfo].[ID] = @ID2034	
Parameters:
@ComponentCode2035[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime2036[DateTime] = 2020/8/11 0:00:00
@Remark2037[String] = 
@SiteCode2038[String] = 6373083923489249281
@Type2039[Int32] = 2
@ProjectId2040[String] = 6372912251695766465
@ID2034[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:11:03
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2041) 	
Parameters:
@Type2041[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:11:03
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2042,@ActionType2043,@HostName2044,@LogDate2045,@UserCode2046,@UserIP2047);select scope_identity()	
Parameters:
@ActionMenu2042[String] = TbModelOtherInfo
@ActionType2043[String] = 新增
@HostName2044[String] = 
@LogDate2045[DateTime] = 2020/8/20 11:11:03
@UserCode2046[String] = 500000
@UserIP2047[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:03
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2048,@Remark2049,@SiteCode2050,@Type2051,@ProjectId2052);select scope_identity()	
Parameters:
@PlanTime2048[DateTime] = 2020/8/20 0:00:00
@Remark2049[String] = 
@SiteCode2050[String] = 6373083923489249281
@Type2051[Int32] = 1
@ProjectId2052[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:11:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2053) 	
Parameters:
@Type2053[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:11:04
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2054,@ActionType2055,@HostName2056,@LogDate2057,@UserCode2058,@UserIP2059);select scope_identity()	
Parameters:
@ActionMenu2054[String] = TbModelOtherInfo
@ActionType2055[String] = 新增
@HostName2056[String] = 
@LogDate2057[DateTime] = 2020/8/20 11:11:04
@UserCode2058[String] = 500000
@UserIP2059[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:04
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2060,@Remark2061,@SiteCode2062,@Type2063,@ProjectId2064);select scope_identity()	
Parameters:
@PlanTime2060[DateTime] = 2020/8/21 0:00:00
@Remark2061[String] = 
@SiteCode2062[String] = 6373083923489249281
@Type2063[Int32] = 1
@ProjectId2064[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode2065) AND ([TbModelOtherInfo].[Type] = @Type2066) 	
Parameters:
@ComponentCode2065[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2066[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2067,@ActionType2068,@HostName2069,@LogDate2070,@UserCode2071,@UserIP2072);select scope_identity()	
Parameters:
@ActionMenu2067[String] = TbModelOtherInfo
@ActionType2068[String] = 编辑
@HostName2069[String] = 
@LogDate2070[DateTime] = 2020/8/20 11:11:05
@UserCode2071[String] = 500000
@UserIP2072[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode2074,[PlanTime]=@PlanTime2075,[Remark]=@Remark2076,[SiteCode]=@SiteCode2077,[Type]=@Type2078,[ProjectId]=@ProjectId2079 WHERE [TbModelOtherInfo].[ID] = @ID2073	
Parameters:
@ComponentCode2074[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime2075[DateTime] = 2020/8/20 0:00:00
@Remark2076[String] = 
@SiteCode2077[String] = 6373083923489249281
@Type2078[Int32] = 2
@ProjectId2079[String] = 6372912251695766465
@ID2073[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode2080) AND ([TbModelOtherInfo].[Type] = @Type2081) 	
Parameters:
@ComponentCode2080[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type2081[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2082,@ActionType2083,@HostName2084,@LogDate2085,@UserCode2086,@UserIP2087);select scope_identity()	
Parameters:
@ActionMenu2082[String] = TbModelOtherInfo
@ActionType2083[String] = 编辑
@HostName2084[String] = 
@LogDate2085[DateTime] = 2020/8/20 11:11:05
@UserCode2086[String] = 500000
@UserIP2087[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:05
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode2089,[PlanTime]=@PlanTime2090,[Remark]=@Remark2091,[SiteCode]=@SiteCode2092,[Type]=@Type2093,[ProjectId]=@ProjectId2094 WHERE [TbModelOtherInfo].[ID] = @ID2088	
Parameters:
@ComponentCode2089[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime2090[DateTime] = 2020/8/11 0:00:00
@Remark2091[String] = 
@SiteCode2092[String] = 6373083923489249281
@Type2093[Int32] = 2
@ProjectId2094[String] = 6372912251695766465
@ID2088[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:11:06
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2095) 	
Parameters:
@Type2095[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:11:06
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2096,@ActionType2097,@HostName2098,@LogDate2099,@UserCode2100,@UserIP2101);select scope_identity()	
Parameters:
@ActionMenu2096[String] = TbModelOtherInfo
@ActionType2097[String] = 新增
@HostName2098[String] = 
@LogDate2099[DateTime] = 2020/8/20 11:11:06
@UserCode2100[String] = 500000
@UserIP2101[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:11:06
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2102,@Remark2103,@SiteCode2104,@Type2105,@ProjectId2106);select scope_identity()	
Parameters:
@PlanTime2102[DateTime] = 2020/8/20 0:00:00
@Remark2103[String] = 
@SiteCode2104[String] = 6373083923489249281
@Type2105[Int32] = 1
@ProjectId2106[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2107) 	
Parameters:
@Type2107[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2108,@ActionType2109,@HostName2110,@LogDate2111,@UserCode2112,@UserIP2113);select scope_identity()	
Parameters:
@ActionMenu2108[String] = TbModelOtherInfo
@ActionType2109[String] = 新增
@HostName2110[String] = 
@LogDate2111[DateTime] = 2020/8/20 11:13:00
@UserCode2112[String] = 500000
@UserIP2113[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2114,@Remark2115,@SiteCode2116,@Type2117,@ProjectId2118);select scope_identity()	
Parameters:
@PlanTime2114[DateTime] = 2020/8/11 0:00:00
@Remark2115[String] = 
@SiteCode2116[String] = 6373083923489249281
@Type2117[Int32] = 1
@ProjectId2118[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId2119,@MxGjId2120) 	
Parameters:
@MxGjId2119[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId2120[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:13:00
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode2121,@ComponentCode2122)) AND ([TbModelOtherInfo].[Type] = @Type2123) 	
Parameters:
@ComponentCode2121[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode2122[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2123[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:13:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2124) 	
Parameters:
@Type2124[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:13:04
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2125,@ActionType2126,@HostName2127,@LogDate2128,@UserCode2129,@UserIP2130);select scope_identity()	
Parameters:
@ActionMenu2125[String] = TbModelOtherInfo
@ActionType2126[String] = 新增
@HostName2127[String] = 
@LogDate2128[DateTime] = 2020/8/20 11:13:04
@UserCode2129[String] = 500000
@UserIP2130[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:13:04
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2131,@Remark2132,@SiteCode2133,@Type2134,@ProjectId2135);select scope_identity()	
Parameters:
@PlanTime2131[DateTime] = 2020/8/21 0:00:00
@Remark2132[String] = 
@SiteCode2133[String] = 6373083923489249281
@Type2134[Int32] = 1
@ProjectId2135[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2136) 	
Parameters:
@Type2136[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2137,@ActionType2138,@HostName2139,@LogDate2140,@UserCode2141,@UserIP2142);select scope_identity()	
Parameters:
@ActionMenu2137[String] = TbModelOtherInfo
@ActionType2138[String] = 新增
@HostName2139[String] = 
@LogDate2140[DateTime] = 2020/8/20 11:13:10
@UserCode2141[String] = 500000
@UserIP2142[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2143,@Remark2144,@SiteCode2145,@Type2146,@ProjectId2147);select scope_identity()	
Parameters:
@PlanTime2143[DateTime] = 2020/8/13 0:00:00
@Remark2144[String] = 
@SiteCode2145[String] = 6373083923489249281
@Type2146[Int32] = 1
@ProjectId2147[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId2148,@MxGjId2149) 	
Parameters:
@MxGjId2148[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId2149[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:13:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode2150,@ComponentCode2151)) AND ([TbModelOtherInfo].[Type] = @Type2152) 	
Parameters:
@ComponentCode2150[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode2151[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2152[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:13:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:14:36
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:14:36
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:14:36
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type2153) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2154)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode2155,@CompanyCode2156,@CompanyCode2157,@CompanyCode2158,@CompanyCode2159,@CompanyCode2160,@CompanyCode2161,@CompanyCode2162)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode2163))) 	
Parameters:
@Type2153[Int32] = 1
@ProjectId2154[String] = 6372912251695766465
@CompanyCode2155[String] = 6373083923489249281
@CompanyCode2156[String] = 6373083925531366080
@CompanyCode2157[String] = 6373083927883400612
@CompanyCode2158[String] = 6373083918575368225
@CompanyCode2159[String] = 6373083920445075162
@CompanyCode2160[String] = 6373083908618598731
@CompanyCode2161[String] = 6373083911842783146
@CompanyCode2162[String] = 6373083913928202424
@ParentCompanyCode2163[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type2164) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2165)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode2166,@CompanyCode2167,@CompanyCode2168,@CompanyCode2169,@CompanyCode2170,@CompanyCode2171,@CompanyCode2172,@CompanyCode2173)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode2174))) 	
Parameters:
@Type2164[Int32] = 2
@ProjectId2165[String] = 6372912251695766465
@CompanyCode2166[String] = 6373083923489249281
@CompanyCode2167[String] = 6373083925531366080
@CompanyCode2168[String] = 6373083927883400612
@CompanyCode2169[String] = 6373083918575368225
@CompanyCode2170[String] = 6373083920445075162
@CompanyCode2171[String] = 6373083908618598731
@CompanyCode2172[String] = 6373083911842783146
@CompanyCode2173[String] = 6373083913928202424
@ParentCompanyCode2174[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode2203)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId2175) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode2176,@SiteCode2177,@SiteCode2178,@SiteCode2179,@SiteCode2180,@SiteCode2181,@SiteCode2182,@SiteCode2183,@SiteCode2184,@SiteCode2185,@SiteCode2186,@SiteCode2187,@SiteCode2188,@SiteCode2189,@SiteCode2190,@SiteCode2191,@SiteCode2192,@SiteCode2193,@SiteCode2194,@SiteCode2195,@SiteCode2196,@SiteCode2197,@SiteCode2198,@SiteCode2199,@SiteCode2200,@SiteCode2201,@SiteCode2202)))	
Parameters:
@ProjectId2175[String] = 6372912251695766465
@SiteCode2176[String] = 6373083923489249281
@SiteCode2177[String] = 6373083925531366080
@SiteCode2178[String] = 6373083927883400612
@SiteCode2179[String] = 6373083918575368225
@SiteCode2180[String] = 6373083920445075162
@SiteCode2181[String] = 6373083908618598731
@SiteCode2182[String] = 6373083911842783146
@SiteCode2183[String] = 6373083913928202424
@SiteCode2184[String] = 6373083877551621804
@SiteCode2185[String] = 6373083879921857377
@SiteCode2186[String] = 6373083881542550067
@SiteCode2187[String] = 6373083883689772886
@SiteCode2188[String] = 6373083887136270013
@SiteCode2189[String] = 6373083889697116488
@SiteCode2190[String] = 6373083891969846476
@SiteCode2191[String] = 6373083894422586761
@SiteCode2192[String] = 6373083897509963358
@SiteCode2193[String] = 6373083900444931227
@SiteCode2194[String] = 6373083829464571372
@SiteCode2195[String] = 6373083833327492328
@SiteCode2196[String] = 6373083841964286321
@SiteCode2197[String] = 6373083844982558950
@SiteCode2198[String] = 6373083847585007801
@SiteCode2199[String] = 6373083856887939900
@SiteCode2200[String] = 6373083859102666584
@SiteCode2201[String] = 6373083864919499284
@SiteCode2202[String] = 6373334974514214221
@FDictionaryCode2203[String] = OrderState
@FDictionaryCode2204[String] = UrgentDegree
@FDictionaryCode2205[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:14:37
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode2204) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode2205) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode2203)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId2175) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode2176,@SiteCode2177,@SiteCode2178,@SiteCode2179,@SiteCode2180,@SiteCode2181,@SiteCode2182,@SiteCode2183,@SiteCode2184,@SiteCode2185,@SiteCode2186,@SiteCode2187,@SiteCode2188,@SiteCode2189,@SiteCode2190,@SiteCode2191,@SiteCode2192,@SiteCode2193,@SiteCode2194,@SiteCode2195,@SiteCode2196,@SiteCode2197,@SiteCode2198,@SiteCode2199,@SiteCode2200,@SiteCode2201,@SiteCode2202))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId2175[String] = 6372912251695766465
@SiteCode2176[String] = 6373083923489249281
@SiteCode2177[String] = 6373083925531366080
@SiteCode2178[String] = 6373083927883400612
@SiteCode2179[String] = 6373083918575368225
@SiteCode2180[String] = 6373083920445075162
@SiteCode2181[String] = 6373083908618598731
@SiteCode2182[String] = 6373083911842783146
@SiteCode2183[String] = 6373083913928202424
@SiteCode2184[String] = 6373083877551621804
@SiteCode2185[String] = 6373083879921857377
@SiteCode2186[String] = 6373083881542550067
@SiteCode2187[String] = 6373083883689772886
@SiteCode2188[String] = 6373083887136270013
@SiteCode2189[String] = 6373083889697116488
@SiteCode2190[String] = 6373083891969846476
@SiteCode2191[String] = 6373083894422586761
@SiteCode2192[String] = 6373083897509963358
@SiteCode2193[String] = 6373083900444931227
@SiteCode2194[String] = 6373083829464571372
@SiteCode2195[String] = 6373083833327492328
@SiteCode2196[String] = 6373083841964286321
@SiteCode2197[String] = 6373083844982558950
@SiteCode2198[String] = 6373083847585007801
@SiteCode2199[String] = 6373083856887939900
@SiteCode2200[String] = 6373083859102666584
@SiteCode2201[String] = 6373083864919499284
@SiteCode2202[String] = 6373334974514214221
@FDictionaryCode2203[String] = OrderState
@FDictionaryCode2204[String] = UrgentDegree
@FDictionaryCode2205[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:14:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:14:38
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:14:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:14:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:14:38
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:14:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:14:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:14:42
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:14:43
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:14:47
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode2207) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode2208) 	
Parameters:
@SiteCode2207[String] = 6373083923489249281
@ComponentCode2208[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:14:47
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:14:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:14:47
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm2209,@MxGjBm2210,@MxGjBm2211) 	
Parameters:
@MxGjBm2209[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm2210[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm2211[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:14:47
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode2212,@ComponentCode2213,@ComponentCode2214)) AND ([TbModelOtherInfo].[Type] = @Type2215) 	
Parameters:
@ComponentCode2212[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode2213[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode2214[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type2215[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:14:50
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:14:50
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:14:50
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId2216,@MxGjId2217) 	
Parameters:
@MxGjId2216[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId2217[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:14:50
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode2218,@ComponentCode2219)) AND ([TbModelOtherInfo].[Type] = @Type2220) 	
Parameters:
@ComponentCode2218[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode2219[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2220[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:15:00
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type2221) 	
Parameters:
@Type2221[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:15:00
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu2222,@ActionType2223,@HostName2224,@LogDate2225,@UserCode2226,@UserIP2227);select scope_identity()	
Parameters:
@ActionMenu2222[String] = TbModelOtherInfo
@ActionType2223[String] = 新增
@HostName2224[String] = 
@LogDate2225[DateTime] = 2020/8/20 11:15:00
@UserCode2226[String] = 500000
@UserIP2227[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 11:15:00
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime2228,@Remark2229,@SiteCode2230,@Type2231,@ProjectId2232);select scope_identity()	
Parameters:
@PlanTime2228[DateTime] = 2020/8/25 0:00:00
@Remark2229[String] = 
@SiteCode2230[String] = 6373083923489249281
@Type2231[Int32] = 1
@ProjectId2232[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:15:16
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:15:16
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:15:16
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId2233,@MxGjId2234) 	
Parameters:
@MxGjId2233[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId2234[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:15:16
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode2235,@ComponentCode2236)) AND ([TbModelOtherInfo].[Type] = @Type2237) 	
Parameters:
@ComponentCode2235[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode2236[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type2237[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:17:39
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:18:19
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:18:19
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:18:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:18:21
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:18:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:18:25
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:18:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:18:27
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:18:31
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode55) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode56) 	
Parameters:
@SiteCode55[String] = 6373083923489249281
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:18:31
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:18:31
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:18:31
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm57,@MxGjBm58,@MxGjBm59) 	
Parameters:
@MxGjBm57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm58[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm59[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:18:31
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60,@ComponentCode61,@ComponentCode62)) AND ([TbModelOtherInfo].[Type] = @Type63) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type63[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:18:36
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:18:36
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:18:36
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId64,@MxGjId65) 	
Parameters:
@MxGjId64[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId65[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:18:36
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode66,@ComponentCode67)) AND ([TbModelOtherInfo].[Type] = @Type68) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type68[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type69) 	
Parameters:
@Type69[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime70,@Remark71,@SiteCode72,@Type73,@ProjectId74);select scope_identity()	
Parameters:
@PlanTime70[DateTime] = 2020/8/11 0:00:00
@Remark71[String] = 
@SiteCode72[String] = 6373083923489249281
@Type73[Int32] = 1
@ProjectId74[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId75,@MxGjId76) 	
Parameters:
@MxGjId75[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId76[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:18:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode77,@ComponentCode78)) AND ([TbModelOtherInfo].[Type] = @Type79) 	
Parameters:
@ComponentCode77[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode78[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type79[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:18:50
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode80) AND ([TbModelOtherInfo].[Type] = @Type81) 	
Parameters:
@ComponentCode80[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type81[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:18:50
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode83,[PlanTime]=@PlanTime84,[Remark]=@Remark85,[SiteCode]=@SiteCode86,[Type]=@Type87,[ProjectId]=@ProjectId88 WHERE [TbModelOtherInfo].[ID] = @ID82	
Parameters:
@ComponentCode83[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime84[DateTime] = 2020/8/11 0:00:00
@Remark85[String] = 
@SiteCode86[String] = 6373083923489249281
@Type87[Int32] = 2
@ProjectId88[String] = 6372912251695766465
@ID82[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type89) 	
Parameters:
@Type89[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime90,@Remark91,@SiteCode92,@Type93,@ProjectId94);select scope_identity()	
Parameters:
@PlanTime90[DateTime] = 2020/8/26 0:00:00
@Remark91[String] = 
@SiteCode92[String] = 6373083923489249281
@Type93[Int32] = 1
@ProjectId94[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId95,@MxGjId96) 	
Parameters:
@MxGjId95[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId96[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:18:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode97,@ComponentCode98)) AND ([TbModelOtherInfo].[Type] = @Type99) 	
Parameters:
@ComponentCode97[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type99[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:19:34
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode100) AND ([TbModelOtherInfo].[Type] = @Type101) 	
Parameters:
@ComponentCode100[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type101[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:19:34
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode103,[PlanTime]=@PlanTime104,[Remark]=@Remark105,[SiteCode]=@SiteCode106,[Type]=@Type107,[ProjectId]=@ProjectId108 WHERE [TbModelOtherInfo].[ID] = @ID102	
Parameters:
@ComponentCode103[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime104[DateTime] = 2020/8/11 0:00:00
@Remark105[String] = 
@SiteCode106[String] = 6373083923489249281
@Type107[Int32] = 2
@ProjectId108[String] = 6372912251695766465
@ID102[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:19:47
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type109) 	
Parameters:
@Type109[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:19:47
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime110,@Remark111,@SiteCode112,@Type113,@ProjectId114);select scope_identity()	
Parameters:
@PlanTime110[DateTime] = 2020/8/11 0:00:00
@Remark111[String] = 
@SiteCode112[String] = 6373083923489249281
@Type113[Int32] = 1
@ProjectId114[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:19:54
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:19:54
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:20:29
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:20:29
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:20:29
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId115,@MxGjId116) 	
Parameters:
@MxGjId115[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId116[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:20:29
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode117,@ComponentCode118)) AND ([TbModelOtherInfo].[Type] = @Type119) 	
Parameters:
@ComponentCode117[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type119[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:20:34
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode120) AND ([TbModelOtherInfo].[Type] = @Type121) 	
Parameters:
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type121[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:20:34
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode123,[PlanTime]=@PlanTime124,[Remark]=@Remark125,[SiteCode]=@SiteCode126,[Type]=@Type127,[ProjectId]=@ProjectId128 WHERE [TbModelOtherInfo].[ID] = @ID122	
Parameters:
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime124[DateTime] = 2020/8/11 0:00:00
@Remark125[String] = 
@SiteCode126[String] = 6373083923489249281
@Type127[Int32] = 2
@ProjectId128[String] = 6372912251695766465
@ID122[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:20:39
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type129) 	
Parameters:
@Type129[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:20:39
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime130,@Remark131,@SiteCode132,@Type133,@ProjectId134);select scope_identity()	
Parameters:
@PlanTime130[DateTime] = 2020/8/10 0:00:00
@Remark131[String] = 
@SiteCode132[String] = 6373083923489249281
@Type133[Int32] = 1
@ProjectId134[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:21:12
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:21:40
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:21:57
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:21:57
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:21:57
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:21:57
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId135,@MxGjId136) 	
Parameters:
@MxGjId135[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId136[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:21:57
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode137,@ComponentCode138)) AND ([TbModelOtherInfo].[Type] = @Type139) 	
Parameters:
@ComponentCode137[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type139[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:22:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode140) AND ([TbModelOtherInfo].[Type] = @Type141) 	
Parameters:
@ComponentCode140[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type141[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:22:04
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode143,[PlanTime]=@PlanTime144,[Remark]=@Remark145,[SiteCode]=@SiteCode146,[Type]=@Type147,[ProjectId]=@ProjectId148 WHERE [TbModelOtherInfo].[ID] = @ID142	
Parameters:
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime144[DateTime] = 2020/8/11 0:00:00
@Remark145[String] = 
@SiteCode146[String] = 6373083923489249281
@Type147[Int32] = 2
@ProjectId148[String] = 6372912251695766465
@ID142[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:22:21
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type149) 	
Parameters:
@Type149[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:22:21
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime150,@Remark151,@SiteCode152,@Type153,@ProjectId154);select scope_identity()	
Parameters:
@PlanTime150[DateTime] = 2020/8/12 0:00:00
@Remark151[String] = 
@SiteCode152[String] = 6373083923489249281
@Type153[Int32] = 1
@ProjectId154[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:25:13
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:25:30
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:27:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:27:14
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:27:19
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:27:19
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId155,@MxGjId156) 	
Parameters:
@MxGjId155[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId156[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:27:19
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode157,@ComponentCode158)) AND ([TbModelOtherInfo].[Type] = @Type159) 	
Parameters:
@ComponentCode157[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type159[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:27:19
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:28:29
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:28:29
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:28:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type160) AND ([TbOrganizationMap].[ProjectId] = @ProjectId161)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode162,@CompanyCode163,@CompanyCode164,@CompanyCode165,@CompanyCode166,@CompanyCode167,@CompanyCode168,@CompanyCode169)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode170))) 	
Parameters:
@Type160[Int32] = 1
@ProjectId161[String] = 6372912251695766465
@CompanyCode162[String] = 6373083923489249281
@CompanyCode163[String] = 6373083925531366080
@CompanyCode164[String] = 6373083927883400612
@CompanyCode165[String] = 6373083918575368225
@CompanyCode166[String] = 6373083920445075162
@CompanyCode167[String] = 6373083908618598731
@CompanyCode168[String] = 6373083911842783146
@CompanyCode169[String] = 6373083913928202424
@ParentCompanyCode170[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type171) AND ([TbOrganizationMap].[ProjectId] = @ProjectId172)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode173,@CompanyCode174,@CompanyCode175,@CompanyCode176,@CompanyCode177,@CompanyCode178,@CompanyCode179,@CompanyCode180)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode181))) 	
Parameters:
@Type171[Int32] = 2
@ProjectId172[String] = 6372912251695766465
@CompanyCode173[String] = 6373083923489249281
@CompanyCode174[String] = 6373083925531366080
@CompanyCode175[String] = 6373083927883400612
@CompanyCode176[String] = 6373083918575368225
@CompanyCode177[String] = 6373083920445075162
@CompanyCode178[String] = 6373083908618598731
@CompanyCode179[String] = 6373083911842783146
@CompanyCode180[String] = 6373083913928202424
@ParentCompanyCode181[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode210)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId182) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189,@SiteCode190,@SiteCode191,@SiteCode192,@SiteCode193,@SiteCode194,@SiteCode195,@SiteCode196,@SiteCode197,@SiteCode198,@SiteCode199,@SiteCode200,@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209)))	
Parameters:
@ProjectId182[String] = 6372912251695766465
@SiteCode183[String] = 6373083923489249281
@SiteCode184[String] = 6373083925531366080
@SiteCode185[String] = 6373083927883400612
@SiteCode186[String] = 6373083918575368225
@SiteCode187[String] = 6373083920445075162
@SiteCode188[String] = 6373083908618598731
@SiteCode189[String] = 6373083911842783146
@SiteCode190[String] = 6373083913928202424
@SiteCode191[String] = 6373083877551621804
@SiteCode192[String] = 6373083879921857377
@SiteCode193[String] = 6373083881542550067
@SiteCode194[String] = 6373083883689772886
@SiteCode195[String] = 6373083887136270013
@SiteCode196[String] = 6373083889697116488
@SiteCode197[String] = 6373083891969846476
@SiteCode198[String] = 6373083894422586761
@SiteCode199[String] = 6373083897509963358
@SiteCode200[String] = 6373083900444931227
@SiteCode201[String] = 6373083829464571372
@SiteCode202[String] = 6373083833327492328
@SiteCode203[String] = 6373083841964286321
@SiteCode204[String] = 6373083844982558950
@SiteCode205[String] = 6373083847585007801
@SiteCode206[String] = 6373083856887939900
@SiteCode207[String] = 6373083859102666584
@SiteCode208[String] = 6373083864919499284
@SiteCode209[String] = 6373334974514214221
@FDictionaryCode210[String] = OrderState
@FDictionaryCode211[String] = UrgentDegree
@FDictionaryCode212[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode211) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode212) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode210)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId182) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189,@SiteCode190,@SiteCode191,@SiteCode192,@SiteCode193,@SiteCode194,@SiteCode195,@SiteCode196,@SiteCode197,@SiteCode198,@SiteCode199,@SiteCode200,@SiteCode201,@SiteCode202,@SiteCode203,@SiteCode204,@SiteCode205,@SiteCode206,@SiteCode207,@SiteCode208,@SiteCode209))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId182[String] = 6372912251695766465
@SiteCode183[String] = 6373083923489249281
@SiteCode184[String] = 6373083925531366080
@SiteCode185[String] = 6373083927883400612
@SiteCode186[String] = 6373083918575368225
@SiteCode187[String] = 6373083920445075162
@SiteCode188[String] = 6373083908618598731
@SiteCode189[String] = 6373083911842783146
@SiteCode190[String] = 6373083913928202424
@SiteCode191[String] = 6373083877551621804
@SiteCode192[String] = 6373083879921857377
@SiteCode193[String] = 6373083881542550067
@SiteCode194[String] = 6373083883689772886
@SiteCode195[String] = 6373083887136270013
@SiteCode196[String] = 6373083889697116488
@SiteCode197[String] = 6373083891969846476
@SiteCode198[String] = 6373083894422586761
@SiteCode199[String] = 6373083897509963358
@SiteCode200[String] = 6373083900444931227
@SiteCode201[String] = 6373083829464571372
@SiteCode202[String] = 6373083833327492328
@SiteCode203[String] = 6373083841964286321
@SiteCode204[String] = 6373083844982558950
@SiteCode205[String] = 6373083847585007801
@SiteCode206[String] = 6373083856887939900
@SiteCode207[String] = 6373083859102666584
@SiteCode208[String] = 6373083864919499284
@SiteCode209[String] = 6373334974514214221
@FDictionaryCode210[String] = OrderState
@FDictionaryCode211[String] = UrgentDegree
@FDictionaryCode212[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:28:31
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:28:36
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:28:36
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:28:36
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:28:37
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:28:42
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode214) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode215) 	
Parameters:
@SiteCode214[String] = 6373083923489249281
@ComponentCode215[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:28:42
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:28:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:28:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm216,@MxGjBm217,@MxGjBm218) 	
Parameters:
@MxGjBm216[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm217[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm218[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:28:43
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode219,@ComponentCode220,@ComponentCode221)) AND ([TbModelOtherInfo].[Type] = @Type222) 	
Parameters:
@ComponentCode219[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode220[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode221[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type222[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:28:54
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:28:54
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:28:54
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId223,@MxGjId224) 	
Parameters:
@MxGjId223[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId224[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:28:55
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode225,@ComponentCode226)) AND ([TbModelOtherInfo].[Type] = @Type227) 	
Parameters:
@ComponentCode225[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode226[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type227[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:29:13
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type228) 	
Parameters:
@Type228[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:29:14
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime229,@Remark230,@SiteCode231,@Type232,@ProjectId233);select scope_identity()	
Parameters:
@PlanTime229[DateTime] = 2020/8/11 0:00:00
@Remark230[String] = 
@SiteCode231[String] = 6373083923489249281
@Type232[Int32] = 1
@ProjectId233[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:29:18
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:29:18
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:29:22
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:29:22
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:29:22
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId234,@MxGjId235) 	
Parameters:
@MxGjId234[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId235[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:29:22
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode236,@ComponentCode237)) AND ([TbModelOtherInfo].[Type] = @Type238) 	
Parameters:
@ComponentCode236[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode237[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type238[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:29:27
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode239) AND ([TbModelOtherInfo].[Type] = @Type240) 	
Parameters:
@ComponentCode239[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type240[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:29:27
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode242,[PlanTime]=@PlanTime243,[Remark]=@Remark244,[SiteCode]=@SiteCode245,[Type]=@Type246,[ProjectId]=@ProjectId247 WHERE [TbModelOtherInfo].[ID] = @ID241	
Parameters:
@ComponentCode242[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime243[DateTime] = 2020/8/11 0:00:00
@Remark244[String] = 
@SiteCode245[String] = 6373083923489249281
@Type246[Int32] = 2
@ProjectId247[String] = 6372912251695766465
@ID241[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type248) 	
Parameters:
@Type248[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime249,@Remark250,@SiteCode251,@Type252,@ProjectId253);select scope_identity()	
Parameters:
@PlanTime249[DateTime] = 2020/8/10 0:00:00
@Remark250[String] = 
@SiteCode251[String] = 6373083923489249281
@Type252[Int32] = 1
@ProjectId253[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6372921375874657752
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId254,@MxGjId255) 	
Parameters:
@MxGjId254[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId255[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:29:43
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode256,@ComponentCode257)) AND ([TbModelOtherInfo].[Type] = @Type258) 	
Parameters:
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type258[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:30:34
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:30:34
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 11:30:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:30:48
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:30:49
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:30:53
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:30:53
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 11:30:53
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:30:55
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 11:31:00
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode55) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode56) 	
Parameters:
@SiteCode55[String] = 6373083923489249281
@ComponentCode56[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:31:00
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:31:00
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:31:00
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm57,@MxGjBm58,@MxGjBm59) 	
Parameters:
@MxGjBm57[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm58[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm59[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:31:00
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode60,@ComponentCode61,@ComponentCode62)) AND ([TbModelOtherInfo].[Type] = @Type63) 	
Parameters:
@ComponentCode60[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode61[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode62[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type63[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:31:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:31:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:31:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId64,@MxGjId65) 	
Parameters:
@MxGjId64[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId65[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:31:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode66,@ComponentCode67)) AND ([TbModelOtherInfo].[Type] = @Type68) 	
Parameters:
@ComponentCode66[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode67[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type68[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type69) 	
Parameters:
@Type69[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime70,@Remark71,@SiteCode72,@Type73,@ProjectId74);select scope_identity()	
Parameters:
@PlanTime70[DateTime] = 2020/8/18 0:00:00
@Remark71[String] = 
@SiteCode72[String] = 6373083923489249281
@Type73[Int32] = 1
@ProjectId74[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode75,@ComponentCode76)) AND ([TbModelOtherInfo].[Type] = @Type77) 	
Parameters:
@ComponentCode75[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode76[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type77[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime79 WHERE [TbModelOtherInfo].[ID] = @ID78	
Parameters:
@PlanTime79[DateTime] = 2020/8/18 0:00:00
@ID78[Int32] = 59


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	UPDATE [TbModelOtherInfo] SET [PlanTime]=@PlanTime81 WHERE [TbModelOtherInfo].[ID] = @ID80	
Parameters:
@PlanTime81[DateTime] = 2020/8/18 0:00:00
@ID80[Int32] = 60


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId82,@MxGjId83) 	
Parameters:
@MxGjId82[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId83[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:31:09
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode84,@ComponentCode85)) AND ([TbModelOtherInfo].[Type] = @Type86) 	
Parameters:
@ComponentCode84[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode85[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type86[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:33:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:33:35
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:33:35
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:33:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId87,@MxGjId88) 	
Parameters:
@MxGjId87[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId88[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:33:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode89,@ComponentCode90)) AND ([TbModelOtherInfo].[Type] = @Type91) 	
Parameters:
@ComponentCode89[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode90[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type91[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:34:08
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode93) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode94) 	
Parameters:
@SiteCode93[String] = 6373083923489249281
@ComponentCode94[String] = L21_Z08_00KT_DXT_DXT_MD%


-----------------------------------------------------------------------------
2020-08-20 11:34:08
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-20 11:34:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%
@ComponentCode1[String] = L21_Z08_00KT_DXT_DXT_MD_%


-----------------------------------------------------------------------------
2020-08-20 11:34:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm95,@MxGjBm96,@MxGjBm97,@MxGjBm98,@MxGjBm99,@MxGjBm100,@MxGjBm101,@MxGjBm102,@MxGjBm103) 	
Parameters:
@MxGjBm95[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm96[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm97[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm98[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm99[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm100[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm101[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm102[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm103[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02


-----------------------------------------------------------------------------
2020-08-20 11:34:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode104,@ComponentCode105,@ComponentCode106,@ComponentCode107,@ComponentCode108,@ComponentCode109,@ComponentCode110,@ComponentCode111,@ComponentCode112)) AND ([TbModelOtherInfo].[Type] = @Type113) 	
Parameters:
@ComponentCode104[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode105[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode106[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode107[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode108[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode109[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode110[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode111[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode112[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@Type113[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:34:10
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode115) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode116) 	
Parameters:
@SiteCode115[String] = 6373083923489249281
@ComponentCode116[String] = L21_Z08_00KT_DXT_DXT_MD%


-----------------------------------------------------------------------------
2020-08-20 11:34:10
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:34:10
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:34:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm117,@MxGjBm118,@MxGjBm119) 	
Parameters:
@MxGjBm117[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm118[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm119[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:34:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode120,@ComponentCode121,@ComponentCode122)) AND ([TbModelOtherInfo].[Type] = @Type123) 	
Parameters:
@ComponentCode120[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode121[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode122[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type123[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:34:11
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode125) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode126) 	
Parameters:
@SiteCode125[String] = 6373083923489249281
@ComponentCode126[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode128) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode129) 	
Parameters:
@SiteCode128[String] = 6373083923489249281
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm130,@MxGjBm131,@MxGjBm132) 	
Parameters:
@MxGjBm130[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm131[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm132[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode133,@ComponentCode134,@ComponentCode135)) AND ([TbModelOtherInfo].[Type] = @Type136) 	
Parameters:
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode135[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type136[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:34:12
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode138) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode139) 	
Parameters:
@SiteCode138[String] = 6373083923489249281
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type140) AND ([TbOrganizationMap].[ProjectId] = @ProjectId141)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode142,@CompanyCode143,@CompanyCode144,@CompanyCode145,@CompanyCode146,@CompanyCode147,@CompanyCode148,@CompanyCode149)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode150))) 	
Parameters:
@Type140[Int32] = 1
@ProjectId141[String] = 6372912251695766465
@CompanyCode142[String] = 6373083923489249281
@CompanyCode143[String] = 6373083925531366080
@CompanyCode144[String] = 6373083927883400612
@CompanyCode145[String] = 6373083918575368225
@CompanyCode146[String] = 6373083920445075162
@CompanyCode147[String] = 6373083908618598731
@CompanyCode148[String] = 6373083911842783146
@CompanyCode149[String] = 6373083913928202424
@ParentCompanyCode150[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type151) AND ([TbOrganizationMap].[ProjectId] = @ProjectId152)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode153,@CompanyCode154,@CompanyCode155,@CompanyCode156,@CompanyCode157,@CompanyCode158,@CompanyCode159,@CompanyCode160)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode161))) 	
Parameters:
@Type151[Int32] = 2
@ProjectId152[String] = 6372912251695766465
@CompanyCode153[String] = 6373083923489249281
@CompanyCode154[String] = 6373083925531366080
@CompanyCode155[String] = 6373083927883400612
@CompanyCode156[String] = 6373083918575368225
@CompanyCode157[String] = 6373083920445075162
@CompanyCode158[String] = 6373083908618598731
@CompanyCode159[String] = 6373083911842783146
@CompanyCode160[String] = 6373083913928202424
@ParentCompanyCode161[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode190)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId162) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171,@SiteCode172,@SiteCode173,@SiteCode174,@SiteCode175,@SiteCode176,@SiteCode177,@SiteCode178,@SiteCode179,@SiteCode180,@SiteCode181,@SiteCode182,@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189)))	
Parameters:
@ProjectId162[String] = 6372912251695766465
@SiteCode163[String] = 6373083923489249281
@SiteCode164[String] = 6373083925531366080
@SiteCode165[String] = 6373083927883400612
@SiteCode166[String] = 6373083918575368225
@SiteCode167[String] = 6373083920445075162
@SiteCode168[String] = 6373083908618598731
@SiteCode169[String] = 6373083911842783146
@SiteCode170[String] = 6373083913928202424
@SiteCode171[String] = 6373083877551621804
@SiteCode172[String] = 6373083879921857377
@SiteCode173[String] = 6373083881542550067
@SiteCode174[String] = 6373083883689772886
@SiteCode175[String] = 6373083887136270013
@SiteCode176[String] = 6373083889697116488
@SiteCode177[String] = 6373083891969846476
@SiteCode178[String] = 6373083894422586761
@SiteCode179[String] = 6373083897509963358
@SiteCode180[String] = 6373083900444931227
@SiteCode181[String] = 6373083829464571372
@SiteCode182[String] = 6373083833327492328
@SiteCode183[String] = 6373083841964286321
@SiteCode184[String] = 6373083844982558950
@SiteCode185[String] = 6373083847585007801
@SiteCode186[String] = 6373083856887939900
@SiteCode187[String] = 6373083859102666584
@SiteCode188[String] = 6373083864919499284
@SiteCode189[String] = 6373334974514214221
@FDictionaryCode190[String] = OrderState
@FDictionaryCode191[String] = UrgentDegree
@FDictionaryCode192[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode191) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode192) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode190)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId162) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode163,@SiteCode164,@SiteCode165,@SiteCode166,@SiteCode167,@SiteCode168,@SiteCode169,@SiteCode170,@SiteCode171,@SiteCode172,@SiteCode173,@SiteCode174,@SiteCode175,@SiteCode176,@SiteCode177,@SiteCode178,@SiteCode179,@SiteCode180,@SiteCode181,@SiteCode182,@SiteCode183,@SiteCode184,@SiteCode185,@SiteCode186,@SiteCode187,@SiteCode188,@SiteCode189))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId162[String] = 6372912251695766465
@SiteCode163[String] = 6373083923489249281
@SiteCode164[String] = 6373083925531366080
@SiteCode165[String] = 6373083927883400612
@SiteCode166[String] = 6373083918575368225
@SiteCode167[String] = 6373083920445075162
@SiteCode168[String] = 6373083908618598731
@SiteCode169[String] = 6373083911842783146
@SiteCode170[String] = 6373083913928202424
@SiteCode171[String] = 6373083877551621804
@SiteCode172[String] = 6373083879921857377
@SiteCode173[String] = 6373083881542550067
@SiteCode174[String] = 6373083883689772886
@SiteCode175[String] = 6373083887136270013
@SiteCode176[String] = 6373083889697116488
@SiteCode177[String] = 6373083891969846476
@SiteCode178[String] = 6373083894422586761
@SiteCode179[String] = 6373083897509963358
@SiteCode180[String] = 6373083900444931227
@SiteCode181[String] = 6373083829464571372
@SiteCode182[String] = 6373083833327492328
@SiteCode183[String] = 6373083841964286321
@SiteCode184[String] = 6373083844982558950
@SiteCode185[String] = 6373083847585007801
@SiteCode186[String] = 6373083856887939900
@SiteCode187[String] = 6373083859102666584
@SiteCode188[String] = 6373083864919499284
@SiteCode189[String] = 6373334974514214221
@FDictionaryCode190[String] = OrderState
@FDictionaryCode191[String] = UrgentDegree
@FDictionaryCode192[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb 	


-----------------------------------------------------------------------------
2020-08-20 11:34:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb ) as a)  SELECT * FROM temptbl where Row between 1 and 15	


-----------------------------------------------------------------------------
2020-08-20 11:34:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 11:34:40
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 11:34:40
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 11:34:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 11:34:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 11:34:42
Text:	select * from (select * from TbProcessingTechnology where PID!=0 
                            union all
                            select 0,-1,0,'请选择') Tb order by Tb.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:34:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-20 11:34:43
Text:	select * from (select * from TbProcessingTechnology where PID!=0 
                            union all
                            select 0,-1,0,'请选择') Tb order by Tb.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 11:34:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 11:34:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = DistributionTimeJg


-----------------------------------------------------------------------------
2020-08-20 11:36:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:36:42
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode194) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode195) 	
Parameters:
@SiteCode194[String] = 6373083923489249281
@ComponentCode195[String] = L21_Z08_00KT_DXT%


-----------------------------------------------------------------------------
2020-08-20 11:36:42
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-20 11:36:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_%


-----------------------------------------------------------------------------
2020-08-20 11:36:43
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm196,@MxGjBm197,@MxGjBm198,@MxGjBm199,@MxGjBm200,@MxGjBm201,@MxGjBm202,@MxGjBm203,@MxGjBm204,@MxGjBm205,@MxGjBm206,@MxGjBm207,@MxGjBm208,@MxGjBm209,@MxGjBm210,@MxGjBm211,@MxGjBm212,@MxGjBm213,@MxGjBm214,@MxGjBm215,@MxGjBm216,@MxGjBm217,@MxGjBm218,@MxGjBm219,@MxGjBm220,@MxGjBm221,@MxGjBm222,@MxGjBm223,@MxGjBm224,@MxGjBm225,@MxGjBm226,@MxGjBm227,@MxGjBm228,@MxGjBm229,@MxGjBm230,@MxGjBm231,@MxGjBm232,@MxGjBm233,@MxGjBm234,@MxGjBm235,@MxGjBm236,@MxGjBm237,@MxGjBm238,@MxGjBm239,@MxGjBm240,@MxGjBm241,@MxGjBm242,@MxGjBm243,@MxGjBm244,@MxGjBm245) 	
Parameters:
@MxGjBm196[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm197[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm198[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01
@MxGjBm199[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08
@MxGjBm200[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05
@MxGjBm201[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06
@MxGjBm202[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07
@MxGjBm203[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06
@MxGjBm204[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02
@MxGjBm205[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03
@MxGjBm206[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01
@MxGjBm207[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02
@MxGjBm208[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02
@MxGjBm209[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02
@MxGjBm210[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04
@MxGjBm211[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01
@MxGjBm212[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03
@MxGjBm213[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM
@MxGjBm214[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm215[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm216[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm217[String] = L21_Z08_00KT_DXT_DXT_FK_FK
@MxGjBm218[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm219[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm220[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm221[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm222[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm223[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm224[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm225[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm226[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm227[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm228[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm229[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm230[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm231[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm232[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm233[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm234[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm235[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm236[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm237[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm238[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm239[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm240[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm241[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm242[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm243[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm244[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ
@MxGjBm245[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ


-----------------------------------------------------------------------------
2020-08-20 11:36:43
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode246,@ComponentCode247,@ComponentCode248,@ComponentCode249,@ComponentCode250,@ComponentCode251,@ComponentCode252,@ComponentCode253,@ComponentCode254,@ComponentCode255,@ComponentCode256,@ComponentCode257,@ComponentCode258,@ComponentCode259,@ComponentCode260,@ComponentCode261,@ComponentCode262,@ComponentCode263,@ComponentCode264,@ComponentCode265,@ComponentCode266,@ComponentCode267,@ComponentCode268,@ComponentCode269,@ComponentCode270,@ComponentCode271,@ComponentCode272,@ComponentCode273,@ComponentCode274,@ComponentCode275,@ComponentCode276,@ComponentCode277,@ComponentCode278,@ComponentCode279,@ComponentCode280,@ComponentCode281,@ComponentCode282,@ComponentCode283,@ComponentCode284,@ComponentCode285,@ComponentCode286,@ComponentCode287,@ComponentCode288,@ComponentCode289,@ComponentCode290,@ComponentCode291,@ComponentCode292,@ComponentCode293,@ComponentCode294,@ComponentCode295)) AND ([TbModelOtherInfo].[Type] = @Type296) 	
Parameters:
@ComponentCode246[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode247[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode248[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@ComponentCode249[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B08_000
@ComponentCode250[String] = L21_Z08_00KT_DXT_DXT_MD_D-B05_000
@ComponentCode251[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B06_000
@ComponentCode252[String] = L21_Z08_00KT_DXT_DXT_MD_MD-A07_000
@ComponentCode253[String] = L21_Z08_00KT_DXT_DXT_MD_D-B06_000
@ComponentCode254[String] = L21_Z08_00KT_DXT_DXT_MD_MD-B02_000
@ComponentCode255[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B03_000
@ComponentCode256[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B01_000
@ComponentCode257[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-B02_000
@ComponentCode258[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-B02_000
@ComponentCode259[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@ComponentCode260[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A04_001
@ComponentCode261[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A01_000
@ComponentCode262[String] = L21_Z08_00KT_DXT_DXT_FD_FD1-A03_000
@ComponentCode263[String] = L21_Z08_00KT_DXT_DXT_BWM_BWM_999
@ComponentCode264[String] = L21_Z08_00KT_DXT_DXT_FK_FK_059
@ComponentCode265[String] = L21_Z08_00KT_DXT_DXT_FK_FK_058
@ComponentCode266[String] = L21_Z08_00KT_DXT_DXT_FK_FK_104
@ComponentCode267[String] = L21_Z08_00KT_DXT_DXT_FK_FK_111
@ComponentCode268[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_207
@ComponentCode269[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_026
@ComponentCode270[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_514
@ComponentCode271[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_002
@ComponentCode272[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_006
@ComponentCode273[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_487
@ComponentCode274[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_032
@ComponentCode275[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_030
@ComponentCode276[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_568
@ComponentCode277[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_031
@ComponentCode278[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_008
@ComponentCode279[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_259
@ComponentCode280[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_009
@ComponentCode281[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_007
@ComponentCode282[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_295
@ComponentCode283[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_027
@ComponentCode284[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_028
@ComponentCode285[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_083
@ComponentCode286[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_016
@ComponentCode287[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_165
@ComponentCode288[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_011
@ComponentCode289[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_010
@ComponentCode290[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_197
@ComponentCode291[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_388
@ComponentCode292[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_018
@ComponentCode293[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_020
@ComponentCode294[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_003
@ComponentCode295[String] = L21_Z08_00KT_DXT_DXT_GJ_GDJ_087
@Type296[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 11:36:46
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode298) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode299) 	
Parameters:
@SiteCode298[String] = 6373083923489249281
@ComponentCode299[String] = L21_Z08_00KT_DXT%


-----------------------------------------------------------------------------
2020-08-20 11:39:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:42:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:44:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:44:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:44:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId300,@MxGjId301) 	
Parameters:
@MxGjId300[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId301[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:44:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode302,@ComponentCode303)) AND ([TbModelOtherInfo].[Type] = @Type304) 	
Parameters:
@ComponentCode302[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode303[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type304[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:44:07
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:44:07
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 11:44:07
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId305,@MxGjId306) 	
Parameters:
@MxGjId305[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId306[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 11:44:07
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode307,@ComponentCode308)) AND ([TbModelOtherInfo].[Type] = @Type309) 	
Parameters:
@ComponentCode307[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode308[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type309[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:44:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 11:44:21
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 11:44:21
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId310,@MxGjId311) 	
Parameters:
@MxGjId310[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId311[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 11:44:21
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode312,@ComponentCode313)) AND ([TbModelOtherInfo].[Type] = @Type314) 	
Parameters:
@ComponentCode312[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode313[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type314[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 11:45:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:48:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 11:52:10
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 12:46:09
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 12:49:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 12:51:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 12:54:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 12:57:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:00:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:09:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:12:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:15:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:18:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:21:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:24:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:27:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:30:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:33:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:36:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:39:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:42:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:45:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:48:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:51:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:54:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 13:57:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:00:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:09:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:12:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:15:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:18:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:21:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:24:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:27:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:30:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:33:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:36:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:39:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:42:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:45:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:48:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:51:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:54:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 14:57:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:00:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:09:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:12:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:15:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:18:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:21:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:24:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:27:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:30:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:33:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:36:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:39:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:42:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:45:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:48:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:51:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:54:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 15:57:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:00:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:09:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:12:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:15:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:18:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:21:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:24:30
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb 	


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb ) as a)  SELECT * FROM temptbl where Row between 1 and 15	


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 16:24:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 16:24:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:25:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/RawMaterialStock/Index


-----------------------------------------------------------------------------
2020-08-20 16:25:08
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 16:25:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 16:25:08
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/InOrder/Index


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	select ino.*,case when ISNULL(ino.ChackResult,0)=0 then '' when ISNULL(ino.ChackResult,0)=1 then '合格' when ISNULL(ino.ChackResult,0)=2 then '不合格' when ISNULL(ino.ChackResult,0)=3 then '部分合格' end ChackResultName,ur.UserName,ur1.UserName as DeliverUser,st.StorageName,sdd.DictionaryText as RebarTypeName,sp.SupplierName,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as BranchName,case when rmsp.DemandPlanCode is null then fbnp.RawMaterialDemandNum else rmsp.DemandPlanCode end DemandPlanCode,inoi.IsTh,sap.NoJcBhgCount from TbInOrder ino
							left join(select '退回' as IsTh,InOrderCode from TbInOrderItem where ReturnTime is not null group by InOrderCode) inoi on ino.InOrderCode=inoi.InOrderCode
                            left join TbUser ur on ino.InsertUserCode=ur.UserCode
                            left join TbUser ur1 on ino.UserCode=ur1.UserCode
                            left join TbStorage st on ino.StorageCode=st.StorageCode
                            left join TbSysDictionaryData sdd on ino.RebarType=sdd.DictionaryCode
                            left join TbCompany cp1 on ino.SiteCode=cp1.CompanyCode
                            left join TbCompany cp2 on ino.WorkAreaCode=cp2.CompanyCode
                            left join TbCompany cp3 on cp2.ParentCompanyCode=cp3.CompanyCode
                            left join TbSupplier sp on ino.SupplierCode=sp.SupplierCode
                            left join TbFactoryBatchNeedPlan fbnp on ino.BatchPlanCode=fbnp.BatchPlanNum
							left join TbRawMaterialMonthDemandSupplyPlan rmsp on fbnp.RawMaterialDemandNum=rmsp.SupplyPlanCode
							left join (	select a.InOrderCode,SUM(c.PassCount) as NoJcBhgCount from TbSampleOrder a
							left join TbSampleOrderItem b on a.SampleOrderCode=b.SampleOrderCode
							left join TbInOrderItem c on b.InOrderItemId=c.ID
							where b.ChackState=2 group by a.InOrderCode) sap on ino.InOrderCode=sap.InOrderCode where 1=1 and  ino.BatchPlanCode!='' and ino.BatchPlanCode is not null and (ino.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221') or ino.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) and ino.ProjectId='6372912251695766465' and st.ProcessFactoryCode='6372982160979097303'	


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by InOrderCode desc)AS Row, * from (select ino.*,case when ISNULL(ino.ChackResult,0)=0 then '' when ISNULL(ino.ChackResult,0)=1 then '合格' when ISNULL(ino.ChackResult,0)=2 then '不合格' when ISNULL(ino.ChackResult,0)=3 then '部分合格' end ChackResultName,ur.UserName,ur1.UserName as DeliverUser,st.StorageName,sdd.DictionaryText as RebarTypeName,sp.SupplierName,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as BranchName,case when rmsp.DemandPlanCode is null then fbnp.RawMaterialDemandNum else rmsp.DemandPlanCode end DemandPlanCode,inoi.IsTh,sap.NoJcBhgCount from TbInOrder ino
							left join(select '退回' as IsTh,InOrderCode from TbInOrderItem where ReturnTime is not null group by InOrderCode) inoi on ino.InOrderCode=inoi.InOrderCode
                            left join TbUser ur on ino.InsertUserCode=ur.UserCode
                            left join TbUser ur1 on ino.UserCode=ur1.UserCode
                            left join TbStorage st on ino.StorageCode=st.StorageCode
                            left join TbSysDictionaryData sdd on ino.RebarType=sdd.DictionaryCode
                            left join TbCompany cp1 on ino.SiteCode=cp1.CompanyCode
                            left join TbCompany cp2 on ino.WorkAreaCode=cp2.CompanyCode
                            left join TbCompany cp3 on cp2.ParentCompanyCode=cp3.CompanyCode
                            left join TbSupplier sp on ino.SupplierCode=sp.SupplierCode
                            left join TbFactoryBatchNeedPlan fbnp on ino.BatchPlanCode=fbnp.BatchPlanNum
							left join TbRawMaterialMonthDemandSupplyPlan rmsp on fbnp.RawMaterialDemandNum=rmsp.SupplyPlanCode
							left join (	select a.InOrderCode,SUM(c.PassCount) as NoJcBhgCount from TbSampleOrder a
							left join TbSampleOrderItem b on a.SampleOrderCode=b.SampleOrderCode
							left join TbInOrderItem c on b.InOrderItemId=c.ID
							where b.ChackState=2 group by a.InOrderCode) sap on ino.InOrderCode=sap.InOrderCode where 1=1 and  ino.BatchPlanCode!='' and ino.BatchPlanCode is not null and (ino.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221') or ino.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) and ino.ProjectId='6372912251695766465' and st.ProcessFactoryCode='6372982160979097303') as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	select Tb.DataMonth,ISNULL(sum(TbData.InorderCount),0) as InCount,ISNULL(sum(TbData.InCount),0) as InWeight from (select datepart(MONTH,dateadd(mm,-t.number,getdate())) as DataMonth
from
(select number from master..spt_values where type='P') t
where year(dateadd(mm,-t.number,getdate()))=year(getdate())) Tb 
left join (select COUNT(1) as InorderCount,SUM(a.InCount) as InCount,a.RebarType,datepart(year,a.InsertTime) InsertYear,datepart(MONTH,a.InsertTime) InsertMonth from TbInOrder a 
left join TbStorage b on a.StorageCode=b.StorageCode
where a.Examinestatus!='已退回' 
and a.Examinestatus!='已撤销' 
and datepart(year,a.InsertTime)=datepart(year,GETDATE())  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
group by a.RebarType,datepart(year,a.InsertTime),datepart(MONTH,a.InsertTime)) TbData on  Tb.DataMonth=TbData.InsertMonth
group by Tb.DataMonth order by Tb.DataMonth asc 	


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	select TbType.InType,isnull(TbData.InCount,0) as InCount from (select '入库单数' as InType
                           union all
                           select '未取样' as InType
                           union all
                           select '验收不合格' as InType
                           union all
                           select '检测部分合格' as InType
                           union all
                           select '检测不合格' as InType) TbType
                           left join(select '入库单数' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode 
                           where 1=1 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '未取样' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1 and a.SampleOrderState='取样未完成' and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '验收不合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and NoPassTotal>0 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '检测部分合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and ChackResult=3 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '检测不合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and ChackResult=2 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) TbData on TbType.InType=TbData.InType	


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/StockTaking/Index


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = MaterialType


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	 SELECT count(*) as r_cnt FROM [TbStockTaking] LEFT OUTER JOIN [TbUser] ON ([TbStockTaking].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON ([TbStockTaking].[WarehouseType] = [TbSysDictionaryData].[DictionaryCode]) LEFT OUTER JOIN [TbCompany] ON ([TbStockTaking].[ProcessFactoryCode] = [TbCompany].[CompanyCode]) WHERE ([TbStockTaking].[ProcessFactoryCode] = @ProcessFactoryCode54)	
Parameters:
@ProcessFactoryCode54[String] = 6372982160979097303


-----------------------------------------------------------------------------
2020-08-20 16:25:09
Text:	 SELECT   TOP 50 [TbStockTaking].[ID],[TbStockTaking].[TakNum],[TbStockTaking].[TakDay],[TbStockTaking].[TotalInventory],[TbStockTaking].[TotalTak],[TbStockTaking].[TotalEarnOrLos],[TbStockTaking].[EarnOrLos],[TbStockTaking].[Remarks],[TbStockTaking].[InsertUserCode],[TbStockTaking].[InsertTime],[TbUser].[UserName],[TbCompany].[CompanyFullName] AS [FactoryName],[TbSysDictionaryData].[DictionaryText] AS [WarehouseTypeName] FROM [TbStockTaking] LEFT OUTER JOIN [TbUser] ON ([TbStockTaking].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON ([TbStockTaking].[WarehouseType] = [TbSysDictionaryData].[DictionaryCode]) LEFT OUTER JOIN [TbCompany] ON ([TbStockTaking].[ProcessFactoryCode] = [TbCompany].[CompanyCode])  WHERE ([TbStockTaking].[ProcessFactoryCode] = @ProcessFactoryCode54) ORDER BY [TbStockTaking].[ID] DESC 	
Parameters:
@ProcessFactoryCode54[String] = 6372982160979097303


-----------------------------------------------------------------------------
2020-08-20 16:27:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/RawMaterialStock/Index


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/InOrder/Index


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select ino.*,case when ISNULL(ino.ChackResult,0)=0 then '' when ISNULL(ino.ChackResult,0)=1 then '合格' when ISNULL(ino.ChackResult,0)=2 then '不合格' when ISNULL(ino.ChackResult,0)=3 then '部分合格' end ChackResultName,ur.UserName,ur1.UserName as DeliverUser,st.StorageName,sdd.DictionaryText as RebarTypeName,sp.SupplierName,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as BranchName,case when rmsp.DemandPlanCode is null then fbnp.RawMaterialDemandNum else rmsp.DemandPlanCode end DemandPlanCode,inoi.IsTh,sap.NoJcBhgCount from TbInOrder ino
							left join(select '退回' as IsTh,InOrderCode from TbInOrderItem where ReturnTime is not null group by InOrderCode) inoi on ino.InOrderCode=inoi.InOrderCode
                            left join TbUser ur on ino.InsertUserCode=ur.UserCode
                            left join TbUser ur1 on ino.UserCode=ur1.UserCode
                            left join TbStorage st on ino.StorageCode=st.StorageCode
                            left join TbSysDictionaryData sdd on ino.RebarType=sdd.DictionaryCode
                            left join TbCompany cp1 on ino.SiteCode=cp1.CompanyCode
                            left join TbCompany cp2 on ino.WorkAreaCode=cp2.CompanyCode
                            left join TbCompany cp3 on cp2.ParentCompanyCode=cp3.CompanyCode
                            left join TbSupplier sp on ino.SupplierCode=sp.SupplierCode
                            left join TbFactoryBatchNeedPlan fbnp on ino.BatchPlanCode=fbnp.BatchPlanNum
							left join TbRawMaterialMonthDemandSupplyPlan rmsp on fbnp.RawMaterialDemandNum=rmsp.SupplyPlanCode
							left join (	select a.InOrderCode,SUM(c.PassCount) as NoJcBhgCount from TbSampleOrder a
							left join TbSampleOrderItem b on a.SampleOrderCode=b.SampleOrderCode
							left join TbInOrderItem c on b.InOrderItemId=c.ID
							where b.ChackState=2 group by a.InOrderCode) sap on ino.InOrderCode=sap.InOrderCode where 1=1 and  ino.BatchPlanCode!='' and ino.BatchPlanCode is not null and (ino.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221') or ino.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) and ino.ProjectId='6372912251695766465' and st.ProcessFactoryCode='6372982160979097303'	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by InOrderCode desc)AS Row, * from (select ino.*,case when ISNULL(ino.ChackResult,0)=0 then '' when ISNULL(ino.ChackResult,0)=1 then '合格' when ISNULL(ino.ChackResult,0)=2 then '不合格' when ISNULL(ino.ChackResult,0)=3 then '部分合格' end ChackResultName,ur.UserName,ur1.UserName as DeliverUser,st.StorageName,sdd.DictionaryText as RebarTypeName,sp.SupplierName,cp1.CompanyFullName as SiteName,cp2.CompanyFullName as WorkAreaName,cp3.CompanyFullName as BranchName,case when rmsp.DemandPlanCode is null then fbnp.RawMaterialDemandNum else rmsp.DemandPlanCode end DemandPlanCode,inoi.IsTh,sap.NoJcBhgCount from TbInOrder ino
							left join(select '退回' as IsTh,InOrderCode from TbInOrderItem where ReturnTime is not null group by InOrderCode) inoi on ino.InOrderCode=inoi.InOrderCode
                            left join TbUser ur on ino.InsertUserCode=ur.UserCode
                            left join TbUser ur1 on ino.UserCode=ur1.UserCode
                            left join TbStorage st on ino.StorageCode=st.StorageCode
                            left join TbSysDictionaryData sdd on ino.RebarType=sdd.DictionaryCode
                            left join TbCompany cp1 on ino.SiteCode=cp1.CompanyCode
                            left join TbCompany cp2 on ino.WorkAreaCode=cp2.CompanyCode
                            left join TbCompany cp3 on cp2.ParentCompanyCode=cp3.CompanyCode
                            left join TbSupplier sp on ino.SupplierCode=sp.SupplierCode
                            left join TbFactoryBatchNeedPlan fbnp on ino.BatchPlanCode=fbnp.BatchPlanNum
							left join TbRawMaterialMonthDemandSupplyPlan rmsp on fbnp.RawMaterialDemandNum=rmsp.SupplyPlanCode
							left join (	select a.InOrderCode,SUM(c.PassCount) as NoJcBhgCount from TbSampleOrder a
							left join TbSampleOrderItem b on a.SampleOrderCode=b.SampleOrderCode
							left join TbInOrderItem c on b.InOrderItemId=c.ID
							where b.ChackState=2 group by a.InOrderCode) sap on ino.InOrderCode=sap.InOrderCode where 1=1 and  ino.BatchPlanCode!='' and ino.BatchPlanCode is not null and (ino.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221') or ino.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) and ino.ProjectId='6372912251695766465' and st.ProcessFactoryCode='6372982160979097303') as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select Tb.DataMonth,ISNULL(sum(TbData.InorderCount),0) as InCount,ISNULL(sum(TbData.InCount),0) as InWeight from (select datepart(MONTH,dateadd(mm,-t.number,getdate())) as DataMonth
from
(select number from master..spt_values where type='P') t
where year(dateadd(mm,-t.number,getdate()))=year(getdate())) Tb 
left join (select COUNT(1) as InorderCount,SUM(a.InCount) as InCount,a.RebarType,datepart(year,a.InsertTime) InsertYear,datepart(MONTH,a.InsertTime) InsertMonth from TbInOrder a 
left join TbStorage b on a.StorageCode=b.StorageCode
where a.Examinestatus!='已退回' 
and a.Examinestatus!='已撤销' 
and datepart(year,a.InsertTime)=datepart(year,GETDATE())  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
group by a.RebarType,datepart(year,a.InsertTime),datepart(MONTH,a.InsertTime)) TbData on  Tb.DataMonth=TbData.InsertMonth
group by Tb.DataMonth order by Tb.DataMonth asc 	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 4


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select TbType.InType,isnull(TbData.InCount,0) as InCount from (select '入库单数' as InType
                           union all
                           select '未取样' as InType
                           union all
                           select '验收不合格' as InType
                           union all
                           select '检测部分合格' as InType
                           union all
                           select '检测不合格' as InType) TbType
                           left join(select '入库单数' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode 
                           where 1=1 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '未取样' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1 and a.SampleOrderState='取样未完成' and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '验收不合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and NoPassTotal>0 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '检测部分合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and ChackResult=3 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')
                           union all
                           select '检测不合格' as InType,COUNT(1) as InCount from TbInOrder a
                           left join TbStorage b on a.StorageCode=b.StorageCode
                           where 1=1  and ChackResult=2 and a.BatchPlanCode !=''  and a.ProjectId='6372912251695766465' and b.ProcessFactoryCode='6372982160979097303' and a.WorkAreaCode in('6373083571609922937','6373083573064806156','6373083640859283773','6373083555017573908','6372921396045311451')) TbData on TbType.InType=TbData.InType	


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /RawMaterial/StockTaking/Index


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = MaterialType


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	 SELECT count(*) as r_cnt FROM [TbStockTaking] LEFT OUTER JOIN [TbUser] ON ([TbStockTaking].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON ([TbStockTaking].[WarehouseType] = [TbSysDictionaryData].[DictionaryCode]) LEFT OUTER JOIN [TbCompany] ON ([TbStockTaking].[ProcessFactoryCode] = [TbCompany].[CompanyCode]) WHERE ([TbStockTaking].[ProcessFactoryCode] = @ProcessFactoryCode55)	
Parameters:
@ProcessFactoryCode55[String] = 6372982160979097303


-----------------------------------------------------------------------------
2020-08-20 16:27:51
Text:	 SELECT   TOP 50 [TbStockTaking].[ID],[TbStockTaking].[TakNum],[TbStockTaking].[TakDay],[TbStockTaking].[TotalInventory],[TbStockTaking].[TotalTak],[TbStockTaking].[TotalEarnOrLos],[TbStockTaking].[EarnOrLos],[TbStockTaking].[Remarks],[TbStockTaking].[InsertUserCode],[TbStockTaking].[InsertTime],[TbUser].[UserName],[TbCompany].[CompanyFullName] AS [FactoryName],[TbSysDictionaryData].[DictionaryText] AS [WarehouseTypeName] FROM [TbStockTaking] LEFT OUTER JOIN [TbUser] ON ([TbStockTaking].[InsertUserCode] = [TbUser].[UserCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON ([TbStockTaking].[WarehouseType] = [TbSysDictionaryData].[DictionaryCode]) LEFT OUTER JOIN [TbCompany] ON ([TbStockTaking].[ProcessFactoryCode] = [TbCompany].[CompanyCode])  WHERE ([TbStockTaking].[ProcessFactoryCode] = @ProcessFactoryCode55) ORDER BY [TbStockTaking].[ID] DESC 	
Parameters:
@ProcessFactoryCode55[String] = 6372982160979097303


-----------------------------------------------------------------------------
2020-08-20 16:30:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:33:31
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083877551621804
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:31
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode58)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId56) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode57)))	
Parameters:
@ProjectId56[String] = 6372912251695766465
@SiteCode57[String] = 6373083877551621804
@FDictionaryCode58[String] = OrderState
@FDictionaryCode59[String] = UrgentDegree
@FDictionaryCode60[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:31
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode59) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode58)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId56) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode57))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId56[String] = 6372912251695766465
@SiteCode57[String] = 6373083877551621804
@FDictionaryCode58[String] = OrderState
@FDictionaryCode59[String] = UrgentDegree
@FDictionaryCode60[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083879921857377
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:32
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode63)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId61) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode62)))	
Parameters:
@ProjectId61[String] = 6372912251695766465
@SiteCode62[String] = 6373083879921857377
@FDictionaryCode63[String] = OrderState
@FDictionaryCode64[String] = UrgentDegree
@FDictionaryCode65[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:32
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode64) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode65) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode63)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId61) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode62))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId61[String] = 6372912251695766465
@SiteCode62[String] = 6373083879921857377
@FDictionaryCode63[String] = OrderState
@FDictionaryCode64[String] = UrgentDegree
@FDictionaryCode65[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083900444931227
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:34
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode68)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId66) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode67)))	
Parameters:
@ProjectId66[String] = 6372912251695766465
@SiteCode67[String] = 6373083900444931227
@FDictionaryCode68[String] = OrderState
@FDictionaryCode69[String] = UrgentDegree
@FDictionaryCode70[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:34
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode69) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode70) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode68)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId66) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode67))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId66[String] = 6372912251695766465
@SiteCode67[String] = 6373083900444931227
@FDictionaryCode68[String] = OrderState
@FDictionaryCode69[String] = UrgentDegree
@FDictionaryCode70[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083891969846476
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode73)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId71) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode72)))	
Parameters:
@ProjectId71[String] = 6372912251695766465
@SiteCode72[String] = 6373083891969846476
@FDictionaryCode73[String] = OrderState
@FDictionaryCode74[String] = UrgentDegree
@FDictionaryCode75[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode74) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode75) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode73)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId71) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode72))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId71[String] = 6372912251695766465
@SiteCode72[String] = 6373083891969846476
@FDictionaryCode73[String] = OrderState
@FDictionaryCode74[String] = UrgentDegree
@FDictionaryCode75[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083889697116488
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode78)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId76) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode77)))	
Parameters:
@ProjectId76[String] = 6372912251695766465
@SiteCode77[String] = 6373083889697116488
@FDictionaryCode78[String] = OrderState
@FDictionaryCode79[String] = UrgentDegree
@FDictionaryCode80[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:38
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode79) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode80) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode78)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId76) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode77))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId76[String] = 6372912251695766465
@SiteCode77[String] = 6373083889697116488
@FDictionaryCode78[String] = OrderState
@FDictionaryCode79[String] = UrgentDegree
@FDictionaryCode80[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:41
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:41
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode83)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId81) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode82)))	
Parameters:
@ProjectId81[String] = 6372912251695766465
@SiteCode82[String] = 6373083923489249281
@FDictionaryCode83[String] = OrderState
@FDictionaryCode84[String] = UrgentDegree
@FDictionaryCode85[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:41
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode84) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode85) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode83)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId81) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode82))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId81[String] = 6372912251695766465
@SiteCode82[String] = 6373083923489249281
@FDictionaryCode83[String] = OrderState
@FDictionaryCode84[String] = UrgentDegree
@FDictionaryCode85[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 16:33:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 16:33:42
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 16:33:42
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 16:33:46
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 16:33:52
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode87) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode88) 	
Parameters:
@SiteCode87[String] = 6373083923489249281
@ComponentCode88[String] = L21_Z08_00KT_DXT_DXT_FJ%


-----------------------------------------------------------------------------
2020-08-20 16:33:52
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 16:33:52
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_%


-----------------------------------------------------------------------------
2020-08-20 16:33:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm89,@MxGjBm90,@MxGjBm91) 	
Parameters:
@MxGjBm89[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01
@MxGjBm90[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01
@MxGjBm91[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01


-----------------------------------------------------------------------------
2020-08-20 16:33:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode92,@ComponentCode93,@ComponentCode94)) AND ([TbModelOtherInfo].[Type] = @Type95) 	
Parameters:
@ComponentCode92[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@ComponentCode93[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@ComponentCode94[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type95[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 16:34:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:34:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:34:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId96,@MxGjId97) 	
Parameters:
@MxGjId96[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId97[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:34:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode98,@ComponentCode99)) AND ([TbModelOtherInfo].[Type] = @Type100) 	
Parameters:
@ComponentCode98[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode99[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type100[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:34:45
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:34:45
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:34:45
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId101,@MxGjId102) 	
Parameters:
@MxGjId101[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId102[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:34:45
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode103,@ComponentCode104)) AND ([TbModelOtherInfo].[Type] = @Type105) 	
Parameters:
@ComponentCode103[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode104[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type105[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:34:46
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:34:46
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 16:34:46
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId106,@MxGjId107) 	
Parameters:
@MxGjId106[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId107[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 16:34:46
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode108,@ComponentCode109)) AND ([TbModelOtherInfo].[Type] = @Type110) 	
Parameters:
@ComponentCode108[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode109[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type110[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:34:48
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:34:48
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 16:34:48
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId111,@MxGjId112) 	
Parameters:
@MxGjId111[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId112[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 16:34:48
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode113,@ComponentCode114)) AND ([TbModelOtherInfo].[Type] = @Type115) 	
Parameters:
@ComponentCode113[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode114[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type115[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:35:01
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:35:01
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:35:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId116,@MxGjId117) 	
Parameters:
@MxGjId116[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId117[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:35:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode118,@ComponentCode119)) AND ([TbModelOtherInfo].[Type] = @Type120) 	
Parameters:
@ComponentCode118[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode119[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type120[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:35:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:35:03
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 16:35:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId121,@MxGjId122) 	
Parameters:
@MxGjId121[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId122[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 16:35:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode123,@ComponentCode124)) AND ([TbModelOtherInfo].[Type] = @Type125) 	
Parameters:
@ComponentCode123[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode124[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type125[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:35:12
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:35:12
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:35:12
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId126,@MxGjId127) 	
Parameters:
@MxGjId126[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId127[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:35:12
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode128,@ComponentCode129)) AND ([TbModelOtherInfo].[Type] = @Type130) 	
Parameters:
@ComponentCode128[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode129[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type130[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:35:29
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:35:29
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:35:29
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId131,@MxGjId132) 	
Parameters:
@MxGjId131[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId132[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:35:29
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode133,@ComponentCode134)) AND ([TbModelOtherInfo].[Type] = @Type135) 	
Parameters:
@ComponentCode133[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode134[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type135[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:36:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:37:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:37:53
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:37:53
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId136,@MxGjId137) 	
Parameters:
@MxGjId136[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId137[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:37:53
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode138,@ComponentCode139)) AND ([TbModelOtherInfo].[Type] = @Type140) 	
Parameters:
@ComponentCode138[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode139[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type140[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:37:58
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:37:58
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 16:37:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId141,@MxGjId142) 	
Parameters:
@MxGjId141[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId142[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 16:37:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode143,@ComponentCode144)) AND ([TbModelOtherInfo].[Type] = @Type145) 	
Parameters:
@ComponentCode143[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode144[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type145[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:38:00
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:38:00
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 16:38:00
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId146,@MxGjId147) 	
Parameters:
@MxGjId146[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId147[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 16:38:00
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode148,@ComponentCode149)) AND ([TbModelOtherInfo].[Type] = @Type150) 	
Parameters:
@ComponentCode148[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode149[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type150[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:38:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:38:02
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 16:38:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId151,@MxGjId152) 	
Parameters:
@MxGjId151[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId152[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 16:38:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode153,@ComponentCode154)) AND ([TbModelOtherInfo].[Type] = @Type155) 	
Parameters:
@ComponentCode153[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode154[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type155[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:38:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:38:10
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:38:10
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId156,@MxGjId157) 	
Parameters:
@MxGjId156[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId157[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:38:10
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode158,@ComponentCode159)) AND ([TbModelOtherInfo].[Type] = @Type160) 	
Parameters:
@ComponentCode158[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode159[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type160[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:39:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:41:33
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:41:33
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 16:41:33
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId161,@MxGjId162) 	
Parameters:
@MxGjId161[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId162[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 16:41:33
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode163,@ComponentCode164)) AND ([TbModelOtherInfo].[Type] = @Type165) 	
Parameters:
@ComponentCode163[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode164[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type165[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:41:36
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:41:36
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF_%


-----------------------------------------------------------------------------
2020-08-20 16:41:36
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId166,@MxGjId167) 	
Parameters:
@MxGjId166[String] = 0e382df2-9fac-4985-bc30-079fc902135d
@MxGjId167[String] = ef5c8605-fcc4-4e81-a453-17749613ec5f


-----------------------------------------------------------------------------
2020-08-20 16:41:36
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode168,@ComponentCode169)) AND ([TbModelOtherInfo].[Type] = @Type170) 	
Parameters:
@ComponentCode168[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-A01_000
@ComponentCode169[String] = L21_Z08_00KT_DXT_DXT_FJ_SEF-B01_000
@Type170[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:41:39
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:41:39
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 16:41:39
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId171,@MxGjId172) 	
Parameters:
@MxGjId171[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId172[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 16:41:39
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode173,@ComponentCode174)) AND ([TbModelOtherInfo].[Type] = @Type175) 	
Parameters:
@ComponentCode173[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode174[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type175[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:41:44
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 16:41:44
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF_%


-----------------------------------------------------------------------------
2020-08-20 16:41:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId176,@MxGjId177) 	
Parameters:
@MxGjId176[String] = d43df6dc-647e-49cb-8a6c-c628ff244243
@MxGjId177[String] = 74e538d3-7989-46de-866a-b023c6cfa6eb


-----------------------------------------------------------------------------
2020-08-20 16:41:44
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode178,@ComponentCode179)) AND ([TbModelOtherInfo].[Type] = @Type180) 	
Parameters:
@ComponentCode178[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-A01_000
@ComponentCode179[String] = L21_Z08_00KT_DXT_DXT_FJ_FAF-B01_000
@Type180[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 16:42:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:45:35
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:48:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:51:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:54:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 16:57:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:00:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:03:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:03:58
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 17:03:58
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF_%


-----------------------------------------------------------------------------
2020-08-20 17:03:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId181,@MxGjId182) 	
Parameters:
@MxGjId181[String] = 262e2102-0715-46b9-b78a-fac71f3f7a8c
@MxGjId182[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 17:03:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode183,@ComponentCode184)) AND ([TbModelOtherInfo].[Type] = @Type185) 	
Parameters:
@ComponentCode183[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@ComponentCode184[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type185[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:06:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:07:03
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode186) AND ([TbModelOtherInfo].[Type] = @Type187) 	
Parameters:
@ComponentCode186[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type187[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:07:03
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode189,[PlanTime]=@PlanTime190,[Remark]=@Remark191,[SiteCode]=@SiteCode192,[Type]=@Type193,[ProjectId]=@ProjectId194 WHERE [TbModelOtherInfo].[ID] = @ID188	
Parameters:
@ComponentCode189[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime190[DateTime] = 2020/8/18 0:00:00
@Remark191[String] = 
@SiteCode192[String] = 6373083923489249281
@Type193[Int32] = 2
@ProjectId194[String] = 6372912251695766465
@ID188[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:07:05
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type195) 	
Parameters:
@Type195[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:07:05
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode196,@Type197,@ProjectId198);select scope_identity()	
Parameters:
@SiteCode196[String] = 6373083923489249281
@Type197[Int32] = 1
@ProjectId198[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:07:07
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode199) AND ([TbModelOtherInfo].[Type] = @Type200) 	
Parameters:
@ComponentCode199[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type200[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:07:07
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode202,[PlanTime]=@PlanTime203,[Remark]=@Remark204,[SiteCode]=@SiteCode205,[Type]=@Type206,[ProjectId]=@ProjectId207 WHERE [TbModelOtherInfo].[ID] = @ID201	
Parameters:
@ComponentCode202[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime203[DateTime] = 2020/8/13 0:00:00
@Remark204[String] = 
@SiteCode205[String] = 6373083923489249281
@Type206[Int32] = 2
@ProjectId207[String] = 6372912251695766465
@ID201[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:07:08
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode208) AND ([TbModelOtherInfo].[Type] = @Type209) 	
Parameters:
@ComponentCode208[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type209[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:07:08
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode211,[PlanTime]=@PlanTime212,[Remark]=@Remark213,[SiteCode]=@SiteCode214,[Type]=@Type215,[ProjectId]=@ProjectId216 WHERE [TbModelOtherInfo].[ID] = @ID210	
Parameters:
@ComponentCode211[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime212[DateTime] = 2020/8/18 0:00:00
@Remark213[String] = 
@SiteCode214[String] = 6373083923489249281
@Type215[Int32] = 2
@ProjectId216[String] = 6372912251695766465
@ID210[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:07:22
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode217) AND ([TbModelOtherInfo].[Type] = @Type218) 	
Parameters:
@ComponentCode217[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type218[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:07:23
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode220,[Remark]=@Remark221,[SiteCode]=@SiteCode222,[Type]=@Type223,[ProjectId]=@ProjectId224 WHERE [TbModelOtherInfo].[ID] = @ID219	
Parameters:
@ComponentCode220[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Remark221[String] = 
@SiteCode222[String] = 6373083923489249281
@Type223[Int32] = 2
@ProjectId224[String] = 6372912251695766465
@ID219[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:07:23
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type225) 	
Parameters:
@Type225[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:07:23
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime226,@Remark227,@SiteCode228,@Type229,@ProjectId230);select scope_identity()	
Parameters:
@PlanTime226[DateTime] = 2020/8/20 0:00:00
@Remark227[String] = 
@SiteCode228[String] = 6373083923489249281
@Type229[Int32] = 1
@ProjectId230[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:07:24
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type231) 	
Parameters:
@Type231[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:07:24
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode232,@Type233,@ProjectId234);select scope_identity()	
Parameters:
@SiteCode232[String] = 6373083923489249281
@Type233[Int32] = 1
@ProjectId234[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:07:25
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode235) AND ([TbModelOtherInfo].[Type] = @Type236) 	
Parameters:
@ComponentCode235[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type236[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:07:25
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode238,[PlanTime]=@PlanTime239,[Remark]=@Remark240,[SiteCode]=@SiteCode241,[Type]=@Type242,[ProjectId]=@ProjectId243 WHERE [TbModelOtherInfo].[ID] = @ID237	
Parameters:
@ComponentCode238[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime239[DateTime] = 2020/8/5 0:00:00
@Remark240[String] = 
@SiteCode241[String] = 6373083923489249281
@Type242[Int32] = 2
@ProjectId243[String] = 6372912251695766465
@ID237[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:07:28
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type244) 	
Parameters:
@Type244[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:07:28
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime245,@Remark246,@SiteCode247,@Type248,@ProjectId249);select scope_identity()	
Parameters:
@PlanTime245[DateTime] = 2020/8/21 0:00:00
@Remark246[String] = 
@SiteCode247[String] = 6373083923489249281
@Type248[Int32] = 1
@ProjectId249[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:07:29
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type250) 	
Parameters:
@Type250[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:07:29
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime251,@Remark252,@SiteCode253,@Type254,@ProjectId255);select scope_identity()	
Parameters:
@PlanTime251[DateTime] = 2020/8/20 0:00:00
@Remark252[String] = 
@SiteCode253[String] = 6373083923489249281
@Type254[Int32] = 1
@ProjectId255[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:08:33
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type256) 	
Parameters:
@Type256[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:08:33
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime257,@Remark258,@SiteCode259,@Type260,@ProjectId261);select scope_identity()	
Parameters:
@PlanTime257[DateTime] = 2020/8/21 0:00:00
@Remark258[String] = 
@SiteCode259[String] = 6373083923489249281
@Type260[Int32] = 1
@ProjectId261[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:08:36
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type262) 	
Parameters:
@Type262[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:08:36
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode263,@Type264,@ProjectId265);select scope_identity()	
Parameters:
@SiteCode263[String] = 6373083923489249281
@Type264[Int32] = 1
@ProjectId265[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:08:38
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode266) AND ([TbModelOtherInfo].[Type] = @Type267) 	
Parameters:
@ComponentCode266[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type267[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:08:38
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode269,[PlanTime]=@PlanTime270,[Remark]=@Remark271,[SiteCode]=@SiteCode272,[Type]=@Type273,[ProjectId]=@ProjectId274 WHERE [TbModelOtherInfo].[ID] = @ID268	
Parameters:
@ComponentCode269[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@PlanTime270[DateTime] = 2020/8/15 0:00:00
@Remark271[String] = 
@SiteCode272[String] = 6373083923489249281
@Type273[Int32] = 2
@ProjectId274[String] = 6372912251695766465
@ID268[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:08:39
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode275) AND ([TbModelOtherInfo].[Type] = @Type276) 	
Parameters:
@ComponentCode275[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type276[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:08:39
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode278,[PlanTime]=@PlanTime279,[Remark]=@Remark280,[SiteCode]=@SiteCode281,[Type]=@Type282,[ProjectId]=@ProjectId283 WHERE [TbModelOtherInfo].[ID] = @ID277	
Parameters:
@ComponentCode278[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime279[DateTime] = 2020/8/5 0:00:00
@Remark280[String] = 
@SiteCode281[String] = 6373083923489249281
@Type282[Int32] = 2
@ProjectId283[String] = 6372912251695766465
@ID277[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:08:49
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode284) AND ([TbModelOtherInfo].[Type] = @Type285) 	
Parameters:
@ComponentCode284[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Type285[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:08:49
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode287,[Remark]=@Remark288,[SiteCode]=@SiteCode289,[Type]=@Type290,[ProjectId]=@ProjectId291 WHERE [TbModelOtherInfo].[ID] = @ID286	
Parameters:
@ComponentCode287[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-A01_000
@Remark288[String] = 
@SiteCode289[String] = 6373083923489249281
@Type290[Int32] = 2
@ProjectId291[String] = 6372912251695766465
@ID286[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:08:49
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode292) AND ([TbModelOtherInfo].[Type] = @Type293) 	
Parameters:
@ComponentCode292[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type293[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:08:49
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode295,[PlanTime]=@PlanTime296,[Remark]=@Remark297,[SiteCode]=@SiteCode298,[Type]=@Type299,[ProjectId]=@ProjectId300 WHERE [TbModelOtherInfo].[ID] = @ID294	
Parameters:
@ComponentCode295[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@PlanTime296[DateTime] = 2020/8/5 0:00:00
@Remark297[String] = 
@SiteCode298[String] = 6373083923489249281
@Type299[Int32] = 2
@ProjectId300[String] = 6372912251695766465
@ID294[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type301) AND ([TbOrganizationMap].[ProjectId] = @ProjectId302)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode303,@CompanyCode304,@CompanyCode305,@CompanyCode306,@CompanyCode307,@CompanyCode308,@CompanyCode309,@CompanyCode310)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode311))) 	
Parameters:
@Type301[Int32] = 1
@ProjectId302[String] = 6372912251695766465
@CompanyCode303[String] = 6373083923489249281
@CompanyCode304[String] = 6373083925531366080
@CompanyCode305[String] = 6373083927883400612
@CompanyCode306[String] = 6373083918575368225
@CompanyCode307[String] = 6373083920445075162
@CompanyCode308[String] = 6373083908618598731
@CompanyCode309[String] = 6373083911842783146
@CompanyCode310[String] = 6373083913928202424
@ParentCompanyCode311[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type312) AND ([TbOrganizationMap].[ProjectId] = @ProjectId313)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode314,@CompanyCode315,@CompanyCode316,@CompanyCode317,@CompanyCode318,@CompanyCode319,@CompanyCode320,@CompanyCode321)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode322))) 	
Parameters:
@Type312[Int32] = 2
@ProjectId313[String] = 6372912251695766465
@CompanyCode314[String] = 6373083923489249281
@CompanyCode315[String] = 6373083925531366080
@CompanyCode316[String] = 6373083927883400612
@CompanyCode317[String] = 6373083918575368225
@CompanyCode318[String] = 6373083920445075162
@CompanyCode319[String] = 6373083908618598731
@CompanyCode320[String] = 6373083911842783146
@CompanyCode321[String] = 6373083913928202424
@ParentCompanyCode322[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/Index


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = ProcessingState


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = UrgentDegree


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/ProblemOrder/Index


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode351)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId323) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode324,@SiteCode325,@SiteCode326,@SiteCode327,@SiteCode328,@SiteCode329,@SiteCode330,@SiteCode331,@SiteCode332,@SiteCode333,@SiteCode334,@SiteCode335,@SiteCode336,@SiteCode337,@SiteCode338,@SiteCode339,@SiteCode340,@SiteCode341,@SiteCode342,@SiteCode343,@SiteCode344,@SiteCode345,@SiteCode346,@SiteCode347,@SiteCode348,@SiteCode349,@SiteCode350)))	
Parameters:
@ProjectId323[String] = 6372912251695766465
@SiteCode324[String] = 6373083923489249281
@SiteCode325[String] = 6373083925531366080
@SiteCode326[String] = 6373083927883400612
@SiteCode327[String] = 6373083918575368225
@SiteCode328[String] = 6373083920445075162
@SiteCode329[String] = 6373083908618598731
@SiteCode330[String] = 6373083911842783146
@SiteCode331[String] = 6373083913928202424
@SiteCode332[String] = 6373083877551621804
@SiteCode333[String] = 6373083879921857377
@SiteCode334[String] = 6373083881542550067
@SiteCode335[String] = 6373083883689772886
@SiteCode336[String] = 6373083887136270013
@SiteCode337[String] = 6373083889697116488
@SiteCode338[String] = 6373083891969846476
@SiteCode339[String] = 6373083894422586761
@SiteCode340[String] = 6373083897509963358
@SiteCode341[String] = 6373083900444931227
@SiteCode342[String] = 6373083829464571372
@SiteCode343[String] = 6373083833327492328
@SiteCode344[String] = 6373083841964286321
@SiteCode345[String] = 6373083844982558950
@SiteCode346[String] = 6373083847585007801
@SiteCode347[String] = 6373083856887939900
@SiteCode348[String] = 6373083859102666584
@SiteCode349[String] = 6373083864919499284
@SiteCode350[String] = 6373334974514214221
@FDictionaryCode351[String] = OrderState
@FDictionaryCode352[String] = UrgentDegree
@FDictionaryCode353[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode352) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode353) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode351)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId323) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode324,@SiteCode325,@SiteCode326,@SiteCode327,@SiteCode328,@SiteCode329,@SiteCode330,@SiteCode331,@SiteCode332,@SiteCode333,@SiteCode334,@SiteCode335,@SiteCode336,@SiteCode337,@SiteCode338,@SiteCode339,@SiteCode340,@SiteCode341,@SiteCode342,@SiteCode343,@SiteCode344,@SiteCode345,@SiteCode346,@SiteCode347,@SiteCode348,@SiteCode349,@SiteCode350))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId323[String] = 6372912251695766465
@SiteCode324[String] = 6373083923489249281
@SiteCode325[String] = 6373083925531366080
@SiteCode326[String] = 6373083927883400612
@SiteCode327[String] = 6373083918575368225
@SiteCode328[String] = 6373083920445075162
@SiteCode329[String] = 6373083908618598731
@SiteCode330[String] = 6373083911842783146
@SiteCode331[String] = 6373083913928202424
@SiteCode332[String] = 6373083877551621804
@SiteCode333[String] = 6373083879921857377
@SiteCode334[String] = 6373083881542550067
@SiteCode335[String] = 6373083883689772886
@SiteCode336[String] = 6373083887136270013
@SiteCode337[String] = 6373083889697116488
@SiteCode338[String] = 6373083891969846476
@SiteCode339[String] = 6373083894422586761
@SiteCode340[String] = 6373083897509963358
@SiteCode341[String] = 6373083900444931227
@SiteCode342[String] = 6373083829464571372
@SiteCode343[String] = 6373083833327492328
@SiteCode344[String] = 6373083841964286321
@SiteCode345[String] = 6373083844982558950
@SiteCode346[String] = 6373083847585007801
@SiteCode347[String] = 6373083856887939900
@SiteCode348[String] = 6373083859102666584
@SiteCode349[String] = 6373083864919499284
@SiteCode350[String] = 6373334974514214221
@FDictionaryCode351[String] = OrderState
@FDictionaryCode352[String] = UrgentDegree
@FDictionaryCode353[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /Production/WorkOrder/OrderPackIndex


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb 	


-----------------------------------------------------------------------------
2020-08-20 17:09:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by PackCode desc)AS Row, * from (select Tb.*,case when Tb.ThisPackNumber>Tb.QsCount and Tb.QsCount>0 then '部分签收' when Tb.QsCount=0 then '未签收' else '已签收' end SignForState from (select b.*,(select COUNT(1) QsCount from TbPackDetail where PackCode=b.PackCode and IsSignFor='是') as QsCount,CONVERT(varchar(100), b.PackDate, 23) as PackDateNew,CONVERT(varchar(100), a.DistributionTime, 23) as DistributionTime,a.SumNumber,a.Major,c.CompanyFullName as SiteName from TbWorkOrder a
left join TbWorkOrderPack b on a.OrderCode=b.OrderCode
left join TbCompany c on a.SiteCode=c.CompanyCode  where 1=1 and b.ID is not null  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')) Tb ) as a)  SELECT * FROM temptbl where Row between 1 and 15	


-----------------------------------------------------------------------------
2020-08-20 17:09:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 17:09:17
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 17:09:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 17:09:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 17:09:17
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:09:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:23
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode356)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId354) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode355)))	
Parameters:
@ProjectId354[String] = 6372912251695766465
@SiteCode355[String] = 6373083923489249281
@FDictionaryCode356[String] = OrderState
@FDictionaryCode357[String] = UrgentDegree
@FDictionaryCode358[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:09:23
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode357) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode358) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode356)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId354) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode355))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId354[String] = 6372912251695766465
@SiteCode355[String] = 6373083923489249281
@FDictionaryCode356[String] = OrderState
@FDictionaryCode357[String] = UrgentDegree
@FDictionaryCode358[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:09:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:09:25
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-20 17:09:25
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 17:09:26
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' then b.ComponentStrat else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.Examinestatus='审核完成' and a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-20 17:09:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:09:35
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode360) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode361) 	
Parameters:
@SiteCode360[String] = 6373083923489249281
@ComponentCode361[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01%


-----------------------------------------------------------------------------
2020-08-20 17:09:35
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 17:09:35
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 17:09:35
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm362) 	
Parameters:
@MxGjBm362[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01


-----------------------------------------------------------------------------
2020-08-20 17:09:35
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode363)) AND ([TbModelOtherInfo].[Type] = @Type364) 	
Parameters:
@ComponentCode363[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type364[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:09:37
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_%


-----------------------------------------------------------------------------
2020-08-20 17:09:37
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId365) 	
Parameters:
@MxGjId365[String] = 23bc6ea6-cf3d-4a7a-ad50-6bea0df02037


-----------------------------------------------------------------------------
2020-08-20 17:09:37
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode366)) AND ([TbModelOtherInfo].[Type] = @Type367) 	
Parameters:
@ComponentCode366[String] = L21_Z08_00KT_DXT_DXT_FJ_RAF-B01_000
@Type367[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:10:18
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type368) 	
Parameters:
@Type368[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:10:18
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode369,@Type370,@ProjectId371);select scope_identity()	
Parameters:
@SiteCode369[String] = 6373083923489249281
@Type370[Int32] = 1
@ProjectId371[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:11:44
Text:	SELECT id,ComponentCode,ComponentName as Name,Length,Size,Area,Material,1 as Total 
                           from TbModel_Property
                           where 1=1 and SiteCode=@SiteCode and Size=@Size and ComponentCode like @ComponentCode	
Parameters:
@SiteCode[String] = 6373083923489249281
@Size[String] = 1400x2000-1400x2000
@ComponentCode[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_%


-----------------------------------------------------------------------------
2020-08-20 17:11:44
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjId] IN (@MxGjId372) 	
Parameters:
@MxGjId372[String] = d43df6dc-647e-49cb-8a6c-c628ff245d60


-----------------------------------------------------------------------------
2020-08-20 17:11:44
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode373)) AND ([TbModelOtherInfo].[Type] = @Type374) 	
Parameters:
@ComponentCode373[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type374[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:11:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type375) 	
Parameters:
@Type375[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:11:57
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode376,@Type377,@ProjectId378);select scope_identity()	
Parameters:
@SiteCode376[String] = 6373083923489249281
@Type377[Int32] = 1
@ProjectId378[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:12:23
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode379) AND ([TbModelOtherInfo].[Type] = @Type380) 	
Parameters:
@ComponentCode379[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type380[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:12:23
Text:	INSERT INTO [TbModelOtherInfo] ([ComponentCode],[PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@ComponentCode381,@PlanTime382,@Remark383,@SiteCode384,@Type385,@ProjectId386);select scope_identity()	
Parameters:
@ComponentCode381[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@PlanTime382[DateTime] = 2020/8/10 0:00:00
@Remark383[String] = 
@SiteCode384[String] = 6373083923489249281
@Type385[Int32] = 2
@ProjectId386[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:12:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:12:37
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type387) 	
Parameters:
@Type387[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:12:37
Text:	INSERT INTO [TbModelOtherInfo] ([Remark],[SiteCode],[Type],[ProjectId]) VALUES (@Remark388,@SiteCode389,@Type390,@ProjectId391);select scope_identity()	
Parameters:
@Remark388[String] = 
@SiteCode389[String] = 6373083923489249281
@Type390[Int32] = 1
@ProjectId391[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:13:02
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode392) AND ([TbModelOtherInfo].[Type] = @Type393) 	
Parameters:
@ComponentCode392[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type393[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:13:02
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode395,[PlanTime]=@PlanTime396,[Remark]=@Remark397,[SiteCode]=@SiteCode398,[Type]=@Type399,[ProjectId]=@ProjectId400 WHERE [TbModelOtherInfo].[ID] = @ID394	
Parameters:
@ComponentCode395[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@PlanTime396[DateTime] = 2020/8/10 0:00:00
@Remark397[String] = 
@SiteCode398[String] = 6373083923489249281
@Type399[Int32] = 2
@ProjectId400[String] = 6372912251695766465
@ID394[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:13:04
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode401) AND ([TbModelOtherInfo].[Type] = @Type402) 	
Parameters:
@ComponentCode401[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type402[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:13:04
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode404,[PlanTime]=@PlanTime405,[Remark]=@Remark406,[SiteCode]=@SiteCode407,[Type]=@Type408,[ProjectId]=@ProjectId409 WHERE [TbModelOtherInfo].[ID] = @ID403	
Parameters:
@ComponentCode404[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@PlanTime405[DateTime] = 2020/8/10 0:00:00
@Remark406[String] = 
@SiteCode407[String] = 6373083923489249281
@Type408[Int32] = 2
@ProjectId409[String] = 6372912251695766465
@ID403[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:13:36
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type410) 	
Parameters:
@Type410[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:13:36
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime411,@Remark412,@SiteCode413,@Type414,@ProjectId415);select scope_identity()	
Parameters:
@PlanTime411[DateTime] = 2020/10/22 0:00:00
@Remark412[String] = 
@SiteCode413[String] = 6373083923489249281
@Type414[Int32] = 1
@ProjectId415[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:13:52
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode416) AND ([TbModelOtherInfo].[Type] = @Type417) 	
Parameters:
@ComponentCode416[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type417[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:13:52
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode419,[PlanTime]=@PlanTime420,[Remark]=@Remark421,[SiteCode]=@SiteCode422,[Type]=@Type423,[ProjectId]=@ProjectId424 WHERE [TbModelOtherInfo].[ID] = @ID418	
Parameters:
@ComponentCode419[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@PlanTime420[DateTime] = 2020/8/10 0:00:00
@Remark421[String] = 
@SiteCode422[String] = 6373083923489249281
@Type423[Int32] = 2
@ProjectId424[String] = 6372912251695766465
@ID418[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:13:56
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type425) 	
Parameters:
@Type425[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:13:56
Text:	INSERT INTO [TbModelOtherInfo] ([PlanTime],[Remark],[SiteCode],[Type],[ProjectId]) VALUES (@PlanTime426,@Remark427,@SiteCode428,@Type429,@ProjectId430);select scope_identity()	
Parameters:
@PlanTime426[DateTime] = 2020/10/22 0:00:00
@Remark427[String] = 
@SiteCode428[String] = 6373083923489249281
@Type429[Int32] = 1
@ProjectId430[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:13:57
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type431) 	
Parameters:
@Type431[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:13:57
Text:	INSERT INTO [TbModelOtherInfo] ([SiteCode],[Type],[ProjectId]) VALUES (@SiteCode432,@Type433,@ProjectId434);select scope_identity()	
Parameters:
@SiteCode432[String] = 6373083923489249281
@Type433[Int32] = 1
@ProjectId434[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:14:10
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] = @ComponentCode435) AND ([TbModelOtherInfo].[Type] = @Type436) 	
Parameters:
@ComponentCode435[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@Type436[Int32] = 2


-----------------------------------------------------------------------------
2020-08-20 17:14:10
Text:	UPDATE [TbModelOtherInfo] SET [ComponentCode]=@ComponentCode438,[PlanTime]=@PlanTime439,[Remark]=@Remark440,[SiteCode]=@SiteCode441,[Type]=@Type442,[ProjectId]=@ProjectId443 WHERE [TbModelOtherInfo].[ID] = @ID437	
Parameters:
@ComponentCode438[String] = L21_Z08_00KT_DXT_DXT_FD_FD2-A02_000
@PlanTime439[DateTime] = 2020/8/14 0:00:00
@Remark440[String] = 
@SiteCode441[String] = 6373083923489249281
@Type442[Int32] = 2
@ProjectId443[String] = 6372912251695766465
@ID437[Int32] = 0


-----------------------------------------------------------------------------
2020-08-20 17:14:15
Text:	 SELECT   TOP 1 * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] is null ) AND ([TbModelOtherInfo].[Type] = @Type444) 	
Parameters:
@Type444[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:14:15
Text:	INSERT INTO [TbModelOtherInfo] ([Remark],[SiteCode],[Type],[ProjectId]) VALUES (@Remark445,@SiteCode446,@Type447,@ProjectId448);select scope_identity()	
Parameters:
@Remark445[String] = 
@SiteCode446[String] = 6373083923489249281
@Type447[Int32] = 1
@ProjectId448[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:15:34
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:16:08
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 17:16:08
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 17:16:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type449) AND ([TbOrganizationMap].[ProjectId] = @ProjectId450)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode451,@CompanyCode452,@CompanyCode453,@CompanyCode454,@CompanyCode455,@CompanyCode456,@CompanyCode457,@CompanyCode458)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode459))) 	
Parameters:
@Type449[Int32] = 1
@ProjectId450[String] = 6372912251695766465
@CompanyCode451[String] = 6373083923489249281
@CompanyCode452[String] = 6373083925531366080
@CompanyCode453[String] = 6373083927883400612
@CompanyCode454[String] = 6373083918575368225
@CompanyCode455[String] = 6373083920445075162
@CompanyCode456[String] = 6373083908618598731
@CompanyCode457[String] = 6373083911842783146
@CompanyCode458[String] = 6373083913928202424
@ParentCompanyCode459[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type460) AND ([TbOrganizationMap].[ProjectId] = @ProjectId461)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode462,@CompanyCode463,@CompanyCode464,@CompanyCode465,@CompanyCode466,@CompanyCode467,@CompanyCode468,@CompanyCode469)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode470))) 	
Parameters:
@Type460[Int32] = 2
@ProjectId461[String] = 6372912251695766465
@CompanyCode462[String] = 6373083923489249281
@CompanyCode463[String] = 6373083925531366080
@CompanyCode464[String] = 6373083927883400612
@CompanyCode465[String] = 6373083918575368225
@CompanyCode466[String] = 6373083920445075162
@CompanyCode467[String] = 6373083908618598731
@CompanyCode468[String] = 6373083911842783146
@CompanyCode469[String] = 6373083913928202424
@ParentCompanyCode470[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode499)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId471) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490,@SiteCode491,@SiteCode492,@SiteCode493,@SiteCode494,@SiteCode495,@SiteCode496,@SiteCode497,@SiteCode498)))	
Parameters:
@ProjectId471[String] = 6372912251695766465
@SiteCode472[String] = 6373083923489249281
@SiteCode473[String] = 6373083925531366080
@SiteCode474[String] = 6373083927883400612
@SiteCode475[String] = 6373083918575368225
@SiteCode476[String] = 6373083920445075162
@SiteCode477[String] = 6373083908618598731
@SiteCode478[String] = 6373083911842783146
@SiteCode479[String] = 6373083913928202424
@SiteCode480[String] = 6373083877551621804
@SiteCode481[String] = 6373083879921857377
@SiteCode482[String] = 6373083881542550067
@SiteCode483[String] = 6373083883689772886
@SiteCode484[String] = 6373083887136270013
@SiteCode485[String] = 6373083889697116488
@SiteCode486[String] = 6373083891969846476
@SiteCode487[String] = 6373083894422586761
@SiteCode488[String] = 6373083897509963358
@SiteCode489[String] = 6373083900444931227
@SiteCode490[String] = 6373083829464571372
@SiteCode491[String] = 6373083833327492328
@SiteCode492[String] = 6373083841964286321
@SiteCode493[String] = 6373083844982558950
@SiteCode494[String] = 6373083847585007801
@SiteCode495[String] = 6373083856887939900
@SiteCode496[String] = 6373083859102666584
@SiteCode497[String] = 6373083864919499284
@SiteCode498[String] = 6373334974514214221
@FDictionaryCode499[String] = OrderState
@FDictionaryCode500[String] = UrgentDegree
@FDictionaryCode501[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode500) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode501) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode499)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId471) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode472,@SiteCode473,@SiteCode474,@SiteCode475,@SiteCode476,@SiteCode477,@SiteCode478,@SiteCode479,@SiteCode480,@SiteCode481,@SiteCode482,@SiteCode483,@SiteCode484,@SiteCode485,@SiteCode486,@SiteCode487,@SiteCode488,@SiteCode489,@SiteCode490,@SiteCode491,@SiteCode492,@SiteCode493,@SiteCode494,@SiteCode495,@SiteCode496,@SiteCode497,@SiteCode498))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId471[String] = 6372912251695766465
@SiteCode472[String] = 6373083923489249281
@SiteCode473[String] = 6373083925531366080
@SiteCode474[String] = 6373083927883400612
@SiteCode475[String] = 6373083918575368225
@SiteCode476[String] = 6373083920445075162
@SiteCode477[String] = 6373083908618598731
@SiteCode478[String] = 6373083911842783146
@SiteCode479[String] = 6373083913928202424
@SiteCode480[String] = 6373083877551621804
@SiteCode481[String] = 6373083879921857377
@SiteCode482[String] = 6373083881542550067
@SiteCode483[String] = 6373083883689772886
@SiteCode484[String] = 6373083887136270013
@SiteCode485[String] = 6373083889697116488
@SiteCode486[String] = 6373083891969846476
@SiteCode487[String] = 6373083894422586761
@SiteCode488[String] = 6373083897509963358
@SiteCode489[String] = 6373083900444931227
@SiteCode490[String] = 6373083829464571372
@SiteCode491[String] = 6373083833327492328
@SiteCode492[String] = 6373083841964286321
@SiteCode493[String] = 6373083844982558950
@SiteCode494[String] = 6373083847585007801
@SiteCode495[String] = 6373083856887939900
@SiteCode496[String] = 6373083859102666584
@SiteCode497[String] = 6373083864919499284
@SiteCode498[String] = 6373334974514214221
@FDictionaryCode499[String] = OrderState
@FDictionaryCode500[String] = UrgentDegree
@FDictionaryCode501[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 17:16:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 17:16:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083925531366080
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:16:15
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083925531366080')	


-----------------------------------------------------------------------------
2020-08-20 17:16:15
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-20 17:16:16
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode503) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode504) 	
Parameters:
@SiteCode503[String] = 6373083925531366080
@ComponentCode504[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:16:17
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:16:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:16:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm505,@MxGjBm506,@MxGjBm507,@MxGjBm508,@MxGjBm509,@MxGjBm510,@MxGjBm511,@MxGjBm512,@MxGjBm513,@MxGjBm514,@MxGjBm515,@MxGjBm516,@MxGjBm517,@MxGjBm518,@MxGjBm519,@MxGjBm520,@MxGjBm521,@MxGjBm522,@MxGjBm523,@MxGjBm524,@MxGjBm525,@MxGjBm526,@MxGjBm527,@MxGjBm528,@MxGjBm529,@MxGjBm530,@MxGjBm531,@MxGjBm532,@MxGjBm533,@MxGjBm534,@MxGjBm535,@MxGjBm536,@MxGjBm537,@MxGjBm538,@MxGjBm539,@MxGjBm540,@MxGjBm541,@MxGjBm542,@MxGjBm543,@MxGjBm544,@MxGjBm545,@MxGjBm546) 	
Parameters:
@MxGjBm505[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm506[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm507[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm508[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm509[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm510[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm511[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm512[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm513[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm514[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm515[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm516[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm517[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm518[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm519[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm520[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm521[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm522[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm523[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm524[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm525[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm526[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm527[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm528[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm529[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm530[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm531[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm532[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm533[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm534[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm535[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm536[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm537[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm538[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm539[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm540[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm541[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm542[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm543[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm544[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm545[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm546[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:16:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode547,@ComponentCode548,@ComponentCode549,@ComponentCode550,@ComponentCode551,@ComponentCode552,@ComponentCode553,@ComponentCode554,@ComponentCode555,@ComponentCode556,@ComponentCode557,@ComponentCode558,@ComponentCode559,@ComponentCode560,@ComponentCode561,@ComponentCode562,@ComponentCode563,@ComponentCode564,@ComponentCode565,@ComponentCode566,@ComponentCode567,@ComponentCode568,@ComponentCode569,@ComponentCode570,@ComponentCode571,@ComponentCode572,@ComponentCode573,@ComponentCode574,@ComponentCode575,@ComponentCode576,@ComponentCode577,@ComponentCode578,@ComponentCode579,@ComponentCode580,@ComponentCode581,@ComponentCode582,@ComponentCode583,@ComponentCode584,@ComponentCode585,@ComponentCode586,@ComponentCode587,@ComponentCode588)) AND ([TbModelOtherInfo].[Type] = @Type589) 	
Parameters:
@ComponentCode547[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode548[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode549[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode550[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode551[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode552[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode553[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode554[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode555[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode556[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode557[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode558[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode559[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode560[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode561[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode562[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode563[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode564[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode565[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode566[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode567[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode568[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode569[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode570[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode571[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode572[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode573[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode574[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode575[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode576[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode577[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode578[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode579[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode580[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode581[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode582[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode583[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode584[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode585[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode586[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode587[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode588[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type589[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:22:35
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode590) AND ([TbUser].[UserPwd] = @UserPwd591) 	
Parameters:
@UserCode590[String] = 500000
@UserPwd591[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode592 	
Parameters:
@UserCode592[String] = 500000


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu593,@ActionType594,@HostName595,@LogDate596,@UserCode597,@UserIP598);select scope_identity()	
Parameters:
@ActionMenu593[String] = 0
@ActionType594[String] = 登录系统
@HostName595[String] = 
@LogDate596[DateTime] = 2020/8/20 17:22:36
@UserCode597[String] = 500000
@UserIP598[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 17:22:36
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 17:22:37
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type599) AND ([TbOrganizationMap].[ProjectId] = @ProjectId600)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode601,@CompanyCode602,@CompanyCode603,@CompanyCode604,@CompanyCode605,@CompanyCode606,@CompanyCode607,@CompanyCode608)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode609))) 	
Parameters:
@Type599[Int32] = 1
@ProjectId600[String] = 6372912251695766465
@CompanyCode601[String] = 6373083923489249281
@CompanyCode602[String] = 6373083925531366080
@CompanyCode603[String] = 6373083927883400612
@CompanyCode604[String] = 6373083918575368225
@CompanyCode605[String] = 6373083920445075162
@CompanyCode606[String] = 6373083908618598731
@CompanyCode607[String] = 6373083911842783146
@CompanyCode608[String] = 6373083913928202424
@ParentCompanyCode609[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type610) AND ([TbOrganizationMap].[ProjectId] = @ProjectId611)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode612,@CompanyCode613,@CompanyCode614,@CompanyCode615,@CompanyCode616,@CompanyCode617,@CompanyCode618,@CompanyCode619)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode620))) 	
Parameters:
@Type610[Int32] = 2
@ProjectId611[String] = 6372912251695766465
@CompanyCode612[String] = 6373083923489249281
@CompanyCode613[String] = 6373083925531366080
@CompanyCode614[String] = 6373083927883400612
@CompanyCode615[String] = 6373083918575368225
@CompanyCode616[String] = 6373083920445075162
@CompanyCode617[String] = 6373083908618598731
@CompanyCode618[String] = 6373083911842783146
@CompanyCode619[String] = 6373083913928202424
@ParentCompanyCode620[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode649)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId621) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode622,@SiteCode623,@SiteCode624,@SiteCode625,@SiteCode626,@SiteCode627,@SiteCode628,@SiteCode629,@SiteCode630,@SiteCode631,@SiteCode632,@SiteCode633,@SiteCode634,@SiteCode635,@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648)))	
Parameters:
@ProjectId621[String] = 6372912251695766465
@SiteCode622[String] = 6373083923489249281
@SiteCode623[String] = 6373083925531366080
@SiteCode624[String] = 6373083927883400612
@SiteCode625[String] = 6373083918575368225
@SiteCode626[String] = 6373083920445075162
@SiteCode627[String] = 6373083908618598731
@SiteCode628[String] = 6373083911842783146
@SiteCode629[String] = 6373083913928202424
@SiteCode630[String] = 6373083877551621804
@SiteCode631[String] = 6373083879921857377
@SiteCode632[String] = 6373083881542550067
@SiteCode633[String] = 6373083883689772886
@SiteCode634[String] = 6373083887136270013
@SiteCode635[String] = 6373083889697116488
@SiteCode636[String] = 6373083891969846476
@SiteCode637[String] = 6373083894422586761
@SiteCode638[String] = 6373083897509963358
@SiteCode639[String] = 6373083900444931227
@SiteCode640[String] = 6373083829464571372
@SiteCode641[String] = 6373083833327492328
@SiteCode642[String] = 6373083841964286321
@SiteCode643[String] = 6373083844982558950
@SiteCode644[String] = 6373083847585007801
@SiteCode645[String] = 6373083856887939900
@SiteCode646[String] = 6373083859102666584
@SiteCode647[String] = 6373083864919499284
@SiteCode648[String] = 6373334974514214221
@FDictionaryCode649[String] = OrderState
@FDictionaryCode650[String] = UrgentDegree
@FDictionaryCode651[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode650) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode651) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode649)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId621) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode622,@SiteCode623,@SiteCode624,@SiteCode625,@SiteCode626,@SiteCode627,@SiteCode628,@SiteCode629,@SiteCode630,@SiteCode631,@SiteCode632,@SiteCode633,@SiteCode634,@SiteCode635,@SiteCode636,@SiteCode637,@SiteCode638,@SiteCode639,@SiteCode640,@SiteCode641,@SiteCode642,@SiteCode643,@SiteCode644,@SiteCode645,@SiteCode646,@SiteCode647,@SiteCode648))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId621[String] = 6372912251695766465
@SiteCode622[String] = 6373083923489249281
@SiteCode623[String] = 6373083925531366080
@SiteCode624[String] = 6373083927883400612
@SiteCode625[String] = 6373083918575368225
@SiteCode626[String] = 6373083920445075162
@SiteCode627[String] = 6373083908618598731
@SiteCode628[String] = 6373083911842783146
@SiteCode629[String] = 6373083913928202424
@SiteCode630[String] = 6373083877551621804
@SiteCode631[String] = 6373083879921857377
@SiteCode632[String] = 6373083881542550067
@SiteCode633[String] = 6373083883689772886
@SiteCode634[String] = 6373083887136270013
@SiteCode635[String] = 6373083889697116488
@SiteCode636[String] = 6373083891969846476
@SiteCode637[String] = 6373083894422586761
@SiteCode638[String] = 6373083897509963358
@SiteCode639[String] = 6373083900444931227
@SiteCode640[String] = 6373083829464571372
@SiteCode641[String] = 6373083833327492328
@SiteCode642[String] = 6373083841964286321
@SiteCode643[String] = 6373083844982558950
@SiteCode644[String] = 6373083847585007801
@SiteCode645[String] = 6373083856887939900
@SiteCode646[String] = 6373083859102666584
@SiteCode647[String] = 6373083864919499284
@SiteCode648[String] = 6373334974514214221
@FDictionaryCode649[String] = OrderState
@FDictionaryCode650[String] = UrgentDegree
@FDictionaryCode651[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:22:38
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 17:22:40
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 17:22:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 17:22:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 17:22:40
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:22:44
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083925531366080
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:22:44
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083925531366080')	


-----------------------------------------------------------------------------
2020-08-20 17:22:44
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-20 17:23:16
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode653) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode654) 	
Parameters:
@SiteCode653[String] = 6373083925531366080
@ComponentCode654[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:23:17
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:23:17
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:23:17
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm655,@MxGjBm656,@MxGjBm657,@MxGjBm658,@MxGjBm659,@MxGjBm660,@MxGjBm661,@MxGjBm662,@MxGjBm663,@MxGjBm664,@MxGjBm665,@MxGjBm666,@MxGjBm667,@MxGjBm668,@MxGjBm669,@MxGjBm670,@MxGjBm671,@MxGjBm672,@MxGjBm673,@MxGjBm674,@MxGjBm675,@MxGjBm676,@MxGjBm677,@MxGjBm678,@MxGjBm679,@MxGjBm680,@MxGjBm681,@MxGjBm682,@MxGjBm683,@MxGjBm684,@MxGjBm685,@MxGjBm686,@MxGjBm687,@MxGjBm688,@MxGjBm689,@MxGjBm690,@MxGjBm691,@MxGjBm692,@MxGjBm693,@MxGjBm694,@MxGjBm695,@MxGjBm696) 	
Parameters:
@MxGjBm655[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm656[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm657[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm658[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm659[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm660[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm661[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm662[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm663[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm664[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm665[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm666[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm667[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm668[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm669[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm670[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm671[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm672[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm673[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm674[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm675[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm676[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm677[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm678[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm679[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm680[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm681[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm682[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm683[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm684[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm685[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm686[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm687[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm688[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm689[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm690[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm691[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm692[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm693[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm694[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm695[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm696[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:23:17
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode697,@ComponentCode698,@ComponentCode699,@ComponentCode700,@ComponentCode701,@ComponentCode702,@ComponentCode703,@ComponentCode704,@ComponentCode705,@ComponentCode706,@ComponentCode707,@ComponentCode708,@ComponentCode709,@ComponentCode710,@ComponentCode711,@ComponentCode712,@ComponentCode713,@ComponentCode714,@ComponentCode715,@ComponentCode716,@ComponentCode717,@ComponentCode718,@ComponentCode719,@ComponentCode720,@ComponentCode721,@ComponentCode722,@ComponentCode723,@ComponentCode724,@ComponentCode725,@ComponentCode726,@ComponentCode727,@ComponentCode728,@ComponentCode729,@ComponentCode730,@ComponentCode731,@ComponentCode732,@ComponentCode733,@ComponentCode734,@ComponentCode735,@ComponentCode736,@ComponentCode737,@ComponentCode738)) AND ([TbModelOtherInfo].[Type] = @Type739) 	
Parameters:
@ComponentCode697[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode698[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode699[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode700[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode701[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode702[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode703[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode704[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode705[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode706[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode707[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode708[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode709[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode710[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode711[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode712[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode713[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode714[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode715[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode716[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode717[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode718[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode719[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode720[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode721[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode722[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode723[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode724[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode725[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode726[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode727[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode728[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode729[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode730[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode731[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode732[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode733[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode734[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode735[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode736[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode737[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode738[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type739[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type740) AND ([TbOrganizationMap].[ProjectId] = @ProjectId741)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode742,@CompanyCode743,@CompanyCode744,@CompanyCode745,@CompanyCode746,@CompanyCode747,@CompanyCode748,@CompanyCode749)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode750))) 	
Parameters:
@Type740[Int32] = 1
@ProjectId741[String] = 6372912251695766465
@CompanyCode742[String] = 6373083923489249281
@CompanyCode743[String] = 6373083925531366080
@CompanyCode744[String] = 6373083927883400612
@CompanyCode745[String] = 6373083918575368225
@CompanyCode746[String] = 6373083920445075162
@CompanyCode747[String] = 6373083908618598731
@CompanyCode748[String] = 6373083911842783146
@CompanyCode749[String] = 6373083913928202424
@ParentCompanyCode750[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type751) AND ([TbOrganizationMap].[ProjectId] = @ProjectId752)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode753,@CompanyCode754,@CompanyCode755,@CompanyCode756,@CompanyCode757,@CompanyCode758,@CompanyCode759,@CompanyCode760)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode761))) 	
Parameters:
@Type751[Int32] = 2
@ProjectId752[String] = 6372912251695766465
@CompanyCode753[String] = 6373083923489249281
@CompanyCode754[String] = 6373083925531366080
@CompanyCode755[String] = 6373083927883400612
@CompanyCode756[String] = 6373083918575368225
@CompanyCode757[String] = 6373083920445075162
@CompanyCode758[String] = 6373083908618598731
@CompanyCode759[String] = 6373083911842783146
@CompanyCode760[String] = 6373083913928202424
@ParentCompanyCode761[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode790)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId762) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode763,@SiteCode764,@SiteCode765,@SiteCode766,@SiteCode767,@SiteCode768,@SiteCode769,@SiteCode770,@SiteCode771,@SiteCode772,@SiteCode773,@SiteCode774,@SiteCode775,@SiteCode776,@SiteCode777,@SiteCode778,@SiteCode779,@SiteCode780,@SiteCode781,@SiteCode782,@SiteCode783,@SiteCode784,@SiteCode785,@SiteCode786,@SiteCode787,@SiteCode788,@SiteCode789)))	
Parameters:
@ProjectId762[String] = 6372912251695766465
@SiteCode763[String] = 6373083923489249281
@SiteCode764[String] = 6373083925531366080
@SiteCode765[String] = 6373083927883400612
@SiteCode766[String] = 6373083918575368225
@SiteCode767[String] = 6373083920445075162
@SiteCode768[String] = 6373083908618598731
@SiteCode769[String] = 6373083911842783146
@SiteCode770[String] = 6373083913928202424
@SiteCode771[String] = 6373083877551621804
@SiteCode772[String] = 6373083879921857377
@SiteCode773[String] = 6373083881542550067
@SiteCode774[String] = 6373083883689772886
@SiteCode775[String] = 6373083887136270013
@SiteCode776[String] = 6373083889697116488
@SiteCode777[String] = 6373083891969846476
@SiteCode778[String] = 6373083894422586761
@SiteCode779[String] = 6373083897509963358
@SiteCode780[String] = 6373083900444931227
@SiteCode781[String] = 6373083829464571372
@SiteCode782[String] = 6373083833327492328
@SiteCode783[String] = 6373083841964286321
@SiteCode784[String] = 6373083844982558950
@SiteCode785[String] = 6373083847585007801
@SiteCode786[String] = 6373083856887939900
@SiteCode787[String] = 6373083859102666584
@SiteCode788[String] = 6373083864919499284
@SiteCode789[String] = 6373334974514214221
@FDictionaryCode790[String] = OrderState
@FDictionaryCode791[String] = UrgentDegree
@FDictionaryCode792[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:24:05
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode791) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode792) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode790)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId762) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode763,@SiteCode764,@SiteCode765,@SiteCode766,@SiteCode767,@SiteCode768,@SiteCode769,@SiteCode770,@SiteCode771,@SiteCode772,@SiteCode773,@SiteCode774,@SiteCode775,@SiteCode776,@SiteCode777,@SiteCode778,@SiteCode779,@SiteCode780,@SiteCode781,@SiteCode782,@SiteCode783,@SiteCode784,@SiteCode785,@SiteCode786,@SiteCode787,@SiteCode788,@SiteCode789))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId762[String] = 6372912251695766465
@SiteCode763[String] = 6373083923489249281
@SiteCode764[String] = 6373083925531366080
@SiteCode765[String] = 6373083927883400612
@SiteCode766[String] = 6373083918575368225
@SiteCode767[String] = 6373083920445075162
@SiteCode768[String] = 6373083908618598731
@SiteCode769[String] = 6373083911842783146
@SiteCode770[String] = 6373083913928202424
@SiteCode771[String] = 6373083877551621804
@SiteCode772[String] = 6373083879921857377
@SiteCode773[String] = 6373083881542550067
@SiteCode774[String] = 6373083883689772886
@SiteCode775[String] = 6373083887136270013
@SiteCode776[String] = 6373083889697116488
@SiteCode777[String] = 6373083891969846476
@SiteCode778[String] = 6373083894422586761
@SiteCode779[String] = 6373083897509963358
@SiteCode780[String] = 6373083900444931227
@SiteCode781[String] = 6373083829464571372
@SiteCode782[String] = 6373083833327492328
@SiteCode783[String] = 6373083841964286321
@SiteCode784[String] = 6373083844982558950
@SiteCode785[String] = 6373083847585007801
@SiteCode786[String] = 6373083856887939900
@SiteCode787[String] = 6373083859102666584
@SiteCode788[String] = 6373083864919499284
@SiteCode789[String] = 6373334974514214221
@FDictionaryCode790[String] = OrderState
@FDictionaryCode791[String] = UrgentDegree
@FDictionaryCode792[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:24:06
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 17:24:06
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 17:24:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 17:24:06
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 17:24:06
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:24:10
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083925531366080
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:24:10
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083925531366080')	


-----------------------------------------------------------------------------
2020-08-20 17:24:10
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-20 17:24:49
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode794) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode795) 	
Parameters:
@SiteCode794[String] = 6373083925531366080
@ComponentCode795[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:25:08
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:25:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:25:08
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm796,@MxGjBm797,@MxGjBm798,@MxGjBm799,@MxGjBm800,@MxGjBm801,@MxGjBm802,@MxGjBm803,@MxGjBm804,@MxGjBm805,@MxGjBm806,@MxGjBm807,@MxGjBm808,@MxGjBm809,@MxGjBm810,@MxGjBm811,@MxGjBm812,@MxGjBm813,@MxGjBm814,@MxGjBm815,@MxGjBm816,@MxGjBm817,@MxGjBm818,@MxGjBm819,@MxGjBm820,@MxGjBm821,@MxGjBm822,@MxGjBm823,@MxGjBm824,@MxGjBm825,@MxGjBm826,@MxGjBm827,@MxGjBm828,@MxGjBm829,@MxGjBm830,@MxGjBm831,@MxGjBm832,@MxGjBm833,@MxGjBm834,@MxGjBm835,@MxGjBm836,@MxGjBm837) 	
Parameters:
@MxGjBm796[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm797[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm798[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm799[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm800[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm801[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm802[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm803[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm804[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm805[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm806[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm807[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm808[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm809[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm810[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm811[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm812[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm813[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm814[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm815[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm816[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm817[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm818[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm819[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm820[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm821[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm822[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm823[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm824[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm825[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm826[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm827[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm828[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm829[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm830[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm831[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm832[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm833[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm834[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm835[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm836[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm837[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:25:08
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode838,@ComponentCode839,@ComponentCode840,@ComponentCode841,@ComponentCode842,@ComponentCode843,@ComponentCode844,@ComponentCode845,@ComponentCode846,@ComponentCode847,@ComponentCode848,@ComponentCode849,@ComponentCode850,@ComponentCode851,@ComponentCode852,@ComponentCode853,@ComponentCode854,@ComponentCode855,@ComponentCode856,@ComponentCode857,@ComponentCode858,@ComponentCode859,@ComponentCode860,@ComponentCode861,@ComponentCode862,@ComponentCode863,@ComponentCode864,@ComponentCode865,@ComponentCode866,@ComponentCode867,@ComponentCode868,@ComponentCode869,@ComponentCode870,@ComponentCode871,@ComponentCode872,@ComponentCode873,@ComponentCode874,@ComponentCode875,@ComponentCode876,@ComponentCode877,@ComponentCode878,@ComponentCode879)) AND ([TbModelOtherInfo].[Type] = @Type880) 	
Parameters:
@ComponentCode838[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode839[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode840[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode841[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode842[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode843[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode844[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode845[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode846[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode847[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode848[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode849[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode850[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode851[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode852[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode853[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode854[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode855[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode856[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode857[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode858[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode859[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode860[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode861[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode862[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode863[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode864[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode865[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode866[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode867[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode868[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode869[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode870[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode871[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode872[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode873[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode874[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode875[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode876[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode877[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode878[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode879[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type880[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:25:20
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode882) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode883) 	
Parameters:
@SiteCode882[String] = 6373083925531366080
@ComponentCode883[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:27:40
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:41
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm884,@MxGjBm885,@MxGjBm886,@MxGjBm887,@MxGjBm888,@MxGjBm889,@MxGjBm890,@MxGjBm891,@MxGjBm892,@MxGjBm893,@MxGjBm894,@MxGjBm895,@MxGjBm896,@MxGjBm897,@MxGjBm898,@MxGjBm899,@MxGjBm900,@MxGjBm901,@MxGjBm902,@MxGjBm903,@MxGjBm904,@MxGjBm905,@MxGjBm906,@MxGjBm907,@MxGjBm908,@MxGjBm909,@MxGjBm910,@MxGjBm911,@MxGjBm912,@MxGjBm913,@MxGjBm914,@MxGjBm915,@MxGjBm916,@MxGjBm917,@MxGjBm918,@MxGjBm919,@MxGjBm920,@MxGjBm921,@MxGjBm922,@MxGjBm923,@MxGjBm924,@MxGjBm925) 	
Parameters:
@MxGjBm884[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm885[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm886[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm887[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm888[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm889[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm890[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm891[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm892[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm893[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm894[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm895[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm896[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm897[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm898[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm899[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm900[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm901[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm902[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm903[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm904[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm905[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm906[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm907[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm908[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm909[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm910[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm911[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm912[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm913[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm914[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm915[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm916[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm917[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm918[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm919[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm920[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm921[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm922[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm923[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm924[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm925[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:27:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode926,@ComponentCode927,@ComponentCode928,@ComponentCode929,@ComponentCode930,@ComponentCode931,@ComponentCode932,@ComponentCode933,@ComponentCode934,@ComponentCode935,@ComponentCode936,@ComponentCode937,@ComponentCode938,@ComponentCode939,@ComponentCode940,@ComponentCode941,@ComponentCode942,@ComponentCode943,@ComponentCode944,@ComponentCode945,@ComponentCode946,@ComponentCode947,@ComponentCode948,@ComponentCode949,@ComponentCode950,@ComponentCode951,@ComponentCode952,@ComponentCode953,@ComponentCode954,@ComponentCode955,@ComponentCode956,@ComponentCode957,@ComponentCode958,@ComponentCode959,@ComponentCode960,@ComponentCode961,@ComponentCode962,@ComponentCode963,@ComponentCode964,@ComponentCode965,@ComponentCode966,@ComponentCode967)) AND ([TbModelOtherInfo].[Type] = @Type968) 	
Parameters:
@ComponentCode926[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode927[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode928[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode929[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode930[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode931[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode932[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode933[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode934[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode935[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode936[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode937[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode938[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode939[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode940[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode941[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode942[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode943[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode944[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode945[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode946[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode947[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode948[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode949[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode950[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode951[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode952[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode953[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode954[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode955[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode956[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode957[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode958[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode959[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode960[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode961[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode962[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode963[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode964[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode965[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode966[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode967[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type968[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:27:41
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:27:56
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode970) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode971) 	
Parameters:
@SiteCode970[String] = 6373083925531366080
@ComponentCode971[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:27:56
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:56
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:56
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm972,@MxGjBm973,@MxGjBm974,@MxGjBm975,@MxGjBm976,@MxGjBm977,@MxGjBm978,@MxGjBm979,@MxGjBm980,@MxGjBm981,@MxGjBm982,@MxGjBm983,@MxGjBm984,@MxGjBm985,@MxGjBm986,@MxGjBm987,@MxGjBm988,@MxGjBm989,@MxGjBm990,@MxGjBm991,@MxGjBm992,@MxGjBm993,@MxGjBm994,@MxGjBm995,@MxGjBm996,@MxGjBm997,@MxGjBm998,@MxGjBm999,@MxGjBm1000,@MxGjBm1001,@MxGjBm1002,@MxGjBm1003,@MxGjBm1004,@MxGjBm1005,@MxGjBm1006,@MxGjBm1007,@MxGjBm1008,@MxGjBm1009,@MxGjBm1010,@MxGjBm1011,@MxGjBm1012,@MxGjBm1013) 	
Parameters:
@MxGjBm972[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm973[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm974[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm975[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm976[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm977[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm978[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm979[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm980[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm981[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm982[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm983[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm984[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm985[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm986[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm987[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm988[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm989[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm990[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm991[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm992[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm993[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm994[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm995[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm996[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm997[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm998[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm999[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1000[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1001[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1002[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1003[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1004[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1005[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1006[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1007[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1008[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1009[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1010[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1011[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1012[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1013[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:27:56
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1014,@ComponentCode1015,@ComponentCode1016,@ComponentCode1017,@ComponentCode1018,@ComponentCode1019,@ComponentCode1020,@ComponentCode1021,@ComponentCode1022,@ComponentCode1023,@ComponentCode1024,@ComponentCode1025,@ComponentCode1026,@ComponentCode1027,@ComponentCode1028,@ComponentCode1029,@ComponentCode1030,@ComponentCode1031,@ComponentCode1032,@ComponentCode1033,@ComponentCode1034,@ComponentCode1035,@ComponentCode1036,@ComponentCode1037,@ComponentCode1038,@ComponentCode1039,@ComponentCode1040,@ComponentCode1041,@ComponentCode1042,@ComponentCode1043,@ComponentCode1044,@ComponentCode1045,@ComponentCode1046,@ComponentCode1047,@ComponentCode1048,@ComponentCode1049,@ComponentCode1050,@ComponentCode1051,@ComponentCode1052,@ComponentCode1053,@ComponentCode1054,@ComponentCode1055)) AND ([TbModelOtherInfo].[Type] = @Type1056) 	
Parameters:
@ComponentCode1014[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode1015[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode1016[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode1017[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode1018[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode1019[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1020[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1021[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1022[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1023[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1024[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1025[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1026[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1027[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1028[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1029[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1030[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1031[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1032[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1033[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1034[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1035[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1036[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1037[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1038[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1039[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1040[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1041[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1042[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1043[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1044[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1045[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1046[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1047[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1048[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1049[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1050[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1051[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1052[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1053[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1054[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1055[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1056[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:27:58
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1058) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1059) 	
Parameters:
@SiteCode1058[String] = 6373083925531366080
@ComponentCode1059[String] = L21_Z17_PDZM_DL_DL_CZ%


-----------------------------------------------------------------------------
2020-08-20 17:27:58
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:58
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1060,@MxGjBm1061,@MxGjBm1062,@MxGjBm1063,@MxGjBm1064,@MxGjBm1065,@MxGjBm1066,@MxGjBm1067,@MxGjBm1068,@MxGjBm1069,@MxGjBm1070,@MxGjBm1071,@MxGjBm1072,@MxGjBm1073,@MxGjBm1074,@MxGjBm1075,@MxGjBm1076,@MxGjBm1077,@MxGjBm1078,@MxGjBm1079,@MxGjBm1080,@MxGjBm1081,@MxGjBm1082,@MxGjBm1083,@MxGjBm1084,@MxGjBm1085,@MxGjBm1086,@MxGjBm1087,@MxGjBm1088,@MxGjBm1089,@MxGjBm1090,@MxGjBm1091,@MxGjBm1092,@MxGjBm1093,@MxGjBm1094,@MxGjBm1095,@MxGjBm1096,@MxGjBm1097,@MxGjBm1098,@MxGjBm1099,@MxGjBm1100) 	
Parameters:
@MxGjBm1060[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm1061[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1062[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1063[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1064[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1065[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1066[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1067[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1068[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1069[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1070[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1071[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1072[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1073[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1074[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1075[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1076[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1077[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1078[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1079[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1080[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1081[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1082[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1083[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1084[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1085[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1086[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1087[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1088[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1089[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1090[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1091[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1092[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1093[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1094[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1095[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1096[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1097[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1098[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1099[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1100[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:27:58
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1101,@ComponentCode1102,@ComponentCode1103,@ComponentCode1104,@ComponentCode1105,@ComponentCode1106,@ComponentCode1107,@ComponentCode1108,@ComponentCode1109,@ComponentCode1110,@ComponentCode1111,@ComponentCode1112,@ComponentCode1113,@ComponentCode1114,@ComponentCode1115,@ComponentCode1116,@ComponentCode1117,@ComponentCode1118,@ComponentCode1119,@ComponentCode1120,@ComponentCode1121,@ComponentCode1122,@ComponentCode1123,@ComponentCode1124,@ComponentCode1125,@ComponentCode1126,@ComponentCode1127,@ComponentCode1128,@ComponentCode1129,@ComponentCode1130,@ComponentCode1131,@ComponentCode1132,@ComponentCode1133,@ComponentCode1134,@ComponentCode1135,@ComponentCode1136,@ComponentCode1137,@ComponentCode1138,@ComponentCode1139,@ComponentCode1140,@ComponentCode1141)) AND ([TbModelOtherInfo].[Type] = @Type1142) 	
Parameters:
@ComponentCode1101[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode1102[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode1103[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode1104[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode1105[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1106[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1107[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1108[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1109[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1110[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1111[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1112[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1113[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1114[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1115[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1116[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1117[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1118[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1119[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1120[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1121[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1122[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1123[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1124[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1125[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1126[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1127[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1128[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1129[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1130[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1131[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1132[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1133[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1134[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1135[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1136[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1137[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1138[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1139[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1140[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1141[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1142[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:27:59
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1144) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1145) 	
Parameters:
@SiteCode1144[String] = 6373083925531366080
@ComponentCode1145[String] = L21_Z17_PDZM_DL_DL_PDX%


-----------------------------------------------------------------------------
2020-08-20 17:27:59
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:59
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:27:59
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1146,@MxGjBm1147,@MxGjBm1148,@MxGjBm1149,@MxGjBm1150,@MxGjBm1151,@MxGjBm1152,@MxGjBm1153,@MxGjBm1154,@MxGjBm1155,@MxGjBm1156,@MxGjBm1157,@MxGjBm1158,@MxGjBm1159,@MxGjBm1160,@MxGjBm1161,@MxGjBm1162,@MxGjBm1163,@MxGjBm1164,@MxGjBm1165,@MxGjBm1166,@MxGjBm1167,@MxGjBm1168,@MxGjBm1169,@MxGjBm1170,@MxGjBm1171,@MxGjBm1172,@MxGjBm1173,@MxGjBm1174,@MxGjBm1175,@MxGjBm1176,@MxGjBm1177,@MxGjBm1178,@MxGjBm1179,@MxGjBm1180,@MxGjBm1181,@MxGjBm1182,@MxGjBm1183,@MxGjBm1184,@MxGjBm1185) 	
Parameters:
@MxGjBm1146[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1147[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1148[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1149[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1150[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1151[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1152[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1153[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1154[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1155[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1156[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1157[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1158[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1159[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1160[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1161[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1162[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1163[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1164[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1165[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1166[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1167[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1168[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1169[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1170[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1171[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1172[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1173[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1174[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1175[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1176[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1177[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1178[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1179[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1180[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1181[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1182[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1183[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1184[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1185[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:27:59
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1186,@ComponentCode1187,@ComponentCode1188,@ComponentCode1189,@ComponentCode1190,@ComponentCode1191,@ComponentCode1192,@ComponentCode1193,@ComponentCode1194,@ComponentCode1195,@ComponentCode1196,@ComponentCode1197,@ComponentCode1198,@ComponentCode1199,@ComponentCode1200,@ComponentCode1201,@ComponentCode1202,@ComponentCode1203,@ComponentCode1204,@ComponentCode1205,@ComponentCode1206,@ComponentCode1207,@ComponentCode1208,@ComponentCode1209,@ComponentCode1210,@ComponentCode1211,@ComponentCode1212,@ComponentCode1213,@ComponentCode1214,@ComponentCode1215,@ComponentCode1216,@ComponentCode1217,@ComponentCode1218,@ComponentCode1219,@ComponentCode1220,@ComponentCode1221,@ComponentCode1222,@ComponentCode1223,@ComponentCode1224,@ComponentCode1225)) AND ([TbModelOtherInfo].[Type] = @Type1226) 	
Parameters:
@ComponentCode1186[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode1187[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode1188[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode1189[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1190[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1191[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1192[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1193[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1194[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1195[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1196[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1197[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1198[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1199[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1200[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1201[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1202[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1203[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1204[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1205[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1206[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1207[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1208[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1209[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1210[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1211[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1212[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1213[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1214[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1215[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1216[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1217[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1218[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1219[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1220[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1221[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1222[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1223[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1224[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1225[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1226[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:28:00
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1228) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1229) 	
Parameters:
@SiteCode1228[String] = 6373083925531366080
@ComponentCode1229[String] = L21_Z17_PDZM_DL_DL_XG%


-----------------------------------------------------------------------------
2020-08-20 17:28:00
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:00
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:00
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1230,@MxGjBm1231,@MxGjBm1232,@MxGjBm1233,@MxGjBm1234,@MxGjBm1235,@MxGjBm1236,@MxGjBm1237,@MxGjBm1238,@MxGjBm1239,@MxGjBm1240,@MxGjBm1241,@MxGjBm1242,@MxGjBm1243,@MxGjBm1244,@MxGjBm1245,@MxGjBm1246,@MxGjBm1247,@MxGjBm1248,@MxGjBm1249,@MxGjBm1250,@MxGjBm1251,@MxGjBm1252,@MxGjBm1253,@MxGjBm1254,@MxGjBm1255,@MxGjBm1256,@MxGjBm1257,@MxGjBm1258,@MxGjBm1259,@MxGjBm1260,@MxGjBm1261,@MxGjBm1262,@MxGjBm1263,@MxGjBm1264,@MxGjBm1265,@MxGjBm1266) 	
Parameters:
@MxGjBm1230[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1231[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1232[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1233[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1234[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1235[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1236[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1237[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1238[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1239[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1240[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1241[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1242[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1243[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1244[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1245[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1246[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1247[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1248[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1249[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1250[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1251[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1252[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1253[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1254[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1255[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1256[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1257[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1258[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1259[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1260[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1261[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1262[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1263[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1264[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1265[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1266[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:28:00
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1267,@ComponentCode1268,@ComponentCode1269,@ComponentCode1270,@ComponentCode1271,@ComponentCode1272,@ComponentCode1273,@ComponentCode1274,@ComponentCode1275,@ComponentCode1276,@ComponentCode1277,@ComponentCode1278,@ComponentCode1279,@ComponentCode1280,@ComponentCode1281,@ComponentCode1282,@ComponentCode1283,@ComponentCode1284,@ComponentCode1285,@ComponentCode1286,@ComponentCode1287,@ComponentCode1288,@ComponentCode1289,@ComponentCode1290,@ComponentCode1291,@ComponentCode1292,@ComponentCode1293,@ComponentCode1294,@ComponentCode1295,@ComponentCode1296,@ComponentCode1297,@ComponentCode1298,@ComponentCode1299,@ComponentCode1300,@ComponentCode1301,@ComponentCode1302,@ComponentCode1303)) AND ([TbModelOtherInfo].[Type] = @Type1304) 	
Parameters:
@ComponentCode1267[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1268[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1269[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1270[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1271[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1272[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1273[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1274[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1275[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1276[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1277[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1278[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1279[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1280[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1281[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1282[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1283[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1284[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1285[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1286[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1287[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1288[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1289[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1290[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1291[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1292[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1293[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1294[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1295[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1296[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1297[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1298[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1299[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1300[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1301[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1302[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1303[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1304[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:28:01
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1306) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1307) 	
Parameters:
@SiteCode1306[String] = 6373083925531366080
@ComponentCode1307[String] = L21_Z17_PDZM_DL_DL_XC%


-----------------------------------------------------------------------------
2020-08-20 17:28:01
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:01
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1308,@MxGjBm1309,@MxGjBm1310,@MxGjBm1311,@MxGjBm1312,@MxGjBm1313,@MxGjBm1314,@MxGjBm1315,@MxGjBm1316,@MxGjBm1317,@MxGjBm1318,@MxGjBm1319,@MxGjBm1320,@MxGjBm1321,@MxGjBm1322,@MxGjBm1323,@MxGjBm1324,@MxGjBm1325,@MxGjBm1326,@MxGjBm1327,@MxGjBm1328,@MxGjBm1329,@MxGjBm1330,@MxGjBm1331,@MxGjBm1332,@MxGjBm1333,@MxGjBm1334,@MxGjBm1335,@MxGjBm1336,@MxGjBm1337,@MxGjBm1338,@MxGjBm1339,@MxGjBm1340,@MxGjBm1341) 	
Parameters:
@MxGjBm1308[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1309[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1310[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1311[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1312[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1313[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1314[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1315[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1316[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1317[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1318[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1319[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1320[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1321[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1322[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1323[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1324[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1325[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1326[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1327[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1328[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1329[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1330[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1331[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1332[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1333[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1334[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1335[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1336[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1337[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1338[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1339[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1340[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1341[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:28:01
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1342,@ComponentCode1343,@ComponentCode1344,@ComponentCode1345,@ComponentCode1346,@ComponentCode1347,@ComponentCode1348,@ComponentCode1349,@ComponentCode1350,@ComponentCode1351,@ComponentCode1352,@ComponentCode1353,@ComponentCode1354,@ComponentCode1355,@ComponentCode1356,@ComponentCode1357,@ComponentCode1358,@ComponentCode1359,@ComponentCode1360,@ComponentCode1361,@ComponentCode1362,@ComponentCode1363,@ComponentCode1364,@ComponentCode1365,@ComponentCode1366,@ComponentCode1367,@ComponentCode1368,@ComponentCode1369,@ComponentCode1370,@ComponentCode1371,@ComponentCode1372,@ComponentCode1373,@ComponentCode1374,@ComponentCode1375)) AND ([TbModelOtherInfo].[Type] = @Type1376) 	
Parameters:
@ComponentCode1342[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1343[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1344[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1345[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1346[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1347[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1348[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1349[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1350[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1351[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1352[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1353[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1354[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1355[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1356[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1357[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1358[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1359[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1360[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1361[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1362[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1363[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1364[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1365[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1366[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1367[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1368[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1369[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1370[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1371[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1372[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1373[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1374[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1375[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1376[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:28:02
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1378) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1379) 	
Parameters:
@SiteCode1378[String] = 6373083925531366080
@ComponentCode1379[String] = L21_Z17_PDZM_DL_DL_QJ%


-----------------------------------------------------------------------------
2020-08-20 17:28:02
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:02
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:02
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1380,@MxGjBm1381,@MxGjBm1382,@MxGjBm1383,@MxGjBm1384,@MxGjBm1385,@MxGjBm1386,@MxGjBm1387,@MxGjBm1388,@MxGjBm1389,@MxGjBm1390,@MxGjBm1391,@MxGjBm1392,@MxGjBm1393,@MxGjBm1394,@MxGjBm1395,@MxGjBm1396,@MxGjBm1397,@MxGjBm1398,@MxGjBm1399,@MxGjBm1400,@MxGjBm1401,@MxGjBm1402,@MxGjBm1403,@MxGjBm1404,@MxGjBm1405,@MxGjBm1406) 	
Parameters:
@MxGjBm1380[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1381[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1382[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1383[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1384[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1385[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1386[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1387[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1388[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1389[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1390[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1391[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1392[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1393[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1394[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1395[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1396[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1397[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1398[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1399[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1400[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1401[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1402[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1403[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1404[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1405[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1406[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:28:02
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1407,@ComponentCode1408,@ComponentCode1409,@ComponentCode1410,@ComponentCode1411,@ComponentCode1412,@ComponentCode1413,@ComponentCode1414,@ComponentCode1415,@ComponentCode1416,@ComponentCode1417,@ComponentCode1418,@ComponentCode1419,@ComponentCode1420,@ComponentCode1421,@ComponentCode1422,@ComponentCode1423,@ComponentCode1424,@ComponentCode1425,@ComponentCode1426,@ComponentCode1427,@ComponentCode1428,@ComponentCode1429,@ComponentCode1430,@ComponentCode1431,@ComponentCode1432,@ComponentCode1433)) AND ([TbModelOtherInfo].[Type] = @Type1434) 	
Parameters:
@ComponentCode1407[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1408[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1409[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1410[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1411[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1412[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1413[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1414[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1415[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1416[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1417[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1418[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1419[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1420[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1421[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1422[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1423[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1424[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1425[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1426[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1427[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1428[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1429[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1430[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1431[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1432[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1433[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1434[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:28:03
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1436) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1437) 	
Parameters:
@SiteCode1436[String] = 6373083925531366080
@ComponentCode1437[String] = L21_Z17_PDZM_DL_DL_QJPJ%


-----------------------------------------------------------------------------
2020-08-20 17:28:03
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:03
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:28:03
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1438) 	
Parameters:
@MxGjBm1438[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:28:03
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1439)) AND ([TbModelOtherInfo].[Type] = @Type1440) 	
Parameters:
@ComponentCode1439[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1440[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:28:04
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1442) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1443) 	
Parameters:
@SiteCode1442[String] = 6373083925531366080
@ComponentCode1443[String] = L21_Z17_PDZM_DL_DL_PDG%


-----------------------------------------------------------------------------
2020-08-20 17:28:23
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1445) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1446) 	
Parameters:
@SiteCode1445[String] = 6373083925531366080
@ComponentCode1446[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:32:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:32:45
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:32:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:32:45
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1447,@MxGjBm1448,@MxGjBm1449,@MxGjBm1450,@MxGjBm1451,@MxGjBm1452,@MxGjBm1453,@MxGjBm1454,@MxGjBm1455,@MxGjBm1456,@MxGjBm1457,@MxGjBm1458,@MxGjBm1459,@MxGjBm1460,@MxGjBm1461,@MxGjBm1462,@MxGjBm1463,@MxGjBm1464,@MxGjBm1465,@MxGjBm1466,@MxGjBm1467,@MxGjBm1468,@MxGjBm1469,@MxGjBm1470,@MxGjBm1471,@MxGjBm1472,@MxGjBm1473,@MxGjBm1474,@MxGjBm1475,@MxGjBm1476,@MxGjBm1477,@MxGjBm1478,@MxGjBm1479,@MxGjBm1480,@MxGjBm1481,@MxGjBm1482,@MxGjBm1483,@MxGjBm1484,@MxGjBm1485,@MxGjBm1486,@MxGjBm1487,@MxGjBm1488) 	
Parameters:
@MxGjBm1447[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm1448[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm1449[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1450[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1451[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1452[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1453[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1454[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1455[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1456[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1457[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1458[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1459[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1460[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1461[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1462[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1463[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1464[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1465[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1466[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1467[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1468[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1469[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1470[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1471[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1472[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1473[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1474[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1475[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1476[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1477[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1478[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1479[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1480[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1481[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1482[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1483[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1484[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1485[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1486[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1487[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1488[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:32:45
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1489,@ComponentCode1490,@ComponentCode1491,@ComponentCode1492,@ComponentCode1493,@ComponentCode1494,@ComponentCode1495,@ComponentCode1496,@ComponentCode1497,@ComponentCode1498,@ComponentCode1499,@ComponentCode1500,@ComponentCode1501,@ComponentCode1502,@ComponentCode1503,@ComponentCode1504,@ComponentCode1505,@ComponentCode1506,@ComponentCode1507,@ComponentCode1508,@ComponentCode1509,@ComponentCode1510,@ComponentCode1511,@ComponentCode1512,@ComponentCode1513,@ComponentCode1514,@ComponentCode1515,@ComponentCode1516,@ComponentCode1517,@ComponentCode1518,@ComponentCode1519,@ComponentCode1520,@ComponentCode1521,@ComponentCode1522,@ComponentCode1523,@ComponentCode1524,@ComponentCode1525,@ComponentCode1526,@ComponentCode1527,@ComponentCode1528,@ComponentCode1529,@ComponentCode1530)) AND ([TbModelOtherInfo].[Type] = @Type1531) 	
Parameters:
@ComponentCode1489[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode1490[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode1491[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode1492[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode1493[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode1494[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1495[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1496[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1497[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1498[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1499[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1500[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1501[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1502[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1503[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1504[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1505[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1506[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1507[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1508[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1509[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1510[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1511[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1512[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1513[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1514[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1515[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1516[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1517[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1518[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1519[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1520[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1521[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1522[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1523[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1524[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1525[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1526[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1527[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1528[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1529[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1530[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1531[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:34:18
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode1533) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode1534) 	
Parameters:
@SiteCode1533[String] = 6373083925531366080
@ComponentCode1534[String] = L21_Z17_PDZM_DL_DL_%


-----------------------------------------------------------------------------
2020-08-20 17:34:42
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 or ComponentCode like @ComponentCode7 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL__%
@ComponentCode7[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:34:42
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 or ComponentCode like @ComponentCode7 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL__%
@ComponentCode7[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:34:42
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm1535,@MxGjBm1536,@MxGjBm1537,@MxGjBm1538,@MxGjBm1539,@MxGjBm1540,@MxGjBm1541,@MxGjBm1542,@MxGjBm1543,@MxGjBm1544,@MxGjBm1545,@MxGjBm1546,@MxGjBm1547,@MxGjBm1548,@MxGjBm1549,@MxGjBm1550,@MxGjBm1551,@MxGjBm1552,@MxGjBm1553,@MxGjBm1554,@MxGjBm1555,@MxGjBm1556,@MxGjBm1557,@MxGjBm1558,@MxGjBm1559,@MxGjBm1560,@MxGjBm1561,@MxGjBm1562,@MxGjBm1563,@MxGjBm1564,@MxGjBm1565,@MxGjBm1566,@MxGjBm1567,@MxGjBm1568,@MxGjBm1569,@MxGjBm1570,@MxGjBm1571,@MxGjBm1572,@MxGjBm1573,@MxGjBm1574,@MxGjBm1575,@MxGjBm1576,@MxGjBm1577,@MxGjBm1578,@MxGjBm1579) 	
Parameters:
@MxGjBm1535[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm1536[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm1537[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1538[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1539[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm1540[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1541[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1542[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm1543[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1544[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1545[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1546[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1547[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1548[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1549[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm1550[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1551[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1552[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1553[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1554[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1555[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm1556[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1557[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1558[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1559[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1560[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1561[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1562[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1563[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1564[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1565[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1566[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1567[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1568[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1569[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1570[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1571[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1572[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1573[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1574[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1575[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm1576[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ
@MxGjBm1577[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ
@MxGjBm1578[String] = L21_Z17_PDZM_DL_DL_
XCPJ_WT
@MxGjBm1579[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:34:42
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode1580,@ComponentCode1581,@ComponentCode1582,@ComponentCode1583,@ComponentCode1584,@ComponentCode1585,@ComponentCode1586,@ComponentCode1587,@ComponentCode1588,@ComponentCode1589,@ComponentCode1590,@ComponentCode1591,@ComponentCode1592,@ComponentCode1593,@ComponentCode1594,@ComponentCode1595,@ComponentCode1596,@ComponentCode1597,@ComponentCode1598,@ComponentCode1599,@ComponentCode1600,@ComponentCode1601,@ComponentCode1602,@ComponentCode1603,@ComponentCode1604,@ComponentCode1605,@ComponentCode1606,@ComponentCode1607,@ComponentCode1608,@ComponentCode1609,@ComponentCode1610,@ComponentCode1611,@ComponentCode1612,@ComponentCode1613,@ComponentCode1614,@ComponentCode1615,@ComponentCode1616,@ComponentCode1617,@ComponentCode1618,@ComponentCode1619,@ComponentCode1620,@ComponentCode1621,@ComponentCode1622,@ComponentCode1623,@ComponentCode1624)) AND ([TbModelOtherInfo].[Type] = @Type1625) 	
Parameters:
@ComponentCode1580[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode1581[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode1582[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode1583[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode1584[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode1585[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode1586[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode1587[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode1588[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode1589[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode1590[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode1591[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode1592[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode1593[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode1594[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode1595[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode1596[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode1597[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode1598[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode1599[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode1600[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode1601[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode1602[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode1603[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode1604[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode1605[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode1606[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode1607[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode1608[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode1609[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode1610[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode1611[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode1612[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode1613[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode1614[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode1615[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode1616[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode1617[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode1618[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode1619[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode1620[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode1621[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ_026
@ComponentCode1622[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ_173
@ComponentCode1623[String] = L21_Z17_PDZM_DL_DL_
XCPJ_WT_035
@ComponentCode1624[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type1625[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:34:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:36:04
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:39:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:42:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:45:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:48:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:51:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:54:05
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:54:17
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-20 17:54:17
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-20 17:54:17
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 17:54:18
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-20 17:54:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:54:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50)))	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode52) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode53) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode51)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId23) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode24,@SiteCode25,@SiteCode26,@SiteCode27,@SiteCode28,@SiteCode29,@SiteCode30,@SiteCode31,@SiteCode32,@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId23[String] = 6372912251695766465
@SiteCode24[String] = 6373083923489249281
@SiteCode25[String] = 6373083925531366080
@SiteCode26[String] = 6373083927883400612
@SiteCode27[String] = 6373083918575368225
@SiteCode28[String] = 6373083920445075162
@SiteCode29[String] = 6373083908618598731
@SiteCode30[String] = 6373083911842783146
@SiteCode31[String] = 6373083913928202424
@SiteCode32[String] = 6373083877551621804
@SiteCode33[String] = 6373083879921857377
@SiteCode34[String] = 6373083881542550067
@SiteCode35[String] = 6373083883689772886
@SiteCode36[String] = 6373083887136270013
@SiteCode37[String] = 6373083889697116488
@SiteCode38[String] = 6373083891969846476
@SiteCode39[String] = 6373083894422586761
@SiteCode40[String] = 6373083897509963358
@SiteCode41[String] = 6373083900444931227
@SiteCode42[String] = 6373083829464571372
@SiteCode43[String] = 6373083833327492328
@SiteCode44[String] = 6373083841964286321
@SiteCode45[String] = 6373083844982558950
@SiteCode46[String] = 6373083847585007801
@SiteCode47[String] = 6373083856887939900
@SiteCode48[String] = 6373083859102666584
@SiteCode49[String] = 6373083864919499284
@SiteCode50[String] = 6373334974514214221
@FDictionaryCode51[String] = OrderState
@FDictionaryCode52[String] = UrgentDegree
@FDictionaryCode53[String] = OrderType


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-20 17:54:19
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode and FileName='tmpEBD0'
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-20 17:54:23
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083925531366080
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-20 17:54:23
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083925531366080')	


-----------------------------------------------------------------------------
2020-08-20 17:54:24
Text:	select Major,System,Subsystem,MaterialType,Material,MAX(ComponentCode) as ComponentCode,MAX(FileName) as FileName
                               from 
                               TbModel_Property
                               where SiteCode=@SiteCode and FileName='tmpEBD0'
                               group by Major,System,Subsystem,MaterialType,Material	
Parameters:
@SiteCode[String] = 6373083925531366080


-----------------------------------------------------------------------------
2020-08-20 17:54:28
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode55) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode56) 	
Parameters:
@SiteCode55[String] = 6373083925531366080
@ComponentCode56[String] = L21_Z17_PDZM%


-----------------------------------------------------------------------------
2020-08-20 17:54:31
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:54:32
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:54:32
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm57,@MxGjBm58,@MxGjBm59,@MxGjBm60,@MxGjBm61,@MxGjBm62,@MxGjBm63,@MxGjBm64,@MxGjBm65,@MxGjBm66,@MxGjBm67,@MxGjBm68,@MxGjBm69,@MxGjBm70,@MxGjBm71,@MxGjBm72,@MxGjBm73,@MxGjBm74,@MxGjBm75,@MxGjBm76,@MxGjBm77,@MxGjBm78,@MxGjBm79,@MxGjBm80,@MxGjBm81,@MxGjBm82,@MxGjBm83,@MxGjBm84,@MxGjBm85,@MxGjBm86,@MxGjBm87,@MxGjBm88,@MxGjBm89,@MxGjBm90,@MxGjBm91,@MxGjBm92,@MxGjBm93,@MxGjBm94,@MxGjBm95,@MxGjBm96,@MxGjBm97,@MxGjBm98) 	
Parameters:
@MxGjBm57[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm58[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm59[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm60[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm61[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm62[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm63[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm64[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm65[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm66[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm67[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm68[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm69[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm70[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm71[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm72[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm73[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm74[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm75[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm76[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm77[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm78[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm79[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm80[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm81[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm82[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm83[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm84[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm85[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm86[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm87[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm88[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm89[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm90[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm91[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm92[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm93[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm94[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm95[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm96[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm97[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm98[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:54:32
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode99,@ComponentCode100,@ComponentCode101,@ComponentCode102,@ComponentCode103,@ComponentCode104,@ComponentCode105,@ComponentCode106,@ComponentCode107,@ComponentCode108,@ComponentCode109,@ComponentCode110,@ComponentCode111,@ComponentCode112,@ComponentCode113,@ComponentCode114,@ComponentCode115,@ComponentCode116,@ComponentCode117,@ComponentCode118,@ComponentCode119,@ComponentCode120,@ComponentCode121,@ComponentCode122,@ComponentCode123,@ComponentCode124,@ComponentCode125,@ComponentCode126,@ComponentCode127,@ComponentCode128,@ComponentCode129,@ComponentCode130,@ComponentCode131,@ComponentCode132,@ComponentCode133,@ComponentCode134,@ComponentCode135,@ComponentCode136,@ComponentCode137,@ComponentCode138,@ComponentCode139,@ComponentCode140)) AND ([TbModelOtherInfo].[Type] = @Type141) 	
Parameters:
@ComponentCode99[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode100[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode101[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode102[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode103[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode104[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode105[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode106[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode107[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode108[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode109[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode110[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode111[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode112[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode113[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode114[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode115[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode116[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode117[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode118[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode119[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode120[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode121[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode122[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode123[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode124[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode125[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode126[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode127[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode128[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode129[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode130[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode131[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode132[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode133[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode134[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode135[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode136[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode137[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode138[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode139[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode140[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type141[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:54:38
Text:	 SELECT   * FROM [TbModel_Property]  WHERE ([TbModel_Property].[SiteCode] = @SiteCode143) AND ([TbModel_Property].[ComponentCode] LIKE @ComponentCode144) 	
Parameters:
@SiteCode143[String] = 6373083925531366080
@ComponentCode144[String] = L21_Z17_PDZM_DL_DL_%


-----------------------------------------------------------------------------
2020-08-20 17:54:41
Text:	SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 or ComponentCode like @ComponentCode7 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode 	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL__%
@ComponentCode7[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:54:41
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by Major asc)AS Row, * from (SELECT SiteCode,Major,System,Subsystem,MaterialType,Material,Size,count(*) as Total, MAX(ComponentCode) as ComponentCode
                        from TbModel_Property
                         where 1=1 and SiteCode=@SiteCode and ( ComponentCode like @ComponentCode or ComponentCode like @ComponentCode1 or ComponentCode like @ComponentCode2 or ComponentCode like @ComponentCode3 or ComponentCode like @ComponentCode4 or ComponentCode like @ComponentCode5 or ComponentCode like @ComponentCode6 or ComponentCode like @ComponentCode7 )
                        GROUP BY Major,System,Subsystem,MaterialType,Material,Size,SiteCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	
Parameters:
@SiteCode[String] = 6373083925531366080
@ComponentCode[String] = L21_Z17_PDZM_DL_DL_CZ_%
@ComponentCode1[String] = L21_Z17_PDZM_DL_DL_PDX_%
@ComponentCode2[String] = L21_Z17_PDZM_DL_DL_XG_%
@ComponentCode3[String] = L21_Z17_PDZM_DL_DL_XC_%
@ComponentCode4[String] = L21_Z17_PDZM_DL_DL_QJ_%
@ComponentCode5[String] = L21_Z17_PDZM_DL_DL_QJPJ_%
@ComponentCode6[String] = L21_Z17_PDZM_DL_DL__%
@ComponentCode7[String] = L21_Z17_PDZM_DL_DL_PDG_%


-----------------------------------------------------------------------------
2020-08-20 17:54:41
Text:	 SELECT   * FROM [TbWorkOrderDetail]  WHERE [TbWorkOrderDetail].[MxGjBm] IN (@MxGjBm145,@MxGjBm146,@MxGjBm147,@MxGjBm148,@MxGjBm149,@MxGjBm150,@MxGjBm151,@MxGjBm152,@MxGjBm153,@MxGjBm154,@MxGjBm155,@MxGjBm156,@MxGjBm157,@MxGjBm158,@MxGjBm159,@MxGjBm160,@MxGjBm161,@MxGjBm162,@MxGjBm163,@MxGjBm164,@MxGjBm165,@MxGjBm166,@MxGjBm167,@MxGjBm168,@MxGjBm169,@MxGjBm170,@MxGjBm171,@MxGjBm172,@MxGjBm173,@MxGjBm174,@MxGjBm175,@MxGjBm176,@MxGjBm177,@MxGjBm178,@MxGjBm179,@MxGjBm180,@MxGjBm181,@MxGjBm182,@MxGjBm183,@MxGjBm184,@MxGjBm185,@MxGjBm186,@MxGjBm187,@MxGjBm188,@MxGjBm189) 	
Parameters:
@MxGjBm145[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw
@MxGjBm146[String] = L21_Z17_PDZM_DL_DL_PDX_PDX
@MxGjBm147[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm148[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm149[String] = L21_Z17_PDZM_DL_DL_XG_XG
@MxGjBm150[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm151[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm152[String] = L21_Z17_PDZM_DL_DL_XC_XC
@MxGjBm153[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm154[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm155[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm156[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm157[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm158[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm159[String] = L21_Z17_PDZM_DL_DL_QJ_QJ
@MxGjBm160[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm161[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm162[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm163[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm164[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm165[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ
@MxGjBm166[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm167[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm168[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm169[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm170[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm171[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm172[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm173[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm174[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm175[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm176[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm177[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm178[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm179[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm180[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm181[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm182[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm183[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm184[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm185[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT
@MxGjBm186[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ
@MxGjBm187[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ
@MxGjBm188[String] = L21_Z17_PDZM_DL_DL_
XCPJ_WT
@MxGjBm189[String] = L21_Z17_PDZM_DL_DL_PDG_PDG


-----------------------------------------------------------------------------
2020-08-20 17:54:41
Text:	 SELECT   * FROM [TbModelOtherInfo]  WHERE ([TbModelOtherInfo].[ComponentCode] IN (@ComponentCode190,@ComponentCode191,@ComponentCode192,@ComponentCode193,@ComponentCode194,@ComponentCode195,@ComponentCode196,@ComponentCode197,@ComponentCode198,@ComponentCode199,@ComponentCode200,@ComponentCode201,@ComponentCode202,@ComponentCode203,@ComponentCode204,@ComponentCode205,@ComponentCode206,@ComponentCode207,@ComponentCode208,@ComponentCode209,@ComponentCode210,@ComponentCode211,@ComponentCode212,@ComponentCode213,@ComponentCode214,@ComponentCode215,@ComponentCode216,@ComponentCode217,@ComponentCode218,@ComponentCode219,@ComponentCode220,@ComponentCode221,@ComponentCode222,@ComponentCode223,@ComponentCode224,@ComponentCode225,@ComponentCode226,@ComponentCode227,@ComponentCode228,@ComponentCode229,@ComponentCode230,@ComponentCode231,@ComponentCode232,@ComponentCode233,@ComponentCode234)) AND ([TbModelOtherInfo].[Type] = @Type235) 	
Parameters:
@ComponentCode190[String] = L21_Z17_PDZM_DL_DL_CZ_CZ-1aw_167
@ComponentCode191[String] = L21_Z17_PDZM_DL_DL_PDX_PDX_081
@ComponentCode192[String] = L21_Z17_PDZM_DL_DL_XG_XG_444
@ComponentCode193[String] = L21_Z17_PDZM_DL_DL_XG_XG_448
@ComponentCode194[String] = L21_Z17_PDZM_DL_DL_XG_XG_265
@ComponentCode195[String] = L21_Z17_PDZM_DL_DL_XC_XC_072
@ComponentCode196[String] = L21_Z17_PDZM_DL_DL_XC_XC_219
@ComponentCode197[String] = L21_Z17_PDZM_DL_DL_XC_XC_039
@ComponentCode198[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_432
@ComponentCode199[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_045
@ComponentCode200[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_450
@ComponentCode201[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_424
@ComponentCode202[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_317
@ComponentCode203[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_434
@ComponentCode204[String] = L21_Z17_PDZM_DL_DL_QJ_QJ_361
@ComponentCode205[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_330
@ComponentCode206[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_348
@ComponentCode207[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_322
@ComponentCode208[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_215
@ComponentCode209[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_332
@ComponentCode210[String] = L21_Z17_PDZM_DL_DL_QJPJ_GDJ_259
@ComponentCode211[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_083
@ComponentCode212[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_062
@ComponentCode213[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_079
@ComponentCode214[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_052
@ComponentCode215[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_055
@ComponentCode216[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_073
@ComponentCode217[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_033
@ComponentCode218[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_071
@ComponentCode219[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_050
@ComponentCode220[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_018
@ComponentCode221[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_023
@ComponentCode222[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_022
@ComponentCode223[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_076
@ComponentCode224[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_024
@ComponentCode225[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_032
@ComponentCode226[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_031
@ComponentCode227[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_046
@ComponentCode228[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_043
@ComponentCode229[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_082
@ComponentCode230[String] = L21_Z17_PDZM_DL_DL_QJPJ_WT_016
@ComponentCode231[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ_026
@ComponentCode232[String] = L21_Z17_PDZM_DL_DL_
XCPJ_GDJ_173
@ComponentCode233[String] = L21_Z17_PDZM_DL_DL_
XCPJ_WT_035
@ComponentCode234[String] = L21_Z17_PDZM_DL_DL_PDG_PDG_044
@Type235[Int32] = 1


-----------------------------------------------------------------------------
2020-08-20 17:57:21
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 18:00:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-20 18:03:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
