2020-08-25 10:51:06
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-25 10:51:06
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 10:51:06
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 10:51:06
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 10:51:06
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 10:51:06
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/25 10:51:06
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 10:51:08
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 10:51:08
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 10:51:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 10:51:09
Text:	 SELECT count(*) as r_cnt FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode]) WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59)))	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-25 10:51:10
Text:	 SELECT   TOP 50 [TbWorkOrder].*,[TbCompany].[CompanyFullName] AS [SiteName],[TbSysDictionaryData].[DictionaryText] AS [OrderStateNew],[TbUser].[UserName],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[UrgentDegree]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode61) ) AS [UrgentDegreeNew],( SELECT   [TbSysDictionaryData].[DictionaryText] FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = [TbWorkOrder].[OrderType]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode62) ) AS [OrderTypeNew],( SELECT   count([TbWorkOrderPack].[ID]) AS [ID] FROM [TbWorkOrderPack]  WHERE [TbWorkOrderPack].[OrderCode] = [TbWorkOrder].[OrderCode] ) AS [PackNum] FROM [TbWorkOrder] LEFT OUTER JOIN [TbCompany] ON ([TbWorkOrder].[SiteCode] = [TbCompany].[CompanyCode]) LEFT OUTER JOIN [TbSysDictionaryData] ON (([TbWorkOrder].[OrderState] = [TbSysDictionaryData].[DictionaryCode]) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode60)) LEFT OUTER JOIN [TbUser] ON ([TbWorkOrder].[InsertUserCode] = [TbUser].[UserCode])  WHERE (([TbWorkOrder].[ProjectId] = @ProjectId32) AND ([TbWorkOrder].[SiteCode] IN (@SiteCode33,@SiteCode34,@SiteCode35,@SiteCode36,@SiteCode37,@SiteCode38,@SiteCode39,@SiteCode40,@SiteCode41,@SiteCode42,@SiteCode43,@SiteCode44,@SiteCode45,@SiteCode46,@SiteCode47,@SiteCode48,@SiteCode49,@SiteCode50,@SiteCode51,@SiteCode52,@SiteCode53,@SiteCode54,@SiteCode55,@SiteCode56,@SiteCode57,@SiteCode58,@SiteCode59))) ORDER BY [TbWorkOrder].[ID] DESC 	
Parameters:
@ProjectId32[String] = 6372912251695766465
@SiteCode33[String] = 6373083923489249281
@SiteCode34[String] = 6373083925531366080
@SiteCode35[String] = 6373083927883400612
@SiteCode36[String] = 6373083918575368225
@SiteCode37[String] = 6373083920445075162
@SiteCode38[String] = 6373083908618598731
@SiteCode39[String] = 6373083911842783146
@SiteCode40[String] = 6373083913928202424
@SiteCode41[String] = 6373083877551621804
@SiteCode42[String] = 6373083879921857377
@SiteCode43[String] = 6373083881542550067
@SiteCode44[String] = 6373083883689772886
@SiteCode45[String] = 6373083887136270013
@SiteCode46[String] = 6373083889697116488
@SiteCode47[String] = 6373083891969846476
@SiteCode48[String] = 6373083894422586761
@SiteCode49[String] = 6373083897509963358
@SiteCode50[String] = 6373083900444931227
@SiteCode51[String] = 6373083829464571372
@SiteCode52[String] = 6373083833327492328
@SiteCode53[String] = 6373083841964286321
@SiteCode54[String] = 6373083844982558950
@SiteCode55[String] = 6373083847585007801
@SiteCode56[String] = 6373083856887939900
@SiteCode57[String] = 6373083859102666584
@SiteCode58[String] = 6373083864919499284
@SiteCode59[String] = 6373334974514214221
@FDictionaryCode60[String] = OrderState
@FDictionaryCode61[String] = UrgentDegree
@FDictionaryCode62[String] = OrderType


-----------------------------------------------------------------------------
2020-08-25 10:51:10
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 10:51:25
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 10:51:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 10:52:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = EarlyWarningTimeType


-----------------------------------------------------------------------------
2020-08-25 10:52:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = PoliticalOutlook


-----------------------------------------------------------------------------
2020-08-25 10:52:28
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = OrgType


-----------------------------------------------------------------------------
2020-08-25 10:52:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = EarlyWarningTimeType


-----------------------------------------------------------------------------
2020-08-25 10:54:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 10:57:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:00:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:00:11
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = EarlyWarningTimeType


-----------------------------------------------------------------------------
2020-08-25 11:00:11
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:00:13
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 11:00:33
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 11:00:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 11:00:48
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:00:51
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:01:07
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:02:03
Text:	 SELECT   TOP 1 [TbSysDictionaryType].[id] FROM [TbSysDictionaryType]  WHERE [TbSysDictionaryType].[DictionaryCode] = @DictionaryCode63 	
Parameters:
@DictionaryCode63[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:02:03
Text:	 SELECT   TOP 1 [TbSysDictionaryType].[id] FROM [TbSysDictionaryType]  WHERE [TbSysDictionaryType].[DictionaryType] = @DictionaryType64 	
Parameters:
@DictionaryType64[String] = 滞后百分比


-----------------------------------------------------------------------------
2020-08-25 11:02:03
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu65,@ActionType66,@HostName67,@LogDate68,@UserCode69,@UserIP70);select scope_identity()	
Parameters:
@ActionMenu65[String] = TbSysDictionaryType
@ActionType66[String] = 新增
@HostName67[String] = 
@LogDate68[DateTime] = 2020/8/25 11:02:03
@UserCode69[String] = 500000
@UserIP70[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 11:02:03
Text:	INSERT INTO [TbSysDictionaryType] ([DictionaryCode],[DictionaryType],[PDictionaryCode],[FullCode]) VALUES (@DictionaryCode71,@DictionaryType72,@PDictionaryCode73,@FullCode74);select scope_identity()	
Parameters:
@DictionaryCode71[String] = LagPoint
@DictionaryType72[String] = 滞后百分比
@PDictionaryCode73[String] = 0
@FullCode74[String] = 


-----------------------------------------------------------------------------
2020-08-25 11:02:03
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:02:05
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:02:07
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:03:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:03:29
Text:	 SELECT   * FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode75) AND ([TbSysDictionaryData].[DictionaryText] = @DictionaryText76) 	
Parameters:
@FDictionaryCode75[String] = LagPoint
@DictionaryText76[String] = 0


-----------------------------------------------------------------------------
2020-08-25 11:03:29
Text:	 SELECT   * FROM [TbSysDictionaryData]  WHERE ([TbSysDictionaryData].[DictionaryCode] = @DictionaryCode77) AND ([TbSysDictionaryData].[FDictionaryCode] = @FDictionaryCode78) 	
Parameters:
@DictionaryCode77[String] = LagPoint_6372912251695766465
@FDictionaryCode78[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:03:29
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu79,@ActionType80,@HostName81,@LogDate82,@UserCode83,@UserIP84);select scope_identity()	
Parameters:
@ActionMenu79[String] = TbSysDictionaryData
@ActionType80[String] = 新增
@HostName81[String] = 
@LogDate82[DateTime] = 2020/8/25 11:03:29
@UserCode83[String] = 500000
@UserIP84[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 11:03:29
Text:	INSERT INTO [TbSysDictionaryData] ([FDictionaryCode],[DictionaryCode],[DictionaryText],[DictionaryOrder],[DictionaryValue]) VALUES (@FDictionaryCode85,@DictionaryCode86,@DictionaryText87,@DictionaryOrder88,@DictionaryValue89);select scope_identity()	
Parameters:
@FDictionaryCode85[String] = LagPoint
@DictionaryCode86[String] = LagPoint_6372912251695766465
@DictionaryText87[String] = 0
@DictionaryOrder88[Int32] = 1
@DictionaryValue89[String] = 


-----------------------------------------------------------------------------
2020-08-25 11:03:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:03:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:06:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:09:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:10:00
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = Employee


-----------------------------------------------------------------------------
2020-08-25 11:10:01
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:12:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:15:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:18:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:21:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:24:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:27:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:30:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:31:06
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = LagPoint


-----------------------------------------------------------------------------
2020-08-25 11:31:07
Text:	 SELECT   * FROM [TbSysDictionaryType]  ORDER BY [TbSysDictionaryType].[DictionaryCode] ASC 	


-----------------------------------------------------------------------------
2020-08-25 11:33:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:36:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:39:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:42:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:45:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:48:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:51:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:54:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 11:57:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:00:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:03:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:06:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:09:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:12:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:15:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:18:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:21:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:24:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:27:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:30:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:33:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:36:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:39:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:42:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:45:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:48:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:51:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:54:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 12:57:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:00:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:03:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:06:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:09:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:12:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:15:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:18:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:21:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:24:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:27:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:30:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:33:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:36:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:39:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:42:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:45:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:48:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:51:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:54:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 13:57:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:00:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:03:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:06:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:09:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:12:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:15:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:18:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:21:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:24:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:27:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:30:10
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:30:38
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:30:38
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:30:38
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:30:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:30:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:30:39
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:30:40
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:31:05
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6373083923489249281
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:31:05
Text:	select a.*,b.CompanyFullName as SiteName,c.CompanyFullName as WorkArea ,d.CompanyFullName as Branch 
                            from TbModelOrg a
                            left join TbCompany b on a.SiteCode=b.CompanyCode
                            left join TbCompany c on b.ParentCompanyCode=c.CompanyCode
                            left join TbCompany d on c.ParentCompanyCode=d.CompanyCode where 1=1  and a.ProjectId='6372912251695766465' and a.SiteCode in('6373083923489249281')	


-----------------------------------------------------------------------------
2020-08-25 14:31:05
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-25 14:31:06
Text:	select b.id,b.MxGjId,case when b.IsInstall='否' and b.ComponentStrat!='未加工' then b.ComponentStrat when b.ComponentStrat='未加工' then '已下单' else '安装完成' end Orderstate from TbWorkOrder a
left join TbWorkOrderDetail b on a.OrderCode=b.OrderCode
where a.ProjectId=@ProjectId and a.SiteCode=@SiteCode	
Parameters:
@ProjectId[String] = 6372912251695766465
@SiteCode[String] = 6373083923489249281


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:31:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:31:17
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:31:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:31:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:31:17
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type45) AND ([TbOrganizationMap].[ProjectId] = @ProjectId46)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode55))) 	
Parameters:
@Type45[Int32] = 1
@ProjectId46[String] = 6372912251695766465
@CompanyCode47[String] = 6373083923489249281
@CompanyCode48[String] = 6373083925531366080
@CompanyCode49[String] = 6373083927883400612
@CompanyCode50[String] = 6373083918575368225
@CompanyCode51[String] = 6373083920445075162
@CompanyCode52[String] = 6373083908618598731
@CompanyCode53[String] = 6373083911842783146
@CompanyCode54[String] = 6373083913928202424
@ParentCompanyCode55[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type56) AND ([TbOrganizationMap].[ProjectId] = @ProjectId57)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode66))) 	
Parameters:
@Type56[Int32] = 2
@ProjectId57[String] = 6372912251695766465
@CompanyCode58[String] = 6373083923489249281
@CompanyCode59[String] = 6373083925531366080
@CompanyCode60[String] = 6373083927883400612
@CompanyCode61[String] = 6373083918575368225
@CompanyCode62[String] = 6373083920445075162
@CompanyCode63[String] = 6373083908618598731
@CompanyCode64[String] = 6373083911842783146
@CompanyCode65[String] = 6373083913928202424
@ParentCompanyCode66[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:32:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:32:14
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:32:14
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:32:24
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:32:24
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:34:27
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:34:27
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:34:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:34:28
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:34:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:34:28
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:34:29
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 2451 and 2500	


-----------------------------------------------------------------------------
2020-08-25 14:35:23
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:35:23
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:35:23
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type23) AND ([TbOrganizationMap].[ProjectId] = @ProjectId24)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30,@CompanyCode31,@CompanyCode32)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode33))) 	
Parameters:
@Type23[Int32] = 1
@ProjectId24[String] = 6372912251695766465
@CompanyCode25[String] = 6373083923489249281
@CompanyCode26[String] = 6373083925531366080
@CompanyCode27[String] = 6373083927883400612
@CompanyCode28[String] = 6373083918575368225
@CompanyCode29[String] = 6373083920445075162
@CompanyCode30[String] = 6373083908618598731
@CompanyCode31[String] = 6373083911842783146
@CompanyCode32[String] = 6373083913928202424
@ParentCompanyCode33[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type34) AND ([TbOrganizationMap].[ProjectId] = @ProjectId35)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41,@CompanyCode42,@CompanyCode43)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode44))) 	
Parameters:
@Type34[Int32] = 2
@ProjectId35[String] = 6372912251695766465
@CompanyCode36[String] = 6373083923489249281
@CompanyCode37[String] = 6373083925531366080
@CompanyCode38[String] = 6373083927883400612
@CompanyCode39[String] = 6373083918575368225
@CompanyCode40[String] = 6373083920445075162
@CompanyCode41[String] = 6373083908618598731
@CompanyCode42[String] = 6373083911842783146
@CompanyCode43[String] = 6373083913928202424
@ParentCompanyCode44[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:35:24
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:35:27
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:35:27
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:35:27
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 2451 and 2500	


-----------------------------------------------------------------------------
2020-08-25 14:35:53
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:35:53
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:35:53
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:35:53
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:36:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:36:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:36:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type45) AND ([TbOrganizationMap].[ProjectId] = @ProjectId46)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52,@CompanyCode53,@CompanyCode54)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode55))) 	
Parameters:
@Type45[Int32] = 1
@ProjectId46[String] = 6372912251695766465
@CompanyCode47[String] = 6373083923489249281
@CompanyCode48[String] = 6373083925531366080
@CompanyCode49[String] = 6373083927883400612
@CompanyCode50[String] = 6373083918575368225
@CompanyCode51[String] = 6373083920445075162
@CompanyCode52[String] = 6373083908618598731
@CompanyCode53[String] = 6373083911842783146
@CompanyCode54[String] = 6373083913928202424
@ParentCompanyCode55[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type56) AND ([TbOrganizationMap].[ProjectId] = @ProjectId57)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63,@CompanyCode64,@CompanyCode65)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode66))) 	
Parameters:
@Type56[Int32] = 2
@ProjectId57[String] = 6372912251695766465
@CompanyCode58[String] = 6373083923489249281
@CompanyCode59[String] = 6373083925531366080
@CompanyCode60[String] = 6373083927883400612
@CompanyCode61[String] = 6373083918575368225
@CompanyCode62[String] = 6373083920445075162
@CompanyCode63[String] = 6373083908618598731
@CompanyCode64[String] = 6373083911842783146
@CompanyCode65[String] = 6373083913928202424
@ParentCompanyCode66[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:36:17
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:36:21
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:36:21
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:36:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 2451 and 2500	


-----------------------------------------------------------------------------
2020-08-25 14:36:21
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:36:21
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:36:38
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:36:49
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:37:21
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 2451 and 2500	


-----------------------------------------------------------------------------
2020-08-25 14:39:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:39:33
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:39:33
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:39:33
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:39:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            min(PlanTime)as PlanTime,
                            max(ActualTime)as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 14:39:35
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:39:35
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:39:35
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:39:35
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:41:29
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:41:29
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:41:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(min(PlanTime),'') as PlanTime,
                            isnull(max(ActualTime),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(min(PlanTime),'') as PlanTime,
                            isnull(max(ActualTime),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:41:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:44:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:47:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:47:30
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 14:47:30
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 14:47:31
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type1) AND ([TbOrganizationMap].[ProjectId] = @ProjectId2)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode3,@CompanyCode4,@CompanyCode5,@CompanyCode6,@CompanyCode7,@CompanyCode8,@CompanyCode9,@CompanyCode10)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode11))) 	
Parameters:
@Type1[Int32] = 1
@ProjectId2[String] = 6372912251695766465
@CompanyCode3[String] = 6373083923489249281
@CompanyCode4[String] = 6373083925531366080
@CompanyCode5[String] = 6373083927883400612
@CompanyCode6[String] = 6373083918575368225
@CompanyCode7[String] = 6373083920445075162
@CompanyCode8[String] = 6373083908618598731
@CompanyCode9[String] = 6373083911842783146
@CompanyCode10[String] = 6373083913928202424
@ParentCompanyCode11[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type12) AND ([TbOrganizationMap].[ProjectId] = @ProjectId13)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19,@CompanyCode20,@CompanyCode21)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode22))) 	
Parameters:
@Type12[Int32] = 2
@ProjectId13[String] = 6372912251695766465
@CompanyCode14[String] = 6373083923489249281
@CompanyCode15[String] = 6373083925531366080
@CompanyCode16[String] = 6373083927883400612
@CompanyCode17[String] = 6373083918575368225
@CompanyCode18[String] = 6373083920445075162
@CompanyCode19[String] = 6373083908618598731
@CompanyCode20[String] = 6373083911842783146
@CompanyCode21[String] = 6373083913928202424
@ParentCompanyCode22[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 14:47:32
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 14:50:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:53:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 14:56:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 14:59:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:02:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:05:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:08:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:11:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:14:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:17:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:20:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:23:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:26:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:29:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:32:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:35:31
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:38:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:41:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 15:44:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6487716734823440384
@ProjectId[String] = 6245721945602523136


-----------------------------------------------------------------------------
2020-08-25 16:34:00
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode1) AND ([TbUser].[UserPwd] = @UserPwd2) 	
Parameters:
@UserCode1[String] = 500000
@UserPwd2[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-25 16:34:00
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:34:00
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:34:00
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 16:34:00
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode3 	
Parameters:
@UserCode3[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:34:01
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu4,@ActionType5,@HostName6,@LogDate7,@UserCode8,@UserIP9);select scope_identity()	
Parameters:
@ActionMenu4[String] = 0
@ActionType5[String] = 登录系统
@HostName6[String] = 
@LogDate7[DateTime] = 2020/8/25 16:34:01
@UserCode8[String] = 500000
@UserIP9[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 16:34:02
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 16:34:02
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 16:34:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type10) AND ([TbOrganizationMap].[ProjectId] = @ProjectId11)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode12,@CompanyCode13,@CompanyCode14,@CompanyCode15,@CompanyCode16,@CompanyCode17,@CompanyCode18,@CompanyCode19)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode20))) 	
Parameters:
@Type10[Int32] = 1
@ProjectId11[String] = 6372912251695766465
@CompanyCode12[String] = 6373083923489249281
@CompanyCode13[String] = 6373083925531366080
@CompanyCode14[String] = 6373083927883400612
@CompanyCode15[String] = 6373083918575368225
@CompanyCode16[String] = 6373083920445075162
@CompanyCode17[String] = 6373083908618598731
@CompanyCode18[String] = 6373083911842783146
@CompanyCode19[String] = 6373083913928202424
@ParentCompanyCode20[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type21) AND ([TbOrganizationMap].[ProjectId] = @ProjectId22)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode23,@CompanyCode24,@CompanyCode25,@CompanyCode26,@CompanyCode27,@CompanyCode28,@CompanyCode29,@CompanyCode30)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode31))) 	
Parameters:
@Type21[Int32] = 2
@ProjectId22[String] = 6372912251695766465
@CompanyCode23[String] = 6373083923489249281
@CompanyCode24[String] = 6373083925531366080
@CompanyCode25[String] = 6373083927883400612
@CompanyCode26[String] = 6373083918575368225
@CompanyCode27[String] = 6373083920445075162
@CompanyCode28[String] = 6373083908618598731
@CompanyCode29[String] = 6373083911842783146
@CompanyCode30[String] = 6373083913928202424
@ParentCompanyCode31[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 16:34:03
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 16:34:04
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 16:34:04
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 16:34:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 16:34:04
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 16:34:04
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 16:37:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:40:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:43:01
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:46:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:49:02
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:51:07
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 16:51:07
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 16:51:07
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type32) AND ([TbOrganizationMap].[ProjectId] = @ProjectId33)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode34,@CompanyCode35,@CompanyCode36,@CompanyCode37,@CompanyCode38,@CompanyCode39,@CompanyCode40,@CompanyCode41)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode42))) 	
Parameters:
@Type32[Int32] = 1
@ProjectId33[String] = 6372912251695766465
@CompanyCode34[String] = 6373083923489249281
@CompanyCode35[String] = 6373083925531366080
@CompanyCode36[String] = 6373083927883400612
@CompanyCode37[String] = 6373083918575368225
@CompanyCode38[String] = 6373083920445075162
@CompanyCode39[String] = 6373083908618598731
@CompanyCode40[String] = 6373083911842783146
@CompanyCode41[String] = 6373083913928202424
@ParentCompanyCode42[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type43) AND ([TbOrganizationMap].[ProjectId] = @ProjectId44)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode45,@CompanyCode46,@CompanyCode47,@CompanyCode48,@CompanyCode49,@CompanyCode50,@CompanyCode51,@CompanyCode52)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode53))) 	
Parameters:
@Type43[Int32] = 2
@ProjectId44[String] = 6372912251695766465
@CompanyCode45[String] = 6373083923489249281
@CompanyCode46[String] = 6373083925531366080
@CompanyCode47[String] = 6373083927883400612
@CompanyCode48[String] = 6373083918575368225
@CompanyCode49[String] = 6373083920445075162
@CompanyCode50[String] = 6373083908618598731
@CompanyCode51[String] = 6373083911842783146
@CompanyCode52[String] = 6373083913928202424
@ParentCompanyCode53[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 16:51:08
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type54) AND ([TbOrganizationMap].[ProjectId] = @ProjectId55)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode56,@CompanyCode57,@CompanyCode58,@CompanyCode59,@CompanyCode60,@CompanyCode61,@CompanyCode62,@CompanyCode63)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode64))) 	
Parameters:
@Type54[Int32] = 1
@ProjectId55[String] = 6372912251695766465
@CompanyCode56[String] = 6373083923489249281
@CompanyCode57[String] = 6373083925531366080
@CompanyCode58[String] = 6373083927883400612
@CompanyCode59[String] = 6373083918575368225
@CompanyCode60[String] = 6373083920445075162
@CompanyCode61[String] = 6373083908618598731
@CompanyCode62[String] = 6373083911842783146
@CompanyCode63[String] = 6373083913928202424
@ParentCompanyCode64[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type65) AND ([TbOrganizationMap].[ProjectId] = @ProjectId66)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode67,@CompanyCode68,@CompanyCode69,@CompanyCode70,@CompanyCode71,@CompanyCode72,@CompanyCode73,@CompanyCode74)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode75))) 	
Parameters:
@Type65[Int32] = 2
@ProjectId66[String] = 6372912251695766465
@CompanyCode67[String] = 6373083923489249281
@CompanyCode68[String] = 6373083925531366080
@CompanyCode69[String] = 6373083927883400612
@CompanyCode70[String] = 6373083918575368225
@CompanyCode71[String] = 6373083920445075162
@CompanyCode72[String] = 6373083908618598731
@CompanyCode73[String] = 6373083911842783146
@CompanyCode74[String] = 6373083913928202424
@ParentCompanyCode75[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 16:51:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode76) AND ([TbUser].[UserPwd] = @UserPwd77) 	
Parameters:
@UserCode76[String] = 500000
@UserPwd77[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode78 	
Parameters:
@UserCode78[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu79,@ActionType80,@HostName81,@LogDate82,@UserCode83,@UserIP84);select scope_identity()	
Parameters:
@ActionMenu79[String] = 0
@ActionType80[String] = 登录系统
@HostName81[String] = 
@LogDate82[DateTime] = 2020/8/25 16:53:53
@UserCode83[String] = 500000
@UserIP84[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 16:53:53
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type85) AND ([TbOrganizationMap].[ProjectId] = @ProjectId86)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode87,@CompanyCode88,@CompanyCode89,@CompanyCode90,@CompanyCode91,@CompanyCode92,@CompanyCode93,@CompanyCode94)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode95))) 	
Parameters:
@Type85[Int32] = 1
@ProjectId86[String] = 6372912251695766465
@CompanyCode87[String] = 6373083923489249281
@CompanyCode88[String] = 6373083925531366080
@CompanyCode89[String] = 6373083927883400612
@CompanyCode90[String] = 6373083918575368225
@CompanyCode91[String] = 6373083920445075162
@CompanyCode92[String] = 6373083908618598731
@CompanyCode93[String] = 6373083911842783146
@CompanyCode94[String] = 6373083913928202424
@ParentCompanyCode95[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type96) AND ([TbOrganizationMap].[ProjectId] = @ProjectId97)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode98,@CompanyCode99,@CompanyCode100,@CompanyCode101,@CompanyCode102,@CompanyCode103,@CompanyCode104,@CompanyCode105)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode106))) 	
Parameters:
@Type96[Int32] = 2
@ProjectId97[String] = 6372912251695766465
@CompanyCode98[String] = 6373083923489249281
@CompanyCode99[String] = 6373083925531366080
@CompanyCode100[String] = 6373083927883400612
@CompanyCode101[String] = 6373083918575368225
@CompanyCode102[String] = 6373083920445075162
@CompanyCode103[String] = 6373083908618598731
@CompanyCode104[String] = 6373083911842783146
@CompanyCode105[String] = 6373083913928202424
@ParentCompanyCode106[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 16:53:54
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 16:53:55
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 16:53:55
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 16:53:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 16:53:55
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 16:53:55
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 16:56:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 16:59:54
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type107) AND ([TbOrganizationMap].[ProjectId] = @ProjectId108)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode109,@CompanyCode110,@CompanyCode111,@CompanyCode112,@CompanyCode113,@CompanyCode114,@CompanyCode115,@CompanyCode116)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode117))) 	
Parameters:
@Type107[Int32] = 1
@ProjectId108[String] = 6372912251695766465
@CompanyCode109[String] = 6373083923489249281
@CompanyCode110[String] = 6373083925531366080
@CompanyCode111[String] = 6373083927883400612
@CompanyCode112[String] = 6373083918575368225
@CompanyCode113[String] = 6373083920445075162
@CompanyCode114[String] = 6373083908618598731
@CompanyCode115[String] = 6373083911842783146
@CompanyCode116[String] = 6373083913928202424
@ParentCompanyCode117[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type118) AND ([TbOrganizationMap].[ProjectId] = @ProjectId119)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode120,@CompanyCode121,@CompanyCode122,@CompanyCode123,@CompanyCode124,@CompanyCode125,@CompanyCode126,@CompanyCode127)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode128))) 	
Parameters:
@Type118[Int32] = 2
@ProjectId119[String] = 6372912251695766465
@CompanyCode120[String] = 6373083923489249281
@CompanyCode121[String] = 6373083925531366080
@CompanyCode122[String] = 6373083927883400612
@CompanyCode123[String] = 6373083918575368225
@CompanyCode124[String] = 6373083920445075162
@CompanyCode125[String] = 6373083908618598731
@CompanyCode126[String] = 6373083911842783146
@CompanyCode127[String] = 6373083913928202424
@ParentCompanyCode128[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:01:11
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:01:12
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:01:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:01:12
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:01:12
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:04:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:07:12
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:09:46
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:09:46
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:09:46
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type129) AND ([TbOrganizationMap].[ProjectId] = @ProjectId130)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode131,@CompanyCode132,@CompanyCode133,@CompanyCode134,@CompanyCode135,@CompanyCode136,@CompanyCode137,@CompanyCode138)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode139))) 	
Parameters:
@Type129[Int32] = 1
@ProjectId130[String] = 6372912251695766465
@CompanyCode131[String] = 6373083923489249281
@CompanyCode132[String] = 6373083925531366080
@CompanyCode133[String] = 6373083927883400612
@CompanyCode134[String] = 6373083918575368225
@CompanyCode135[String] = 6373083920445075162
@CompanyCode136[String] = 6373083908618598731
@CompanyCode137[String] = 6373083911842783146
@CompanyCode138[String] = 6373083913928202424
@ParentCompanyCode139[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type140) AND ([TbOrganizationMap].[ProjectId] = @ProjectId141)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode142,@CompanyCode143,@CompanyCode144,@CompanyCode145,@CompanyCode146,@CompanyCode147,@CompanyCode148,@CompanyCode149)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode150))) 	
Parameters:
@Type140[Int32] = 2
@ProjectId141[String] = 6372912251695766465
@CompanyCode142[String] = 6373083923489249281
@CompanyCode143[String] = 6373083925531366080
@CompanyCode144[String] = 6373083927883400612
@CompanyCode145[String] = 6373083918575368225
@CompanyCode146[String] = 6373083920445075162
@CompanyCode147[String] = 6373083908618598731
@CompanyCode148[String] = 6373083911842783146
@CompanyCode149[String] = 6373083913928202424
@ParentCompanyCode150[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:09:47
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type151) AND ([TbOrganizationMap].[ProjectId] = @ProjectId152)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode153,@CompanyCode154,@CompanyCode155,@CompanyCode156,@CompanyCode157,@CompanyCode158,@CompanyCode159,@CompanyCode160)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode161))) 	
Parameters:
@Type151[Int32] = 1
@ProjectId152[String] = 6372912251695766465
@CompanyCode153[String] = 6373083923489249281
@CompanyCode154[String] = 6373083925531366080
@CompanyCode155[String] = 6373083927883400612
@CompanyCode156[String] = 6373083918575368225
@CompanyCode157[String] = 6373083920445075162
@CompanyCode158[String] = 6373083908618598731
@CompanyCode159[String] = 6373083911842783146
@CompanyCode160[String] = 6373083913928202424
@ParentCompanyCode161[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type162) AND ([TbOrganizationMap].[ProjectId] = @ProjectId163)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode164,@CompanyCode165,@CompanyCode166,@CompanyCode167,@CompanyCode168,@CompanyCode169,@CompanyCode170,@CompanyCode171)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode172))) 	
Parameters:
@Type162[Int32] = 2
@ProjectId163[String] = 6372912251695766465
@CompanyCode164[String] = 6373083923489249281
@CompanyCode165[String] = 6373083925531366080
@CompanyCode166[String] = 6373083927883400612
@CompanyCode167[String] = 6373083918575368225
@CompanyCode168[String] = 6373083920445075162
@CompanyCode169[String] = 6373083908618598731
@CompanyCode170[String] = 6373083911842783146
@CompanyCode171[String] = 6373083913928202424
@ParentCompanyCode172[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:10:14
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:10:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:15
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:10:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:10:15
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:10:33
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:33
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:10:33
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type173) AND ([TbOrganizationMap].[ProjectId] = @ProjectId174)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode175,@CompanyCode176,@CompanyCode177,@CompanyCode178,@CompanyCode179,@CompanyCode180,@CompanyCode181,@CompanyCode182)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode183))) 	
Parameters:
@Type173[Int32] = 1
@ProjectId174[String] = 6372912251695766465
@CompanyCode175[String] = 6373083923489249281
@CompanyCode176[String] = 6373083925531366080
@CompanyCode177[String] = 6373083927883400612
@CompanyCode178[String] = 6373083918575368225
@CompanyCode179[String] = 6373083920445075162
@CompanyCode180[String] = 6373083908618598731
@CompanyCode181[String] = 6373083911842783146
@CompanyCode182[String] = 6373083913928202424
@ParentCompanyCode183[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type184) AND ([TbOrganizationMap].[ProjectId] = @ProjectId185)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode186,@CompanyCode187,@CompanyCode188,@CompanyCode189,@CompanyCode190,@CompanyCode191,@CompanyCode192,@CompanyCode193)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode194))) 	
Parameters:
@Type184[Int32] = 2
@ProjectId185[String] = 6372912251695766465
@CompanyCode186[String] = 6373083923489249281
@CompanyCode187[String] = 6373083925531366080
@CompanyCode188[String] = 6373083927883400612
@CompanyCode189[String] = 6373083918575368225
@CompanyCode190[String] = 6373083920445075162
@CompanyCode191[String] = 6373083908618598731
@CompanyCode192[String] = 6373083911842783146
@CompanyCode193[String] = 6373083913928202424
@ParentCompanyCode194[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:10:34
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:10:38
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:38
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:10:38
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type195) AND ([TbOrganizationMap].[ProjectId] = @ProjectId196)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode197,@CompanyCode198,@CompanyCode199,@CompanyCode200,@CompanyCode201,@CompanyCode202,@CompanyCode203,@CompanyCode204)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode205))) 	
Parameters:
@Type195[Int32] = 1
@ProjectId196[String] = 6372912251695766465
@CompanyCode197[String] = 6373083923489249281
@CompanyCode198[String] = 6373083925531366080
@CompanyCode199[String] = 6373083927883400612
@CompanyCode200[String] = 6373083918575368225
@CompanyCode201[String] = 6373083920445075162
@CompanyCode202[String] = 6373083908618598731
@CompanyCode203[String] = 6373083911842783146
@CompanyCode204[String] = 6373083913928202424
@ParentCompanyCode205[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type206) AND ([TbOrganizationMap].[ProjectId] = @ProjectId207)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode208,@CompanyCode209,@CompanyCode210,@CompanyCode211,@CompanyCode212,@CompanyCode213,@CompanyCode214,@CompanyCode215)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode216))) 	
Parameters:
@Type206[Int32] = 2
@ProjectId207[String] = 6372912251695766465
@CompanyCode208[String] = 6373083923489249281
@CompanyCode209[String] = 6373083925531366080
@CompanyCode210[String] = 6373083927883400612
@CompanyCode211[String] = 6373083918575368225
@CompanyCode212[String] = 6373083920445075162
@CompanyCode213[String] = 6373083908618598731
@CompanyCode214[String] = 6373083911842783146
@CompanyCode215[String] = 6373083913928202424
@ParentCompanyCode216[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:10:39
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:11:57
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:11:57
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:11:57
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type217) AND ([TbOrganizationMap].[ProjectId] = @ProjectId218)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode219,@CompanyCode220,@CompanyCode221,@CompanyCode222,@CompanyCode223,@CompanyCode224,@CompanyCode225,@CompanyCode226)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode227))) 	
Parameters:
@Type217[Int32] = 1
@ProjectId218[String] = 6372912251695766465
@CompanyCode219[String] = 6373083923489249281
@CompanyCode220[String] = 6373083925531366080
@CompanyCode221[String] = 6373083927883400612
@CompanyCode222[String] = 6373083918575368225
@CompanyCode223[String] = 6373083920445075162
@CompanyCode224[String] = 6373083908618598731
@CompanyCode225[String] = 6373083911842783146
@CompanyCode226[String] = 6373083913928202424
@ParentCompanyCode227[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type228) AND ([TbOrganizationMap].[ProjectId] = @ProjectId229)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode230,@CompanyCode231,@CompanyCode232,@CompanyCode233,@CompanyCode234,@CompanyCode235,@CompanyCode236,@CompanyCode237)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode238))) 	
Parameters:
@Type228[Int32] = 2
@ProjectId229[String] = 6372912251695766465
@CompanyCode230[String] = 6373083923489249281
@CompanyCode231[String] = 6373083925531366080
@CompanyCode232[String] = 6373083927883400612
@CompanyCode233[String] = 6373083918575368225
@CompanyCode234[String] = 6373083920445075162
@CompanyCode235[String] = 6373083908618598731
@CompanyCode236[String] = 6373083911842783146
@CompanyCode237[String] = 6373083913928202424
@ParentCompanyCode238[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:11:58
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:11:59
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:11:59
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:11:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:11:59
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:11:59
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:12:27
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:12:27
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:12:27
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:12:27
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:12:27
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type239) AND ([TbOrganizationMap].[ProjectId] = @ProjectId240)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode241,@CompanyCode242,@CompanyCode243,@CompanyCode244,@CompanyCode245,@CompanyCode246,@CompanyCode247,@CompanyCode248)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode249))) 	
Parameters:
@Type239[Int32] = 1
@ProjectId240[String] = 6372912251695766465
@CompanyCode241[String] = 6373083923489249281
@CompanyCode242[String] = 6373083925531366080
@CompanyCode243[String] = 6373083927883400612
@CompanyCode244[String] = 6373083918575368225
@CompanyCode245[String] = 6373083920445075162
@CompanyCode246[String] = 6373083908618598731
@CompanyCode247[String] = 6373083911842783146
@CompanyCode248[String] = 6373083913928202424
@ParentCompanyCode249[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type250) AND ([TbOrganizationMap].[ProjectId] = @ProjectId251)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode252,@CompanyCode253,@CompanyCode254,@CompanyCode255,@CompanyCode256,@CompanyCode257,@CompanyCode258,@CompanyCode259)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode260))) 	
Parameters:
@Type250[Int32] = 2
@ProjectId251[String] = 6372912251695766465
@CompanyCode252[String] = 6373083923489249281
@CompanyCode253[String] = 6373083925531366080
@CompanyCode254[String] = 6373083927883400612
@CompanyCode255[String] = 6373083918575368225
@CompanyCode256[String] = 6373083920445075162
@CompanyCode257[String] = 6373083908618598731
@CompanyCode258[String] = 6373083911842783146
@CompanyCode259[String] = 6373083913928202424
@ParentCompanyCode260[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:12:28
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:13:00
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:00
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:13:00
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:13:00
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type261) AND ([TbOrganizationMap].[ProjectId] = @ProjectId262)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode263,@CompanyCode264,@CompanyCode265,@CompanyCode266,@CompanyCode267,@CompanyCode268,@CompanyCode269,@CompanyCode270)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode271))) 	
Parameters:
@Type261[Int32] = 1
@ProjectId262[String] = 6372912251695766465
@CompanyCode263[String] = 6373083923489249281
@CompanyCode264[String] = 6373083925531366080
@CompanyCode265[String] = 6373083927883400612
@CompanyCode266[String] = 6373083918575368225
@CompanyCode267[String] = 6373083920445075162
@CompanyCode268[String] = 6373083908618598731
@CompanyCode269[String] = 6373083911842783146
@CompanyCode270[String] = 6373083913928202424
@ParentCompanyCode271[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type272) AND ([TbOrganizationMap].[ProjectId] = @ProjectId273)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode274,@CompanyCode275,@CompanyCode276,@CompanyCode277,@CompanyCode278,@CompanyCode279,@CompanyCode280,@CompanyCode281)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode282))) 	
Parameters:
@Type272[Int32] = 2
@ProjectId273[String] = 6372912251695766465
@CompanyCode274[String] = 6373083923489249281
@CompanyCode275[String] = 6373083925531366080
@CompanyCode276[String] = 6373083927883400612
@CompanyCode277[String] = 6373083918575368225
@CompanyCode278[String] = 6373083920445075162
@CompanyCode279[String] = 6373083908618598731
@CompanyCode280[String] = 6373083911842783146
@CompanyCode281[String] = 6373083913928202424
@ParentCompanyCode282[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:13:01
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type283) AND ([TbOrganizationMap].[ProjectId] = @ProjectId284)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode285,@CompanyCode286,@CompanyCode287,@CompanyCode288,@CompanyCode289,@CompanyCode290,@CompanyCode291,@CompanyCode292)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode293))) 	
Parameters:
@Type283[Int32] = 1
@ProjectId284[String] = 6372912251695766465
@CompanyCode285[String] = 6373083923489249281
@CompanyCode286[String] = 6373083925531366080
@CompanyCode287[String] = 6373083927883400612
@CompanyCode288[String] = 6373083918575368225
@CompanyCode289[String] = 6373083920445075162
@CompanyCode290[String] = 6373083908618598731
@CompanyCode291[String] = 6373083911842783146
@CompanyCode292[String] = 6373083913928202424
@ParentCompanyCode293[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type294) AND ([TbOrganizationMap].[ProjectId] = @ProjectId295)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode296,@CompanyCode297,@CompanyCode298,@CompanyCode299,@CompanyCode300,@CompanyCode301,@CompanyCode302,@CompanyCode303)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode304))) 	
Parameters:
@Type294[Int32] = 2
@ProjectId295[String] = 6372912251695766465
@CompanyCode296[String] = 6373083923489249281
@CompanyCode297[String] = 6373083925531366080
@CompanyCode298[String] = 6373083927883400612
@CompanyCode299[String] = 6373083918575368225
@CompanyCode300[String] = 6373083920445075162
@CompanyCode301[String] = 6373083908618598731
@CompanyCode302[String] = 6373083911842783146
@CompanyCode303[String] = 6373083913928202424
@ParentCompanyCode304[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:13:18
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:19
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:13:19
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:13:19
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:13:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:13:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type305) AND ([TbOrganizationMap].[ProjectId] = @ProjectId306)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode307,@CompanyCode308,@CompanyCode309,@CompanyCode310,@CompanyCode311,@CompanyCode312,@CompanyCode313,@CompanyCode314)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode315))) 	
Parameters:
@Type305[Int32] = 1
@ProjectId306[String] = 6372912251695766465
@CompanyCode307[String] = 6373083923489249281
@CompanyCode308[String] = 6373083925531366080
@CompanyCode309[String] = 6373083927883400612
@CompanyCode310[String] = 6373083918575368225
@CompanyCode311[String] = 6373083920445075162
@CompanyCode312[String] = 6373083908618598731
@CompanyCode313[String] = 6373083911842783146
@CompanyCode314[String] = 6373083913928202424
@ParentCompanyCode315[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type316) AND ([TbOrganizationMap].[ProjectId] = @ProjectId317)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode318,@CompanyCode319,@CompanyCode320,@CompanyCode321,@CompanyCode322,@CompanyCode323,@CompanyCode324,@CompanyCode325)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode326))) 	
Parameters:
@Type316[Int32] = 2
@ProjectId317[String] = 6372912251695766465
@CompanyCode318[String] = 6373083923489249281
@CompanyCode319[String] = 6373083925531366080
@CompanyCode320[String] = 6373083927883400612
@CompanyCode321[String] = 6373083918575368225
@CompanyCode322[String] = 6373083920445075162
@CompanyCode323[String] = 6373083908618598731
@CompanyCode324[String] = 6373083911842783146
@CompanyCode325[String] = 6373083913928202424
@ParentCompanyCode326[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:13:43
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type327) AND ([TbOrganizationMap].[ProjectId] = @ProjectId328)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode329,@CompanyCode330,@CompanyCode331,@CompanyCode332,@CompanyCode333,@CompanyCode334,@CompanyCode335,@CompanyCode336)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode337))) 	
Parameters:
@Type327[Int32] = 1
@ProjectId328[String] = 6372912251695766465
@CompanyCode329[String] = 6373083923489249281
@CompanyCode330[String] = 6373083925531366080
@CompanyCode331[String] = 6373083927883400612
@CompanyCode332[String] = 6373083918575368225
@CompanyCode333[String] = 6373083920445075162
@CompanyCode334[String] = 6373083908618598731
@CompanyCode335[String] = 6373083911842783146
@CompanyCode336[String] = 6373083913928202424
@ParentCompanyCode337[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type338) AND ([TbOrganizationMap].[ProjectId] = @ProjectId339)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode340,@CompanyCode341,@CompanyCode342,@CompanyCode343,@CompanyCode344,@CompanyCode345,@CompanyCode346,@CompanyCode347)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode348))) 	
Parameters:
@Type338[Int32] = 2
@ProjectId339[String] = 6372912251695766465
@CompanyCode340[String] = 6373083923489249281
@CompanyCode341[String] = 6373083925531366080
@CompanyCode342[String] = 6373083927883400612
@CompanyCode343[String] = 6373083918575368225
@CompanyCode344[String] = 6373083920445075162
@CompanyCode345[String] = 6373083908618598731
@CompanyCode346[String] = 6373083911842783146
@CompanyCode347[String] = 6373083913928202424
@ParentCompanyCode348[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:16:42
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:18:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type349) AND ([TbOrganizationMap].[ProjectId] = @ProjectId350)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode351,@CompanyCode352,@CompanyCode353,@CompanyCode354,@CompanyCode355,@CompanyCode356,@CompanyCode357,@CompanyCode358)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode359))) 	
Parameters:
@Type349[Int32] = 1
@ProjectId350[String] = 6372912251695766465
@CompanyCode351[String] = 6373083923489249281
@CompanyCode352[String] = 6373083925531366080
@CompanyCode353[String] = 6373083927883400612
@CompanyCode354[String] = 6373083918575368225
@CompanyCode355[String] = 6373083920445075162
@CompanyCode356[String] = 6373083908618598731
@CompanyCode357[String] = 6373083911842783146
@CompanyCode358[String] = 6373083913928202424
@ParentCompanyCode359[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type360) AND ([TbOrganizationMap].[ProjectId] = @ProjectId361)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode362,@CompanyCode363,@CompanyCode364,@CompanyCode365,@CompanyCode366,@CompanyCode367,@CompanyCode368,@CompanyCode369)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode370))) 	
Parameters:
@Type360[Int32] = 2
@ProjectId361[String] = 6372912251695766465
@CompanyCode362[String] = 6373083923489249281
@CompanyCode363[String] = 6373083925531366080
@CompanyCode364[String] = 6373083927883400612
@CompanyCode365[String] = 6373083918575368225
@CompanyCode366[String] = 6373083920445075162
@CompanyCode367[String] = 6373083908618598731
@CompanyCode368[String] = 6373083911842783146
@CompanyCode369[String] = 6373083913928202424
@ParentCompanyCode370[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:18:52
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type371) AND ([TbOrganizationMap].[ProjectId] = @ProjectId372)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode373,@CompanyCode374,@CompanyCode375,@CompanyCode376,@CompanyCode377,@CompanyCode378,@CompanyCode379,@CompanyCode380)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode381))) 	
Parameters:
@Type371[Int32] = 1
@ProjectId372[String] = 6372912251695766465
@CompanyCode373[String] = 6373083923489249281
@CompanyCode374[String] = 6373083925531366080
@CompanyCode375[String] = 6373083927883400612
@CompanyCode376[String] = 6373083918575368225
@CompanyCode377[String] = 6373083920445075162
@CompanyCode378[String] = 6373083908618598731
@CompanyCode379[String] = 6373083911842783146
@CompanyCode380[String] = 6373083913928202424
@ParentCompanyCode381[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type382) AND ([TbOrganizationMap].[ProjectId] = @ProjectId383)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode384,@CompanyCode385,@CompanyCode386,@CompanyCode387,@CompanyCode388,@CompanyCode389,@CompanyCode390,@CompanyCode391)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode392))) 	
Parameters:
@Type382[Int32] = 2
@ProjectId383[String] = 6372912251695766465
@CompanyCode384[String] = 6373083923489249281
@CompanyCode385[String] = 6373083925531366080
@CompanyCode386[String] = 6373083927883400612
@CompanyCode387[String] = 6373083918575368225
@CompanyCode388[String] = 6373083920445075162
@CompanyCode389[String] = 6373083908618598731
@CompanyCode390[String] = 6373083911842783146
@CompanyCode391[String] = 6373083913928202424
@ParentCompanyCode392[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:16
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:19:17
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:19:17
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:19:44
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:44
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:19:44
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type393) AND ([TbOrganizationMap].[ProjectId] = @ProjectId394)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode395,@CompanyCode396,@CompanyCode397,@CompanyCode398,@CompanyCode399,@CompanyCode400,@CompanyCode401,@CompanyCode402)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode403))) 	
Parameters:
@Type393[Int32] = 1
@ProjectId394[String] = 6372912251695766465
@CompanyCode395[String] = 6373083923489249281
@CompanyCode396[String] = 6373083925531366080
@CompanyCode397[String] = 6373083927883400612
@CompanyCode398[String] = 6373083918575368225
@CompanyCode399[String] = 6373083920445075162
@CompanyCode400[String] = 6373083908618598731
@CompanyCode401[String] = 6373083911842783146
@CompanyCode402[String] = 6373083913928202424
@ParentCompanyCode403[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type404) AND ([TbOrganizationMap].[ProjectId] = @ProjectId405)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode406,@CompanyCode407,@CompanyCode408,@CompanyCode409,@CompanyCode410,@CompanyCode411,@CompanyCode412,@CompanyCode413)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode414))) 	
Parameters:
@Type404[Int32] = 2
@ProjectId405[String] = 6372912251695766465
@CompanyCode406[String] = 6373083923489249281
@CompanyCode407[String] = 6373083925531366080
@CompanyCode408[String] = 6373083927883400612
@CompanyCode409[String] = 6373083918575368225
@CompanyCode410[String] = 6373083920445075162
@CompanyCode411[String] = 6373083908618598731
@CompanyCode412[String] = 6373083911842783146
@CompanyCode413[String] = 6373083913928202424
@ParentCompanyCode414[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:19:45
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:19:50
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:50
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:19:50
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:19:50
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type415) AND ([TbOrganizationMap].[ProjectId] = @ProjectId416)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode417,@CompanyCode418,@CompanyCode419,@CompanyCode420,@CompanyCode421,@CompanyCode422,@CompanyCode423,@CompanyCode424)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode425))) 	
Parameters:
@Type415[Int32] = 1
@ProjectId416[String] = 6372912251695766465
@CompanyCode417[String] = 6373083923489249281
@CompanyCode418[String] = 6373083925531366080
@CompanyCode419[String] = 6373083927883400612
@CompanyCode420[String] = 6373083918575368225
@CompanyCode421[String] = 6373083920445075162
@CompanyCode422[String] = 6373083908618598731
@CompanyCode423[String] = 6373083911842783146
@CompanyCode424[String] = 6373083913928202424
@ParentCompanyCode425[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type426) AND ([TbOrganizationMap].[ProjectId] = @ProjectId427)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode428,@CompanyCode429,@CompanyCode430,@CompanyCode431,@CompanyCode432,@CompanyCode433,@CompanyCode434,@CompanyCode435)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode436))) 	
Parameters:
@Type426[Int32] = 2
@ProjectId427[String] = 6372912251695766465
@CompanyCode428[String] = 6373083923489249281
@CompanyCode429[String] = 6373083925531366080
@CompanyCode430[String] = 6373083927883400612
@CompanyCode431[String] = 6373083918575368225
@CompanyCode432[String] = 6373083920445075162
@CompanyCode433[String] = 6373083908618598731
@CompanyCode434[String] = 6373083911842783146
@CompanyCode435[String] = 6373083913928202424
@ParentCompanyCode436[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:19:51
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:20:24
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:20:24
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:20:24
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type437) AND ([TbOrganizationMap].[ProjectId] = @ProjectId438)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode439,@CompanyCode440,@CompanyCode441,@CompanyCode442,@CompanyCode443,@CompanyCode444,@CompanyCode445,@CompanyCode446)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode447))) 	
Parameters:
@Type437[Int32] = 1
@ProjectId438[String] = 6372912251695766465
@CompanyCode439[String] = 6373083923489249281
@CompanyCode440[String] = 6373083925531366080
@CompanyCode441[String] = 6373083927883400612
@CompanyCode442[String] = 6373083918575368225
@CompanyCode443[String] = 6373083920445075162
@CompanyCode444[String] = 6373083908618598731
@CompanyCode445[String] = 6373083911842783146
@CompanyCode446[String] = 6373083913928202424
@ParentCompanyCode447[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type448) AND ([TbOrganizationMap].[ProjectId] = @ProjectId449)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode450,@CompanyCode451,@CompanyCode452,@CompanyCode453,@CompanyCode454,@CompanyCode455,@CompanyCode456,@CompanyCode457)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode458))) 	
Parameters:
@Type448[Int32] = 2
@ProjectId449[String] = 6372912251695766465
@CompanyCode450[String] = 6373083923489249281
@CompanyCode451[String] = 6373083925531366080
@CompanyCode452[String] = 6373083927883400612
@CompanyCode453[String] = 6373083918575368225
@CompanyCode454[String] = 6373083920445075162
@CompanyCode455[String] = 6373083908618598731
@CompanyCode456[String] = 6373083911842783146
@CompanyCode457[String] = 6373083913928202424
@ParentCompanyCode458[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:20:25
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:21:13
Text:	 SELECT   TOP 1 * FROM [TbUser]  WHERE ([TbUser].[UserCode] = @UserCode459) AND ([TbUser].[UserPwd] = @UserPwd460) 	
Parameters:
@UserCode459[String] = 500000
@UserPwd460[String] = c4ca4238a0b923820dcc509a6f75849b


-----------------------------------------------------------------------------
2020-08-25 17:21:13
Text:	SELECT UserClosed FROM TbUser WHERE UserCode=@UserName	
Parameters:
@UserName[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 17:21:13
Text:	select top 1 ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode as UserId,u.UserCode,u.UserName from TbUserRole ur 
left join TbCompany cm on ur.OrgId=cm.CompanyCode
left join TbProjectInfo pro on ur.ProjectId=pro.ProjectId
left join TbUser u on ur.UserCode=u.UserId
where u.UserCode=@UserCode and ur.Flag=0 group by ur.ProjectId,pro.ProjectName,ur.OrgId,cm.CompanyFullName,cm.ParentCompanyCode,ur.OrgType,ur.UserCode,u.UserCode,u.UserName order by OrgId asc	
Parameters:
@UserCode[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 17:21:13
Text:	select distinct ur.RoleCode as RoleId,r.RoleCode,r.RoleName from TbUserRole ur
left join TbUser u on ur.UserCode=u.UserId
left join TbRole r on ur.RoleCode=r.RoleId
where u.UserCode=@UserCode and ProjectId=@ProjectId and OrgId=@OrgId and ur.Flag=0	
Parameters:
@UserCode[String] = 500000
@ProjectId[String] = 6372912251695766465
@OrgId[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:21:13
Text:	 SELECT   TOP 1 [TbCarInfoDetail].[ID] FROM [TbCarInfoDetail]  WHERE [TbCarInfoDetail].[UserCode] = @UserCode461 	
Parameters:
@UserCode461[String] = 500000


-----------------------------------------------------------------------------
2020-08-25 17:21:14
Text:	INSERT INTO [TbSysLog] ([ActionMenu],[ActionType],[HostName],[LogDate],[UserCode],[UserIP]) VALUES (@ActionMenu462,@ActionType463,@HostName464,@LogDate465,@UserCode466,@UserIP467);select scope_identity()	
Parameters:
@ActionMenu462[String] = 0
@ActionType463[String] = 登录系统
@HostName464[String] = 
@LogDate465[DateTime] = 2020/8/25 17:21:14
@UserCode466[String] = 500000
@UserIP467[String] = 192.168.3.222


-----------------------------------------------------------------------------
2020-08-25 17:21:14
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:21:14
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:21:14
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type468) AND ([TbOrganizationMap].[ProjectId] = @ProjectId469)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode470,@CompanyCode471,@CompanyCode472,@CompanyCode473,@CompanyCode474,@CompanyCode475,@CompanyCode476,@CompanyCode477)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode478))) 	
Parameters:
@Type468[Int32] = 1
@ProjectId469[String] = 6372912251695766465
@CompanyCode470[String] = 6373083923489249281
@CompanyCode471[String] = 6373083925531366080
@CompanyCode472[String] = 6373083927883400612
@CompanyCode473[String] = 6373083918575368225
@CompanyCode474[String] = 6373083920445075162
@CompanyCode475[String] = 6373083908618598731
@CompanyCode476[String] = 6373083911842783146
@CompanyCode477[String] = 6373083913928202424
@ParentCompanyCode478[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type479) AND ([TbOrganizationMap].[ProjectId] = @ProjectId480)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode481,@CompanyCode482,@CompanyCode483,@CompanyCode484,@CompanyCode485,@CompanyCode486,@CompanyCode487,@CompanyCode488)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode489))) 	
Parameters:
@Type479[Int32] = 2
@ProjectId480[String] = 6372912251695766465
@CompanyCode481[String] = 6373083923489249281
@CompanyCode482[String] = 6373083925531366080
@CompanyCode483[String] = 6373083927883400612
@CompanyCode484[String] = 6373083918575368225
@CompanyCode485[String] = 6373083920445075162
@CompanyCode486[String] = 6373083908618598731
@CompanyCode487[String] = 6373083911842783146
@CompanyCode488[String] = 6373083913928202424
@ParentCompanyCode489[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:21:15
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:24:15
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type490) AND ([TbOrganizationMap].[ProjectId] = @ProjectId491)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode492,@CompanyCode493,@CompanyCode494,@CompanyCode495,@CompanyCode496,@CompanyCode497,@CompanyCode498,@CompanyCode499)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode500))) 	
Parameters:
@Type490[Int32] = 1
@ProjectId491[String] = 6372912251695766465
@CompanyCode492[String] = 6373083923489249281
@CompanyCode493[String] = 6373083925531366080
@CompanyCode494[String] = 6373083927883400612
@CompanyCode495[String] = 6373083918575368225
@CompanyCode496[String] = 6373083920445075162
@CompanyCode497[String] = 6373083908618598731
@CompanyCode498[String] = 6373083911842783146
@CompanyCode499[String] = 6373083913928202424
@ParentCompanyCode500[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type501) AND ([TbOrganizationMap].[ProjectId] = @ProjectId502)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode503,@CompanyCode504,@CompanyCode505,@CompanyCode506,@CompanyCode507,@CompanyCode508,@CompanyCode509,@CompanyCode510)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode511))) 	
Parameters:
@Type501[Int32] = 2
@ProjectId502[String] = 6372912251695766465
@CompanyCode503[String] = 6373083923489249281
@CompanyCode504[String] = 6373083925531366080
@CompanyCode505[String] = 6373083927883400612
@CompanyCode506[String] = 6373083918575368225
@CompanyCode507[String] = 6373083920445075162
@CompanyCode508[String] = 6373083908618598731
@CompanyCode509[String] = 6373083911842783146
@CompanyCode510[String] = 6373083913928202424
@ParentCompanyCode511[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:24:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:24:31
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:24:31
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:24:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:24:31
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:24:31
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:25:29
Text:	select tsm.* from TbRoleMenu tum
                           left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                           where tsm.IsShow=0 and tsm.MenuType='PC' and tum.RoleCode in('6372919444627396738','6372919451594895243') order by tsm.Sort asc	


-----------------------------------------------------------------------------
2020-08-25 17:25:29
Text:	select 
                        	tsm.*
                        from TbUserMenu tum
                        left join TbSysMenu tsm on tum.MenuCode=tsm.MenuCode
                        where tsm.IsShow=0 and tsm.MenuType='PC' and tum.UserCode=@userCode order by tsm.Sort asc	
Parameters:
@userCode[String] = 6372930471544160074


-----------------------------------------------------------------------------
2020-08-25 17:25:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:25:29
Text:	select * from TbSysDictionaryData where 1=1 and FDictionaryCode=@name order by DictionaryOrder asc	
Parameters:
@name[String] = SystemSeting


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type512) AND ([TbOrganizationMap].[ProjectId] = @ProjectId513)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode514,@CompanyCode515,@CompanyCode516,@CompanyCode517,@CompanyCode518,@CompanyCode519,@CompanyCode520,@CompanyCode521)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode522))) 	
Parameters:
@Type512[Int32] = 1
@ProjectId513[String] = 6372912251695766465
@CompanyCode514[String] = 6373083923489249281
@CompanyCode515[String] = 6373083925531366080
@CompanyCode516[String] = 6373083927883400612
@CompanyCode517[String] = 6373083918575368225
@CompanyCode518[String] = 6373083920445075162
@CompanyCode519[String] = 6373083908618598731
@CompanyCode520[String] = 6373083911842783146
@CompanyCode521[String] = 6373083913928202424
@ParentCompanyCode522[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921389720849710
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	 SELECT   [TbOrganizationMap].* FROM [TbOrganizationMap]  WHERE ((([TbOrganizationMap].[Type] = @Type523) AND ([TbOrganizationMap].[ProjectId] = @ProjectId524)) AND (([TbOrganizationMap].[CompanyCode] IN (@CompanyCode525,@CompanyCode526,@CompanyCode527,@CompanyCode528,@CompanyCode529,@CompanyCode530,@CompanyCode531,@CompanyCode532)) OR ([TbOrganizationMap].[ParentCompanyCode] = @ParentCompanyCode533))) 	
Parameters:
@Type523[Int32] = 2
@ProjectId524[String] = 6372912251695766465
@CompanyCode525[String] = 6373083923489249281
@CompanyCode526[String] = 6373083925531366080
@CompanyCode527[String] = 6373083927883400612
@CompanyCode528[String] = 6373083918575368225
@CompanyCode529[String] = 6373083920445075162
@CompanyCode530[String] = 6373083908618598731
@CompanyCode531[String] = 6373083911842783146
@CompanyCode532[String] = 6373083913928202424
@ParentCompanyCode533[String] = 6372921389720849710


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/GISGridList


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	WITH TREE AS(SELECT * FROM TbCompany WHERE CompanyCode =@parentCode UNION ALL SELECT TbCompany.* FROM TbCompany, TREE WHERE TbCompany.ParentCompanyCode = TREE.CompanyCode) SELECT CompanyCode FROM TREE where TREE.OrgType=@type	
Parameters:
@parentCode[String] = 6372921375874657752
@type[Int32] = 5


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode 	


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	with temptbl as (SELECT ROW_NUMBER() OVER (order by SiteCode asc)AS Row, * from (select tc.CompanyFullName as SiteName,ret.* from (
                            select 
                            SiteCode,
                            isnull(convert(varchar(50),min(PlanTime)),'') as PlanTime,
                            isnull(convert(varchar(50),max(ActualTime)),'') as ActualTime,
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=3) as PlanTotal1, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=4) as PlanTotal2, 
                            (select sum(PlanTotal) from TbModelReporte where SiteCode=a.SiteCode and type=5) as PlanTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=4) as ProcessingTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=1 and type=5) as ProcessingTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工中') as ProcessingTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=4) as MachinTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=2 and type=5) as MachinTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and ComponentStrat='加工完成') as MachinTotal3,  
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=4) as InstallTotal1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and State=3 and type=5) as InstallTotal2, 
                            (select count(*) from TbWorkOrderDetail where SiteCode=a.SiteCode and IsInstall='是') as InstallTotal3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference<0) as lag1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference<0) as lag2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference<0) as lag3, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=4 and Difference>0) as lea1, 
                            (select count(*) from TbModelReporte where SiteCode=a.SiteCode and type=5 and Difference>0) as lea2, 
                            (select count(*) from TbModelOtherInfo where SiteCode=a.SiteCode and type=2 and Difference>0) as lea3 
                            from TbModelReporte a
                            where 1=1 and SiteCode in('6373083923489249281','6373083925531366080','6373083927883400612','6373083918575368225','6373083920445075162','6373083908618598731','6373083911842783146','6373083913928202424','6373083877551621804','6373083879921857377','6373083881542550067','6373083883689772886','6373083887136270013','6373083889697116488','6373083891969846476','6373083894422586761','6373083897509963358','6373083900444931227','6373083829464571372','6373083833327492328','6373083841964286321','6373083844982558950','6373083847585007801','6373083856887939900','6373083859102666584','6373083864919499284','6373334974514214221')
                            group by SiteCode
                            ) ret
                            left join TbCompany tc on ret.SiteCode=tc.CompanyCode ) as a)  SELECT * FROM temptbl where Row between 1 and 50	


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	SELECT mm.MenuUrl, pp.UserCode, pp.menuCode, pp.OperationView, pp.OperationAdd
	                        , pp.OperationEdit, pp.OperationDel, pp.OperationExamination, pp.OperationOutput, pp.OperationOther1
	                        , mm.OperationOther1Fun, mm.OperationOther1IconCls, pp.OperationOther2, mm.OperationOther2Fun, mm.OperationOther2IconCls
	                        , pp.OperationOther3, mm.OperationOther3Fun, mm.OperationOther3IconCls, pp.OperationOther4, mm.OperationOther4Fun
	                        , mm.OperationOther4IconCls, pp.OperationOther5, mm.OperationOther5Fun, mm.OperationOther5IconCls
                        FROM (
	                        SELECT UserCode, menuCode, MAX(OperationView) AS OperationView
		                        , MAX(OperationAdd) AS OperationAdd, MAX(OperationEdit) AS OperationEdit
		                        , MAX(OperationDel) AS OperationDel, MAX(OperationExamination) AS OperationExamination
		                        , MAX(OperationOutput) AS OperationOutput, MAX(OperationOther1) AS OperationOther1
		                        , MAX(OperationOther2) AS OperationOther2, MAX(OperationOther3) AS OperationOther3
		                        , MAX(OperationOther4) AS OperationOther4, MAX(OperationOther5) AS OperationOther5
	                        FROM (
		                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
			                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
			                        , OperationOther3, OperationOther4, OperationOther5
		                        FROM (
			                        SELECT a.UserCode, b.menuCode, MAX(b.OperationView) AS OperationView
				                        , MAX(b.OperationAdd) AS OperationAdd, MAX(b.OperationEdit) AS OperationEdit
				                        , MAX(b.OperationDel) AS OperationDel, MAX(b.OperationExamination) AS OperationExamination
				                        , MAX(b.OperationOutput) AS OperationOutput, MAX(b.OperationOther1) AS OperationOther1
				                        , MAX(b.OperationOther2) AS OperationOther2, MAX(b.OperationOther3) AS OperationOther3
				                        , MAX(b.OperationOther4) AS OperationOther4, MAX(b.OperationOther5) AS OperationOther5
			                        FROM dbo.TbUserRole a
				                        INNER JOIN dbo.TbRoleMenu b ON a.RoleCode = b.RoleCode
                                        where b.RoleCode in('6372919444627396738','6372919451594895243')
			                        GROUP BY a.UserCode, b.menuCode
			                        UNION ALL
			                        SELECT UserCode, menuCode, OperationView, OperationAdd, OperationEdit
				                        , OperationDel, OperationExamination, OperationOutput, OperationOther1, OperationOther2
				                        , OperationOther3, OperationOther4, OperationOther5
			                        FROM dbo.TbUserMenu
			                        union all
			                        SELECT p.UserCode, d.menuCode, MAX(d.OperationView) AS OperationView
				                        , MAX(d.OperationAdd) AS OperationAdd, MAX(d.OperationEdit) AS OperationEdit
				                        , MAX(d.OperationDel) AS OperationDel, MAX(d.OperationExamination) AS OperationExamination
				                        , MAX(d.OperationOutput) AS OperationOutput, MAX(d.OperationOther1) AS OperationOther1
				                        , MAX(d.OperationOther2) AS OperationOther2, MAX(d.OperationOther3) AS OperationOther3
				                        , MAX(d.OperationOther4) AS OperationOther4, MAX(d.OperationOther5) AS OperationOther5
			                        FROM dbo.TbPositionUser p
				                        INNER JOIN dbo.TbPositionMenu d ON p.PositionCode = d.PositionCode
			                        GROUP BY p.UserCode, d.menuCode
			
		                        ) c
	                        ) aa
	                        GROUP BY UserCode, menuCode
                        ) pp
                        INNER JOIN dbo.TbSysMenu mm ON pp.menuCode = mm.menuCode 
                        left join dbo.TbUser u on pp.UserCode=u.UserId
                        where u.UserCode=@UserCode And mm.MenuUrl=@menuURI	
Parameters:
@UserCode[String] = 500000
@menuURI[String] = /BIM/3DGridList


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	select a.*,a.FullCode as ProjectId,b.CompanyFullName as ParentCompanyName from TbCompany a
left join TbCompany b on a.ParentCompanyCode=b.CompanyCode 
where 1=1  order by a.LocalCurrency asc	


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=2;	


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	select FullCode,CompanyCode,CompanyFullName,Address,OrgType,PostalCode from TbCompany where OrgType=1 order by CompanyCode asc;	


-----------------------------------------------------------------------------
2020-08-25 17:25:30
Text:	select ComponentCode as id,ComponentCodeP as pid,ComponentName as name,FileName
                               from 
                               TbModelReporte
                               where SiteCode=@SiteCode	
Parameters:
@SiteCode[String] = 6372921375874657752


-----------------------------------------------------------------------------
2020-08-25 17:28:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:31:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:34:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:37:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:40:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:43:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:46:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:49:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:52:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:55:29
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
2020-08-25 17:58:30
Text:	select COUNT(1) as MsgCount from TbFlowPerformOpinions o
                           left join TbFlowPerform p on o.FlowPerformID=p.FlowPerformID
                           left join TbFlowDefine d on p.FlowCode=d.FlowCode
                           where o.UserCode=@UserCode and (ISNULL(@ProjectId,'')='' or d.ProjectId=@ProjectId) and (PerformState=-1 or PerformState=7)
                           union all
                           select COUNT(1) as MsgCount from TbFormEarlyWarningNodeInfo m where m.MsgType=1 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select SUM(Tb.EarlyCount) as earlywarningcount from (select COUNT(1) as EarlyCount from TbFormEarlyWarningNodeInfo m where m.MsgType=2 and m.EWStart=0 and m.EWUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or m.ProjectId=@ProjectId)
                           union all
                           select COUNT(1) as EarlyCount from TbFlowEarlyWarningOtherInfo o where o.EarlyWarningStart=0 and o.FlowYjUserCode=@UserCode and (ISNULL(@ProjectId,'')='' or o.ProjectId=@ProjectId)) Tb	
Parameters:
@UserCode[String] = 6372930471544160074
@ProjectId[String] = 6372912251695766465


-----------------------------------------------------------------------------
